
(function(e,undefined){var t,n,r=typeof undefined,i=e.location,o=e.document,s=o.documentElement,a=e.jQuery,u=e.$,l={},c=[],p="2.0.3",f=c.concat,h=c.push,d=c.slice,g=c.indexOf,m=l.toString,y=l.hasOwnProperty,v=p.trim,x=function(e,n){return new x.fn.init(e,n,t)},b=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,w=/\S+/g,T=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,C=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,k=/^-ms-/,N=/-([\da-z])/gi,E=function(e,t){return t.toUpperCase()},S=function(){o.removeEventListener("DOMContentLoaded",S,!1),e.removeEventListener("load",S,!1),x.ready()};x.fn=x.prototype={jquery:p,constructor:x,init:function(e,t,n){var r,i;if(!e)return this;if("string"==typeof e){if(r="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:T.exec(e),!r||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof x?t[0]:t,x.merge(this,x.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:o,!0)),C.test(r[1])&&x.isPlainObject(t))for(r in t)x.isFunction(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return i=o.getElementById(r[2]),i&&i.parentNode&&(this.length=1,this[0]=i),this.context=o,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):x.isFunction(e)?n.ready(e):(e.selector!==undefined&&(this.selector=e.selector,this.context=e.context),x.makeArray(e,this))},selector:"",length:0,toArray:function(){return d.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=x.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return x.each(this,e,t)},ready:function(e){return x.ready.promise().done(e),this},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(x.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:h,sort:[].sort,splice:[].splice},x.fn.init.prototype=x.fn,x.extend=x.fn.extend=function(){var e,t,n,r,i,o,s=arguments[0]||{},a=1,u=arguments.length,l=!1;for("boolean"==typeof s&&(l=s,s=arguments[1]||{},a=2),"object"==typeof s||x.isFunction(s)||(s={}),u===a&&(s=this,--a);u>a;a++)if(null!=(e=arguments[a]))for(t in e)n=s[t],r=e[t],s!==r&&(l&&r&&(x.isPlainObject(r)||(i=x.isArray(r)))?(i?(i=!1,o=n&&x.isArray(n)?n:[]):o=n&&x.isPlainObject(n)?n:{},s[t]=x.extend(l,o,r)):r!==undefined&&(s[t]=r));return s},x.extend({expando:"jQuery"+(p+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===x&&(e.$=u),t&&e.jQuery===x&&(e.jQuery=a),x},isReady:!1,readyWait:1,holdReady:function(e){e?x.readyWait++:x.ready(!0)},ready:function(e){(e===!0?--x.readyWait:x.isReady)||(x.isReady=!0,e!==!0&&--x.readyWait>0||(n.resolveWith(o,[x]),x.fn.trigger&&x(o).trigger("ready").off("ready")))},isFunction:function(e){return"function"===x.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[m.call(e)]||"object":typeof e},isPlainObject:function(e){if("object"!==x.type(e)||e.nodeType||x.isWindow(e))return!1;try{if(e.constructor&&!y.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||o;var r=C.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=x.buildFragment([e],t,i),i&&x(i).remove(),x.merge([],r.childNodes))},parseJSON:JSON.parse,parseXML:function(e){var t,n;if(!e||"string"!=typeof e)return null;try{n=new DOMParser,t=n.parseFromString(e,"text/xml")}catch(r){t=undefined}return(!t||t.getElementsByTagName("parsererror").length)&&x.error("Invalid XML: "+e),t},noop:function(){},globalEval:function(e){var t,n=eval;e=x.trim(e),e&&(1===e.indexOf("use strict")?(t=o.createElement("script"),t.text=e,o.head.appendChild(t).parentNode.removeChild(t)):n(e))},camelCase:function(e){return e.replace(k,"ms-").replace(N,E)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,o=e.length,s=j(e);if(n){if(s){for(;o>i;i++)if(r=t.apply(e[i],n),r===!1)break}else for(i in e)if(r=t.apply(e[i],n),r===!1)break}else if(s){for(;o>i;i++)if(r=t.call(e[i],i,e[i]),r===!1)break}else for(i in e)if(r=t.call(e[i],i,e[i]),r===!1)break;return e},trim:function(e){return null==e?"":v.call(e)},makeArray:function(e,t){var n=t||[];return null!=e&&(j(Object(e))?x.merge(n,"string"==typeof e?[e]:e):h.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:g.call(t,e,n)},merge:function(e,t){var n=t.length,r=e.length,i=0;if("number"==typeof n)for(;n>i;i++)e[r++]=t[i];else while(t[i]!==undefined)e[r++]=t[i++];return e.length=r,e},grep:function(e,t,n){var r,i=[],o=0,s=e.length;for(n=!!n;s>o;o++)r=!!t(e[o],o),n!==r&&i.push(e[o]);return i},map:function(e,t,n){var r,i=0,o=e.length,s=j(e),a=[];if(s)for(;o>i;i++)r=t(e[i],i,n),null!=r&&(a[a.length]=r);else for(i in e)r=t(e[i],i,n),null!=r&&(a[a.length]=r);return f.apply([],a)},guid:1,proxy:function(e,t){var n,r,i;return"string"==typeof t&&(n=e[t],t=e,e=n),x.isFunction(e)?(r=d.call(arguments,2),i=function(){return e.apply(t||this,r.concat(d.call(arguments)))},i.guid=e.guid=e.guid||x.guid++,i):undefined},access:function(e,t,n,r,i,o,s){var a=0,u=e.length,l=null==n;if("object"===x.type(n)){i=!0;for(a in n)x.access(e,t,a,n[a],!0,o,s)}else if(r!==undefined&&(i=!0,x.isFunction(r)||(s=!0),l&&(s?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(x(e),n)})),t))for(;u>a;a++)t(e[a],n,s?r:r.call(e[a],a,t(e[a],n)));return i?e:l?t.call(e):u?t(e[0],n):o},now:Date.now,swap:function(e,t,n,r){var i,o,s={};for(o in t)s[o]=e.style[o],e.style[o]=t[o];i=n.apply(e,r||[]);for(o in t)e.style[o]=s[o];return i}}),x.ready.promise=function(t){return n||(n=x.Deferred(),"complete"===o.readyState?setTimeout(x.ready):(o.addEventListener("DOMContentLoaded",S,!1),e.addEventListener("load",S,!1))),n.promise(t)},x.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){l["[object "+t+"]"]=t.toLowerCase()});function j(e){var t=e.length,n=x.type(e);return x.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}t=x(o),function(e,undefined){var t,n,r,i,o,s,a,u,l,c,p,f,h,d,g,m,y,v="sizzle"+-new Date,b=e.document,w=0,T=0,C=st(),k=st(),N=st(),E=!1,S=function(e,t){return e===t?(E=!0,0):0},j=typeof undefined,D=1<<31,A={}.hasOwnProperty,L=[],q=L.pop,H=L.push,O=L.push,F=L.slice,P=L.indexOf||function(e){var t=0,n=this.length;for(;n>t;t++)if(this[t]===e)return t;return-1},R="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",M="[\\x20\\t\\r\\n\\f]",W="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",$=W.replace("w","w#"),B="\\["+M+"*("+W+")"+M+"*(?:([*^$|!~]?=)"+M+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+$+")|)|)"+M+"*\\]",I=":("+W+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+B.replace(3,8)+")*)|.*)\\)|)",z=RegExp("^"+M+"+|((?:^|[^\\\\])(?:\\\\.)*)"+M+"+$","g"),_=RegExp("^"+M+"*,"+M+"*"),X=RegExp("^"+M+"*([>+~]|"+M+")"+M+"*"),U=RegExp(M+"*[+~]"),Y=RegExp("="+M+"*([^\\]'\"]*)"+M+"*\\]","g"),V=RegExp(I),G=RegExp("^"+$+"$"),J={ID:RegExp("^#("+W+")"),CLASS:RegExp("^\\.("+W+")"),TAG:RegExp("^("+W.replace("w","w*")+")"),ATTR:RegExp("^"+B),PSEUDO:RegExp("^"+I),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+M+"*(even|odd|(([+-]|)(\\d*)n|)"+M+"*(?:([+-]|)"+M+"*(\\d+)|))"+M+"*\\)|)","i"),bool:RegExp("^(?:"+R+")$","i"),needsContext:RegExp("^"+M+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+M+"*((?:-\\d)?\\d*)"+M+"*\\)|)(?=[^-]|$)","i")},Q=/^[^{]+\{\s*\[native \w/,K=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Z=/^(?:input|select|textarea|button)$/i,et=/^h\d$/i,tt=/'|\\/g,nt=RegExp("\\\\([\\da-f]{1,6}"+M+"?|("+M+")|.)","ig"),rt=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:0>r?String.fromCharCode(r+65536):String.fromCharCode(55296|r>>10,56320|1023&r)};try{O.apply(L=F.call(b.childNodes),b.childNodes),L[b.childNodes.length].nodeType}catch(it){O={apply:L.length?function(e,t){H.apply(e,F.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}function ot(e,t,r,i){var o,s,a,u,l,f,g,m,x,w;if((t?t.ownerDocument||t:b)!==p&&c(t),t=t||p,r=r||[],!e||"string"!=typeof e)return r;if(1!==(u=t.nodeType)&&9!==u)return[];if(h&&!i){if(o=K.exec(e))if(a=o[1]){if(9===u){if(s=t.getElementById(a),!s||!s.parentNode)return r;if(s.id===a)return r.push(s),r}else if(t.ownerDocument&&(s=t.ownerDocument.getElementById(a))&&y(t,s)&&s.id===a)return r.push(s),r}else{if(o[2])return O.apply(r,t.getElementsByTagName(e)),r;if((a=o[3])&&n.getElementsByClassName&&t.getElementsByClassName)return O.apply(r,t.getElementsByClassName(a)),r}if(n.qsa&&(!d||!d.test(e))){if(m=g=v,x=t,w=9===u&&e,1===u&&"object"!==t.nodeName.toLowerCase()){f=gt(e),(g=t.getAttribute("id"))?m=g.replace(tt,"\\$&"):t.setAttribute("id",m),m="[id='"+m+"'] ",l=f.length;while(l--)f[l]=m+mt(f[l]);x=U.test(e)&&t.parentNode||t,w=f.join(",")}if(w)try{return O.apply(r,x.querySelectorAll(w)),r}catch(T){}finally{g||t.removeAttribute("id")}}}return kt(e.replace(z,"$1"),t,r,i)}function st(){var e=[];function t(n,r){return e.push(n+=" ")>i.cacheLength&&delete t[e.shift()],t[n]=r}return t}function at(e){return e[v]=!0,e}function ut(e){var t=p.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function lt(e,t){var n=e.split("|"),r=e.length;while(r--)i.attrHandle[n[r]]=t}function ct(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||D)-(~e.sourceIndex||D);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function pt(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function ft(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function ht(e){return at(function(t){return t=+t,at(function(n,r){var i,o=e([],n.length,t),s=o.length;while(s--)n[i=o[s]]&&(n[i]=!(r[i]=n[i]))})})}s=ot.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},n=ot.support={},c=ot.setDocument=function(e){var t=e?e.ownerDocument||e:b,r=t.defaultView;return t!==p&&9===t.nodeType&&t.documentElement?(p=t,f=t.documentElement,h=!s(t),r&&r.attachEvent&&r!==r.top&&r.attachEvent("onbeforeunload",function(){c()}),n.attributes=ut(function(e){return e.className="i",!e.getAttribute("className")}),n.getElementsByTagName=ut(function(e){return e.appendChild(t.createComment("")),!e.getElementsByTagName("*").length}),n.getElementsByClassName=ut(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),n.getById=ut(function(e){return f.appendChild(e).id=v,!t.getElementsByName||!t.getElementsByName(v).length}),n.getById?(i.find.ID=function(e,t){if(typeof t.getElementById!==j&&h){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},i.filter.ID=function(e){var t=e.replace(nt,rt);return function(e){return e.getAttribute("id")===t}}):(delete i.find.ID,i.filter.ID=function(e){var t=e.replace(nt,rt);return function(e){var n=typeof e.getAttributeNode!==j&&e.getAttributeNode("id");return n&&n.value===t}}),i.find.TAG=n.getElementsByTagName?function(e,t){return typeof t.getElementsByTagName!==j?t.getElementsByTagName(e):undefined}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){while(n=o[i++])1===n.nodeType&&r.push(n);return r}return o},i.find.CLASS=n.getElementsByClassName&&function(e,t){return typeof t.getElementsByClassName!==j&&h?t.getElementsByClassName(e):undefined},g=[],d=[],(n.qsa=Q.test(t.querySelectorAll))&&(ut(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||d.push("\\["+M+"*(?:value|"+R+")"),e.querySelectorAll(":checked").length||d.push(":checked")}),ut(function(e){var n=t.createElement("input");n.setAttribute("type","hidden"),e.appendChild(n).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&d.push("[*^$]="+M+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||d.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),d.push(",.*:")})),(n.matchesSelector=Q.test(m=f.webkitMatchesSelector||f.mozMatchesSelector||f.oMatchesSelector||f.msMatchesSelector))&&ut(function(e){n.disconnectedMatch=m.call(e,"div"),m.call(e,"[s!='']:x"),g.push("!=",I)}),d=d.length&&RegExp(d.join("|")),g=g.length&&RegExp(g.join("|")),y=Q.test(f.contains)||f.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},S=f.compareDocumentPosition?function(e,r){if(e===r)return E=!0,0;var i=r.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(r);return i?1&i||!n.sortDetached&&r.compareDocumentPosition(e)===i?e===t||y(b,e)?-1:r===t||y(b,r)?1:l?P.call(l,e)-P.call(l,r):0:4&i?-1:1:e.compareDocumentPosition?-1:1}:function(e,n){var r,i=0,o=e.parentNode,s=n.parentNode,a=[e],u=[n];if(e===n)return E=!0,0;if(!o||!s)return e===t?-1:n===t?1:o?-1:s?1:l?P.call(l,e)-P.call(l,n):0;if(o===s)return ct(e,n);r=e;while(r=r.parentNode)a.unshift(r);r=n;while(r=r.parentNode)u.unshift(r);while(a[i]===u[i])i++;return i?ct(a[i],u[i]):a[i]===b?-1:u[i]===b?1:0},t):p},ot.matches=function(e,t){return ot(e,null,null,t)},ot.matchesSelector=function(e,t){if((e.ownerDocument||e)!==p&&c(e),t=t.replace(Y,"='$1']"),!(!n.matchesSelector||!h||g&&g.test(t)||d&&d.test(t)))try{var r=m.call(e,t);if(r||n.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(i){}return ot(t,p,null,[e]).length>0},ot.contains=function(e,t){return(e.ownerDocument||e)!==p&&c(e),y(e,t)},ot.attr=function(e,t){(e.ownerDocument||e)!==p&&c(e);var r=i.attrHandle[t.toLowerCase()],o=r&&A.call(i.attrHandle,t.toLowerCase())?r(e,t,!h):undefined;return o===undefined?n.attributes||!h?e.getAttribute(t):(o=e.getAttributeNode(t))&&o.specified?o.value:null:o},ot.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},ot.uniqueSort=function(e){var t,r=[],i=0,o=0;if(E=!n.detectDuplicates,l=!n.sortStable&&e.slice(0),e.sort(S),E){while(t=e[o++])t===e[o]&&(i=r.push(o));while(i--)e.splice(r[i],1)}return e},o=ot.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=o(t);return n},i=ot.selectors={cacheLength:50,createPseudo:at,match:J,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(nt,rt),e[3]=(e[4]||e[5]||"").replace(nt,rt),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ot.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ot.error(e[0]),e},PSEUDO:function(e){var t,n=!e[5]&&e[2];return J.CHILD.test(e[0])?null:(e[3]&&e[4]!==undefined?e[2]=e[4]:n&&V.test(n)&&(t=gt(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(nt,rt).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=C[e+" "];return t||(t=RegExp("(^|"+M+")"+e+"("+M+"|$)"))&&C(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==j&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=ot.attr(r,e);return null==i?"!="===t:t?(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i+" ").indexOf(n)>-1:"|="===t?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),s="last"!==e.slice(-4),a="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,u){var l,c,p,f,h,d,g=o!==s?"nextSibling":"previousSibling",m=t.parentNode,y=a&&t.nodeName.toLowerCase(),x=!u&&!a;if(m){if(o){while(g){p=t;while(p=p[g])if(a?p.nodeName.toLowerCase()===y:1===p.nodeType)return!1;d=g="only"===e&&!d&&"nextSibling"}return!0}if(d=[s?m.firstChild:m.lastChild],s&&x){c=m[v]||(m[v]={}),l=c[e]||[],h=l[0]===w&&l[1],f=l[0]===w&&l[2],p=h&&m.childNodes[h];while(p=++h&&p&&p[g]||(f=h=0)||d.pop())if(1===p.nodeType&&++f&&p===t){c[e]=[w,h,f];break}}else if(x&&(l=(t[v]||(t[v]={}))[e])&&l[0]===w)f=l[1];else while(p=++h&&p&&p[g]||(f=h=0)||d.pop())if((a?p.nodeName.toLowerCase()===y:1===p.nodeType)&&++f&&(x&&((p[v]||(p[v]={}))[e]=[w,f]),p===t))break;return f-=i,f===r||0===f%r&&f/r>=0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||ot.error("unsupported pseudo: "+e);return r[v]?r(t):r.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?at(function(e,n){var i,o=r(e,t),s=o.length;while(s--)i=P.call(e,o[s]),e[i]=!(n[i]=o[s])}):function(e){return r(e,0,n)}):r}},pseudos:{not:at(function(e){var t=[],n=[],r=a(e.replace(z,"$1"));return r[v]?at(function(e,t,n,i){var o,s=r(e,null,i,[]),a=e.length;while(a--)(o=s[a])&&(e[a]=!(t[a]=o))}):function(e,i,o){return t[0]=e,r(t,null,o,n),!n.pop()}}),has:at(function(e){return function(t){return ot(e,t).length>0}}),contains:at(function(e){return function(t){return(t.textContent||t.innerText||o(t)).indexOf(e)>-1}}),lang:at(function(e){return G.test(e||"")||ot.error("unsupported lang: "+e),e=e.replace(nt,rt).toLowerCase(),function(t){var n;do if(n=h?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===f},focus:function(e){return e===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!i.pseudos.empty(e)},header:function(e){return et.test(e.nodeName)},input:function(e){return Z.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:ht(function(){return[0]}),last:ht(function(e,t){return[t-1]}),eq:ht(function(e,t,n){return[0>n?n+t:n]}),even:ht(function(e,t){var n=0;for(;t>n;n+=2)e.push(n);return e}),odd:ht(function(e,t){var n=1;for(;t>n;n+=2)e.push(n);return e}),lt:ht(function(e,t,n){var r=0>n?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:ht(function(e,t,n){var r=0>n?n+t:n;for(;t>++r;)e.push(r);return e})}},i.pseudos.nth=i.pseudos.eq;for(t in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[t]=pt(t);for(t in{submit:!0,reset:!0})i.pseudos[t]=ft(t);function dt(){}dt.prototype=i.filters=i.pseudos,i.setFilters=new dt;function gt(e,t){var n,r,o,s,a,u,l,c=k[e+" "];if(c)return t?0:c.slice(0);a=e,u=[],l=i.preFilter;while(a){(!n||(r=_.exec(a)))&&(r&&(a=a.slice(r[0].length)||a),u.push(o=[])),n=!1,(r=X.exec(a))&&(n=r.shift(),o.push({value:n,type:r[0].replace(z," ")}),a=a.slice(n.length));for(s in i.filter)!(r=J[s].exec(a))||l[s]&&!(r=l[s](r))||(n=r.shift(),o.push({value:n,type:s,matches:r}),a=a.slice(n.length));if(!n)break}return t?a.length:a?ot.error(e):k(e,u).slice(0)}function mt(e){var t=0,n=e.length,r="";for(;n>t;t++)r+=e[t].value;return r}function yt(e,t,n){var i=t.dir,o=n&&"parentNode"===i,s=T++;return t.first?function(t,n,r){while(t=t[i])if(1===t.nodeType||o)return e(t,n,r)}:function(t,n,a){var u,l,c,p=w+" "+s;if(a){while(t=t[i])if((1===t.nodeType||o)&&e(t,n,a))return!0}else while(t=t[i])if(1===t.nodeType||o)if(c=t[v]||(t[v]={}),(l=c[i])&&l[0]===p){if((u=l[1])===!0||u===r)return u===!0}else if(l=c[i]=[p],l[1]=e(t,n,a)||r,l[1]===!0)return!0}}function vt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function xt(e,t,n,r,i){var o,s=[],a=0,u=e.length,l=null!=t;for(;u>a;a++)(o=e[a])&&(!n||n(o,r,i))&&(s.push(o),l&&t.push(a));return s}function bt(e,t,n,r,i,o){return r&&!r[v]&&(r=bt(r)),i&&!i[v]&&(i=bt(i,o)),at(function(o,s,a,u){var l,c,p,f=[],h=[],d=s.length,g=o||Ct(t||"*",a.nodeType?[a]:a,[]),m=!e||!o&&t?g:xt(g,f,e,a,u),y=n?i||(o?e:d||r)?[]:s:m;if(n&&n(m,y,a,u),r){l=xt(y,h),r(l,[],a,u),c=l.length;while(c--)(p=l[c])&&(y[h[c]]=!(m[h[c]]=p))}if(o){if(i||e){if(i){l=[],c=y.length;while(c--)(p=y[c])&&l.push(m[c]=p);i(null,y=[],l,u)}c=y.length;while(c--)(p=y[c])&&(l=i?P.call(o,p):f[c])>-1&&(o[l]=!(s[l]=p))}}else y=xt(y===s?y.splice(d,y.length):y),i?i(null,s,y,u):O.apply(s,y)})}function wt(e){var t,n,r,o=e.length,s=i.relative[e[0].type],a=s||i.relative[" "],l=s?1:0,c=yt(function(e){return e===t},a,!0),p=yt(function(e){return P.call(t,e)>-1},a,!0),f=[function(e,n,r){return!s&&(r||n!==u)||((t=n).nodeType?c(e,n,r):p(e,n,r))}];for(;o>l;l++)if(n=i.relative[e[l].type])f=[yt(vt(f),n)];else{if(n=i.filter[e[l].type].apply(null,e[l].matches),n[v]){for(r=++l;o>r;r++)if(i.relative[e[r].type])break;return bt(l>1&&vt(f),l>1&&mt(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(z,"$1"),n,r>l&&wt(e.slice(l,r)),o>r&&wt(e=e.slice(r)),o>r&&mt(e))}f.push(n)}return vt(f)}function Tt(e,t){var n=0,o=t.length>0,s=e.length>0,a=function(a,l,c,f,h){var d,g,m,y=[],v=0,x="0",b=a&&[],T=null!=h,C=u,k=a||s&&i.find.TAG("*",h&&l.parentNode||l),N=w+=null==C?1:Math.random()||.1;for(T&&(u=l!==p&&l,r=n);null!=(d=k[x]);x++){if(s&&d){g=0;while(m=e[g++])if(m(d,l,c)){f.push(d);break}T&&(w=N,r=++n)}o&&((d=!m&&d)&&v--,a&&b.push(d))}if(v+=x,o&&x!==v){g=0;while(m=t[g++])m(b,y,l,c);if(a){if(v>0)while(x--)b[x]||y[x]||(y[x]=q.call(f));y=xt(y)}O.apply(f,y),T&&!a&&y.length>0&&v+t.length>1&&ot.uniqueSort(f)}return T&&(w=N,u=C),b};return o?at(a):a}a=ot.compile=function(e,t){var n,r=[],i=[],o=N[e+" "];if(!o){t||(t=gt(e)),n=t.length;while(n--)o=wt(t[n]),o[v]?r.push(o):i.push(o);o=N(e,Tt(i,r))}return o};function Ct(e,t,n){var r=0,i=t.length;for(;i>r;r++)ot(e,t[r],n);return n}function kt(e,t,r,o){var s,u,l,c,p,f=gt(e);if(!o&&1===f.length){if(u=f[0]=f[0].slice(0),u.length>2&&"ID"===(l=u[0]).type&&n.getById&&9===t.nodeType&&h&&i.relative[u[1].type]){if(t=(i.find.ID(l.matches[0].replace(nt,rt),t)||[])[0],!t)return r;e=e.slice(u.shift().value.length)}s=J.needsContext.test(e)?0:u.length;while(s--){if(l=u[s],i.relative[c=l.type])break;if((p=i.find[c])&&(o=p(l.matches[0].replace(nt,rt),U.test(u[0].type)&&t.parentNode||t))){if(u.splice(s,1),e=o.length&&mt(u),!e)return O.apply(r,o),r;break}}}return a(e,f)(o,t,!h,r,U.test(e)),r}n.sortStable=v.split("").sort(S).join("")===v,n.detectDuplicates=E,c(),n.sortDetached=ut(function(e){return 1&e.compareDocumentPosition(p.createElement("div"))}),ut(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||lt("type|href|height|width",function(e,t,n){return n?undefined:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),n.attributes&&ut(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||lt("value",function(e,t,n){return n||"input"!==e.nodeName.toLowerCase()?undefined:e.defaultValue}),ut(function(e){return null==e.getAttribute("disabled")})||lt(R,function(e,t,n){var r;return n?undefined:(r=e.getAttributeNode(t))&&r.specified?r.value:e[t]===!0?t.toLowerCase():null}),x.find=ot,x.expr=ot.selectors,x.expr[":"]=x.expr.pseudos,x.unique=ot.uniqueSort,x.text=ot.getText,x.isXMLDoc=ot.isXML,x.contains=ot.contains}(e);var D={};function A(e){var t=D[e]={};return x.each(e.match(w)||[],function(e,n){t[n]=!0}),t}x.Callbacks=function(e){e="string"==typeof e?D[e]||A(e):x.extend({},e);var t,n,r,i,o,s,a=[],u=!e.once&&[],l=function(p){for(t=e.memory&&p,n=!0,s=i||0,i=0,o=a.length,r=!0;a&&o>s;s++)if(a[s].apply(p[0],p[1])===!1&&e.stopOnFalse){t=!1;break}r=!1,a&&(u?u.length&&l(u.shift()):t?a=[]:c.disable())},c={add:function(){if(a){var n=a.length;(function s(t){x.each(t,function(t,n){var r=x.type(n);"function"===r?e.unique&&c.has(n)||a.push(n):n&&n.length&&"string"!==r&&s(n)})})(arguments),r?o=a.length:t&&(i=n,l(t))}return this},remove:function(){return a&&x.each(arguments,function(e,t){var n;while((n=x.inArray(t,a,n))>-1)a.splice(n,1),r&&(o>=n&&o--,s>=n&&s--)}),this},has:function(e){return e?x.inArray(e,a)>-1:!(!a||!a.length)},empty:function(){return a=[],o=0,this},disable:function(){return a=u=t=undefined,this},disabled:function(){return!a},lock:function(){return u=undefined,t||c.disable(),this},locked:function(){return!u},fireWith:function(e,t){return!a||n&&!u||(t=t||[],t=[e,t.slice?t.slice():t],r?u.push(t):l(t)),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!n}};return c},x.extend({Deferred:function(e){var t=[["resolve","done",x.Callbacks("once memory"),"resolved"],["reject","fail",x.Callbacks("once memory"),"rejected"],["notify","progress",x.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return x.Deferred(function(n){x.each(t,function(t,o){var s=o[0],a=x.isFunction(e[t])&&e[t];i[o[1]](function(){var e=a&&a.apply(this,arguments);e&&x.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[s+"With"](this===r?n.promise():this,a?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?x.extend(e,r):r}},i={};return r.pipe=r.then,x.each(t,function(e,o){var s=o[2],a=o[3];r[o[1]]=s.add,a&&s.add(function(){n=a},t[1^e][2].disable,t[2][2].lock),i[o[0]]=function(){return i[o[0]+"With"](this===i?r:this,arguments),this},i[o[0]+"With"]=s.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=d.call(arguments),r=n.length,i=1!==r||e&&x.isFunction(e.promise)?r:0,o=1===i?e:x.Deferred(),s=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?d.call(arguments):r,n===a?o.notifyWith(t,n):--i||o.resolveWith(t,n)}},a,u,l;if(r>1)for(a=Array(r),u=Array(r),l=Array(r);r>t;t++)n[t]&&x.isFunction(n[t].promise)?n[t].promise().done(s(t,l,n)).fail(o.reject).progress(s(t,u,a)):--i;return i||o.resolveWith(l,n),o.promise()}}),x.support=function(t){var n=o.createElement("input"),r=o.createDocumentFragment(),i=o.createElement("div"),s=o.createElement("select"),a=s.appendChild(o.createElement("option"));return n.type?(n.type="checkbox",t.checkOn=""!==n.value,t.optSelected=a.selected,t.reliableMarginRight=!0,t.boxSizingReliable=!0,t.pixelPosition=!1,n.checked=!0,t.noCloneChecked=n.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!a.disabled,n=o.createElement("input"),n.value="t",n.type="radio",t.radioValue="t"===n.value,n.setAttribute("checked","t"),n.setAttribute("name","t"),r.appendChild(n),t.checkClone=r.cloneNode(!0).cloneNode(!0).lastChild.checked,t.focusinBubbles="onfocusin"in e,i.style.backgroundClip="content-box",i.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===i.style.backgroundClip,x(function(){var n,r,s="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",a=o.getElementsByTagName("body")[0];a&&(n=o.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",a.appendChild(n).appendChild(i),i.innerHTML="",i.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",x.swap(a,null!=a.style.zoom?{zoom:1}:{},function(){t.boxSizing=4===i.offsetWidth}),e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(i,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(i,null)||{width:"4px"}).width,r=i.appendChild(o.createElement("div")),r.style.cssText=i.style.cssText=s,r.style.marginRight=r.style.width="0",i.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),a.removeChild(n))}),t):t}({});var L,q,H=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,O=/([A-Z])/g;function F(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=x.expando+Math.random()}F.uid=1,F.accepts=function(e){return e.nodeType?1===e.nodeType||9===e.nodeType:!0},F.prototype={key:function(e){if(!F.accepts(e))return 0;var t={},n=e[this.expando];if(!n){n=F.uid++;try{t[this.expando]={value:n},Object.defineProperties(e,t)}catch(r){t[this.expando]=n,x.extend(e,t)}}return this.cache[n]||(this.cache[n]={}),n},set:function(e,t,n){var r,i=this.key(e),o=this.cache[i];if("string"==typeof t)o[t]=n;else if(x.isEmptyObject(o))x.extend(this.cache[i],t);else for(r in t)o[r]=t[r];return o},get:function(e,t){var n=this.cache[this.key(e)];return t===undefined?n:n[t]},access:function(e,t,n){var r;return t===undefined||t&&"string"==typeof t&&n===undefined?(r=this.get(e,t),r!==undefined?r:this.get(e,x.camelCase(t))):(this.set(e,t,n),n!==undefined?n:t)},remove:function(e,t){var n,r,i,o=this.key(e),s=this.cache[o];if(t===undefined)this.cache[o]={};else{x.isArray(t)?r=t.concat(t.map(x.camelCase)):(i=x.camelCase(t),t in s?r=[t,i]:(r=i,r=r in s?[r]:r.match(w)||[])),n=r.length;while(n--)delete s[r[n]]}},hasData:function(e){return!x.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}},L=new F,q=new F,x.extend({acceptData:F.accepts,hasData:function(e){return L.hasData(e)||q.hasData(e)},data:function(e,t,n){return L.access(e,t,n)},removeData:function(e,t){L.remove(e,t)},_data:function(e,t,n){return q.access(e,t,n)},_removeData:function(e,t){q.remove(e,t)}}),x.fn.extend({data:function(e,t){var n,r,i=this[0],o=0,s=null;if(e===undefined){if(this.length&&(s=L.get(i),1===i.nodeType&&!q.get(i,"hasDataAttrs"))){for(n=i.attributes;n.length>o;o++)r=n[o].name,0===r.indexOf("data-")&&(r=x.camelCase(r.slice(5)),P(i,r,s[r]));q.set(i,"hasDataAttrs",!0)}return s}return"object"==typeof e?this.each(function(){L.set(this,e)}):x.access(this,function(t){var n,r=x.camelCase(e);if(i&&t===undefined){if(n=L.get(i,e),n!==undefined)return n;if(n=L.get(i,r),n!==undefined)return n;if(n=P(i,r,undefined),n!==undefined)return n}else this.each(function(){var n=L.get(this,r);L.set(this,r,t),-1!==e.indexOf("-")&&n!==undefined&&L.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){L.remove(this,e)})}});function P(e,t,n){var r;if(n===undefined&&1===e.nodeType)if(r="data-"+t.replace(O,"-$1").toLowerCase(),n=e.getAttribute(r),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:H.test(n)?JSON.parse(n):n}catch(i){}L.set(e,t,n)}else n=undefined;return n}x.extend({queue:function(e,t,n){var r;return e?(t=(t||"fx")+"queue",r=q.get(e,t),n&&(!r||x.isArray(n)?r=q.access(e,t,x.makeArray(n)):r.push(n)),r||[]):undefined},dequeue:function(e,t){t=t||"fx";var n=x.queue(e,t),r=n.length,i=n.shift(),o=x._queueHooks(e,t),s=function(){x.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,s,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return q.get(e,n)||q.access(e,n,{empty:x.Callbacks("once memory").add(function(){q.remove(e,[t+"queue",n])})})}}),x.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),n>arguments.length?x.queue(this[0],e):t===undefined?this:this.each(function(){var n=x.queue(this,e,t);x._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&x.dequeue(this,e)})},dequeue:function(e){return this.each(function(){x.dequeue(this,e)})},delay:function(e,t){return e=x.fx?x.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=x.Deferred(),o=this,s=this.length,a=function(){--r||i.resolveWith(o,[o])};"string"!=typeof e&&(t=e,e=undefined),e=e||"fx";while(s--)n=q.get(o[s],e+"queueHooks"),n&&n.empty&&(r++,n.empty.add(a));return a(),i.promise(t)}});var R,M,W=/[\t\r\n\f]/g,$=/\r/g,B=/^(?:input|select|textarea|button)$/i;x.fn.extend({attr:function(e,t){return x.access(this,x.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){x.removeAttr(this,e)})},prop:function(e,t){return x.access(this,x.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[x.propFix[e]||e]})},addClass:function(e){var t,n,r,i,o,s=0,a=this.length,u="string"==typeof e&&e;if(x.isFunction(e))return this.each(function(t){x(this).addClass(e.call(this,t,this.className))});if(u)for(t=(e||"").match(w)||[];a>s;s++)if(n=this[s],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(W," "):" ")){o=0;while(i=t[o++])0>r.indexOf(" "+i+" ")&&(r+=i+" ");n.className=x.trim(r)}return this},removeClass:function(e){var t,n,r,i,o,s=0,a=this.length,u=0===arguments.length||"string"==typeof e&&e;if(x.isFunction(e))return this.each(function(t){x(this).removeClass(e.call(this,t,this.className))});if(u)for(t=(e||"").match(w)||[];a>s;s++)if(n=this[s],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(W," "):"")){o=0;while(i=t[o++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");n.className=e?x.trim(r):""}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):x.isFunction(e)?this.each(function(n){x(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n){var t,i=0,o=x(this),s=e.match(w)||[];while(t=s[i++])o.hasClass(t)?o.removeClass(t):o.addClass(t)}else(n===r||"boolean"===n)&&(this.className&&q.set(this,"__className__",this.className),this.className=this.className||e===!1?"":q.get(this,"__className__")||"")})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(W," ").indexOf(t)>=0)return!0;return!1},val:function(e){var t,n,r,i=this[0];{if(arguments.length)return r=x.isFunction(e),this.each(function(n){var i;1===this.nodeType&&(i=r?e.call(this,n,x(this).val()):e,null==i?i="":"number"==typeof i?i+="":x.isArray(i)&&(i=x.map(i,function(e){return null==e?"":e+""})),t=x.valHooks[this.type]||x.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&t.set(this,i,"value")!==undefined||(this.value=i))});if(i)return t=x.valHooks[i.type]||x.valHooks[i.nodeName.toLowerCase()],t&&"get"in t&&(n=t.get(i,"value"))!==undefined?n:(n=i.value,"string"==typeof n?n.replace($,""):null==n?"":n)}}}),x.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,o="select-one"===e.type||0>i,s=o?null:[],a=o?i+1:r.length,u=0>i?a:o?i:0;for(;a>u;u++)if(n=r[u],!(!n.selected&&u!==i||(x.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&x.nodeName(n.parentNode,"optgroup"))){if(t=x(n).val(),o)return t;s.push(t)}return s},set:function(e,t){var n,r,i=e.options,o=x.makeArray(t),s=i.length;while(s--)r=i[s],(r.selected=x.inArray(x(r).val(),o)>=0)&&(n=!0);return n||(e.selectedIndex=-1),o}}},attr:function(e,t,n){var i,o,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return typeof e.getAttribute===r?x.prop(e,t,n):(1===s&&x.isXMLDoc(e)||(t=t.toLowerCase(),i=x.attrHooks[t]||(x.expr.match.bool.test(t)?M:R)),n===undefined?i&&"get"in i&&null!==(o=i.get(e,t))?o:(o=x.find.attr(e,t),null==o?undefined:o):null!==n?i&&"set"in i&&(o=i.set(e,n,t))!==undefined?o:(e.setAttribute(t,n+""),n):(x.removeAttr(e,t),undefined))},removeAttr:function(e,t){var n,r,i=0,o=t&&t.match(w);if(o&&1===e.nodeType)while(n=o[i++])r=x.propFix[n]||n,x.expr.match.bool.test(n)&&(e[r]=!1),e.removeAttribute(n)},attrHooks:{type:{set:function(e,t){if(!x.support.radioValue&&"radio"===t&&x.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,n){var r,i,o,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return o=1!==s||!x.isXMLDoc(e),o&&(t=x.propFix[t]||t,i=x.propHooks[t]),n!==undefined?i&&"set"in i&&(r=i.set(e,n,t))!==undefined?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||B.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),M={set:function(e,t,n){return t===!1?x.removeAttr(e,n):e.setAttribute(n,n),n}},x.each(x.expr.match.bool.source.match(/\w+/g),function(e,t){var n=x.expr.attrHandle[t]||x.find.attr;x.expr.attrHandle[t]=function(e,t,r){var i=x.expr.attrHandle[t],o=r?undefined:(x.expr.attrHandle[t]=undefined)!=n(e,t,r)?t.toLowerCase():null;return x.expr.attrHandle[t]=i,o}}),x.support.optSelected||(x.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),x.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){x.propFix[this.toLowerCase()]=this}),x.each(["radio","checkbox"],function(){x.valHooks[this]={set:function(e,t){return x.isArray(t)?e.checked=x.inArray(x(e).val(),t)>=0:undefined}},x.support.checkOn||(x.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var I=/^key/,z=/^(?:mouse|contextmenu)|click/,_=/^(?:focusinfocus|focusoutblur)$/,X=/^([^.]*)(?:\.(.+)|)$/;function U(){return!0}function Y(){return!1}function V(){try{return o.activeElement}catch(e){}}x.event={global:{},add:function(e,t,n,i,o){var s,a,u,l,c,p,f,h,d,g,m,y=q.get(e);if(y){n.handler&&(s=n,n=s.handler,o=s.selector),n.guid||(n.guid=x.guid++),(l=y.events)||(l=y.events={}),(a=y.handle)||(a=y.handle=function(e){return typeof x===r||e&&x.event.triggered===e.type?undefined:x.event.dispatch.apply(a.elem,arguments)},a.elem=e),t=(t||"").match(w)||[""],c=t.length;while(c--)u=X.exec(t[c])||[],d=m=u[1],g=(u[2]||"").split(".").sort(),d&&(f=x.event.special[d]||{},d=(o?f.delegateType:f.bindType)||d,f=x.event.special[d]||{},p=x.extend({type:d,origType:m,data:i,handler:n,guid:n.guid,selector:o,needsContext:o&&x.expr.match.needsContext.test(o),namespace:g.join(".")},s),(h=l[d])||(h=l[d]=[],h.delegateCount=0,f.setup&&f.setup.call(e,i,g,a)!==!1||e.addEventListener&&e.addEventListener(d,a,!1)),f.add&&(f.add.call(e,p),p.handler.guid||(p.handler.guid=n.guid)),o?h.splice(h.delegateCount++,0,p):h.push(p),x.event.global[d]=!0);e=null}},remove:function(e,t,n,r,i){var o,s,a,u,l,c,p,f,h,d,g,m=q.hasData(e)&&q.get(e);if(m&&(u=m.events)){t=(t||"").match(w)||[""],l=t.length;while(l--)if(a=X.exec(t[l])||[],h=g=a[1],d=(a[2]||"").split(".").sort(),h){p=x.event.special[h]||{},h=(r?p.delegateType:p.bindType)||h,f=u[h]||[],a=a[2]&&RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=f.length;while(o--)c=f[o],!i&&g!==c.origType||n&&n.guid!==c.guid||a&&!a.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(f.splice(o,1),c.selector&&f.delegateCount--,p.remove&&p.remove.call(e,c));s&&!f.length&&(p.teardown&&p.teardown.call(e,d,m.handle)!==!1||x.removeEvent(e,h,m.handle),delete u[h])}else for(h in u)x.event.remove(e,h+t[l],n,r,!0);x.isEmptyObject(u)&&(delete m.handle,q.remove(e,"events"))}},trigger:function(t,n,r,i){var s,a,u,l,c,p,f,h=[r||o],d=y.call(t,"type")?t.type:t,g=y.call(t,"namespace")?t.namespace.split("."):[];if(a=u=r=r||o,3!==r.nodeType&&8!==r.nodeType&&!_.test(d+x.event.triggered)&&(d.indexOf(".")>=0&&(g=d.split("."),d=g.shift(),g.sort()),c=0>d.indexOf(":")&&"on"+d,t=t[x.expando]?t:new x.Event(d,"object"==typeof t&&t),t.isTrigger=i?2:3,t.namespace=g.join("."),t.namespace_re=t.namespace?RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=undefined,t.target||(t.target=r),n=null==n?[t]:x.makeArray(n,[t]),f=x.event.special[d]||{},i||!f.trigger||f.trigger.apply(r,n)!==!1)){if(!i&&!f.noBubble&&!x.isWindow(r)){for(l=f.delegateType||d,_.test(l+d)||(a=a.parentNode);a;a=a.parentNode)h.push(a),u=a;u===(r.ownerDocument||o)&&h.push(u.defaultView||u.parentWindow||e)}s=0;while((a=h[s++])&&!t.isPropagationStopped())t.type=s>1?l:f.bindType||d,p=(q.get(a,"events")||{})[t.type]&&q.get(a,"handle"),p&&p.apply(a,n),p=c&&a[c],p&&x.acceptData(a)&&p.apply&&p.apply(a,n)===!1&&t.preventDefault();return t.type=d,i||t.isDefaultPrevented()||f._default&&f._default.apply(h.pop(),n)!==!1||!x.acceptData(r)||c&&x.isFunction(r[d])&&!x.isWindow(r)&&(u=r[c],u&&(r[c]=null),x.event.triggered=d,r[d](),x.event.triggered=undefined,u&&(r[c]=u)),t.result}},dispatch:function(e){e=x.event.fix(e);var t,n,r,i,o,s=[],a=d.call(arguments),u=(q.get(this,"events")||{})[e.type]||[],l=x.event.special[e.type]||{};if(a[0]=e,e.delegateTarget=this,!l.preDispatch||l.preDispatch.call(this,e)!==!1){s=x.event.handlers.call(this,e,u),t=0;while((i=s[t++])&&!e.isPropagationStopped()){e.currentTarget=i.elem,n=0;while((o=i.handlers[n++])&&!e.isImmediatePropagationStopped())(!e.namespace_re||e.namespace_re.test(o.namespace))&&(e.handleObj=o,e.data=o.data,r=((x.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,a),r!==undefined&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()))}return l.postDispatch&&l.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,r,i,o,s=[],a=t.delegateCount,u=e.target;if(a&&u.nodeType&&(!e.button||"click"!==e.type))for(;u!==this;u=u.parentNode||this)if(u.disabled!==!0||"click"!==e.type){for(r=[],n=0;a>n;n++)o=t[n],i=o.selector+" ",r[i]===undefined&&(r[i]=o.needsContext?x(i,this).index(u)>=0:x.find(i,this,null,[u]).length),r[i]&&r.push(o);r.length&&s.push({elem:u,handlers:r})}return t.length>a&&s.push({elem:this,handlers:t.slice(a)}),s},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,i,s=t.button;return null==e.pageX&&null!=t.clientX&&(n=e.target.ownerDocument||o,r=n.documentElement,i=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),e.which||s===undefined||(e.which=1&s?1:2&s?3:4&s?2:0),e}},fix:function(e){if(e[x.expando])return e;var t,n,r,i=e.type,s=e,a=this.fixHooks[i];a||(this.fixHooks[i]=a=z.test(i)?this.mouseHooks:I.test(i)?this.keyHooks:{}),r=a.props?this.props.concat(a.props):this.props,e=new x.Event(s),t=r.length;while(t--)n=r[t],e[n]=s[n];return e.target||(e.target=o),3===e.target.nodeType&&(e.target=e.target.parentNode),a.filter?a.filter(e,s):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==V()&&this.focus?(this.focus(),!1):undefined},delegateType:"focusin"},blur:{trigger:function(){return this===V()&&this.blur?(this.blur(),!1):undefined},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&x.nodeName(this,"input")?(this.click(),!1):undefined},_default:function(e){return x.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==undefined&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=x.extend(new x.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?x.event.trigger(i,null,t):x.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},x.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},x.Event=function(e,t){return this instanceof x.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.getPreventDefault&&e.getPreventDefault()?U:Y):this.type=e,t&&x.extend(this,t),this.timeStamp=e&&e.timeStamp||x.now(),this[x.expando]=!0,undefined):new x.Event(e,t)},x.Event.prototype={isDefaultPrevented:Y,isPropagationStopped:Y,isImmediatePropagationStopped:Y,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=U,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=U,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=U,this.stopPropagation()}},x.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){x.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,o=e.handleObj;return(!i||i!==r&&!x.contains(r,i))&&(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),x.support.focusinBubbles||x.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){x.event.simulate(t,e.target,x.event.fix(e),!0)};x.event.special[t]={setup:function(){0===n++&&o.addEventListener(e,r,!0)},teardown:function(){0===--n&&o.removeEventListener(e,r,!0)}}}),x.fn.extend({on:function(e,t,n,r,i){var o,s;if("object"==typeof e){"string"!=typeof t&&(n=n||t,t=undefined);for(s in e)this.on(s,t,n,e[s],i);return this}if(null==n&&null==r?(r=t,n=t=undefined):null==r&&("string"==typeof t?(r=n,n=undefined):(r=n,n=t,t=undefined)),r===!1)r=Y;else if(!r)return this;return 1===i&&(o=r,r=function(e){return x().off(e),o.apply(this,arguments)},r.guid=o.guid||(o.guid=x.guid++)),this.each(function(){x.event.add(this,e,r,n,t)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,x(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return(t===!1||"function"==typeof t)&&(n=t,t=undefined),n===!1&&(n=Y),this.each(function(){x.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){x.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?x.event.trigger(e,t,n,!0):undefined}});var G=/^.[^:#\[\.,]*$/,J=/^(?:parents|prev(?:Until|All))/,Q=x.expr.match.needsContext,K={children:!0,contents:!0,next:!0,prev:!0};x.fn.extend({find:function(e){var t,n=[],r=this,i=r.length;if("string"!=typeof e)return this.pushStack(x(e).filter(function(){for(t=0;i>t;t++)if(x.contains(r[t],this))return!0}));for(t=0;i>t;t++)x.find(e,r[t],n);return n=this.pushStack(i>1?x.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},has:function(e){var t=x(e,this),n=t.length;return this.filter(function(){var e=0;for(;n>e;e++)if(x.contains(this,t[e]))return!0})},not:function(e){return this.pushStack(et(this,e||[],!0))},filter:function(e){return this.pushStack(et(this,e||[],!1))},is:function(e){return!!et(this,"string"==typeof e&&Q.test(e)?x(e):e||[],!1).length},closest:function(e,t){var n,r=0,i=this.length,o=[],s=Q.test(e)||"string"!=typeof e?x(e,t||this.context):0;for(;i>r;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(11>n.nodeType&&(s?s.index(n)>-1:1===n.nodeType&&x.find.matchesSelector(n,e))){n=o.push(n);break}return this.pushStack(o.length>1?x.unique(o):o)},index:function(e){return e?"string"==typeof e?g.call(x(e),this[0]):g.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?x(e,t):x.makeArray(e&&e.nodeType?[e]:e),r=x.merge(this.get(),n);return this.pushStack(x.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}});function Z(e,t){while((e=e[t])&&1!==e.nodeType);return e}x.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return x.dir(e,"parentNode")},parentsUntil:function(e,t,n){return x.dir(e,"parentNode",n)},next:function(e){return Z(e,"nextSibling")},prev:function(e){return Z(e,"previousSibling")},nextAll:function(e){return x.dir(e,"nextSibling")},prevAll:function(e){return x.dir(e,"previousSibling")},nextUntil:function(e,t,n){return x.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return x.dir(e,"previousSibling",n)},siblings:function(e){return x.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return x.sibling(e.firstChild)},contents:function(e){return e.contentDocument||x.merge([],e.childNodes)}},function(e,t){x.fn[e]=function(n,r){var i=x.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=x.filter(r,i)),this.length>1&&(K[e]||x.unique(i),J.test(e)&&i.reverse()),this.pushStack(i)}}),x.extend({filter:function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?x.find.matchesSelector(r,e)?[r]:[]:x.find.matches(e,x.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,t,n){var r=[],i=n!==undefined;while((e=e[t])&&9!==e.nodeType)if(1===e.nodeType){if(i&&x(e).is(n))break;r.push(e)}return r},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});function et(e,t,n){if(x.isFunction(t))return x.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return x.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(G.test(t))return x.filter(t,e,n);t=x.filter(t,e)}return x.grep(e,function(e){return g.call(t,e)>=0!==n})}var tt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,nt=/<([\w:]+)/,rt=/<|&#?\w+;/,it=/<(?:script|style|link)/i,ot=/^(?:checkbox|radio)$/i,st=/checked\s*(?:[^=]|=\s*.checked.)/i,at=/^$|\/(?:java|ecma)script/i,ut=/^true\/(.*)/,lt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ct={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ct.optgroup=ct.option,ct.tbody=ct.tfoot=ct.colgroup=ct.caption=ct.thead,ct.th=ct.td,x.fn.extend({text:function(e){return x.access(this,function(e){return e===undefined?x.text(this):this.empty().append((this[0]&&this[0].ownerDocument||o).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=pt(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=pt(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=e?x.filter(e,this):this,i=0;for(;null!=(n=r[i]);i++)t||1!==n.nodeType||x.cleanData(mt(n)),n.parentNode&&(t&&x.contains(n.ownerDocument,n)&&dt(mt(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){var e,t=0;for(;null!=(e=this[t]);t++)1===e.nodeType&&(x.cleanData(mt(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return x.clone(this,e,t)})},html:function(e){return x.access(this,function(e){var t=this[0]||{},n=0,r=this.length;if(e===undefined&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!it.test(e)&&!ct[(nt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(tt,"<$1></$2>");try{for(;r>n;n++)t=this[n]||{},1===t.nodeType&&(x.cleanData(mt(t,!1)),t.innerHTML=e);t=0}catch(i){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=x.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(n){var r=e[t++],i=e[t++];i&&(r&&r.parentNode!==i&&(r=this.nextSibling),x(this).remove(),i.insertBefore(n,r))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,n){e=f.apply([],e);var r,i,o,s,a,u,l=0,c=this.length,p=this,h=c-1,d=e[0],g=x.isFunction(d);if(g||!(1>=c||"string"!=typeof d||x.support.checkClone)&&st.test(d))return this.each(function(r){var i=p.eq(r);g&&(e[0]=d.call(this,r,i.html())),i.domManip(e,t,n)});if(c&&(r=x.buildFragment(e,this[0].ownerDocument,!1,!n&&this),i=r.firstChild,1===r.childNodes.length&&(r=i),i)){for(o=x.map(mt(r,"script"),ft),s=o.length;c>l;l++)a=r,l!==h&&(a=x.clone(a,!0,!0),s&&x.merge(o,mt(a,"script"))),t.call(this[l],a,l);if(s)for(u=o[o.length-1].ownerDocument,x.map(o,ht),l=0;s>l;l++)a=o[l],at.test(a.type||"")&&!q.access(a,"globalEval")&&x.contains(u,a)&&(a.src?x._evalUrl(a.src):x.globalEval(a.textContent.replace(lt,"")))}return this}}),x.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){x.fn[e]=function(e){var n,r=[],i=x(e),o=i.length-1,s=0;for(;o>=s;s++)n=s===o?this:this.clone(!0),x(i[s])[t](n),h.apply(r,n.get());return this.pushStack(r)}}),x.extend({clone:function(e,t,n){var r,i,o,s,a=e.cloneNode(!0),u=x.contains(e.ownerDocument,e);if(!(x.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||x.isXMLDoc(e)))for(s=mt(a),o=mt(e),r=0,i=o.length;i>r;r++)yt(o[r],s[r]);if(t)if(n)for(o=o||mt(e),s=s||mt(a),r=0,i=o.length;i>r;r++)gt(o[r],s[r]);else gt(e,a);return s=mt(a,"script"),s.length>0&&dt(s,!u&&mt(e,"script")),a},buildFragment:function(e,t,n,r){var i,o,s,a,u,l,c=0,p=e.length,f=t.createDocumentFragment(),h=[];for(;p>c;c++)if(i=e[c],i||0===i)if("object"===x.type(i))x.merge(h,i.nodeType?[i]:i);else if(rt.test(i)){o=o||f.appendChild(t.createElement("div")),s=(nt.exec(i)||["",""])[1].toLowerCase(),a=ct[s]||ct._default,o.innerHTML=a[1]+i.replace(tt,"<$1></$2>")+a[2],l=a[0];while(l--)o=o.lastChild;x.merge(h,o.childNodes),o=f.firstChild,o.textContent=""}else h.push(t.createTextNode(i));f.textContent="",c=0;while(i=h[c++])if((!r||-1===x.inArray(i,r))&&(u=x.contains(i.ownerDocument,i),o=mt(f.appendChild(i),"script"),u&&dt(o),n)){l=0;while(i=o[l++])at.test(i.type||"")&&n.push(i)}return f},cleanData:function(e){var t,n,r,i,o,s,a=x.event.special,u=0;for(;(n=e[u])!==undefined;u++){if(F.accepts(n)&&(o=n[q.expando],o&&(t=q.cache[o]))){if(r=Object.keys(t.events||{}),r.length)for(s=0;(i=r[s])!==undefined;s++)a[i]?x.event.remove(n,i):x.removeEvent(n,i,t.handle);q.cache[o]&&delete q.cache[o]}delete L.cache[n[L.expando]]}},_evalUrl:function(e){return x.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}});function pt(e,t){return x.nodeName(e,"table")&&x.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function ft(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function ht(e){var t=ut.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function dt(e,t){var n=e.length,r=0;for(;n>r;r++)q.set(e[r],"globalEval",!t||q.get(t[r],"globalEval"))}function gt(e,t){var n,r,i,o,s,a,u,l;if(1===t.nodeType){if(q.hasData(e)&&(o=q.access(e),s=q.set(t,o),l=o.events)){delete s.handle,s.events={};for(i in l)for(n=0,r=l[i].length;r>n;n++)x.event.add(t,i,l[i][n])}L.hasData(e)&&(a=L.access(e),u=x.extend({},a),L.set(t,u))}}function mt(e,t){var n=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return t===undefined||t&&x.nodeName(e,t)?x.merge([e],n):n}function yt(e,t){var n=t.nodeName.toLowerCase();"input"===n&&ot.test(e.type)?t.checked=e.checked:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}x.fn.extend({wrapAll:function(e){var t;return x.isFunction(e)?this.each(function(t){x(this).wrapAll(e.call(this,t))}):(this[0]&&(t=x(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return x.isFunction(e)?this.each(function(t){x(this).wrapInner(e.call(this,t))}):this.each(function(){var t=x(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=x.isFunction(e);return this.each(function(n){x(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){x.nodeName(this,"body")||x(this).replaceWith(this.childNodes)}).end()}});var vt,xt,bt=/^(none|table(?!-c[ea]).+)/,wt=/^margin/,Tt=RegExp("^("+b+")(.*)$","i"),Ct=RegExp("^("+b+")(?!px)[a-z%]+$","i"),kt=RegExp("^([+-])=("+b+")","i"),Nt={BODY:"block"},Et={position:"absolute",visibility:"hidden",display:"block"},St={letterSpacing:0,fontWeight:400},jt=["Top","Right","Bottom","Left"],Dt=["Webkit","O","Moz","ms"];function At(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=Dt.length;while(i--)if(t=Dt[i]+n,t in e)return t;return r}function Lt(e,t){return e=t||e,"none"===x.css(e,"display")||!x.contains(e.ownerDocument,e)}function qt(t){return e.getComputedStyle(t,null)}function Ht(e,t){var n,r,i,o=[],s=0,a=e.length;for(;a>s;s++)r=e[s],r.style&&(o[s]=q.get(r,"olddisplay"),n=r.style.display,t?(o[s]||"none"!==n||(r.style.display=""),""===r.style.display&&Lt(r)&&(o[s]=q.access(r,"olddisplay",Rt(r.nodeName)))):o[s]||(i=Lt(r),(n&&"none"!==n||!i)&&q.set(r,"olddisplay",i?n:x.css(r,"display"))));for(s=0;a>s;s++)r=e[s],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?o[s]||"":"none"));return e}x.fn.extend({css:function(e,t){return x.access(this,function(e,t,n){var r,i,o={},s=0;if(x.isArray(t)){for(r=qt(e),i=t.length;i>s;s++)o[t[s]]=x.css(e,t[s],!1,r);return o}return n!==undefined?x.style(e,t,n):x.css(e,t)},e,t,arguments.length>1)},show:function(){return Ht(this,!0)},hide:function(){return Ht(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Lt(this)?x(this).show():x(this).hide()})}}),x.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=vt(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,s,a=x.camelCase(t),u=e.style;return t=x.cssProps[a]||(x.cssProps[a]=At(u,a)),s=x.cssHooks[t]||x.cssHooks[a],n===undefined?s&&"get"in s&&(i=s.get(e,!1,r))!==undefined?i:u[t]:(o=typeof n,"string"===o&&(i=kt.exec(n))&&(n=(i[1]+1)*i[2]+parseFloat(x.css(e,t)),o="number"),null==n||"number"===o&&isNaN(n)||("number"!==o||x.cssNumber[a]||(n+="px"),x.support.clearCloneStyle||""!==n||0!==t.indexOf("background")||(u[t]="inherit"),s&&"set"in s&&(n=s.set(e,n,r))===undefined||(u[t]=n)),undefined)}},css:function(e,t,n,r){var i,o,s,a=x.camelCase(t);return t=x.cssProps[a]||(x.cssProps[a]=At(e.style,a)),s=x.cssHooks[t]||x.cssHooks[a],s&&"get"in s&&(i=s.get(e,!0,n)),i===undefined&&(i=vt(e,t,r)),"normal"===i&&t in St&&(i=St[t]),""===n||n?(o=parseFloat(i),n===!0||x.isNumeric(o)?o||0:i):i}}),vt=function(e,t,n){var r,i,o,s=n||qt(e),a=s?s.getPropertyValue(t)||s[t]:undefined,u=e.style;return s&&(""!==a||x.contains(e.ownerDocument,e)||(a=x.style(e,t)),Ct.test(a)&&wt.test(t)&&(r=u.width,i=u.minWidth,o=u.maxWidth,u.minWidth=u.maxWidth=u.width=a,a=s.width,u.width=r,u.minWidth=i,u.maxWidth=o)),a};function Ot(e,t,n){var r=Tt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function Ft(e,t,n,r,i){var o=n===(r?"border":"content")?4:"width"===t?1:0,s=0;for(;4>o;o+=2)"margin"===n&&(s+=x.css(e,n+jt[o],!0,i)),r?("content"===n&&(s-=x.css(e,"padding"+jt[o],!0,i)),"margin"!==n&&(s-=x.css(e,"border"+jt[o]+"Width",!0,i))):(s+=x.css(e,"padding"+jt[o],!0,i),"padding"!==n&&(s+=x.css(e,"border"+jt[o]+"Width",!0,i)));return s}function Pt(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,o=qt(e),s=x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,o);if(0>=i||null==i){if(i=vt(e,t,o),(0>i||null==i)&&(i=e.style[t]),Ct.test(i))return i;r=s&&(x.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+Ft(e,t,n||(s?"border":"content"),r,o)+"px"}function Rt(e){var t=o,n=Nt[e];return n||(n=Mt(e,t),"none"!==n&&n||(xt=(xt||x("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(xt[0].contentWindow||xt[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=Mt(e,t),xt.detach()),Nt[e]=n),n}function Mt(e,t){var n=x(t.createElement(e)).appendTo(t.body),r=x.css(n[0],"display");return n.remove(),r}x.each(["height","width"],function(e,t){x.cssHooks[t]={get:function(e,n,r){return n?0===e.offsetWidth&&bt.test(x.css(e,"display"))?x.swap(e,Et,function(){return Pt(e,t,r)}):Pt(e,t,r):undefined},set:function(e,n,r){var i=r&&qt(e);return Ot(e,n,r?Ft(e,t,r,x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,i),i):0)}}}),x(function(){x.support.reliableMarginRight||(x.cssHooks.marginRight={get:function(e,t){return t?x.swap(e,{display:"inline-block"},vt,[e,"marginRight"]):undefined}}),!x.support.pixelPosition&&x.fn.position&&x.each(["top","left"],function(e,t){x.cssHooks[t]={get:function(e,n){return n?(n=vt(e,t),Ct.test(n)?x(e).position()[t]+"px":n):undefined}}})}),x.expr&&x.expr.filters&&(x.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight},x.expr.filters.visible=function(e){return!x.expr.filters.hidden(e)}),x.each({margin:"",padding:"",border:"Width"},function(e,t){x.cssHooks[e+t]={expand:function(n){var r=0,i={},o="string"==typeof n?n.split(" "):[n];for(;4>r;r++)i[e+jt[r]+t]=o[r]||o[r-2]||o[0];return i}},wt.test(e)||(x.cssHooks[e+t].set=Ot)});var Wt=/%20/g,$t=/\[\]$/,Bt=/\r?\n/g,It=/^(?:submit|button|image|reset|file)$/i,zt=/^(?:input|select|textarea|keygen)/i;x.fn.extend({serialize:function(){return x.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=x.prop(this,"elements");return e?x.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!x(this).is(":disabled")&&zt.test(this.nodeName)&&!It.test(e)&&(this.checked||!ot.test(e))}).map(function(e,t){var n=x(this).val();return null==n?null:x.isArray(n)?x.map(n,function(e){return{name:t.name,value:e.replace(Bt,"\r\n")}}):{name:t.name,value:n.replace(Bt,"\r\n")}}).get()}}),x.param=function(e,t){var n,r=[],i=function(e,t){t=x.isFunction(t)?t():null==t?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(t===undefined&&(t=x.ajaxSettings&&x.ajaxSettings.traditional),x.isArray(e)||e.jquery&&!x.isPlainObject(e))x.each(e,function(){i(this.name,this.value)});else for(n in e)_t(n,e[n],t,i);return r.join("&").replace(Wt,"+")};function _t(e,t,n,r){var i;if(x.isArray(t))x.each(t,function(t,i){n||$t.test(e)?r(e,i):_t(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(n||"object"!==x.type(t))r(e,t);else for(i in t)_t(e+"["+i+"]",t[i],n,r)}x.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){x.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),x.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var Xt,Ut,Yt=x.now(),Vt=/\?/,Gt=/#.*$/,Jt=/([?&])_=[^&]*/,Qt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Kt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Zt=/^(?:GET|HEAD)$/,en=/^\/\//,tn=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,nn=x.fn.load,rn={},on={},sn="*/".concat("*");try{Ut=i.href}catch(an){Ut=o.createElement("a"),Ut.href="",Ut=Ut.href}Xt=tn.exec(Ut.toLowerCase())||[];function un(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,o=t.toLowerCase().match(w)||[];if(x.isFunction(n))while(r=o[i++])"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function ln(e,t,n,r){var i={},o=e===on;function s(a){var u;return i[a]=!0,x.each(e[a]||[],function(e,a){var l=a(t,n,r);return"string"!=typeof l||o||i[l]?o?!(u=l):undefined:(t.dataTypes.unshift(l),s(l),!1)}),u}return s(t.dataTypes[0])||!i["*"]&&s("*")}function cn(e,t){var n,r,i=x.ajaxSettings.flatOptions||{};for(n in t)t[n]!==undefined&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&x.extend(!0,e,r),e}x.fn.load=function(e,t,n){if("string"!=typeof e&&nn)return nn.apply(this,arguments);var r,i,o,s=this,a=e.indexOf(" ");return a>=0&&(r=e.slice(a),e=e.slice(0,a)),x.isFunction(t)?(n=t,t=undefined):t&&"object"==typeof t&&(i="POST"),s.length>0&&x.ajax({url:e,type:i,dataType:"html",data:t}).done(function(e){o=arguments,s.html(r?x("<div>").append(x.parseHTML(e)).find(r):e)}).complete(n&&function(e,t){s.each(n,o||[e.responseText,t,e])}),this},x.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){x.fn[t]=function(e){return this.on(t,e)}}),x.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ut,type:"GET",isLocal:Kt.test(Xt[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":sn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":x.parseJSON,"text xml":x.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?cn(cn(e,x.ajaxSettings),t):cn(x.ajaxSettings,e)},ajaxPrefilter:un(rn),ajaxTransport:un(on),ajax:function(e,t){"object"==typeof e&&(t=e,e=undefined),t=t||{};var n,r,i,o,s,a,u,l,c=x.ajaxSetup({},t),p=c.context||c,f=c.context&&(p.nodeType||p.jquery)?x(p):x.event,h=x.Deferred(),d=x.Callbacks("once memory"),g=c.statusCode||{},m={},y={},v=0,b="canceled",T={readyState:0,getResponseHeader:function(e){var t;if(2===v){if(!o){o={};while(t=Qt.exec(i))o[t[1].toLowerCase()]=t[2]}t=o[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===v?i:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return v||(e=y[n]=y[n]||e,m[e]=t),this},overrideMimeType:function(e){return v||(c.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>v)for(t in e)g[t]=[g[t],e[t]];else T.always(e[T.status]);return this},abort:function(e){var t=e||b;return n&&n.abort(t),k(0,t),this}};if(h.promise(T).complete=d.add,T.success=T.done,T.error=T.fail,c.url=((e||c.url||Ut)+"").replace(Gt,"").replace(en,Xt[1]+"//"),c.type=t.method||t.type||c.method||c.type,c.dataTypes=x.trim(c.dataType||"*").toLowerCase().match(w)||[""],null==c.crossDomain&&(a=tn.exec(c.url.toLowerCase()),c.crossDomain=!(!a||a[1]===Xt[1]&&a[2]===Xt[2]&&(a[3]||("http:"===a[1]?"80":"443"))===(Xt[3]||("http:"===Xt[1]?"80":"443")))),c.data&&c.processData&&"string"!=typeof c.data&&(c.data=x.param(c.data,c.traditional)),ln(rn,c,t,T),2===v)return T;u=c.global,u&&0===x.active++&&x.event.trigger("ajaxStart"),c.type=c.type.toUpperCase(),c.hasContent=!Zt.test(c.type),r=c.url,c.hasContent||(c.data&&(r=c.url+=(Vt.test(r)?"&":"?")+c.data,delete c.data),c.cache===!1&&(c.url=Jt.test(r)?r.replace(Jt,"$1_="+Yt++):r+(Vt.test(r)?"&":"?")+"_="+Yt++)),c.ifModified&&(x.lastModified[r]&&T.setRequestHeader("If-Modified-Since",x.lastModified[r]),x.etag[r]&&T.setRequestHeader("If-None-Match",x.etag[r])),(c.data&&c.hasContent&&c.contentType!==!1||t.contentType)&&T.setRequestHeader("Content-Type",c.contentType),T.setRequestHeader("Accept",c.dataTypes[0]&&c.accepts[c.dataTypes[0]]?c.accepts[c.dataTypes[0]]+("*"!==c.dataTypes[0]?", "+sn+"; q=0.01":""):c.accepts["*"]);for(l in c.headers)T.setRequestHeader(l,c.headers[l]);if(c.beforeSend&&(c.beforeSend.call(p,T,c)===!1||2===v))return T.abort();b="abort";for(l in{success:1,error:1,complete:1})T[l](c[l]);if(n=ln(on,c,t,T)){T.readyState=1,u&&f.trigger("ajaxSend",[T,c]),c.async&&c.timeout>0&&(s=setTimeout(function(){T.abort("timeout")},c.timeout));try{v=1,n.send(m,k)}catch(C){if(!(2>v))throw C;k(-1,C)}}else k(-1,"No Transport");function k(e,t,o,a){var l,m,y,b,w,C=t;2!==v&&(v=2,s&&clearTimeout(s),n=undefined,i=a||"",T.readyState=e>0?4:0,l=e>=200&&300>e||304===e,o&&(b=pn(c,T,o)),b=fn(c,b,T,l),l?(c.ifModified&&(w=T.getResponseHeader("Last-Modified"),w&&(x.lastModified[r]=w),w=T.getResponseHeader("etag"),w&&(x.etag[r]=w)),204===e||"HEAD"===c.type?C="nocontent":304===e?C="notmodified":(C=b.state,m=b.data,y=b.error,l=!y)):(y=C,(e||!C)&&(C="error",0>e&&(e=0))),T.status=e,T.statusText=(t||C)+"",l?h.resolveWith(p,[m,C,T]):h.rejectWith(p,[T,C,y]),T.statusCode(g),g=undefined,u&&f.trigger(l?"ajaxSuccess":"ajaxError",[T,c,l?m:y]),d.fireWith(p,[T,C]),u&&(f.trigger("ajaxComplete",[T,c]),--x.active||x.event.trigger("ajaxStop")))}return T},getJSON:function(e,t,n){return x.get(e,t,n,"json")},getScript:function(e,t){return x.get(e,undefined,t,"script")}}),x.each(["get","post"],function(e,t){x[t]=function(e,n,r,i){return x.isFunction(n)&&(i=i||r,r=n,n=undefined),x.ajax({url:e,type:t,dataType:i,data:n,success:r})}});function pn(e,t,n){var r,i,o,s,a=e.contents,u=e.dataTypes;while("*"===u[0])u.shift(),r===undefined&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in a)if(a[i]&&a[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}s||(s=i)}o=o||s}return o?(o!==u[0]&&u.unshift(o),n[o]):undefined}function fn(e,t,n,r){var i,o,s,a,u,l={},c=e.dataTypes.slice();if(c[1])for(s in e.converters)l[s.toLowerCase()]=e.converters[s];o=c.shift();while(o)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(s=l[u+" "+o]||l["* "+o],!s)for(i in l)if(a=i.split(" "),a[1]===o&&(s=l[u+" "+a[0]]||l["* "+a[0]])){s===!0?s=l[i]:l[i]!==!0&&(o=a[0],c.unshift(a[1]));break}if(s!==!0)if(s&&e["throws"])t=s(t);else try{t=s(t)}catch(p){return{state:"parsererror",error:s?p:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}x.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return x.globalEval(e),e}}}),x.ajaxPrefilter("script",function(e){e.cache===undefined&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),x.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(r,i){t=x("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i("error"===e.type?404:200,e.type)}),o.head.appendChild(t[0])},abort:function(){n&&n()}}}});var hn=[],dn=/(=)\?(?=&|$)|\?\?/;x.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=hn.pop()||x.expando+"_"+Yt++;return this[e]=!0,e}}),x.ajaxPrefilter("json jsonp",function(t,n,r){var i,o,s,a=t.jsonp!==!1&&(dn.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&dn.test(t.data)&&"data");return a||"jsonp"===t.dataTypes[0]?(i=t.jsonpCallback=x.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(dn,"$1"+i):t.jsonp!==!1&&(t.url+=(Vt.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return s||x.error(i+" was not called"),s[0]},t.dataTypes[0]="json",o=e[i],e[i]=function(){s=arguments},r.always(function(){e[i]=o,t[i]&&(t.jsonpCallback=n.jsonpCallback,hn.push(i)),s&&x.isFunction(o)&&o(s[0]),s=o=undefined}),"script"):undefined}),x.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var gn=x.ajaxSettings.xhr(),mn={0:200,1223:204},yn=0,vn={};e.ActiveXObject&&x(e).on("unload",function(){for(var e in vn)vn[e]();vn=undefined}),x.support.cors=!!gn&&"withCredentials"in gn,x.support.ajax=gn=!!gn,x.ajaxTransport(function(e){var t;return x.support.cors||gn&&!e.crossDomain?{send:function(n,r){var i,o,s=e.xhr();if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(i in e.xhrFields)s[i]=e.xhrFields[i];e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");for(i in n)s.setRequestHeader(i,n[i]);t=function(e){return function(){t&&(delete vn[o],t=s.onload=s.onerror=null,"abort"===e?s.abort():"error"===e?r(s.status||404,s.statusText):r(mn[s.status]||s.status,s.statusText,"string"==typeof s.responseText?{text:s.responseText}:undefined,s.getAllResponseHeaders()))}},s.onload=t(),s.onerror=t("error"),t=vn[o=yn++]=t("abort"),s.send(e.hasContent&&e.data||null)},abort:function(){t&&t()}}:undefined});var xn,bn,wn=/^(?:toggle|show|hide)$/,Tn=RegExp("^(?:([+-])=|)("+b+")([a-z%]*)$","i"),Cn=/queueHooks$/,kn=[An],Nn={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=Tn.exec(t),o=i&&i[3]||(x.cssNumber[e]?"":"px"),s=(x.cssNumber[e]||"px"!==o&&+r)&&Tn.exec(x.css(n.elem,e)),a=1,u=20;if(s&&s[3]!==o){o=o||s[3],i=i||[],s=+r||1;do a=a||".5",s/=a,x.style(n.elem,e,s+o);while(a!==(a=n.cur()/r)&&1!==a&&--u)}return i&&(s=n.start=+s||+r||0,n.unit=o,n.end=i[1]?s+(i[1]+1)*i[2]:+i[2]),n}]};function En(){return setTimeout(function(){xn=undefined}),xn=x.now()}function Sn(e,t,n){var r,i=(Nn[t]||[]).concat(Nn["*"]),o=0,s=i.length;for(;s>o;o++)if(r=i[o].call(n,t,e))return r}function jn(e,t,n){var r,i,o=0,s=kn.length,a=x.Deferred().always(function(){delete u.elem}),u=function(){if(i)return!1;var t=xn||En(),n=Math.max(0,l.startTime+l.duration-t),r=n/l.duration||0,o=1-r,s=0,u=l.tweens.length;for(;u>s;s++)l.tweens[s].run(o);return a.notifyWith(e,[l,o,n]),1>o&&u?n:(a.resolveWith(e,[l]),!1)},l=a.promise({elem:e,props:x.extend({},t),opts:x.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:xn||En(),duration:n.duration,tweens:[],createTween:function(t,n){var r=x.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(r),r},stop:function(t){var n=0,r=t?l.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)l.tweens[n].run(1);return t?a.resolveWith(e,[l,t]):a.rejectWith(e,[l,t]),this}}),c=l.props;for(Dn(c,l.opts.specialEasing);s>o;o++)if(r=kn[o].call(l,e,c,l.opts))return r;return x.map(c,Sn,l),x.isFunction(l.opts.start)&&l.opts.start.call(e,l),x.fx.timer(x.extend(u,{elem:e,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function Dn(e,t){var n,r,i,o,s;for(n in e)if(r=x.camelCase(n),i=t[r],o=e[n],x.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),s=x.cssHooks[r],s&&"expand"in s){o=s.expand(o),delete e[r];for(n in o)n in e||(e[n]=o[n],t[n]=i)}else t[r]=i}x.Animation=x.extend(jn,{tweener:function(e,t){x.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;i>r;r++)n=e[r],Nn[n]=Nn[n]||[],Nn[n].unshift(t)},prefilter:function(e,t){t?kn.unshift(e):kn.push(e)}});function An(e,t,n){var r,i,o,s,a,u,l=this,c={},p=e.style,f=e.nodeType&&Lt(e),h=q.get(e,"fxshow");n.queue||(a=x._queueHooks(e,"fx"),null==a.unqueued&&(a.unqueued=0,u=a.empty.fire,a.empty.fire=function(){a.unqueued||u()}),a.unqueued++,l.always(function(){l.always(function(){a.unqueued--,x.queue(e,"fx").length||a.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],"inline"===x.css(e,"display")&&"none"===x.css(e,"float")&&(p.display="inline-block")),n.overflow&&(p.overflow="hidden",l.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}));for(r in t)if(i=t[r],wn.exec(i)){if(delete t[r],o=o||"toggle"===i,i===(f?"hide":"show")){if("show"!==i||!h||h[r]===undefined)continue;f=!0}c[r]=h&&h[r]||x.style(e,r)}if(!x.isEmptyObject(c)){h?"hidden"in h&&(f=h.hidden):h=q.access(e,"fxshow",{}),o&&(h.hidden=!f),f?x(e).show():l.done(function(){x(e).hide()}),l.done(function(){var t;q.remove(e,"fxshow");for(t in c)x.style(e,t,c[t])});for(r in c)s=Sn(f?h[r]:0,r,l),r in h||(h[r]=s.start,f&&(s.end=s.start,s.start="width"===r||"height"===r?1:0))}}function Ln(e,t,n,r,i){return new Ln.prototype.init(e,t,n,r,i)}x.Tween=Ln,Ln.prototype={constructor:Ln,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(x.cssNumber[n]?"":"px")},cur:function(){var e=Ln.propHooks[this.prop];return e&&e.get?e.get(this):Ln.propHooks._default.get(this)},run:function(e){var t,n=Ln.propHooks[this.prop];return this.pos=t=this.options.duration?x.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Ln.propHooks._default.set(this),this}},Ln.prototype.init.prototype=Ln.prototype,Ln.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=x.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){x.fx.step[e.prop]?x.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[x.cssProps[e.prop]]||x.cssHooks[e.prop])?x.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Ln.propHooks.scrollTop=Ln.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},x.each(["toggle","show","hide"],function(e,t){var n=x.fn[t];x.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(qn(t,!0),e,r,i)}}),x.fn.extend({fadeTo:function(e,t,n,r){return this.filter(Lt).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=x.isEmptyObject(e),o=x.speed(t,n,r),s=function(){var t=jn(this,x.extend({},e),o);(i||q.get(this,"finish"))&&t.stop(!0)};return s.finish=s,i||o.queue===!1?this.each(s):this.queue(o.queue,s)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=undefined),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",o=x.timers,s=q.get(this);if(i)s[i]&&s[i].stop&&r(s[i]);else for(i in s)s[i]&&s[i].stop&&Cn.test(i)&&r(s[i]);for(i=o.length;i--;)o[i].elem!==this||null!=e&&o[i].queue!==e||(o[i].anim.stop(n),t=!1,o.splice(i,1));(t||!n)&&x.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=q.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=x.timers,s=r?r.length:0;for(n.finish=!0,x.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;s>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}});function qn(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=jt[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}x.each({slideDown:qn("show"),slideUp:qn("hide"),slideToggle:qn("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){x.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),x.speed=function(e,t,n){var r=e&&"object"==typeof e?x.extend({},e):{complete:n||!n&&t||x.isFunction(e)&&e,duration:e,easing:n&&t||t&&!x.isFunction(t)&&t};return r.duration=x.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in x.fx.speeds?x.fx.speeds[r.duration]:x.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){x.isFunction(r.old)&&r.old.call(this),r.queue&&x.dequeue(this,r.queue)},r},x.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},x.timers=[],x.fx=Ln.prototype.init,x.fx.tick=function(){var e,t=x.timers,n=0;for(xn=x.now();t.length>n;n++)e=t[n],e()||t[n]!==e||t.splice(n--,1);t.length||x.fx.stop(),xn=undefined},x.fx.timer=function(e){e()&&x.timers.push(e)&&x.fx.start()},x.fx.interval=13,x.fx.start=function(){bn||(bn=setInterval(x.fx.tick,x.fx.interval))},x.fx.stop=function(){clearInterval(bn),bn=null},x.fx.speeds={slow:600,fast:200,_default:400},x.fx.step={},x.expr&&x.expr.filters&&(x.expr.filters.animated=function(e){return x.grep(x.timers,function(t){return e===t.elem}).length}),x.fn.offset=function(e){if(arguments.length)return e===undefined?this:this.each(function(t){x.offset.setOffset(this,e,t)});var t,n,i=this[0],o={top:0,left:0},s=i&&i.ownerDocument;if(s)return t=s.documentElement,x.contains(t,i)?(typeof i.getBoundingClientRect!==r&&(o=i.getBoundingClientRect()),n=Hn(s),{top:o.top+n.pageYOffset-t.clientTop,left:o.left+n.pageXOffset-t.clientLeft}):o},x.offset={setOffset:function(e,t,n){var r,i,o,s,a,u,l,c=x.css(e,"position"),p=x(e),f={};"static"===c&&(e.style.position="relative"),a=p.offset(),o=x.css(e,"top"),u=x.css(e,"left"),l=("absolute"===c||"fixed"===c)&&(o+u).indexOf("auto")>-1,l?(r=p.position(),s=r.top,i=r.left):(s=parseFloat(o)||0,i=parseFloat(u)||0),x.isFunction(t)&&(t=t.call(e,n,a)),null!=t.top&&(f.top=t.top-a.top+s),null!=t.left&&(f.left=t.left-a.left+i),"using"in t?t.using.call(e,f):p.css(f)}},x.fn.extend({position:function(){if(this[0]){var e,t,n=this[0],r={top:0,left:0};return"fixed"===x.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),x.nodeName(e[0],"html")||(r=e.offset()),r.top+=x.css(e[0],"borderTopWidth",!0),r.left+=x.css(e[0],"borderLeftWidth",!0)),{top:t.top-r.top-x.css(n,"marginTop",!0),left:t.left-r.left-x.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||s;while(e&&!x.nodeName(e,"html")&&"static"===x.css(e,"position"))e=e.offsetParent;return e||s})}}),x.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,n){var r="pageYOffset"===n;x.fn[t]=function(i){return x.access(this,function(t,i,o){var s=Hn(t);return o===undefined?s?s[n]:t[i]:(s?s.scrollTo(r?e.pageXOffset:o,r?o:e.pageYOffset):t[i]=o,undefined)},t,i,arguments.length,null)}});function Hn(e){return x.isWindow(e)?e:9===e.nodeType&&e.defaultView}x.each({Height:"height",Width:"width"},function(e,t){x.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){x.fn[r]=function(r,i){var o=arguments.length&&(n||"boolean"!=typeof r),s=n||(r===!0||i===!0?"margin":"border");return x.access(this,function(t,n,r){var i;return x.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):r===undefined?x.css(t,n,s):x.style(t,n,r,s)},t,o?r:undefined,o,null)}})}),x.fn.size=function(){return this.length},x.fn.andSelf=x.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=x:"function"==typeof define&&define.amd&&define("jquery",[],function(){return x}),"object"==typeof e&&"object"==typeof e.document&&(e.jQuery=e.$=x)})(window);
;;;
(function(M,T,p){'use strict';function lc(){var b=M.angular;M.angular=mc;return b}function Xa(b){return!b||typeof b.length!=="number"?!1:typeof b.hasOwnProperty!="function"&&typeof b.constructor!="function"?!0:b instanceof R||ga&&b instanceof ga||Ea.call(b)!=="[object Object]"||typeof b.callee==="function"}function n(b,a,c){var d;if(b)if(H(b))for(d in b)d!="prototype"&&d!="length"&&d!="name"&&b.hasOwnProperty(d)&&a.call(c,b[d],d);else if(b.forEach&&b.forEach!==n)b.forEach(a,c);else if(Xa(b))for(d=0;d<b.length;d++)a.call(c,b[d],d);else for(d in b)b.hasOwnProperty(d)&&a.call(c,b[d],d);return b}function qb(b){var a=[],c;for(c in b)b.hasOwnProperty(c)&&a.push(c);return a.sort()}function nc(b,a,c){for(var d=qb(b),e=0;e<d.length;e++)a.call(c,b[d[e]],d[e]);return d}function rb(b){return function(a,c){b(c,a)}}function Fa(){for(var b=ba.length,a;b;){b--;a=ba[b].charCodeAt(0);if(a==57)return ba[b]="A",ba.join("");if(a==90)ba[b]="0";else return ba[b]=String.fromCharCode(a+1),ba.join("")}ba.unshift("0");return ba.join("")}function sb(b,a){a?b.$$hashKey=a:delete b.$$hashKey}function t(b){var a=b.$$hashKey;n(arguments,function(a){a!==b&&n(a,function(a,c){b[c]=a})});sb(b,a);return b}function N(b){return parseInt(b,10)}function tb(b,a){return t(new(t(function(){},{prototype:b})),a)}function q(){}function qa(b){return b}function S(b){return function(){return b}}function C(b){return typeof b=="undefined"}function B(b){return typeof b!="undefined"}function L(b){return b!=null&&typeof b=="object"}function E(b){return typeof b=="string"}function Ya(b){return typeof b=="number"}function ra(b){return Ea.apply(b)=="[object Date]"}function F(b){return Ea.apply(b)=="[object Array]"}function H(b){return typeof b=="function"}function sa(b){return b&&b.document&&b.location&&b.alert&&b.setInterval}function U(b){return E(b)?b.replace(/^\s*/,"").replace(/\s*$/,""):b}function oc(b){return b&&(b.nodeName||b.bind&&b.find)}function Za(b,a,c){var d=[];n(b,function(b,g,i){d.push(a.call(c,b,g,i))});return d}function Ga(b,a){if(b.indexOf)return b.indexOf(a);for(var c=0;c<b.length;c++)if(a===b[c])return c;return-1}function ta(b,a){var c=Ga(b,a);c>=0&&b.splice(c,1);return a}function V(b,a){if(sa(b)||b&&b.$evalAsync&&b.$watch)throw Error("Can't copy Window or Scope");if(a){if(b===a)throw Error("Can't copy equivalent objects or arrays");if(F(b))for(var c=a.length=0;c<b.length;c++)a.push(V(b[c]));else{c=a.$$hashKey;n(a,function(b,c){delete a[c]});for(var d in b)a[d]=V(b[d]);sb(a,c)}}else(a=b)&&(F(b)?a=V(b,[]):ra(b)?a=new Date(b.getTime()):L(b)&&(a=V(b,{})));return a}function pc(b,a){var a=a||{},c;for(c in b)b.hasOwnProperty(c)&&c.substr(0,2)!=="$$"&&(a[c]=b[c]);return a}function ia(b,a){if(b===a)return!0;if(b===null||a===null)return!1;if(b!==b&&a!==a)return!0;var c=typeof b,d;if(c==typeof a&&c=="object")if(F(b)){if((c=b.length)==a.length){for(d=0;d<c;d++)if(!ia(b[d],a[d]))return!1;return!0}}else if(ra(b))return ra(a)&&b.getTime()==a.getTime();else{if(b&&b.$evalAsync&&b.$watch||a&&a.$evalAsync&&a.$watch||sa(b)||sa(a))return!1;c={};for(d in b)if(!(d.charAt(0)==="$"||H(b[d]))){if(!ia(b[d],a[d]))return!1;c[d]=!0}for(d in a)if(!c[d]&&d.charAt(0)!=="$"&&a[d]!==p&&!H(a[d]))return!1;return!0}return!1}function $a(b,a){var c=arguments.length>2?ka.call(arguments,2):[];return H(a)&&!(a instanceof RegExp)?c.length?function(){return arguments.length?a.apply(b,c.concat(ka.call(arguments,0))):a.apply(b,c)}:function(){return arguments.length?a.apply(b,arguments):a.call(b)}:a}function qc(b,a){var c=a;/^\$+/.test(b)?c=p:sa(a)?c="$WINDOW":a&&T===a?c="$DOCUMENT":a&&a.$evalAsync&&
a.$watch&&(c="$SCOPE");return c}function ha(b,a){return JSON.stringify(b,qc,a?"  ":null)}function ub(b){return E(b)?JSON.parse(b):b}function ua(b){b&&b.length!==0?(b=I(""+b),b=!(b=="f"||b=="0"||b=="false"||b=="no"||b=="n"||b=="[]")):b=!1;return b}function va(b){b=v(b).clone();try{b.html("")}catch(a){}var c=v("<div>").append(b).html();try{return b[0].nodeType===3?I(c):c.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(a,b){return"<"+I(b)})}catch(d){return I(c)}}function vb(b){var a={},c,d;n((b||"").split("&"),function(b){b&&(c=b.split("="),d=decodeURIComponent(c[0]),a[d]=B(c[1])?decodeURIComponent(c[1]):!0)});return a}function wb(b){var a=[];n(b,function(b,d){a.push(wa(d,!0)+(b===!0?"":"="+wa(b,!0)))});return a.length?a.join("&"):""}function ab(b){return wa(b,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function wa(b,a){return encodeURIComponent(b).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,a?"%20":"+")}function rc(b,a){function c(a){a&&d.push(a)}var d=[b],e,g,i=["ng:app","ng-app","x-ng-app","data-ng-app"],f=/\sng[:\-]app(:\s*([\w\d_]+);?)?\s/;n(i,function(a){i[a]=!0;c(T.getElementById(a));a=a.replace(":","\\:");b.querySelectorAll&&(n(b.querySelectorAll("."+a),c),n(b.querySelectorAll("."+a+"\\:"),c),n(b.querySelectorAll("["+a+"]"),c))});n(d,function(a){if(!e){var b=f.exec(" "+a.className+" ");b?(e=a,g=(b[2]||"").replace(/\s+/g,",")):n(a.attributes,function(b){if(!e&&i[b.name])e=a,g=b.value})}});e&&a(e,g?[g]:[])}
function xb(b,a){var c=function(){b=v(b);a=a||[];a.unshift(["$provide",function(a){a.value("$rootElement",b)}]);a.unshift("ng");var c=yb(a);c.invoke(["$rootScope","$rootElement","$compile","$injector","$animator",function(a,b,c,d,e){a.$apply(function(){b.data("$injector",d);c(b)(a)});e.enabled(!0)}]);return c},d=/^NG_DEFER_BOOTSTRAP!/;if(M&&!d.test(M.name))return c();M.name=M.name.replace(d,"");Ha.resumeBootstrap=function(b){n(b,function(b){a.push(b)});c()}}function bb(b,a){a=a||"_";return b.replace(sc,function(b,d){return(d?a:"")+b.toLowerCase()})}function cb(b,a,c){if(!b)throw Error("Argument '"+(a||"?")+"' is "+(c||"required"));return b}function xa(b,a,c){c&&F(b)&&(b=b[b.length-1]);cb(H(b),a,"not a function, got "+(b&&typeof b=="object"?b.constructor.name||"Object":typeof b));return b}function tc(b){function a(a,b,e){return a[b]||(a[b]=e())}return a(a(b,"angular",Object),"module",function(){var b={};return function(d,e,g){e&&b.hasOwnProperty(d)&&(b[d]=null);return a(b,d,function(){function a(c,d,e){return function(){b[e||"push"]([c,d,arguments]);return m}}if(!e)throw Error("No module: "+d);var b=[],c=[],j=a("$injector","invoke"),m={_invokeQueue:b,_runBlocks:c,requires:e,name:d,provider:a("$provide","provider"),factory:a("$provide","factory"),service:a("$provide","service"),value:a("$provide","value"),constant:a("$provide","constant","unshift"),animation:a("$animationProvider","register"),filter:a("$filterProvider","register"),controller:a("$controllerProvider","register"),directive:a("$compileProvider","directive"),config:j,run:function(a){c.push(a);return this}};g&&j(g);return m})}})}function Ia(b){return b.replace(uc,function(a,b,d,e){return e?d.toUpperCase():d}).replace(vc,"Moz$1")}function db(b,a){function c(){var e;for(var b=[this],c=a,i,f,h,j,m,k;b.length;){i=b.shift();f=0;for(h=i.length;f<h;f++){j=v(i[f]);c?j.triggerHandler("$destroy"):c=!c;m=0;for(e=(k=j.children()).length,j=e;m<j;m++)b.push(ga(k[m]))}}return d.apply(this,arguments)}var d=ga.fn[b],d=d.$original||d;c.$original=d;ga.fn[b]=c}function R(b){if(b instanceof R)return b;if(!(this instanceof R)){if(E(b)&&b.charAt(0)!="<")throw Error("selectors not implemented");return new R(b)}if(E(b)){var a=T.createElement("div");a.innerHTML="<div>&#160;</div>"+b;a.removeChild(a.firstChild);eb(this,a.childNodes);this.remove()}else eb(this,b)}function fb(b){return b.cloneNode(!0)}function ya(b){zb(b);for(var a=0,b=b.childNodes||[];a<b.length;a++)ya(b[a])}function Ab(b,a,c){var d=ca(b,"events");ca(b,"handle")&&(C(a)?n(d,function(a,c){gb(b,c,a);delete d[c]}):C(c)?(gb(b,a,d[a]),delete d[a]):ta(d[a],c))}function zb(b){var a=b[Ja],c=Ka[a];c&&(c.handle&&(c.events.$destroy&&c.handle({},"$destroy"),Ab(b)),delete Ka[a],b[Ja]=p)}function ca(b,a,c){var d=b[Ja],d=Ka[d||-1];if(B(c))d||(b[Ja]=d=++wc,d=Ka[d]={}),d[a]=c;else return d&&d[a]}function Bb(b,a,c){var d=ca(b,"data"),e=B(c),g=!e&&B(a),i=g&&!L(a);!d&&!i&&ca(b,"data",d={});if(e)d[a]=c;else if(g)if(i)return d&&d[a];else t(d,a);else return d}function La(b,a){return(" "+b.className+" ").replace(/[\n\t]/g," ").indexOf(" "+a+" ")>-1}function Cb(b,a){a&&n(a.split(" "),function(a){b.className=U((" "+b.className+" ").replace(/[\n\t]/g," ").replace(" "+U(a)+" "," "))})}function Db(b,a){a&&n(a.split(" "),function(a){if(!La(b,a))b.className=U(b.className+" "+U(a))})}function eb(b,a){if(a)for(var a=!a.nodeName&&B(a.length)&&!sa(a)?a:[a],c=0;c<a.length;c++)b.push(a[c])}function Eb(b,a){return Ma(b,"$"+(a||"ngController")+"Controller")}function Ma(b,a,c){b=v(b);for(b[0].nodeType==9&&(b=b.find("html"));b.length;){if(c=b.data(a))return c;b=b.parent()}}function Fb(b,a){var c=Na[a.toLowerCase()];return c&&Gb[b.nodeName]&&c}function xc(b,a){var c=function(c,e){if(!c.preventDefault)c.preventDefault=function(){c.returnValue=!1};if(!c.stopPropagation)c.stopPropagation=function(){c.cancelBubble=!0};if(!c.target)c.target=c.srcElement||T;if(C(c.defaultPrevented)){var g=c.preventDefault;c.preventDefault=function(){c.defaultPrevented=!0;g.call(c)};c.defaultPrevented=!1}c.isDefaultPrevented=function(){return c.defaultPrevented||c.returnValue==!1};n(a[e||c.type],function(a){a.call(b,c)});Z<=8?(c.preventDefault=null,c.stopPropagation=null,c.isDefaultPrevented=null):(delete c.preventDefault,delete c.stopPropagation,delete c.isDefaultPrevented)};c.elem=b;return c}function la(b){var a=typeof b,c;if(a=="object"&&b!==null)if(typeof(c=b.$$hashKey)=="function")c=b.$$hashKey();else{if(c===p)c=b.$$hashKey=Fa()}else c=b;return a+":"+c}function za(b){n(b,this.put,this)}function Hb(b){var a,c;if(typeof b=="function"){if(!(a=b.$inject))a=[],c=b.toString().replace(yc,""),c=c.match(zc),n(c[1].split(Ac),function(b){b.replace(Bc,function(b,c,d){a.push(d)})}),b.$inject=a}else F(b)?(c=b.length-1,xa(b[c],"fn"),a=b.slice(0,c)):xa(b,"fn",!0);return a}function yb(b){function a(a){return function(b,c){if(L(b))n(b,rb(a));else return a(b,c)}}function c(a,b){if(H(b)||F(b))b=k.instantiate(b);if(!b.$get)throw Error("Provider "+a+" must define $get factory method.");return m[a+f]=b}function d(a,b){return c(a,{$get:b})}function e(a){var b=[];n(a,function(a){if(!j.get(a))if(j.put(a,!0),E(a)){var c=Aa(a);b=b.concat(e(c.requires)).concat(c._runBlocks);try{for(var d=c._invokeQueue,c=0,f=d.length;c<f;c++){var g=d[c],o=k.get(g[0]);o[g[1]].apply(o,g[2])}}catch(h){throw h.message&&(h.message+=" from "+a),h;}}else if(H(a))try{b.push(k.invoke(a))}catch(l){throw l.message&&(l.message+=" from "+a),l;}else if(F(a))try{b.push(k.invoke(a))}catch(i){throw i.message&&(i.message+=" from "+String(a[a.length-1])),i;}else xa(a,"module")});return b}function g(a,b){function c(d){if(typeof d!=="string")throw Error("Service name expected");if(a.hasOwnProperty(d)){if(a[d]===i)throw Error("Circular dependency: "+h.join(" <- "));return a[d]}else try{return h.unshift(d),a[d]=i,a[d]=b(d)}finally{h.shift()}}function d(a,b,e){var f=[],j=Hb(a),g,o,h;o=0;for(g=j.length;o<g;o++)h=j[o],f.push(e&&e.hasOwnProperty(h)?e[h]:c(h));a.$inject||(a=a[g]);switch(b?-1:f.length){case 0:return a();case 1:return a(f[0]);case 2:return a(f[0],f[1]);case 3:return a(f[0],f[1],f[2]);case 4:return a(f[0],f[1],f[2],f[3]);case 5:return a(f[0],f[1],f[2],f[3],f[4]);case 6:return a(f[0],f[1],f[2],f[3],f[4],f[5]);case 7:return a(f[0],f[1],f[2],f[3],f[4],f[5],f[6]);case 8:return a(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7]);case 9:return a(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],f[8]);case 10:return a(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],f[8],f[9]);default:return a.apply(b,f)}}return{invoke:d,instantiate:function(a,b){var c=function(){},e;c.prototype=(F(a)?a[a.length-1]:a).prototype;c=new c;e=d(a,c,b);return L(e)?e:c},get:c,annotate:Hb,has:function(b){return m.hasOwnProperty(b+
f)||a.hasOwnProperty(b)}}}var i={},f="Provider",h=[],j=new za,m={$provide:{provider:a(c),factory:a(d),service:a(function(a,b){return d(a,["$injector",function(a){return a.instantiate(b)}])}),value:a(function(a,b){return d(a,S(b))}),constant:a(function(a,b){m[a]=b;l[a]=b}),decorator:function(a,b){var c=k.get(a+f),d=c.$get;c.$get=function(){var a=u.invoke(d,c);return u.invoke(b,null,{$delegate:a})}}}},k=m.$injector=g(m,function(){throw Error("Unknown provider: "+h.join(" <- "));}),l={},u=l.$injector=g(l,function(a){a=k.get(a+f);return u.invoke(a.$get,a)});n(e(b),function(a){u.invoke(a||q)});return u}function Cc(){var b=!0;this.disableAutoScrolling=function(){b=!1};this.$get=["$window","$location","$rootScope",function(a,c,d){function e(a){var b=null;n(a,function(a){!b&&I(a.nodeName)==="a"&&(b=a)});return b}function g(){var b=c.hash(),d;b?(d=i.getElementById(b))?d.scrollIntoView():(d=e(i.getElementsByName(b)))?d.scrollIntoView():b==="top"&&a.scrollTo(0,0):a.scrollTo(0,0)}var i=a.document;b&&d.$watch(function(){return c.hash()},function(){d.$evalAsync(g)});return g}]}function Ib(b){this.register=function(a,c){b.factory(Ia(a)+"Animation",c)};this.$get=["$injector",function(a){return function(b){if(b&&(b=Ia(b)+"Animation",a.has(b)))return a.get(b)}}]}function Dc(b,a,c,d){function e(a){try{a.apply(null,ka.call(arguments,1))}finally{if(o--,o===0)for(;z.length;)try{z.pop()()}catch(b){c.error(b)}}}function g(a,b){(function s(){n(r,function(a){a()});y=b(s,a)})()}function i(){x!=f.url()&&(x=f.url(),n(w,function(a){a(f.url())}))}
var f=this,h=a[0],j=b.location,m=b.history,k=b.setTimeout,l=b.clearTimeout,u={};f.isMock=!1;var o=0,z=[];f.$$completeOutstandingRequest=e;f.$$incOutstandingRequestCount=function(){o++};f.notifyWhenNoOutstandingRequests=function(a){n(r,function(a){a()});o===0?a():z.push(a)};var r=[],y;f.addPollFn=function(a){C(y)&&g(100,k);r.push(a);return a};var x=j.href,W=a.find("base");f.url=function(a,b){if(a){if(x!=a)return x=a,d.history?b?m.replaceState(null,"",a):(m.pushState(null,"",a),W.attr("href",W.attr("href"))):b?j.replace(a):j.href=a,f}else return j.href.replace(/%27/g,"'")};var w=[],A=!1;f.onUrlChange=function(a){A||(d.history&&v(b).bind("popstate",i),d.hashchange?v(b).bind("hashchange",i):f.addPollFn(i),A=!0);w.push(a);return a};f.baseHref=function(){var a=W.attr("href");return a?a.replace(/^https?\:\/\/[^\/]*/,""):""};var G={},D="",$=f.baseHref();f.cookies=function(a,b){var d,e,f,j;if(a)if(b===p)h.cookie=escape(a)+"=;path="+$+";expires=Thu, 01 Jan 1970 00:00:00 GMT";else{if(E(b))d=(h.cookie=escape(a)+"="+escape(b)+";path="+$).length+1,d>4096&&c.warn("Cookie '"+a+"' possibly not set or overflowed because it was too large ("+d+" > 4096 bytes)!")}else{if(h.cookie!==D){D=h.cookie;d=D.split("; ");G={};for(f=0;f<d.length;f++)e=d[f],j=e.indexOf("="),j>0&&(a=unescape(e.substring(0,j)),G[a]===p&&(G[a]=unescape(e.substring(j+1))))}return G}};f.defer=function(a,b){var c;o++;c=k(function(){delete u[c];e(a)},b||0);u[c]=!0;return c};f.defer.cancel=function(a){return u[a]?(delete u[a],l(a),e(q),!0):!1}}function Ec(){this.$get=["$window","$log","$sniffer","$document",function(b,a,c,d){return new Dc(b,d,a,c)}]}function Fc(){this.$get=function(){function b(b,d){function e(a){if(a!=k){if(l){if(l==a)l=a.n}else l=a;g(a.n,a.p);g(a,k);k=a;k.n=null}}function g(a,b){if(a!=b){if(a)a.p=b;if(b)b.n=a}}if(b in a)throw Error("cacheId "+b+" taken");var i=0,f=t({},d,{id:b}),h={},j=d&&d.capacity||Number.MAX_VALUE,m={},k=null,l=null;return a[b]={put:function(a,b){var c=m[a]||(m[a]={key:a});e(c);if(!C(b))return a in h||i++,h[a]=b,i>j&&this.remove(l.key),b},get:function(a){var b=m[a];if(b)return e(b),h[a]},remove:function(a){var b=m[a];if(b){if(b==k)k=b.p;if(b==l)l=b.n;g(b.n,b.p);delete m[a];delete h[a];i--}},removeAll:function(){h={};i=0;m={};k=l=null},destroy:function(){m=f=h=null;delete a[b]},info:function(){return t({},f,{size:i})}}}var a={};b.info=function(){var b={};n(a,function(a,e){b[e]=a.info()});return b};b.get=function(b){return a[b]};return b}}function Gc(){this.$get=["$cacheFactory",function(b){return b("templates")}]}function Jb(b){var a={},c="Directive",d=/^\s*directive\:\s*([\d\w\-_]+)\s+(.*)$/,e=/(([\d\w\-_]+)(?:\:([^;]+))?;?)/,g="Template must have exactly one root element. was: ",i=/^\s*(https?|ftp|mailto|file):/;this.directive=function h(d,e){E(d)?(cb(e,"directive"),a.hasOwnProperty(d)||(a[d]=[],b.factory(d+c,["$injector","$exceptionHandler",function(b,c){var e=[];n(a[d],function(a){try{var g=b.invoke(a);if(H(g))g={compile:S(g)};else if(!g.compile&&g.link)g.compile=S(g.link);g.priority=g.priority||0;g.name=g.name||d;g.require=g.require||g.controller&&g.name;g.restrict=g.restrict||"A";e.push(g)}catch(h){c(h)}});return e}])),a[d].push(e)):n(d,rb(h));return this};this.urlSanitizationWhitelist=function(a){return B(a)?(i=a,this):i};this.$get=["$injector","$interpolate","$exceptionHandler","$http","$templateCache","$parse","$controller","$rootScope","$document",function(b,j,m,k,l,u,o,z,r){function y(a,b,c){a instanceof v||(a=v(a));n(a,function(b,c){b.nodeType==3&&b.nodeValue.match(/\S+/)&&(a[c]=v(b).wrap("<span></span>").parent()[0])});var d=W(a,b,a,c);return function(b,c){cb(b,"scope");for(var e=c?Ba.clone.call(a):a,j=0,g=e.length;j<g;j++){var h=e[j];(h.nodeType==1||h.nodeType==9)&&e.eq(j).data("$scope",b)}x(e,"ng-scope");c&&c(e,b);d&&d(b,e,e);return e}}function x(a,b){try{a.addClass(b)}catch(c){}}function W(a,b,c,d){function e(a,c,d,g){var h,i,k,l,o,m,u,z=[];o=0;for(m=c.length;o<m;o++)z.push(c[o]);u=o=0;for(m=j.length;o<m;u++)i=z[u],c=j[o++],h=j[o++],c?(c.scope?(k=a.$new(L(c.scope)),v(i).data("$scope",k)):k=a,(l=c.transclude)||!g&&b?c(h,k,i,d,function(b){return function(c){var d=a.$new();d.$$transcluded=!0;return b(d,c).bind("$destroy",$a(d,d.$destroy))}}(l||b)):c(h,k,i,p,g)):h&&h(a,i.childNodes,p,g)}for(var j=[],g,h,k,i=0;i<a.length;i++)h=new ma,g=w(a[i],[],h,d),h=(g=g.length?A(g,a[i],h,b,c):null)&&g.terminal||!a[i].childNodes||!a[i].childNodes.length?null:W(a[i].childNodes,g?g.transclude:b),j.push(g),j.push(h),k=k||g||h;return k?e:null}function w(a,b,c,j){var g=c.$attr,h;switch(a.nodeType){case 1:G(b,da(hb(a).toLowerCase()),"E",j);var i,k,l;h=a.attributes;for(var o=0,m=h&&h.length;o<m;o++)if(i=h[o],i.specified)k=i.name,l=da(k),Y.test(l)&&(k=l.substr(6).toLowerCase()),l=da(k.toLowerCase()),g[l]=k,c[l]=i=U(Z&&k=="href"?decodeURIComponent(a.getAttribute(k,2)):i.value),Fb(a,l)&&(c[l]=!0),s(a,b,i,l),G(b,l,"A",j);a=a.className;if(E(a)&&a!=="")for(;h=e.exec(a);)l=da(h[2]),G(b,l,"C",j)&&(c[l]=U(h[3])),a=a.substr(h.index+h[0].length);break;case 3:P(b,a.nodeValue);break;case 8:try{if(h=d.exec(a.nodeValue))l=da(h[1]),G(b,l,"M",j)&&(c[l]=U(h[2]))}catch(u){}}b.sort(K);return b}function A(a,b,c,d,e){function h(a,b){if(a)a.require=s.require,z.push(a);if(b)b.require=s.require,ea.push(b)}function i(a,b){var c,d="data",e=!1;if(E(a)){for(;(c=a.charAt(0))=="^"||c=="?";)a=a.substr(1),c=="^"&&(d="inheritedData"),e=e||c=="?";c=b[d]("$"+a+"Controller");if(!c&&!e)throw Error("No controller: "+a);}else F(a)&&(c=[],n(a,function(a){c.push(i(a,b))}));return c}function k(a,d,e,g,h){var l,w,r,D,x;l=b===e?c:pc(c,new ma(v(e),c.$attr));w=l.$$element;if(K){var y=/^\s*([@=&])(\??)\s*(\w*)\s*$/,s=d.$parent||d;n(K.scope,function(a,b){var c=a.match(y)||[],e=c[3]||b,g=c[2]=="?",c=c[1],h,k,i;d.$$isolateBindings[b]=c+e;switch(c){case"@":l.$observe(e,function(a){d[b]=a});l.$$observers[e].$$scope=s;l[e]&&(d[b]=j(l[e])(s));break;case"=":if(g&&!l[e])break;k=u(l[e]);i=k.assign||function(){h=d[b]=k(s);throw Error(Kb+l[e]+" (directive: "+K.name+")");};h=d[b]=k(s);d.$watch(function(){var a=k(s);a!==d[b]&&(a!==h?h=d[b]=a:i(s,a=h=d[b]));return a});break;case"&":k=u(l[e]);d[b]=function(a){return k(s,a)};break;default:throw Error("Invalid isolate scope definition for directive "+K.name+": "+a);}})}q&&n(q,function(a){var b={$scope:d,$element:w,$attrs:l,$transclude:h};x=a.controller;x=="@"&&(x=l[a.name]);w.data("$"+a.name+"Controller",o(x,b))});g=0;for(r=z.length;g<r;g++)try{D=z[g],D(d,w,l,D.require&&i(D.require,w))}catch(Hc){m(Hc,va(w))}a&&a(d,e.childNodes,p,h);g=0;for(r=ea.length;g<r;g++)try{D=ea[g],D(d,w,l,D.require&&i(D.require,w))}catch(J){m(J,va(w))}}for(var l=-Number.MAX_VALUE,z=[],ea=[],r=null,K=null,W=null,J=c.$$element=v(b),s,A,Y,G,P=d,q,na,t,B=0,C=a.length;B<C;B++){s=a[B];Y=p;if(l>s.priority)break;if(t=s.scope)O("isolated scope",K,s,J),L(t)&&(x(J,"ng-isolate-scope"),K=s),x(J,"ng-scope"),r=r||s;A=s.name;if(t=s.controller)q=q||{},O("'"+A+"' controller",q[A],s,J),q[A]=s;if(t=s.transclude)O("transclusion",G,s,J),G=s,l=s.priority,t=="element"?(Y=v(b),J=c.$$element=v(T.createComment(" "+A+": "+c[A]+" ")),b=J[0],ja(e,v(Y[0]),b),P=y(Y,d,l)):(Y=v(fb(b)).contents(),J.html(""),P=y(Y,d));if(s.template)if(O("template",W,s,J),W=s,t=H(s.template)?s.template(J,c):s.template,t=Lb(t),s.replace){Y=v("<div>"+U(t)+"</div>").contents();b=Y[0];if(Y.length!=1||b.nodeType!==1)throw Error(g+t);ja(e,J,b);A={$attr:{}};a=a.concat(w(b,a.splice(B+1,a.length-(B+1)),A));D(c,A);C=a.length}else J.html(t);if(s.templateUrl)O("template",W,s,J),W=s,k=$(a.splice(B,a.length-B),k,J,c,e,s.replace,P),C=a.length;else if(s.compile)try{na=s.compile(J,c,P),H(na)?h(null,na):na&&h(na.pre,na.post)}catch(I){m(I,va(J))}if(s.terminal)k.terminal=!0,l=Math.max(l,s.priority)}k.scope=r&&r.scope;k.transclude=G&&P;return k}function G(d,e,j,g){var l=!1;if(a.hasOwnProperty(e))for(var k,e=b.get(e+c),i=0,o=e.length;i<o;i++)try{if(k=e[i],(g===p||g>k.priority)&&k.restrict.indexOf(j)!=-1)d.push(k),l=!0}catch(u){m(u)}return l}function D(a,b){var c=b.$attr,d=a.$attr,e=a.$$element;n(a,function(d,e){e.charAt(0)!="$"&&(b[e]&&(d+=(e==="style"?";":" ")+b[e]),a.$set(e,d,!0,c[e]))});n(b,function(b,j){j=="class"?(x(e,b),a["class"]=(a["class"]?a["class"]+" ":"")+b):j=="style"?e.attr("style",e.attr("style")+";"+b):j.charAt(0)!="$"&&!a.hasOwnProperty(j)&&(a[j]=b,d[j]=c[j])})}function $(a,b,c,d,e,j,h){var i=[],o,m,u=c[0],z=a.shift(),r=t({},z,{controller:null,templateUrl:null,transclude:null,scope:null}),z=H(z.templateUrl)?z.templateUrl(c,d):z.templateUrl;c.html("");k.get(z,{cache:l}).success(function(l){var k,z,l=Lb(l);if(j){z=v("<div>"+U(l)+"</div>").contents();k=z[0];if(z.length!=1||k.nodeType!==1)throw Error(g+l);l={$attr:{}};ja(e,c,k);w(k,a,l);D(d,l)}else k=u,c.html(l);a.unshift(r);o=A(a,k,d,h);for(m=W(c[0].childNodes,h);i.length;){var ea=i.shift(),l=i.shift();z=i.shift();var x=i.shift(),y=k;l!==u&&(y=fb(k),ja(z,v(l),y));o(function(){b(m,ea,y,e,x)},ea,y,e,x)}i=null}).error(function(a,b,c,d){throw Error("Failed to load template: "+d.url);});return function(a,c,d,e,j){i?(i.push(c),i.push(d),i.push(e),i.push(j)):o(function(){b(m,c,d,e,j)},c,d,e,j)}}function K(a,b){return b.priority-a.priority}function O(a,b,c,d){if(b)throw Error("Multiple directives ["+
b.name+", "+c.name+"] asking for "+a+" on: "+va(d));}function P(a,b){var c=j(b,!0);c&&a.push({priority:0,compile:S(function(a,b){var d=b.parent(),e=d.data("$binding")||[];e.push(c);x(d.data("$binding",e),"ng-binding");a.$watch(c,function(a){b[0].nodeValue=a})})})}function s(a,b,c,d){var e=j(c,!0);e&&b.push({priority:100,compile:S(function(a,b,c){b=c.$$observers||(c.$$observers={});if(e=j(c[d],!0))c[d]=e(a),(b[d]||(b[d]=[])).$$inter=!0,(c.$$observers&&c.$$observers[d].$$scope||a).$watch(e,function(a){c.$set(d,a)})})})}function ja(a,b,c){var d=b[0],e=d.parentNode,j,g;if(a){j=0;for(g=a.length;j<g;j++)if(a[j]==d){a[j]=c;break}}e&&e.replaceChild(c,d);c[v.expando]=d[v.expando];b[0]=c}var ma=function(a,b){this.$$element=a;this.$attr=b||{}};ma.prototype={$normalize:da,$set:function(a,b,c,d){var e=Fb(this.$$element[0],a),j=this.$$observers;e&&(this.$$element.prop(a,b),d=e);this[a]=b;d?this.$attr[a]=d:(d=this.$attr[a])||(this.$attr[a]=d=bb(a,"-"));if(hb(this.$$element[0])==="A"&&a==="href")q.setAttribute("href",b),e=q.href,e.match(i)||(this[a]=b="unsafe:"+e);c!==!1&&(b===null||b===p?this.$$element.removeAttr(d):this.$$element.attr(d,b));j&&n(j[a],function(a){try{a(b)}catch(c){m(c)}})},$observe:function(a,b){var c=this,d=c.$$observers||(c.$$observers={}),e=d[a]||(d[a]=[]);e.push(b);z.$evalAsync(function(){e.$$inter||b(c[a])});return b}};var q=r[0].createElement("a"),ea=j.startSymbol(),J=j.endSymbol(),Lb=ea=="{{"||J=="}}"?qa:function(a){return a.replace(/\{\{/g,ea).replace(/}}/g,J)},Y=/^ngAttr[A-Z]/;return y}]}
function da(b){return Ia(b.replace(Ic,""))}function Jc(){var b={},a=/^(\S+)(\s+as\s+(\w+))?$/;this.register=function(a,d){L(a)?t(b,a):b[a]=d};this.$get=["$injector","$window",function(c,d){return function(e,g){var i,f;E(e)&&(f=e.match(a),i=f[1],f=f[3],e=b.hasOwnProperty(i)?b[i]:ib(g.$scope,i,!0)||ib(d,i,!0),xa(e,i,!0));i=c.instantiate(e,g);if(f){if(typeof g.$scope!=="object")throw Error('Can not export controller as "'+f+'". No scope object provided!');g.$scope[f]=i}return i}}]}function Kc(){this.$get=["$window",function(b){return v(b.document)}]}function Lc(){this.$get=["$log",function(b){return function(a,c){b.error.apply(b,arguments)}}]}function Mc(){var b="{{",a="}}";this.startSymbol=function(a){return a?(b=a,this):b};this.endSymbol=function(b){return b?(a=b,this):a};this.$get=["$parse","$exceptionHandler",function(c,d){function e(e,h){for(var j,m,k=0,l=[],u=e.length,o=!1,z=[];k<u;)(j=e.indexOf(b,k))!=-1&&(m=e.indexOf(a,j+g))!=-1?(k!=j&&l.push(e.substring(k,j)),l.push(k=c(o=e.substring(j+g,m))),k.exp=o,k=m+i,o=!0):(k!=u&&l.push(e.substring(k)),k=u);if(!(u=l.length))l.push(""),u=1;if(!h||o)return z.length=u,k=function(a){try{for(var b=0,c=u,j;b<c;b++){if(typeof(j=l[b])=="function")j=j(a),j==null||j==p?j="":typeof j!="string"&&(j=ha(j));z[b]=j}return z.join("")}catch(g){d(Error("Error while interpolating: "+e+"\n"+g.toString()))}},k.exp=e,k.parts=l,k}var g=b.length,i=a.length;e.startSymbol=function(){return b};e.endSymbol=function(){return a};return e}]}function Mb(b){for(var b=b.split("/"),a=b.length;a--;)b[a]=ab(b[a]);return b.join("/")}function Nb(b,a){var c=jb.exec(b);a.$$protocol=c[1];a.$$host=c[3];a.$$port=N(c[5])||Oa[c[1]]||null}function Ob(b,a){var c=Pb.exec(b);a.$$path=decodeURIComponent(c[1]);a.$$search=vb(c[3]);a.$$hash=decodeURIComponent(c[5]||"");if(a.$$path&&a.$$path.charAt(0)!="/")a.$$path="/"+a.$$path}function fa(b,a,c){return a.indexOf(b)==0?a.substr(b.length):c}function Ca(b){var a=b.indexOf("#");return a==-1?b:b.substr(0,a)}function kb(b){return b.substr(0,Ca(b).lastIndexOf("/")+
1)}function Qb(b,a){var a=a||"",c=kb(b);this.$$parse=function(a){var b={};Nb(a,b);var g=fa(c,a);if(!E(g))throw Error('Invalid url "'+a+'", missing path prefix "'+c+'".');Ob(g,b);t(this,b);if(!this.$$path)this.$$path="/";this.$$compose()};this.$$compose=function(){var a=wb(this.$$search),b=this.$$hash?"#"+ab(this.$$hash):"";this.$$url=Mb(this.$$path)+(a?"?"+a:"")+b;this.$$absUrl=c+this.$$url.substr(1)};this.$$rewrite=function(d){var e;if((e=fa(b,d))!==p)return d=e,(e=fa(a,e))!==p?c+(fa("/",e)||e):b+d;else if((e=fa(c,d))!==p)return c+e;else if(c==d+"/")return c}}function lb(b,a){var c=kb(b);this.$$parse=function(d){Nb(d,this);var e=fa(b,d)||fa(c,d);if(!E(e))throw Error('Invalid url "'+d+'", does not start with "'+b+'".');e=e.charAt(0)=="#"?fa(a,e):e;if(!E(e))throw Error('Invalid url "'+d+'", missing hash prefix "'+a+'".');Ob(e,this);this.$$compose()};this.$$compose=function(){var c=wb(this.$$search),e=this.$$hash?"#"+ab(this.$$hash):"";this.$$url=Mb(this.$$path)+(c?"?"+c:"")+e;this.$$absUrl=b+(this.$$url?a+this.$$url:"")};this.$$rewrite=function(a){if(Ca(b)==Ca(a))return a}}function Rb(b,a){lb.apply(this,arguments);var c=kb(b);this.$$rewrite=function(d){var e;if(b==Ca(d))return d;else if(e=fa(c,d))return b+a+e;else if(c===d+"/")return c}}function Pa(b){return function(){return this[b]}}function Sb(b,a){return function(c){if(C(c))return this[b];this[b]=a(c);this.$$compose();return this}}function Nc(){var b="",a=!1;this.hashPrefix=function(a){return B(a)?(b=a,this):b};this.html5Mode=function(b){return B(b)?(a=b,this):a};this.$get=["$rootScope","$browser","$sniffer","$rootElement",function(c,d,e,g){function i(a){c.$broadcast("$locationChangeSuccess",f.absUrl(),a)}var f,h=d.baseHref(),j=d.url();a?(h=h?j.substring(0,j.indexOf("/",j.indexOf("//")+2))+h:j,e=e.history?Qb:Rb):(h=Ca(j),e=lb);f=new e(h,"#"+b);f.$$parse(f.$$rewrite(j));g.bind("click",function(a){if(!a.ctrlKey&&!(a.metaKey||a.which==2)){for(var b=v(a.target);I(b[0].nodeName)!=="a";)if(b[0]===g[0]||!(b=b.parent())[0])return;var e=b.prop("href"),j=f.$$rewrite(e);e&&!b.attr("target")&&j&&!a.isDefaultPrevented()&&(a.preventDefault(),j!=d.url()&&(f.$$parse(j),c.$apply(),M.angular["ff-684208-preventDefault"]=!0))}});f.absUrl()!=j&&d.url(f.absUrl(),!0);d.onUrlChange(function(a){f.absUrl()!=a&&(c.$broadcast("$locationChangeStart",a,f.absUrl()).defaultPrevented?d.url(f.absUrl()):(c.$evalAsync(function(){var b=f.absUrl();f.$$parse(a);i(b)}),c.$$phase||c.$digest()))});var m=0;c.$watch(function(){var a=d.url(),b=f.$$replace;if(!m||a!=f.absUrl())m++,c.$evalAsync(function(){c.$broadcast("$locationChangeStart",f.absUrl(),a).defaultPrevented?f.$$parse(a):(d.url(f.absUrl(),b),i(a))});f.$$replace=!1;return m});return f}]}function Oc(){var b=!0,a=this;this.debugEnabled=function(a){return B(a)?(b=a,this):b};this.$get=["$window",function(c){function d(a){a instanceof Error&&(a.stack?a=a.message&&a.stack.indexOf(a.message)===-1?"Error: "+a.message+"\n"+a.stack:a.stack:a.sourceURL&&(a=a.message+"\n"+a.sourceURL+":"+a.line));return a}function e(a){var b=c.console||{},e=b[a]||b.log||q;return e.apply?function(){var a=[];n(arguments,function(b){a.push(d(b))});return e.apply(b,a)}:function(a,b){e(a,b)}}return{log:e("log"),warn:e("warn"),info:e("info"),error:e("error"),debug:function(){var c=e("debug");return function(){b&&c.apply(a,arguments)}}()}}]}function Pc(b,a){function c(a){return a.indexOf(r)!=-1}function d(a){a=a||1;return o+a<b.length?b.charAt(o+a):!1}function e(a){return"0"<=a&&a<="9"}function g(a){return a==" "||a=="\r"||a=="\t"||a=="\n"||a=="\u000b"||a=="\u00a0"}function i(a){return"a"<=a&&a<="z"||"A"<=a&&a<="Z"||"_"==a||a=="$"}function f(a){return a=="-"||a=="+"||e(a)}function h(a,c,d){d=d||o;throw Error("Lexer Error: "+a+" at column"+(B(c)?"s "+c+"-"+o+" ["+b.substring(c,d)+"]":" "+d)+" in expression ["+b+"].");}function j(){for(var a="",c=o;o<b.length;){var j=I(b.charAt(o));if(j=="."||e(j))a+=j;else{var g=d();if(j=="e"&&f(g))a+=j;else if(f(j)&&g&&e(g)&&a.charAt(a.length-1)=="e")a+=j;else if(f(j)&&(!g||!e(g))&&a.charAt(a.length-
1)=="e")h("Invalid exponent");else break}o++}a*=1;l.push({index:c,text:a,json:!0,fn:function(){return a}})}function m(){for(var c="",d=o,f,j,h,k;o<b.length;){k=b.charAt(o);if(k=="."||i(k)||e(k))k=="."&&(f=o),c+=k;else break;o++}if(f)for(j=o;j<b.length;){k=b.charAt(j);if(k=="("){h=c.substr(f-d+1);c=c.substr(0,f-d);o=j;break}if(g(k))j++;else break}d={index:d,text:c};if(Da.hasOwnProperty(c))d.fn=d.json=Da[c];else{var m=Tb(c,a);d.fn=t(function(a,b){return m(a,b)},{assign:function(a,b){return Ub(a,c,b)}})}l.push(d);h&&(l.push({index:f,text:".",json:!1}),l.push({index:f+1,text:h,json:!1}))}function k(a){var c=o;o++;for(var d="",e=a,f=!1;o<b.length;){var j=b.charAt(o);e+=j;if(f)j=="u"?(j=b.substring(o+1,o+5),j.match(/[\da-f]{4}/i)||h("Invalid unicode escape [\\u"+j+"]"),o+=4,d+=String.fromCharCode(parseInt(j,16))):(f=Qc[j],d+=f?f:j),f=!1;else if(j=="\\")f=!0;else if(j==a){o++;l.push({index:c,text:e,string:d,json:!0,fn:function(){return d}});return}else d+=j;o++}h("Unterminated quote",c)}for(var l=[],u,o=0,z=[],r,y=":";o<b.length;){r=b.charAt(o);if(c("\"'"))k(r);else if(e(r)||c(".")&&e(d()))j();else if(i(r)){if(m(),"{,".indexOf(y)!=-1&&z[0]=="{"&&(u=l[l.length-1]))u.json=u.text.indexOf(".")==-1}else if(c("(){}[].,;:?"))l.push({index:o,text:r,json:":[,".indexOf(y)!=-1&&c("{[")||c("}]:,")}),c("{[")&&z.unshift(r),c("}]")&&z.shift(),o++;else if(g(r)){o++;continue}else{var x=r+d(),n=x+d(2),w=Da[r],A=Da[x],G=Da[n];G?(l.push({index:o,text:n,fn:G}),o+=3):A?(l.push({index:o,text:x,fn:A}),o+=2):w?(l.push({index:o,text:r,fn:w,json:"[,:".indexOf(y)!=-1&&c("+-")}),o+=1):h("Unexpected next character ",o,o+1)}y=r}return l}function Rc(b,a,c,d){function e(a,c){throw Error("Syntax Error: Token '"+c.text+"' "+a+" at column "+(c.index+1)+" of the expression ["+b+"] starting at ["+b.substring(c.index)+"].");}function g(){if(O.length===0)throw Error("Unexpected end of expression: "+b);return O[0]}function i(a,b,c,d){if(O.length>0){var e=O[0],f=e.text;if(f==a||f==b||f==c||f==d||!a&&!b&&!c&&!d)return e}return!1}function f(b,c,d,f){return(b=i(b,c,d,f))?(a&&!b.json&&e("is not valid json",b),O.shift(),b):!1}function h(a){f(a)||e("is unexpected, expecting ["+a+"]",i())}function j(a,b){return t(function(c,d){return a(c,d,b)},{constant:b.constant})}function m(a,b,c){return t(function(d,e){return a(d,e)?b(d,e):c(d,e)},{constant:a.constant&&b.constant&&c.constant})}function k(a,b,c){return t(function(d,e){return b(d,e,a,c)},{constant:a.constant&&c.constant})}function l(){for(var a=[];;)if(O.length>0&&!i("}",")",";","]")&&a.push(v()),!f(";"))return a.length==1?a[0]:function(b,c){for(var d,e=0;e<a.length;e++){var f=a[e];f&&(d=f(b,c))}return d}}function u(){for(var a=f(),b=c(a.text),d=[];;)if(a=f(":"))d.push(P());else{var e=function(a,c,e){for(var e=[e],f=0;f<d.length;f++)e.push(d[f](a,c));return b.apply(a,e)};return function(){return e}}}function o(){var a=z(),b,c;if(f("?"))if(b=o(),c=f(":"))return m(a,b,o());else e("expected :",c);else return a}function z(){for(var a=r(),b;;)if(b=f("||"))a=k(a,b.fn,r());else return a}function r(){var a=y(),b;if(b=f("&&"))a=k(a,b.fn,r());return a}function y(){var a=x(),b;if(b=f("==","!=","===","!=="))a=k(a,b.fn,y());return a}function x(){var a;a=n();for(var b;b=f("+","-");)a=k(a,b.fn,n());if(b=f("<",">","<=",">="))a=k(a,b.fn,x());return a}function n(){for(var a=w(),b;b=f("*","/","%");)a=k(a,b.fn,w());return a}function w(){var a;return f("+")?A():(a=f("-"))?k($,a.fn,w()):(a=f("!"))?j(a.fn,w()):A()}function A(){var a;if(f("("))a=v(),h(")");else if(f("["))a=G();else if(f("{"))a=D();else{var b=f();(a=b.fn)||e("not a primary expression",b);if(b.json)a.constant=a.literal=!0}for(var c;b=f("(","[",".");)b.text==="("?(a=s(a,c),c=null):b.text==="["?(c=a,a=ma(a)):b.text==="."?(c=a,a=ja(a)):e("IMPOSSIBLE");return a}function G(){var a=[],b=!0;if(g().text!="]"){do{var c=P();a.push(c);c.constant||(b=!1)}while(f(","))}h("]");return t(function(b,c){for(var d=[],e=0;e<a.length;e++)d.push(a[e](b,c));return d},{literal:!0,constant:b})}function D(){var a=[],b=!0;if(g().text!="}"){do{var c=f(),c=c.string||c.text;h(":");var d=P();a.push({key:c,value:d});d.constant||(b=!1)}while(f(","))}h("}");return t(function(b,c){for(var d={},e=0;e<a.length;e++){var f=a[e];d[f.key]=f.value(b,c)}return d},{literal:!0,constant:b})}var $=S(0),K,O=Pc(b,d),P=function(){var a=o(),c,d;return(d=f("="))?(a.assign||e("implies assignment but ["+b.substring(0,d.index)+"] can not be assigned to",d),c=o(),function(b,d){return a.assign(b,c(b,d),d)}):a},s=function(a,b){var c=[];if(g().text!=")"){do c.push(P());while(f(","))}h(")");return function(d,e){for(var f=[],j=b?b(d,e):d,g=0;g<c.length;g++)f.push(c[g](d,e));g=a(d,e,j)||q;return g.apply?g.apply(j,f):g(f[0],f[1],f[2],f[3],f[4])}},ja=function(a){var b=f().text,c=Tb(b,d);return t(function(b,d,e){return c(e||a(b,d),d)},{assign:function(c,d,e){return Ub(a(c,e),b,d)}})},ma=function(a){var b=P();h("]");return t(function(c,d){var e=a(c,d),f=b(c,d),j;if(!e)return p;if((e=e[f])&&e.then){j=e;if(!("$$v"in e))j.$$v=p,j.then(function(a){j.$$v=a});e=e.$$v}return e},{assign:function(c,d,e){return a(c,e)[b(c,e)]=d}})},v=function(){for(var a=P(),b;;)if(b=f("|"))a=k(a,b.fn,u());else return a};a?(P=z,s=ja=ma=v=function(){e("is not valid json",{text:b,index:0})},K=A()):K=l();O.length!==0&&e("is an unexpected token",O[0]);K.literal=!!K.literal;K.constant=!!K.constant;return K}function Ub(b,a,c){for(var a=a.split("."),d=0;a.length>1;d++){var e=a.shift(),g=b[e];g||(g={},b[e]=g);b=g}return b[a.shift()]=c}function ib(b,a,c){if(!a)return b;for(var a=a.split("."),d,e=b,g=a.length,i=0;i<g;i++)d=a[i],b&&(b=(e=b)[d]);return!c&&H(b)?$a(e,b):b}function Vb(b,a,c,d,e){return function(g,i){var f=i&&i.hasOwnProperty(b)?i:g,h;if(f===null||f===p)return f;if((f=f[b])&&f.then){if(!("$$v"in f))h=f,h.$$v=p,h.then(function(a){h.$$v=a});f=f.$$v}if(!a||f===null||f===p)return f;if((f=f[a])&&f.then){if(!("$$v"in f))h=f,h.$$v=p,h.then(function(a){h.$$v=a});f=f.$$v}if(!c||f===null||f===p)return f;if((f=f[c])&&f.then){if(!("$$v"in f))h=f,h.$$v=p,h.then(function(a){h.$$v=a});f=f.$$v}if(!d||f===null||f===p)return f;if((f=f[d])&&f.then){if(!("$$v"in f))h=f,h.$$v=p,h.then(function(a){h.$$v=a});f=f.$$v}if(!e||f===null||f===p)return f;if((f=f[e])&&f.then){if(!("$$v"in f))h=f,h.$$v=p,h.then(function(a){h.$$v=a});f=f.$$v}return f}}function Tb(b,a){if(mb.hasOwnProperty(b))return mb[b];var c=b.split("."),d=c.length,e;if(a)e=d<6?Vb(c[0],c[1],c[2],c[3],c[4]):function(a,b){var e=0,j;do j=Vb(c[e++],c[e++],c[e++],c[e++],c[e++])(a,b),b=p,a=j;while(e<d);return j};else{var g="var l, fn, p;\n";n(c,function(a,b){g+="if(s === null || s === undefined) return s;\nl=s;\ns="+
(b?"s":'((k&&k.hasOwnProperty("'+a+'"))?k:s)')+'["'+a+'"];\nif (s && s.then) {\n if (!("$$v" in s)) {\n p=s;\n p.$$v = undefined;\n p.then(function(v) {p.$$v=v;});\n}\n s=s.$$v\n}\n'});g+="return s;";e=Function("s","k",g);e.toString=function(){return g}}return mb[b]=e}function Sc(){var b={};this.$get=["$filter","$sniffer",function(a,c){return function(d){switch(typeof d){case"string":return b.hasOwnProperty(d)?b[d]:b[d]=Rc(d,!1,a,c.csp);case"function":return d;default:return q}}}]}function Tc(){this.$get=["$rootScope","$exceptionHandler",function(b,a){return Uc(function(a){b.$evalAsync(a)},a)}]}function Uc(b,a){function c(a){return a}function d(a){return i(a)}var e=function(){var f=[],h,j;return j={resolve:function(a){if(f){var c=f;f=p;h=g(a);c.length&&b(function(){for(var a,b=0,d=c.length;b<d;b++)a=c[b],h.then(a[0],a[1])})}},reject:function(a){j.resolve(i(a))},promise:{then:function(b,j){var g=e(),i=function(d){try{g.resolve((b||c)(d))}catch(e){a(e),g.reject(e)}},o=function(b){try{g.resolve((j||d)(b))}catch(c){a(c),g.reject(c)}};f?f.push([i,o]):h.then(i,o);return g.promise},always:function(a){function b(a,c){var d=e();c?d.resolve(a):d.reject(a);return d.promise}function d(e,f){var j=null;try{j=(a||c)()}catch(g){return b(g,!1)}return j&&j.then?j.then(function(){return b(e,f)},function(a){return b(a,!1)}):b(e,f)}return this.then(function(a){return d(a,!0)},function(a){return d(a,!1)})}}}},g=function(a){return a&&a.then?a:{then:function(c){var d=e();b(function(){d.resolve(c(a))});return d.promise}}},i=function(a){return{then:function(c,j){var g=e();b(function(){g.resolve((j||d)(a))});return g.promise}}};return{defer:e,reject:i,when:function(f,h,j){var m=e(),k,l=function(b){try{return(h||c)(b)}catch(d){return a(d),i(d)}},u=function(b){try{return(j||d)(b)}catch(c){return a(c),i(c)}};b(function(){g(f).then(function(a){k||(k=!0,m.resolve(g(a).then(l,u)))},function(a){k||(k=!0,m.resolve(u(a)))})});return m.promise},all:function(a){var b=e(),c=0,d=F(a)?[]:{};n(a,function(a,e){c++;g(a).then(function(a){d.hasOwnProperty(e)||(d[e]=a,--c||b.resolve(d))},function(a){d.hasOwnProperty(e)||b.reject(a)})});c===0&&b.resolve(d);return b.promise}}}function Vc(){var b={};this.when=function(a,c){b[a]=t({reloadOnSearch:!0,caseInsensitiveMatch:!1},c);if(a){var d=a[a.length-1]=="/"?a.substr(0,a.length-1):a+"/";b[d]={redirectTo:a}}return this};this.otherwise=function(a){this.when(null,a);return this};this.$get=["$rootScope","$location","$routeParams","$q","$injector","$http","$templateCache",function(a,c,d,e,g,i,f){function h(a,b,c){for(var b="^"+b.replace(/[-\/\\^$:*+?.()|[\]{}]/g,"\\$&")+"$",d="",e=[],f={},j=/\\([:*])(\w+)/g,g,i=0;(g=j.exec(b))!==null;){d+=b.slice(i,g.index);switch(g[1]){case":":d+="([^\\/]*)";break;case"*":d+="(.*)"}e.push(g[2]);i=j.lastIndex}d+=b.substr(i);var h=a.match(RegExp(d,c.caseInsensitiveMatch?"i":""));h&&n(e,function(a,b){f[a]=h[b+1]});return h?f:null}function j(){var b=m(),j=u.current;if(b&&j&&b.$$route===j.$$route&&ia(b.pathParams,j.pathParams)&&!b.reloadOnSearch&&!l)j.params=b.params,V(j.params,d),a.$broadcast("$routeUpdate",j);else if(b||j)l=!1,a.$broadcast("$routeChangeStart",b,j),(u.current=b)&&b.redirectTo&&(E(b.redirectTo)?c.path(k(b.redirectTo,b.params)).search(b.params).replace():c.url(b.redirectTo(b.pathParams,c.path(),c.search())).replace()),e.when(b).then(function(){if(b){var a=t({},b.resolve),c;n(a,function(b,c){a[c]=E(b)?g.get(b):g.invoke(b)});if(B(c=b.template))H(c)&&(c=c(b.params));else if(B(c=b.templateUrl))if(H(c)&&(c=c(b.params)),B(c))b.loadedTemplateUrl=c,c=i.get(c,{cache:f}).then(function(a){return a.data});B(c)&&(a.$template=c);return e.all(a)}}).then(function(c){if(b==u.current){if(b)b.locals=c,V(b.params,d);a.$broadcast("$routeChangeSuccess",b,j)}},function(c){b==u.current&&a.$broadcast("$routeChangeError",b,j,c)})}function m(){var a,d;n(b,function(b,e){if(!d&&(a=h(c.path(),e,b)))d=tb(b,{params:t({},c.search(),a),pathParams:a}),d.$$route=b});return d||b[null]&&tb(b[null],{params:{},pathParams:{}})}function k(a,b){var c=[];n((a||"").split(":"),function(a,d){if(d==0)c.push(a);else{var e=a.match(/(\w+)(.*)/),f=e[1];c.push(b[f]);c.push(e[2]||"");delete b[f]}});return c.join("")}var l=!1,u={routes:b,reload:function(){l=!0;a.$evalAsync(j)}};a.$on("$locationChangeSuccess",j);return u}]}function Wc(){this.$get=S({})}function Xc(){var b=10;this.digestTtl=function(a){arguments.length&&(b=a);return b};this.$get=["$injector","$exceptionHandler","$parse",function(a,c,d){function e(){this.$id=Fa();this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null;this["this"]=this.$root=this;this.$$destroyed=!1;this.$$asyncQueue=[];this.$$listeners={};this.$$isolateBindings={}}function g(a){if(h.$$phase)throw Error(h.$$phase+" already in progress");h.$$phase=a}function i(a,b){var c=d(a);xa(c,b);return c}function f(){}e.prototype={$new:function(a){if(H(a))throw Error("API-CHANGE: Use $controller to instantiate controllers.");a?(a=new e,a.$root=this.$root):(a=function(){},a.prototype=this,a=new a,a.$id=Fa());a["this"]=a;a.$$listeners={};a.$parent=this;a.$$watchers=a.$$nextSibling=a.$$childHead=a.$$childTail=null;a.$$prevSibling=this.$$childTail;this.$$childHead?this.$$childTail=this.$$childTail.$$nextSibling=a:this.$$childHead=this.$$childTail=a;return a},$watch:function(a,b,c){var d=i(a,"watch"),e=this.$$watchers,g={fn:b,last:f,get:d,exp:a,eq:!!c};if(!H(b)){var h=i(b||q,"listener");g.fn=function(a,b,c){h(c)}}if(typeof a=="string"&&d.constant){var r=g.fn;g.fn=function(a,b,c){r.call(this,a,b,c);ta(e,g)}}if(!e)e=this.$$watchers=[];e.unshift(g);return function(){ta(e,g)}},$watchCollection:function(a,b){var c=this,e,f,g=0,i=d(a),h=[],n={},x=0;return this.$watch(function(){f=i(c);var a,b;if(L(f))if(Xa(f)){if(e!==h)e=h,x=e.length=0,g++;a=f.length;if(x!==a)g++,e.length=x=a;for(b=0;b<a;b++)e[b]!==f[b]&&(g++,e[b]=f[b])}else{e!==n&&(e=n={},x=0,g++);a=0;for(b in f)f.hasOwnProperty(b)&&(a++,e.hasOwnProperty(b)?e[b]!==f[b]&&(g++,e[b]=f[b]):(x++,e[b]=f[b],g++));if(x>a)for(b in g++,e)e.hasOwnProperty(b)&&!f.hasOwnProperty(b)&&(x--,delete e[b])}else e!==f&&(e=f,g++);return g},function(){b(f,e,c)})},$digest:function(){var a,d,e,i,u=this.$$asyncQueue,o,z,r=b,n,x=[],p,w;g("$digest");do{z=!1;for(n=this;u.length;)try{n.$eval(u.shift())}catch(A){c(A)}do{if(i=n.$$watchers)for(o=i.length;o--;)try{if(a=i[o],(d=a.get(n))!==(e=a.last)&&!(a.eq?ia(d,e):typeof d=="number"&&typeof e=="number"&&isNaN(d)&&isNaN(e)))z=!0,a.last=a.eq?V(d):d,a.fn(d,e===f?d:e,n),r<5&&(p=4-r,x[p]||(x[p]=[]),w=H(a.exp)?"fn: "+(a.exp.name||a.exp.toString()):a.exp,w+="; newVal: "+ha(d)+"; oldVal: "+ha(e),x[p].push(w))}catch(G){c(G)}if(!(i=n.$$childHead||n!==this&&n.$$nextSibling))for(;n!==this&&!(i=n.$$nextSibling);)n=n.$parent}while(n=i);if(z&&!r--)throw h.$$phase=null,Error(b+" $digest() iterations reached. Aborting!\nWatchers fired in the last 5 iterations: "+ha(x));}while(z||u.length);h.$$phase=null},$destroy:function(){if(!(h==this||this.$$destroyed)){var a=this.$parent;this.$broadcast("$destroy");this.$$destroyed=!0;if(a.$$childHead==this)a.$$childHead=this.$$nextSibling;if(a.$$childTail==this)a.$$childTail=this.$$prevSibling;if(this.$$prevSibling)this.$$prevSibling.$$nextSibling=this.$$nextSibling;if(this.$$nextSibling)this.$$nextSibling.$$prevSibling=this.$$prevSibling;this.$parent=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null}},$eval:function(a,b){return d(a)(this,b)},$evalAsync:function(a){this.$$asyncQueue.push(a)},$apply:function(a){try{return g("$apply"),this.$eval(a)}catch(b){c(b)}finally{h.$$phase=null;try{h.$digest()}catch(d){throw c(d),d;}}},$on:function(a,b){var c=this.$$listeners[a];c||(this.$$listeners[a]=c=[]);c.push(b);return function(){c[Ga(c,b)]=null}},$emit:function(a,b){var d=[],e,f=this,g=!1,i={name:a,targetScope:f,stopPropagation:function(){g=!0},preventDefault:function(){i.defaultPrevented=!0},defaultPrevented:!1},h=[i].concat(ka.call(arguments,1)),n,x;do{e=f.$$listeners[a]||d;i.currentScope=f;n=0;for(x=e.length;n<x;n++)if(e[n])try{if(e[n].apply(null,h),g)return i}catch(p){c(p)}else e.splice(n,1),n--,x--;f=f.$parent}while(f);return i},$broadcast:function(a,b){var d=this,e=this,f={name:a,targetScope:this,preventDefault:function(){f.defaultPrevented=!0},defaultPrevented:!1},g=[f].concat(ka.call(arguments,1)),i,h;do{d=e;f.currentScope=d;e=d.$$listeners[a]||[];i=0;for(h=e.length;i<h;i++)if(e[i])try{e[i].apply(null,g)}catch(n){c(n)}else e.splice(i,1),i--,h--;if(!(e=d.$$childHead||d!==this&&d.$$nextSibling))for(;d!==this&&!(e=d.$$nextSibling);)d=d.$parent}while(d=e);return f}};var h=new e;return h}]}function Yc(){this.$get=["$window","$document",function(b,a){var c={},d=N((/android (\d+)/.exec(I((b.navigator||{}).userAgent))||[])[1]),e=a[0]||{},g,i=/^(Moz|webkit|O|ms)(?=[A-Z])/,f=e.body&&e.body.style,h=!1,j=!1;if(f){for(var m in f)if(h=i.exec(m)){g=h[0];g=g.substr(0,1).toUpperCase()+g.substr(1);break}h=!!("transition"in f||g+"Transition"in f);j=!!("animation"in f||g+"Animation"in f)}return{history:!(!b.history||!b.history.pushState||d<4),hashchange:"onhashchange"in b&&(!e.documentMode||e.documentMode>7),hasEvent:function(a){if(a=="input"&&Z==9)return!1;if(C(c[a])){var b=e.createElement("div");c[a]="on"+a in b}return c[a]},csp:e.securityPolicy?e.securityPolicy.isActive:!1,vendorPrefix:g,transitions:h,animations:j}}]}function Zc(){this.$get=S(M)}function Wb(b){var a={},c,d,e;if(!b)return a;n(b.split("\n"),function(b){e=b.indexOf(":");c=I(U(b.substr(0,e)));d=U(b.substr(e+1));c&&(a[c]?a[c]+=", "+d:a[c]=d)});return a}function $c(b,a){var c=ad.exec(b);if(c==null)return!0;var d={protocol:c[2],host:c[4],port:N(c[6])||Oa[c[2]]||null,relativeProtocol:c[2]===p||c[2]===""},c=jb.exec(a),c={protocol:c[1],host:c[3],port:N(c[5])||Oa[c[1]]||null};return(d.protocol==c.protocol||d.relativeProtocol)&&d.host==c.host&&(d.port==c.port||d.relativeProtocol&&c.port==Oa[c.protocol])}function Xb(b){var a=L(b)?b:p;return function(c){a||(a=Wb(b));return c?a[I(c)]||null:a}}function Yb(b,a,c){if(H(c))return c(b,a);n(c,function(c){b=c(b,a)});return b}function bd(){var b=/^\s*(\[|\{[^\{])/,a=/[\}\]]\s*$/,c=/^\)\]\}',?\n/,d={"Content-Type":"application/json;charset=utf-8"},e=this.defaults={transformResponse:[function(d){E(d)&&(d=d.replace(c,""),b.test(d)&&a.test(d)&&(d=ub(d,!0)));return d}],transformRequest:[function(a){return L(a)&&Ea.apply(a)!=="[object File]"?ha(a):a}],headers:{common:{Accept:"application/json, text/plain, */*"},post:d,put:d,patch:d},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN"},g=this.interceptors=[],i=this.responseInterceptors=[];this.$get=["$httpBackend","$browser","$cacheFactory","$rootScope","$q","$injector",function(a,b,c,d,k,l){function u(a){function c(a){var b=t({},a,{data:Yb(a.data,a.headers,d.transformResponse)});return 200<=a.status&&a.status<300?b:k.reject(b)}var d={transformRequest:e.transformRequest,transformResponse:e.transformResponse},f={};t(d,a);d.headers=f;d.method=oa(d.method);t(f,e.headers.common,e.headers[I(d.method)],a.headers);(a=$c(d.url,b.url())?b.cookies()[d.xsrfCookieName||e.xsrfCookieName]:p)&&(f[d.xsrfHeaderName||e.xsrfHeaderName]=a);var g=[function(a){var b=Yb(a.data,Xb(f),a.transformRequest);C(a.data)&&delete f["Content-Type"];if(C(a.withCredentials)&&!C(e.withCredentials))a.withCredentials=e.withCredentials;return o(a,b,f).then(c,c)},p],j=k.when(d);for(n(y,function(a){(a.request||a.requestError)&&g.unshift(a.request,a.requestError);(a.response||a.responseError)&&g.push(a.response,a.responseError)});g.length;)var a=g.shift(),i=g.shift(),j=j.then(a,i);j.success=function(a){j.then(function(b){a(b.data,b.status,b.headers,d)});return j};j.error=function(a){j.then(null,function(b){a(b.data,b.status,b.headers,d)});return j};return j}function o(b,c,g){function j(a,b,c){n&&(200<=a&&a<300?n.put(s,[a,b,Wb(c)]):n.remove(s));i(b,a,c);d.$$phase||d.$apply()}function i(a,c,d){c=Math.max(c,0);(200<=c&&c<300?l.resolve:l.reject)({data:a,status:c,headers:Xb(d),config:b})}function h(){var a=Ga(u.pendingRequests,b);a!==-1&&u.pendingRequests.splice(a,1)}var l=k.defer(),o=l.promise,n,p,s=z(b.url,b.params);u.pendingRequests.push(b);o.then(h,h);if((b.cache||e.cache)&&b.cache!==!1&&b.method=="GET")n=L(b.cache)?b.cache:L(e.cache)?e.cache:r;if(n)if(p=n.get(s))if(p.then)return p.then(h,h),p;else F(p)?i(p[1],p[0],V(p[2])):i(p,200,{});else n.put(s,o);p||a(b.method,s,c,j,g,b.timeout,b.withCredentials,b.responseType);return o}function z(a,b){if(!b)return a;var c=[];nc(b,function(a,b){a==null||a==p||(F(a)||(a=[a]),n(a,function(a){L(a)&&(a=ha(a));c.push(wa(b)+"="+wa(a))}))});return a+(a.indexOf("?")==-1?"?":"&")+c.join("&")}var r=c("$http"),y=[];n(g,function(a){y.unshift(E(a)?l.get(a):l.invoke(a))});n(i,function(a,b){var c=E(a)?l.get(a):l.invoke(a);y.splice(b,0,{response:function(a){return c(k.when(a))},responseError:function(a){return c(k.reject(a))}})});u.pendingRequests=[];(function(a){n(arguments,function(a){u[a]=function(b,c){return u(t(c||{},{method:a,url:b}))}})})("get","delete","head","jsonp");(function(a){n(arguments,function(a){u[a]=function(b,c,d){return u(t(d||{},{method:a,url:b,data:c}))}})})("post","put");u.defaults=e;return u}]}function cd(){this.$get=["$browser","$window","$document",function(b,a,c){return dd(b,ed,b.defer,a.angular.callbacks,c[0],a.location.protocol.replace(":",""))}]}
function dd(b,a,c,d,e,g){function i(a,b){var c=e.createElement("script"),d=function(){e.body.removeChild(c);b&&b()};c.type="text/javascript";c.src=a;Z?c.onreadystatechange=function(){/loaded|complete/.test(c.readyState)&&d()}:c.onload=c.onerror=d;e.body.appendChild(c);return d}return function(e,h,j,m,k,l,u,o){function z(){p=-1;t&&t();w&&w.abort()}function r(a,d,e,f){var j=(h.match(jb)||["",g])[1];A&&c.cancel(A);t=w=null;d=j=="file"?e?200:404:d;a(d==1223?204:d,e,f);b.$$completeOutstandingRequest(q)}
var p;b.$$incOutstandingRequestCount();h=h||b.url();if(I(e)=="jsonp"){var x="_"+(d.counter++).toString(36);d[x]=function(a){d[x].data=a};var t=i(h.replace("JSON_CALLBACK","angular.callbacks."+x),function(){d[x].data?r(m,200,d[x].data):r(m,p||-2);delete d[x]})}else{var w=new a;w.open(e,h,!0);n(k,function(a,b){a&&w.setRequestHeader(b,a)});w.onreadystatechange=function(){if(w.readyState==4){var a=w.getAllResponseHeaders(),b=["Cache-Control","Content-Language","Content-Type","Expires","Last-Modified","Pragma"];a||(a="",n(b,function(b){var c=w.getResponseHeader(b);c&&(a+=b+": "+c+"\n")}));r(m,p||w.status,w.responseType?w.response:w.responseText,a)}};if(u)w.withCredentials=!0;if(o)w.responseType=o;w.send(j||"")}if(l>0)var A=c(z,l);else l&&l.then&&l.then(z)}}function fd(){this.$get=function(){return{id:"en-us",NUMBER_FORMATS:{DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{minInt:1,minFrac:0,maxFrac:3,posPre:"",posSuf:"",negPre:"-",negSuf:"",gSize:3,lgSize:3},{minInt:1,minFrac:2,maxFrac:2,posPre:"\u00a4",posSuf:"",negPre:"(\u00a4",negSuf:")",gSize:3,lgSize:3}],CURRENCY_SYM:"$"},DATETIME_FORMATS:{MONTH:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),SHORTMONTH:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),DAY:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),SHORTDAY:"Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(","),AMPMS:["AM","PM"],medium:"MMM d, y h:mm:ss a","short":"M/d/yy h:mm a",fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",mediumDate:"MMM d, y",shortDate:"M/d/yy",mediumTime:"h:mm:ss a",shortTime:"h:mm a"},pluralCat:function(b){return b===1?"one":"other"}}}}function gd(){this.$get=["$rootScope","$browser","$q","$exceptionHandler",function(b,a,c,d){function e(e,f,h){var j=c.defer(),m=j.promise,k=B(h)&&!h,f=a.defer(function(){try{j.resolve(e())}catch(a){j.reject(a),d(a)}k||b.$apply()},f),h=function(){delete g[m.$$timeoutId]};m.$$timeoutId=f;g[f]=j;m.then(h,h);return m}var g={};e.cancel=function(b){return b&&b.$$timeoutId in
g?(g[b.$$timeoutId].reject("canceled"),a.defer.cancel(b.$$timeoutId)):!1};return e}]}function Zb(b){function a(a,e){return b.factory(a+c,e)}var c="Filter";this.register=a;this.$get=["$injector",function(a){return function(b){return a.get(b+c)}}];a("currency",$b);a("date",ac);a("filter",hd);a("json",id);a("limitTo",jd);a("lowercase",kd);a("number",bc);a("orderBy",cc);a("uppercase",ld)}function hd(){return function(b,a,c){if(!F(b))return b;var d=[];d.check=function(a){for(var b=0;b<d.length;b++)if(!d[b](a))return!1;return!0};switch(typeof c){case"function":break;case"boolean":if(c==!0){c=function(a,b){return Ha.equals(a,b)};break}default:c=function(a,b){b=(""+b).toLowerCase();return(""+a).toLowerCase().indexOf(b)>-1}}var e=function(a,b){if(typeof b=="string"&&b.charAt(0)==="!")return!e(a,b.substr(1));switch(typeof a){case"boolean":case"number":case"string":return c(a,b);case"object":switch(typeof b){case"object":return c(a,b);default:for(var d in a)if(d.charAt(0)!=="$"&&e(a[d],b))return!0}return!1;case"array":for(d=0;d<a.length;d++)if(e(a[d],b))return!0;return!1;default:return!1}};switch(typeof a){case"boolean":case"number":case"string":a={$:a};case"object":for(var g in a)g=="$"?function(){if(a[g]){var b=g;d.push(function(c){return e(c,a[b])})}}():function(){if(a[g]){var b=g;d.push(function(c){return e(ib(c,b),a[b])})}}();break;case"function":d.push(a);break;default:return b}for(var i=[],f=0;f<b.length;f++){var h=b[f];d.check(h)&&i.push(h)}return i}}function $b(b){var a=b.NUMBER_FORMATS;return function(b,d){if(C(d))d=a.CURRENCY_SYM;return dc(b,a.PATTERNS[1],a.GROUP_SEP,a.DECIMAL_SEP,2).replace(/\u00A4/g,d)}}function bc(b){var a=b.NUMBER_FORMATS;return function(b,d){return dc(b,a.PATTERNS[0],a.GROUP_SEP,a.DECIMAL_SEP,d)}}function dc(b,a,c,d,e){if(isNaN(b)||!isFinite(b))return"";var g=b<0,b=Math.abs(b),i=b+"",f="",h=[],j=!1;if(i.indexOf("e")!==-1){var m=i.match(/([\d\.]+)e(-?)(\d+)/);m&&m[2]=="-"&&m[3]>e+1?i="0":(f=i,j=!0)}if(!j){i=(i.split(ec)[1]||"").length;C(e)&&(e=Math.min(Math.max(a.minFrac,i),a.maxFrac));var i=Math.pow(10,e),b=Math.round(b*i)/i,b=(""+b).split(ec),i=b[0],b=b[1]||"",j=0,m=a.lgSize,k=a.gSize;if(i.length>=m+k)for(var j=i.length-m,l=0;l<j;l++)(j-l)%k===0&&l!==0&&(f+=c),f+=i.charAt(l);for(l=j;l<i.length;l++)(i.length-l)%m===0&&l!==0&&(f+=c),f+=i.charAt(l);for(;b.length<e;)b+="0";e&&e!=="0"&&(f+=d+b.substr(0,e))}h.push(g?a.negPre:a.posPre);h.push(f);h.push(g?a.negSuf:a.posSuf);return h.join("")}function nb(b,a,c){var d="";b<0&&(d="-",b=-b);for(b=""+b;b.length<a;)b="0"+b;c&&(b=b.substr(b.length-a));return d+b}function Q(b,a,c,d){c=c||0;return function(e){e=e["get"+b]();if(c>0||e>-c)e+=c;e===0&&c==-12&&(e=12);return nb(e,a,d)}}function Qa(b,a){return function(c,d){var e=c["get"+b](),g=oa(a?"SHORT"+b:b);return d[g][e]}}function ac(b){function a(a){var b;if(b=a.match(c)){var a=new Date(0),g=0,i=0,f=b[8]?a.setUTCFullYear:a.setFullYear,h=b[8]?a.setUTCHours:a.setHours;b[9]&&(g=N(b[9]+b[10]),i=N(b[9]+b[11]));f.call(a,N(b[1]),N(b[2])-1,N(b[3]));g=N(b[4]||0)-g;i=N(b[5]||0)-i;f=N(b[6]||0);b=Math.round(parseFloat("0."+(b[7]||0))*1E3);h.call(a,g,i,f,b)}return a}var c=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(c,e){var g="",i=[],f,h,e=e||"mediumDate",e=b.DATETIME_FORMATS[e]||e;E(c)&&(c=md.test(c)?N(c):a(c));Ya(c)&&(c=new Date(c));if(!ra(c))return c;for(;e;)(h=nd.exec(e))?(i=i.concat(ka.call(h,1)),e=i.pop()):(i.push(e),e=null);n(i,function(a){f=od[a];g+=f?f(c,b.DATETIME_FORMATS):a.replace(/(^'|'$)/g,"").replace(/''/g,"'")});return g}}function id(){return function(b){return ha(b,!0)}}function jd(){return function(b,a){if(!F(b)&&!E(b))return b;a=N(a);if(E(b))return a?a>=0?b.slice(0,a):b.slice(a,b.length):"";var c=[],d,e;a>b.length?a=b.length:a<-b.length&&(a=-b.length);a>0?(d=0,e=a):(d=b.length+a,e=b.length);for(;d<e;d++)c.push(b[d]);return c}}function cc(b){return function(a,c,d){function e(a,b){return ua(b)?function(b,c){return a(c,b)}:a}if(!F(a))return a;if(!c)return a;for(var c=F(c)?c:[c],c=Za(c,function(a){var c=!1,d=a||qa;if(E(a)){if(a.charAt(0)=="+"||a.charAt(0)=="-")c=a.charAt(0)=="-",a=a.substring(1);d=b(a)}return e(function(a,b){var c;c=d(a);var e=d(b),f=typeof c,g=typeof e;f==g?(f=="string"&&(c=c.toLowerCase()),f=="string"&&(e=e.toLowerCase()),c=c===e?0:c<e?-1:1):c=f<g?-1:1;return c},c)}),g=[],i=0;i<a.length;i++)g.push(a[i]);return g.sort(e(function(a,b){for(var d=0;d<c.length;d++){var e=c[d](a,b);if(e!==0)return e}return 0},d))}}function aa(b){H(b)&&(b={link:b});b.restrict=b.restrict||"AC";return S(b)}function fc(b,a){function c(a,c){c=c?"-"+bb(c,"-"):"";b.removeClass((a?Ra:Sa)+c).addClass((a?Sa:Ra)+c)}var d=this,e=b.parent().controller("form")||Ta,g=0,i=d.$error={},f=[];d.$name=a.name;d.$dirty=!1;d.$pristine=!0;d.$valid=!0;d.$invalid=!1;e.$addControl(d);b.addClass(pa);c(!0);d.$addControl=function(a){f.push(a);a.$name&&!d.hasOwnProperty(a.$name)&&(d[a.$name]=a)};d.$removeControl=function(a){a.$name&&d[a.$name]===a&&delete d[a.$name];n(i,function(b,c){d.$setValidity(c,!0,a)});ta(f,a)};d.$setValidity=function(a,b,f){var k=i[a];if(b){if(k&&(ta(k,f),!k.length)){g--;if(!g)c(b),d.$valid=!0,d.$invalid=!1;i[a]=!1;c(!0,a);e.$setValidity(a,!0,d)}}else{g||c(b);if(k){if(Ga(k,f)!=-1)return}else i[a]=k=[],g++,c(!1,a),e.$setValidity(a,!1,d);k.push(f);d.$valid=!1;d.$invalid=!0}};d.$setDirty=function(){b.removeClass(pa).addClass(Ua);d.$dirty=!0;d.$pristine=!1;e.$setDirty()};d.$setPristine=function(){b.removeClass(Ua).addClass(pa);d.$dirty=!1;d.$pristine=!0;n(f,function(a){a.$setPristine()})}}
function X(b){return C(b)||b===""||b===null||b!==b}function Va(b,a,c,d,e,g){var i=function(){var e=a.val();if(ua(c.ngTrim||"T"))e=U(e);d.$viewValue!==e&&b.$apply(function(){d.$setViewValue(e)})};if(e.hasEvent("input"))a.bind("input",i);else{var f,h=function(){f||(f=g.defer(function(){i();f=null}))};a.bind("keydown",function(a){a=a.keyCode;a===91||15<a&&a<19||37<=a&&a<=40||h()});a.bind("change",i);e.hasEvent("paste")&&a.bind("paste cut",h)}d.$render=function(){a.val(X(d.$viewValue)?"":d.$viewValue)};var j=c.ngPattern,m=function(a,b){return X(b)||a.test(b)?(d.$setValidity("pattern",!0),b):(d.$setValidity("pattern",!1),p)};j&&((e=j.match(/^\/(.*)\/([gim]*)$/))?(j=RegExp(e[1],e[2]),e=function(a){return m(j,a)}):e=function(a){var c=b.$eval(j);if(!c||!c.test)throw Error("Expected "+j+" to be a RegExp but was "+c);return m(c,a)},d.$formatters.push(e),d.$parsers.push(e));if(c.ngMinlength){var k=N(c.ngMinlength),e=function(a){return!X(a)&&a.length<k?(d.$setValidity("minlength",!1),p):(d.$setValidity("minlength",!0),a)};d.$parsers.push(e);d.$formatters.push(e)}if(c.ngMaxlength){var l=N(c.ngMaxlength),e=function(a){return!X(a)&&a.length>l?(d.$setValidity("maxlength",!1),p):(d.$setValidity("maxlength",!0),a)};d.$parsers.push(e);d.$formatters.push(e)}}function ob(b,a){b="ngClass"+b;return aa(function(c,d,e){function g(b){if(a===!0||c.$index%2===a)h&&!ia(b,h)&&i(h),f(b);h=V(b)}function i(a){L(a)&&!F(a)&&(a=Za(a,function(a,b){if(a)return b}));d.removeClass(F(a)?a.join(" "):a)}function f(a){L(a)&&!F(a)&&(a=Za(a,function(a,b){if(a)return b}));a&&d.addClass(F(a)?a.join(" "):a)}var h=p;c.$watch(e[b],g,!0);e.$observe("class",function(){var a=c.$eval(e[b]);g(a,a)});b!=="ngClass"&&c.$watch("$index",function(d,g){var h=d&1;h!==g&1&&(h===a?f(c.$eval(e[b])):i(c.$eval(e[b])))})})}var I=function(b){return E(b)?b.toLowerCase():b},oa=function(b){return E(b)?b.toUpperCase():b},Z=N((/msie (\d+)/.exec(I(navigator.userAgent))||[])[1]),v,ga,ka=[].slice,Wa=[].push,Ea=Object.prototype.toString,mc=M.angular,Ha=M.angular||(M.angular={}),Aa,hb,ba=["0","0","0"];q.$inject=[];qa.$inject=[];hb=Z<9?function(b){b=b.nodeName?b:b[0];return b.scopeName&&b.scopeName!="HTML"?oa(b.scopeName+":"+b.nodeName):b.nodeName}:function(b){return b.nodeName?b.nodeName:b[0].nodeName};var sc=/[A-Z]/g,pd={full:"1.1.5",major:1,minor:1,dot:5,codeName:"triangle-squarification"},Ka=R.cache={},Ja=R.expando="ng-"+(new Date).getTime(),wc=1,gc=M.document.addEventListener?function(b,a,c){b.addEventListener(a,c,!1)}:function(b,a,c){b.attachEvent("on"+a,c)},gb=M.document.removeEventListener?function(b,a,c){b.removeEventListener(a,c,!1)}:function(b,a,c){b.detachEvent("on"+a,c)},uc=/([\:\-\_]+(.))/g,vc=/^moz([A-Z])/,Ba=R.prototype={ready:function(b){function a(){c||(c=!0,b())}var c=!1;T.readyState==="complete"?setTimeout(a):(this.bind("DOMContentLoaded",a),R(M).bind("load",a))},toString:function(){var b=[];n(this,function(a){b.push(""+a)});return"["+b.join(", ")+"]"},eq:function(b){return b>=0?v(this[b]):v(this[this.length+b])},length:0,push:Wa,sort:[].sort,splice:[].splice},Na={};n("multiple,selected,checked,disabled,readOnly,required,open".split(","),function(b){Na[I(b)]=b});var Gb={};n("input,select,option,textarea,button,form,details".split(","),function(b){Gb[oa(b)]=!0});n({data:Bb,inheritedData:Ma,scope:function(b){return Ma(b,"$scope")},controller:Eb,injector:function(b){return Ma(b,"$injector")},removeAttr:function(b,a){b.removeAttribute(a)},hasClass:La,css:function(b,a,c){a=Ia(a);if(B(c))b.style[a]=c;else{var d;Z<=8&&(d=b.currentStyle&&b.currentStyle[a],d===""&&(d="auto"));d=d||b.style[a];Z<=8&&(d=d===""?p:d);return d}},attr:function(b,a,c){var d=I(a);if(Na[d])if(B(c))c?(b[a]=!0,b.setAttribute(a,d)):(b[a]=!1,b.removeAttribute(d));else return b[a]||(b.attributes.getNamedItem(a)||q).specified?d:p;else if(B(c))b.setAttribute(a,c);else if(b.getAttribute)return b=b.getAttribute(a,2),b===null?p:b},prop:function(b,a,c){if(B(c))b[a]=c;else return b[a]},text:t(Z<9?function(b,a){if(b.nodeType==1){if(C(a))return b.innerText;b.innerText=a}else{if(C(a))return b.nodeValue;b.nodeValue=a}}:function(b,a){if(C(a))return b.textContent;b.textContent=a},{$dv:""}),val:function(b,a){if(C(a))return b.value;b.value=a},html:function(b,a){if(C(a))return b.innerHTML;for(var c=0,d=b.childNodes;c<d.length;c++)ya(d[c]);b.innerHTML=a}},function(b,a){R.prototype[a]=function(a,d){var e,g;if((b.length==2&&b!==La&&b!==Eb?a:d)===p)if(L(a)){for(e=0;e<this.length;e++)if(b===Bb)b(this[e],a);else for(g in a)b(this[e],g,a[g]);return this}else{if(this.length)return b(this[0],a,d)}else{for(e=0;e<this.length;e++)b(this[e],a,d);return this}return b.$dv}});n({removeData:zb,dealoc:ya,bind:function a(c,d,e){var g=ca(c,"events"),i=ca(c,"handle");g||ca(c,"events",g={});i||ca(c,"handle",i=xc(c,g));n(d.split(" "),function(d){var h=g[d];if(!h){if(d=="mouseenter"||d=="mouseleave"){var j=T.body.contains||T.body.compareDocumentPosition?function(a,c){var d=a.nodeType===9?a.documentElement:a,e=c&&c.parentNode;return a===e||!(!e||!(e.nodeType===1&&(d.contains?d.contains(e):a.compareDocumentPosition&&a.compareDocumentPosition(e)&16)))}:function(a,c){if(c)for(;c=c.parentNode;)if(c===a)return!0;return!1};g[d]=[];a(c,{mouseleave:"mouseout",mouseenter:"mouseover"}[d],function(a){var c=a.relatedTarget;(!c||c!==this&&!j(this,c))&&i(a,d)})}else gc(c,d,i),g[d]=[];h=g[d]}h.push(e)})},unbind:Ab,replaceWith:function(a,c){var d,e=a.parentNode;ya(a);n(new R(c),function(c){d?e.insertBefore(c,d.nextSibling):e.replaceChild(c,a);d=c})},children:function(a){var c=[];n(a.childNodes,function(a){a.nodeType===1&&c.push(a)});return c},contents:function(a){return a.childNodes||[]},append:function(a,c){n(new R(c),function(c){(a.nodeType===1||a.nodeType===11)&&a.appendChild(c)})},prepend:function(a,c){if(a.nodeType===1){var d=a.firstChild;n(new R(c),function(c){d?a.insertBefore(c,d):(a.appendChild(c),d=c)})}},wrap:function(a,c){var c=v(c)[0],d=a.parentNode;d&&d.replaceChild(c,a);c.appendChild(a)},remove:function(a){ya(a);var c=a.parentNode;c&&c.removeChild(a)},after:function(a,c){var d=a,e=a.parentNode;n(new R(c),function(a){e.insertBefore(a,d.nextSibling);d=a})},addClass:Db,removeClass:Cb,toggleClass:function(a,c,d){C(d)&&(d=!La(a,c));(d?Db:Cb)(a,c)},parent:function(a){return(a=a.parentNode)&&a.nodeType!==11?a:null},next:function(a){if(a.nextElementSibling)return a.nextElementSibling;for(a=a.nextSibling;a!=null&&a.nodeType!==1;)a=a.nextSibling;return a},find:function(a,c){return a.getElementsByTagName(c)},clone:fb,triggerHandler:function(a,c){var d=(ca(a,"events")||{})[c];n(d,function(c){c.call(a,{preventDefault:q})})}},function(a,c){R.prototype[c]=function(c,e){for(var g,i=0;i<this.length;i++)g==p?(g=a(this[i],c,e),g!==p&&(g=v(g))):eb(g,a(this[i],c,e));return g==p?this:g}});za.prototype={put:function(a,c){this[la(a)]=c},get:function(a){return this[la(a)]},remove:function(a){var c=this[a=la(a)];delete this[a];return c}};var zc=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,Ac=/,/,Bc=/^\s*(_?)(\S+?)\1\s*$/,yc=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg;Ib.$inject=["$provide"];var qd=function(){var a="$ngAnimateController",c={running:!0};this.$get=["$animation","$window","$sniffer","$rootElement","$rootScope",function(d,e,g,i){i.data(a,c);i=function(c,i){function j(j,k,o){return function(m,r,p){function x(a){var c=0,a=E(a)?a.split(/\s*,\s*/):[];n(a,function(a){c=Math.max(parseFloat(a)||0,c)});return c}function t(){m.addClass(K);if($)$(m,w,P);else if(H(e.getComputedStyle)){var a=g.vendorPrefix+"Animation",c=g.vendorPrefix+"Transition",d=0;n(m,function(f){if(f.nodeType==1){var g="transition",i=c,j=1,h=e.getComputedStyle(f)||{};if(parseFloat(h.animationDuration)>0||parseFloat(h[a+"Duration"])>0)g="animation",i=a,j=Math.max(parseInt(h[g+"IterationCount"])||0,parseInt(h[i+"IterationCount"])||0,j);f=Math.max(x(h[g+"Delay"]),x(h[i+"Delay"]));g=Math.max(x(h[g+"Duration"]),x(h[i+"Duration"]));d=Math.max(f+j*g,d)}});e.setTimeout(w,d*1E3)}else w()}function w(){if(!w.run)w.run=!0,o(m,r,p),m.removeClass(v),m.removeClass(K),m.removeData(a)}var A=c.$eval(i.ngAnimate),v=A?L(A)?A[j]:A+"-"+j:"",D=d(v),A=D&&D.setup,$=D&&D.start,D=D&&D.cancel;if(v){var K=v+"-active";r||(r=p?p.parent():m.parent());if(!g.transitions&&!A&&!$||(r.inheritedData(a)||q).running)k(m,r,p),o(m,r,p);else{var O=m.data(a)||{};O.running&&((D||q)(m),O.done());m.data(a,{running:!0,done:w});m.addClass(v);k(m,r,p);if(m.length==0)return w();var P=(A||q)(m);e.setTimeout(t,1)}}else k(m,r,p),o(m,r,p)}}function m(a,c,d){d?d.after(a):c.append(a)}var k={};k.enter=j("enter",m,q);k.leave=j("leave",q,function(a){a.remove()});k.move=j("move",function(a,c,d){m(a,c,d)},q);k.show=j("show",function(a){a.css("display","")},q);k.hide=j("hide",q,function(a){a.css("display","none")});k.animate=function(a,c){j(a,q,q)(c)};return k};i.enabled=function(a){if(arguments.length)c.running=!a;return!c.running};return i}]},Kb="Non-assignable model expression: ";Jb.$inject=["$provide"];var Ic=/^(x[\:\-_]|data[\:\-_])/i,jb=/^([^:]+):\/\/(\w+:{0,1}\w*@)?(\{?[\w\.-]*\}?)(:([0-9]+))?(\/[^\?#]*)?(\?([^#]*))?(#(.*))?$/,Pb=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,Oa={http:80,https:443,ftp:21};Rb.prototype=lb.prototype=Qb.prototype={$$replace:!1,absUrl:Pa("$$absUrl"),url:function(a,c){if(C(a))return this.$$url;var d=Pb.exec(a);d[1]&&this.path(decodeURIComponent(d[1]));if(d[2]||d[1])this.search(d[3]||"");this.hash(d[5]||"",c);return this},protocol:Pa("$$protocol"),host:Pa("$$host"),port:Pa("$$port"),path:Sb("$$path",function(a){return a.charAt(0)=="/"?a:"/"+a}),search:function(a,c){if(C(a))return this.$$search;B(c)?c===null?delete this.$$search[a]:this.$$search[a]=c:this.$$search=E(a)?vb(a):a;this.$$compose();return this},hash:Sb("$$hash",qa),replace:function(){this.$$replace=!0;return this}};var Da={"null":function(){return null},"true":function(){return!0},"false":function(){return!1},undefined:q,"+":function(a,c,d,e){d=d(a,c);e=e(a,c);return B(d)?B(e)?d+e:d:B(e)?e:p},"-":function(a,c,d,e){d=d(a,c);e=e(a,c);return(B(d)?d:0)-(B(e)?e:0)},"*":function(a,c,d,e){return d(a,c)*e(a,c)},"/":function(a,c,d,e){return d(a,c)/e(a,c)},"%":function(a,c,d,e){return d(a,c)%e(a,c)},"^":function(a,c,d,e){return d(a,c)^e(a,c)},"=":q,"===":function(a,c,d,e){return d(a,c)===e(a,c)},"!==":function(a,c,d,e){return d(a,c)!==e(a,c)},"==":function(a,c,d,e){return d(a,c)==e(a,c)},"!=":function(a,c,d,e){return d(a,c)!=e(a,c)},"<":function(a,c,d,e){return d(a,c)<e(a,c)},">":function(a,c,d,e){return d(a,c)>e(a,c)},"<=":function(a,c,d,e){return d(a,c)<=e(a,c)},">=":function(a,c,d,e){return d(a,c)>=e(a,c)},"&&":function(a,c,d,e){return d(a,c)&&e(a,c)},"||":function(a,c,d,e){return d(a,c)||e(a,c)},"&":function(a,c,d,e){return d(a,c)&e(a,c)},"|":function(a,c,d,e){return e(a,c)(a,c,d(a,c))},"!":function(a,c,d){return!d(a,c)}},Qc={n:"\n",f:"\u000c",r:"\r",t:"\t",v:"\u000b","'":"'",'"':'"'},mb={},ad=/^(([^:]+):)?\/\/(\w+:{0,1}\w*@)?([\w\.-]*)?(:([0-9]+))?(.*)$/,ed=M.XMLHttpRequest||function(){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(a){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(c){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(d){}throw Error("This browser does not support XMLHttpRequest.");};Zb.$inject=["$provide"];$b.$inject=["$locale"];bc.$inject=["$locale"];var ec=".",od={yyyy:Q("FullYear",4),yy:Q("FullYear",2,0,!0),y:Q("FullYear",1),MMMM:Qa("Month"),MMM:Qa("Month",!0),MM:Q("Month",2,1),M:Q("Month",1,1),dd:Q("Date",2),d:Q("Date",1),HH:Q("Hours",2),H:Q("Hours",1),hh:Q("Hours",2,-12),h:Q("Hours",1,-12),mm:Q("Minutes",2),m:Q("Minutes",1),ss:Q("Seconds",2),s:Q("Seconds",1),sss:Q("Milliseconds",3),EEEE:Qa("Day"),EEE:Qa("Day",!0),a:function(a,c){return a.getHours()<12?c.AMPMS[0]:c.AMPMS[1]},Z:function(a){var a=-1*a.getTimezoneOffset(),c=a>=0?"+":"";c+=nb(Math[a>0?"floor":"ceil"](a/60),2)+nb(Math.abs(a%60),2);return c}},nd=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,md=/^\d+$/;ac.$inject=["$locale"];var kd=S(I),ld=S(oa);cc.$inject=["$parse"];var rd=S({restrict:"E",compile:function(a,c){Z<=8&&(!c.href&&!c.name&&c.$set("href",""),a.append(T.createComment("IE fix")));return function(a,c){c.bind("click",function(a){c.attr("href")||a.preventDefault()})}}}),pb={};n(Na,function(a,c){var d=da("ng-"+c);pb[d]=function(){return{priority:100,compile:function(){return function(a,g,i){a.$watch(i[d],function(a){i.$set(c,!!a)})}}}}});n(["src","srcset","href"],function(a){var c=da("ng-"+a);pb[c]=function(){return{priority:99,link:function(d,e,g){g.$observe(c,function(c){c&&(g.$set(a,c),Z&&e.prop(a,g[a]))})}}}});var Ta={$addControl:q,$removeControl:q,$setValidity:q,$setDirty:q,$setPristine:q};fc.$inject=["$element","$attrs","$scope"];var Wa=function(a){return["$timeout",function(c){var d={name:"form",restrict:"E",controller:fc,compile:function(){return{pre:function(a,d,i,f){if(!i.action){var h=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1};gc(d[0],"submit",h);d.bind("$destroy",function(){c(function(){gb(d[0],"submit",h)},0,!1)})}var j=d.parent().controller("form"),m=i.name||i.ngForm;m&&(a[m]=f);j&&d.bind("$destroy",function(){j.$removeControl(f);m&&(a[m]=p);t(f,Ta)})}}}};return a?t(V(d),{restrict:"EAC"}):d}]},sd=Wa(),td=Wa(!0),ud=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,vd=/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/,wd=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/,hc={text:Va,number:function(a,c,d,e,g,i){Va(a,c,d,e,g,i);e.$parsers.push(function(a){var c=X(a);return c||wd.test(a)?(e.$setValidity("number",!0),a===""?null:c?a:parseFloat(a)):(e.$setValidity("number",!1),p)});e.$formatters.push(function(a){return X(a)?"":""+a});if(d.min){var f=parseFloat(d.min),a=function(a){return!X(a)&&a<f?(e.$setValidity("min",!1),p):(e.$setValidity("min",!0),a)};e.$parsers.push(a);e.$formatters.push(a)}if(d.max){var h=parseFloat(d.max),d=function(a){return!X(a)&&a>h?(e.$setValidity("max",!1),p):(e.$setValidity("max",!0),a)};e.$parsers.push(d);e.$formatters.push(d)}e.$formatters.push(function(a){return X(a)||Ya(a)?(e.$setValidity("number",!0),a):(e.$setValidity("number",!1),p)})},url:function(a,c,d,e,g,i){Va(a,c,d,e,g,i);a=function(a){return X(a)||ud.test(a)?(e.$setValidity("url",!0),a):(e.$setValidity("url",!1),p)};e.$formatters.push(a);e.$parsers.push(a)},email:function(a,c,d,e,g,i){Va(a,c,d,e,g,i);a=function(a){return X(a)||vd.test(a)?(e.$setValidity("email",!0),a):(e.$setValidity("email",!1),p)};e.$formatters.push(a);e.$parsers.push(a)},radio:function(a,c,d,e){C(d.name)&&c.attr("name",Fa());c.bind("click",function(){c[0].checked&&a.$apply(function(){e.$setViewValue(d.value)})});e.$render=function(){c[0].checked=d.value==e.$viewValue};d.$observe("value",e.$render)},checkbox:function(a,c,d,e){var g=d.ngTrueValue,i=d.ngFalseValue;E(g)||(g=!0);E(i)||(i=!1);c.bind("click",function(){a.$apply(function(){e.$setViewValue(c[0].checked)})});e.$render=function(){c[0].checked=e.$viewValue};e.$formatters.push(function(a){return a===g});e.$parsers.push(function(a){return a?g:i})},hidden:q,button:q,submit:q,reset:q},ic=["$browser","$sniffer",function(a,c){return{restrict:"E",require:"?ngModel",link:function(d,e,g,i){i&&(hc[I(g.type)]||hc.text)(d,e,g,i,c,a)}}}],Sa="ng-valid",Ra="ng-invalid",pa="ng-pristine",Ua="ng-dirty",xd=["$scope","$exceptionHandler","$attrs","$element","$parse",function(a,c,d,e,g){function i(a,c){c=c?"-"+bb(c,"-"):"";e.removeClass((a?Ra:Sa)+c).addClass((a?Sa:Ra)+c)}this.$modelValue=this.$viewValue=Number.NaN;this.$parsers=[];this.$formatters=[];this.$viewChangeListeners=[];this.$pristine=!0;this.$dirty=!1;this.$valid=!0;this.$invalid=!1;this.$name=d.name;var f=g(d.ngModel),h=f.assign;if(!h)throw Error(Kb+d.ngModel+" ("+va(e)+")");this.$render=q;var j=e.inheritedData("$formController")||Ta,m=0,k=this.$error={};e.addClass(pa);i(!0);this.$setValidity=function(a,c){if(k[a]!==!c){if(c){if(k[a]&&m--,!m)i(!0),this.$valid=!0,this.$invalid=!1}else i(!1),this.$invalid=!0,this.$valid=!1,m++;k[a]=!c;i(c,a);j.$setValidity(a,c,this)}};this.$setPristine=function(){this.$dirty=!1;this.$pristine=!0;e.removeClass(Ua).addClass(pa)};this.$setViewValue=function(d){this.$viewValue=d;if(this.$pristine)this.$dirty=!0,this.$pristine=!1,e.removeClass(pa).addClass(Ua),j.$setDirty();n(this.$parsers,function(a){d=a(d)});if(this.$modelValue!==d)this.$modelValue=d,h(a,d),n(this.$viewChangeListeners,function(a){try{a()}catch(d){c(d)}})};var l=this;a.$watch(function(){var c=f(a);if(l.$modelValue!==c){var d=l.$formatters,e=d.length;for(l.$modelValue=c;e--;)c=d[e](c);if(l.$viewValue!==c)l.$viewValue=c,l.$render()}})}],yd=function(){return{require:["ngModel","^?form"],controller:xd,link:function(a,c,d,e){var g=e[0],i=e[1]||Ta;i.$addControl(g);c.bind("$destroy",function(){i.$removeControl(g)})}}},zd=S({require:"ngModel",link:function(a,c,d,e){e.$viewChangeListeners.push(function(){a.$eval(d.ngChange)})}}),jc=function(){return{require:"?ngModel",link:function(a,c,d,e){if(e){d.required=!0;var g=function(a){if(d.required&&(X(a)||a===!1))e.$setValidity("required",!1);else return e.$setValidity("required",!0),a};e.$formatters.push(g);e.$parsers.unshift(g);d.$observe("required",function(){g(e.$viewValue)})}}}},Ad=function(){return{require:"ngModel",link:function(a,c,d,e){var g=(a=/\/(.*)\//.exec(d.ngList))&&RegExp(a[1])||d.ngList||",";e.$parsers.push(function(a){var c=[];a&&n(a.split(g),function(a){a&&c.push(U(a))});return c});e.$formatters.push(function(a){return F(a)?a.join(", "):p})}}},Bd=/^(true|false|\d+)$/,Cd=function(){return{priority:100,compile:function(a,c){return Bd.test(c.ngValue)?function(a,c,g){g.$set("value",a.$eval(g.ngValue))}:function(a,c,g){a.$watch(g.ngValue,function(a){g.$set("value",a,!1)})}}}},Dd=aa(function(a,c,d){c.addClass("ng-binding").data("$binding",d.ngBind);a.$watch(d.ngBind,function(a){c.text(a==p?"":a)})}),Ed=["$interpolate",function(a){return function(c,d,e){c=a(d.attr(e.$attr.ngBindTemplate));d.addClass("ng-binding").data("$binding",c);e.$observe("ngBindTemplate",function(a){d.text(a)})}}],Fd=[function(){return function(a,c,d){c.addClass("ng-binding").data("$binding",d.ngBindHtmlUnsafe);a.$watch(d.ngBindHtmlUnsafe,function(a){c.html(a||"")})}}],Gd=ob("",!0),Hd=ob("Odd",0),Id=ob("Even",1),Jd=aa({compile:function(a,c){c.$set("ngCloak",p);a.removeClass("ng-cloak")}}),Kd=[function(){return{scope:!0,controller:"@"}}],Ld=["$sniffer",function(a){return{priority:1E3,compile:function(){a.csp=!0}}}],kc={};n("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress".split(" "),function(a){var c=da("ng-"+a);kc[c]=["$parse",function(d){return function(e,g,i){var f=d(i[c]);g.bind(I(a),function(a){e.$apply(function(){f(e,{$event:a})})})}}]});var Md=aa(function(a,c,d){c.bind("submit",function(){a.$apply(d.ngSubmit)})}),Nd=["$animator",function(a){return{transclude:"element",priority:1E3,terminal:!0,restrict:"A",compile:function(c,d,e){return function(c,d,f){var h=a(c,f),j,m;c.$watch(f.ngIf,function(a){j&&(h.leave(j),j=p);m&&(m.$destroy(),m=p);ua(a)&&(m=c.$new(),e(m,function(a){j=a;h.enter(a,d.parent(),d)}))})}}}}],Od=["$http","$templateCache","$anchorScroll","$compile","$animator",function(a,c,d,e,g){return{restrict:"ECA",terminal:!0,compile:function(i,f){var h=f.ngInclude||f.src,j=f.onload||"",m=f.autoscroll;return function(f,i,n){var o=g(f,n),p=0,r,t=function(){r&&(r.$destroy(),r=null);o.leave(i.contents(),i)};f.$watch(h,function(g){var h=++p;g?(a.get(g,{cache:c}).success(function(a){h===p&&(r&&r.$destroy(),r=f.$new(),o.leave(i.contents(),i),a=v("<div/>").html(a).contents(),o.enter(a,i),e(a)(r),B(m)&&(!m||f.$eval(m))&&d(),r.$emit("$includeContentLoaded"),f.$eval(j))}).error(function(){h===p&&t()}),f.$emit("$includeContentRequested")):t()})}}}}],Pd=aa({compile:function(){return{pre:function(a,c,d){a.$eval(d.ngInit)}}}}),Qd=aa({terminal:!0,priority:1E3}),Rd=["$locale","$interpolate",function(a,c){var d=/{}/g;return{restrict:"EA",link:function(e,g,i){var f=i.count,h=g.attr(i.$attr.when),j=i.offset||0,m=e.$eval(h),k={},l=c.startSymbol(),p=c.endSymbol();n(m,function(a,e){k[e]=c(a.replace(d,l+f+"-"+j+p))});e.$watch(function(){var c=parseFloat(e.$eval(f));return isNaN(c)?"":(c in m||(c=a.pluralCat(c-j)),k[c](e,g,!0))},function(a){g.text(a)})}}}],Sd=["$parse","$animator",function(a,c){return{transclude:"element",priority:1E3,terminal:!0,compile:function(d,e,g){return function(d,e,h){var j=c(d,h),m=h.ngRepeat,k=m.match(/^\s*(.+)\s+in\s+(.*?)\s*(\s+track\s+by\s+(.+)\s*)?$/),l,p,o,z,r,t={$id:la};if(!k)throw Error("Expected ngRepeat in form of '_item_ in _collection_[ track by _id_]' but got '"+
m+"'.");h=k[1];o=k[2];(k=k[4])?(l=a(k),p=function(a,c,e){r&&(t[r]=a);t[z]=c;t.$index=e;return l(d,t)}):p=function(a,c){return la(c)};k=h.match(/^(?:([\$\w]+)|\(([\$\w]+)\s*,\s*([\$\w]+)\))$/);if(!k)throw Error("'item' in 'item in collection' should be identifier or (key, value) but got '"+h+"'.");z=k[3]||k[1];r=k[2];var x={};d.$watchCollection(o,function(a){var c,h,k=e,l,o={},t,q,v,s,B,y,C=[];if(Xa(a))B=a;else{B=[];for(v in a)a.hasOwnProperty(v)&&v.charAt(0)!="$"&&B.push(v);B.sort()}t=B.length;h=C.length=B.length;for(c=0;c<h;c++)if(v=a===B?c:B[c],s=a[v],l=p(v,s,c),x.hasOwnProperty(l))y=x[l],delete x[l],o[l]=y,C[c]=y;else if(o.hasOwnProperty(l))throw n(C,function(a){a&&a.element&&(x[a.id]=a)}),Error("Duplicates in a repeater are not allowed. Repeater: "+m+" key: "+l);else C[c]={id:l},o[l]=!1;for(v in x)if(x.hasOwnProperty(v))y=x[v],j.leave(y.element),y.element[0].$$NG_REMOVED=!0,y.scope.$destroy();c=0;for(h=B.length;c<h;c++){v=a===B?c:B[c];s=a[v];y=C[c];if(y.element){q=y.scope;l=k[0];do l=l.nextSibling;while(l&&l.$$NG_REMOVED);y.element[0]!=l&&j.move(y.element,null,k);k=y.element}else q=d.$new();q[z]=s;r&&(q[r]=v);q.$index=c;q.$first=c===0;q.$last=c===t-1;q.$middle=!(q.$first||q.$last);y.element||g(q,function(a){j.enter(a,null,k);k=a;y.scope=q;y.element=a;o[y.id]=y})}x=o})}}}}],Td=["$animator",function(a){return function(c,d,e){var g=a(c,e);c.$watch(e.ngShow,function(a){g[ua(a)?"show":"hide"](d)})}}],Ud=["$animator",function(a){return function(c,d,e){var g=a(c,e);c.$watch(e.ngHide,function(a){g[ua(a)?"hide":"show"](d)})}}],Vd=aa(function(a,c,d){a.$watch(d.ngStyle,function(a,d){d&&a!==d&&n(d,function(a,d){c.css(d,"")});a&&c.css(a)},!0)}),Wd=["$animator",function(a){return{restrict:"EA",require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(c,d,e,g){var i=a(c,e),f,h,j=[];c.$watch(e.ngSwitch||e.on,function(a){for(var d=0,l=j.length;d<l;d++)j[d].$destroy(),i.leave(h[d]);h=[];j=[];if(f=g.cases["!"+a]||g.cases["?"])c.$eval(e.change),n(f,function(a){var d=c.$new();j.push(d);a.transclude(d,function(c){var d=a.element;h.push(c);i.enter(c,d.parent(),d)})})})}}}],Xd=aa({transclude:"element",priority:500,require:"^ngSwitch",compile:function(a,c,d){return function(a,g,i,f){f.cases["!"+c.ngSwitchWhen]=f.cases["!"+c.ngSwitchWhen]||[];f.cases["!"+c.ngSwitchWhen].push({transclude:d,element:g})}}}),Yd=aa({transclude:"element",priority:500,require:"^ngSwitch",compile:function(a,c,d){return function(a,c,i,f){f.cases["?"]=f.cases["?"]||[];f.cases["?"].push({transclude:d,element:c})}}}),Zd=aa({controller:["$transclude","$element",function(a,c){a(function(a){c.append(a)})}]}),$d=["$http","$templateCache","$route","$anchorScroll","$compile","$controller","$animator",function(a,c,d,e,g,i,f){return{restrict:"ECA",terminal:!0,link:function(a,c,m){function k(){var f=d.current&&d.current.locals,k=f&&f.$template;if(k){o.leave(c.contents(),c);l&&(l.$destroy(),l=null);k=v("<div></div>").html(k).contents();o.enter(k,c);var k=g(k),m=d.current;l=m.scope=a.$new();if(m.controller)f.$scope=l,f=i(m.controller,f),m.controllerAs&&(l[m.controllerAs]=f),c.children().data("$ngControllerController",f);k(l);l.$emit("$viewContentLoaded");l.$eval(n);e()}else o.leave(c.contents(),c),l&&(l.$destroy(),l=null)}var l,n=m.onload||"",o=f(a,m);a.$on("$routeChangeSuccess",k);k()}}}],ae=["$templateCache",function(a){return{restrict:"E",terminal:!0,compile:function(c,d){d.type=="text/ng-template"&&a.put(d.id,c[0].text)}}}],be=S({terminal:!0}),ce=["$compile","$parse",function(a,c){var d=/^\s*(.*?)(?:\s+as\s+(.*?))?(?:\s+group\s+by\s+(.*))?\s+for\s+(?:([\$\w][\$\w\d]*)|(?:\(\s*([\$\w][\$\w\d]*)\s*,\s*([\$\w][\$\w\d]*)\s*\)))\s+in\s+(.*?)(?:\s+track\s+by\s+(.*?))?$/,e={$setViewValue:q};return{restrict:"E",require:["select","?ngModel"],controller:["$element","$scope","$attrs",function(a,c,d){var h=this,j={},m=e,k;h.databound=d.ngModel;h.init=function(a,c,d){m=a;k=d};h.addOption=function(c){j[c]=!0;m.$viewValue==c&&(a.val(c),k.parent()&&k.remove())};h.removeOption=function(a){this.hasOption(a)&&(delete j[a],m.$viewValue==a&&this.renderUnknownOption(a))};h.renderUnknownOption=function(c){c="? "+la(c)+" ?";k.val(c);a.prepend(k);a.val(c);k.prop("selected",!0)};h.hasOption=function(a){return j.hasOwnProperty(a)};c.$on("$destroy",function(){h.renderUnknownOption=q})}],link:function(e,i,f,h){function j(a,c,d,e){d.$render=function(){var a=d.$viewValue;e.hasOption(a)?(w.parent()&&w.remove(),c.val(a),a===""&&t.prop("selected",!0)):C(a)&&t?c.val(""):e.renderUnknownOption(a)};c.bind("change",function(){a.$apply(function(){w.parent()&&w.remove();d.$setViewValue(c.val())})})}function m(a,c,d){var e;d.$render=function(){var a=new za(d.$viewValue);n(c.find("option"),function(c){c.selected=B(a.get(c.value))})};a.$watch(function(){ia(e,d.$viewValue)||(e=V(d.$viewValue),d.$render())});c.bind("change",function(){a.$apply(function(){var a=[];n(c.find("option"),function(c){c.selected&&a.push(c.value)});d.$setViewValue(a)})})}function k(e,f,g){function i(){var a={"":[]},c=[""],d,h,q,w,s;q=g.$modelValue;w=u(e)||[];var z=l?qb(w):w,B,y,A;y={};s=!1;var C,D;if(o)if(t&&F(q)){s=new za([]);for(h=0;h<q.length;h++)y[k]=q[h],s.put(t(e,y),q[h])}else s=new za(q);for(A=0;B=z.length,A<B;A++){y[k]=w[l?y[l]=z[A]:A];d=m(e,y)||"";if(!(h=a[d]))h=a[d]=[],c.push(d);o?d=s.remove(t?t(e,y):n(e,y))!=p:(t?(d={},d[k]=q,d=t(e,d)===t(e,y)):d=q===n(e,y),s=s||d);C=j(e,y);C=C===p?"":C;h.push({id:t?t(e,y):l?z[A]:A,label:C,selected:d})}o||(r||q===null?a[""].unshift({id:"",label:"",selected:!s}):s||a[""].unshift({id:"?",label:"",selected:!0}));y=0;for(z=c.length;y<z;y++){d=c[y];h=a[d];if(v.length<=y)q={element:E.clone().attr("label",d),label:h.label},w=[q],v.push(w),f.append(q.element);else if(w=v[y],q=w[0],q.label!=d)q.element.attr("label",q.label=d);C=null;A=0;for(B=h.length;A<B;A++)if(d=h[A],s=w[A+1]){C=s.element;if(s.label!==d.label)C.text(s.label=d.label);if(s.id!==d.id)C.val(s.id=d.id);if(s.selected!==d.selected)C.prop("selected",s.selected=d.selected)}else d.id===""&&r?D=r:(D=x.clone()).val(d.id).attr("selected",d.selected).text(d.label),w.push({element:D,label:d.label,id:d.id,selected:d.selected}),C?C.after(D):q.element.append(D),C=D;for(A++;w.length>A;)w.pop().element.remove()}for(;v.length>y;)v.pop()[0].element.remove()}var h;if(!(h=q.match(d)))throw Error("Expected ngOptions in form of '_select_ (as _label_)? for (_key_,)?_value_ in _collection_ (track by _expr_)?' but got '"+q+"'.");var j=c(h[2]||h[1]),k=h[4]||h[6],l=h[5],m=c(h[3]||""),n=c(h[2]?h[1]:k),u=c(h[7]),t=h[8]?c(h[8]):null,v=[[{element:f,label:""}]];r&&(a(r)(e),r.removeClass("ng-scope"),r.remove());f.html("");f.bind("change",function(){e.$apply(function(){var a,c=u(e)||[],d={},h,i,j,m,q,r;if(o){i=[];m=0;for(r=v.length;m<r;m++){a=v[m];j=1;for(q=a.length;j<q;j++)if((h=a[j].element)[0].selected){h=h.val();l&&(d[l]=h);if(t)for(var s=0;s<c.length;s++){if(d[k]=c[s],t(e,d)==h)break}else d[k]=c[h];i.push(n(e,d))}}}else{h=f.val();if(h=="?")i=p;else if(h=="")i=null;else if(t)for(s=0;s<c.length;s++){if(d[k]=c[s],t(e,d)==h){i=n(e,d);break}}else d[k]=c[h],l&&(d[l]=h),i=n(e,d);if(v[0].length>1&&v[0][1].id!==h)v[0][1].selected=!1}g.$setViewValue(i)})});g.$render=i;e.$watch(i)}if(h[1]){for(var l=h[0],u=h[1],o=f.multiple,q=f.ngOptions,r=!1,t,x=v(T.createElement("option")),E=v(T.createElement("optgroup")),w=x.clone(),h=0,A=i.children(),G=A.length;h<G;h++)if(A[h].value==""){t=r=A.eq(h);break}l.init(u,r,w);if(o&&(f.required||f.ngRequired)){var D=function(a){u.$setValidity("required",!f.required||a&&a.length);return a};u.$parsers.push(D);u.$formatters.unshift(D);f.$observe("required",function(){D(u.$viewValue)})}q?k(e,i,u):o?m(e,i,u):j(e,i,u,l)}}}}],de=["$interpolate",function(a){var c={addOption:q,removeOption:q};return{restrict:"E",priority:100,compile:function(d,e){if(C(e.value)){var g=a(d.text(),!0);g||e.$set("value",d.text())}return function(a,d,e){var j=d.parent(),m=j.data("$selectController")||j.parent().data("$selectController");m&&m.databound?d.prop("selected",!1):m=c;g?a.$watch(g,function(a,c){e.$set("value",a);a!==c&&m.removeOption(c);m.addOption(a)}):m.addOption(e.value);d.bind("$destroy",function(){m.removeOption(e.value)})}}}}],ee=S({restrict:"E",terminal:!0});(ga=M.jQuery)?(v=ga,t(ga.fn,{scope:Ba.scope,controller:Ba.controller,injector:Ba.injector,inheritedData:Ba.inheritedData}),db("remove",!0),db("empty"),db("html")):v=R;Ha.element=v;(function(a){t(a,{bootstrap:xb,copy:V,extend:t,equals:ia,element:v,forEach:n,injector:yb,noop:q,bind:$a,toJson:ha,fromJson:ub,identity:qa,isUndefined:C,isDefined:B,isString:E,isFunction:H,isObject:L,isNumber:Ya,isElement:oc,isArray:F,version:pd,isDate:ra,lowercase:I,uppercase:oa,callbacks:{counter:0},noConflict:lc});Aa=tc(M);try{Aa("ngLocale")}catch(c){Aa("ngLocale",[]).provider("$locale",fd)}Aa("ng",["ngLocale"],["$provide",function(a){a.provider("$compile",Jb).directive({a:rd,input:ic,textarea:ic,form:sd,script:ae,select:ce,style:ee,option:de,ngBind:Dd,ngBindHtmlUnsafe:Fd,ngBindTemplate:Ed,ngClass:Gd,ngClassEven:Id,ngClassOdd:Hd,ngCsp:Ld,ngCloak:Jd,ngController:Kd,ngForm:td,ngHide:Ud,ngIf:Nd,ngInclude:Od,ngInit:Pd,ngNonBindable:Qd,ngPluralize:Rd,ngRepeat:Sd,ngShow:Td,ngSubmit:Md,ngStyle:Vd,ngSwitch:Wd,ngSwitchWhen:Xd,ngSwitchDefault:Yd,ngOptions:be,ngView:$d,ngTransclude:Zd,ngModel:yd,ngList:Ad,ngChange:zd,required:jc,ngRequired:jc,ngValue:Cd}).directive(pb).directive(kc);a.provider({$anchorScroll:Cc,$animation:Ib,$animator:qd,$browser:Ec,$cacheFactory:Fc,$controller:Jc,$document:Kc,$exceptionHandler:Lc,$filter:Zb,$interpolate:Mc,$http:bd,$httpBackend:cd,$location:Nc,$log:Oc,$parse:Sc,$route:Vc,$routeParams:Wc,$rootScope:Xc,$q:Tc,$sniffer:Yc,$templateCache:Gc,$timeout:gd,$window:Zc})}])})(Ha);v(T).ready(function(){rc(T,xb)})})(window,document);angular.element(document).find("head").append('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak{display:none;}ng\\:form{display:block;}</style>');
;;;
(function(){var n=this,t=n._,r=Array.prototype,e=Object.prototype,u=Function.prototype,i=r.push,a=r.slice,o=r.concat,l=e.toString,c=e.hasOwnProperty,f=Array.isArray,s=Object.keys,p=u.bind,h=function(n){return n instanceof h?n:this instanceof h?void(this._wrapped=n):new h(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=h),exports._=h):n._=h,h.VERSION="1.7.0";var g=function(n,t,r){if(t===void 0)return n;switch(null==r?3:r){case 1:return function(r){return n.call(t,r)};case 2:return function(r,e){return n.call(t,r,e)};case 3:return function(r,e,u){return n.call(t,r,e,u)};case 4:return function(r,e,u,i){return n.call(t,r,e,u,i)}}return function(){return n.apply(t,arguments)}};h.iteratee=function(n,t,r){return null==n?h.identity:h.isFunction(n)?g(n,t,r):h.isObject(n)?h.matches(n):h.property(n)},h.each=h.forEach=function(n,t,r){if(null==n)return n;t=g(t,r);var e,u=n.length;if(u===+u)for(e=0;u>e;e++)t(n[e],e,n);else{var i=h.keys(n);for(e=0,u=i.length;u>e;e++)t(n[i[e]],i[e],n)}return n},h.map=h.collect=function(n,t,r){if(null==n)return[];t=h.iteratee(t,r);for(var e,u=n.length!==+n.length&&h.keys(n),i=(u||n).length,a=Array(i),o=0;i>o;o++)e=u?u[o]:o,a[o]=t(n[e],e,n);return a};var v="Reduce of empty array with no initial value";h.reduce=h.foldl=h.inject=function(n,t,r,e){null==n&&(n=[]),t=g(t,e,4);var u,i=n.length!==+n.length&&h.keys(n),a=(i||n).length,o=0;if(arguments.length<3){if(!a)throw new TypeError(v);r=n[i?i[o++]:o++]}for(;a>o;o++)u=i?i[o]:o,r=t(r,n[u],u,n);return r},h.reduceRight=h.foldr=function(n,t,r,e){null==n&&(n=[]),t=g(t,e,4);var u,i=n.length!==+n.length&&h.keys(n),a=(i||n).length;if(arguments.length<3){if(!a)throw new TypeError(v);r=n[i?i[--a]:--a]}for(;a--;)u=i?i[a]:a,r=t(r,n[u],u,n);return r},h.find=h.detect=function(n,t,r){var e;return t=h.iteratee(t,r),h.some(n,function(n,r,u){return t(n,r,u)?(e=n,!0):void 0}),e},h.filter=h.select=function(n,t,r){var e=[];return null==n?e:(t=h.iteratee(t,r),h.each(n,function(n,r,u){t(n,r,u)&&e.push(n)}),e)},h.reject=function(n,t,r){return h.filter(n,h.negate(h.iteratee(t)),r)},h.every=h.all=function(n,t,r){if(null==n)return!0;t=h.iteratee(t,r);var e,u,i=n.length!==+n.length&&h.keys(n),a=(i||n).length;for(e=0;a>e;e++)if(u=i?i[e]:e,!t(n[u],u,n))return!1;return!0},h.some=h.any=function(n,t,r){if(null==n)return!1;t=h.iteratee(t,r);var e,u,i=n.length!==+n.length&&h.keys(n),a=(i||n).length;for(e=0;a>e;e++)if(u=i?i[e]:e,t(n[u],u,n))return!0;return!1},h.contains=h.include=function(n,t){return null==n?!1:(n.length!==+n.length&&(n=h.values(n)),h.indexOf(n,t)>=0)},h.invoke=function(n,t){var r=a.call(arguments,2),e=h.isFunction(t);return h.map(n,function(n){return(e?t:n[t]).apply(n,r)})},h.pluck=function(n,t){return h.map(n,h.property(t))},h.where=function(n,t){return h.filter(n,h.matches(t))},h.findWhere=function(n,t){return h.find(n,h.matches(t))},h.max=function(n,t,r){var e,u,i=-1/0,a=-1/0;if(null==t&&null!=n){n=n.length===+n.length?n:h.values(n);for(var o=0,l=n.length;l>o;o++)e=n[o],e>i&&(i=e)}else t=h.iteratee(t,r),h.each(n,function(n,r,e){u=t(n,r,e),(u>a||u===-1/0&&i===-1/0)&&(i=n,a=u)});return i},h.min=function(n,t,r){var e,u,i=1/0,a=1/0;if(null==t&&null!=n){n=n.length===+n.length?n:h.values(n);for(var o=0,l=n.length;l>o;o++)e=n[o],i>e&&(i=e)}else t=h.iteratee(t,r),h.each(n,function(n,r,e){u=t(n,r,e),(a>u||1/0===u&&1/0===i)&&(i=n,a=u)});return i},h.shuffle=function(n){for(var t,r=n&&n.length===+n.length?n:h.values(n),e=r.length,u=Array(e),i=0;e>i;i++)t=h.random(0,i),t!==i&&(u[i]=u[t]),u[t]=r[i];return u},h.sample=function(n,t,r){return null==t||r?(n.length!==+n.length&&(n=h.values(n)),n[h.random(n.length-1)]):h.shuffle(n).slice(0,Math.max(0,t))},h.sortBy=function(n,t,r){return t=h.iteratee(t,r),h.pluck(h.map(n,function(n,r,e){return{value:n,index:r,criteria:t(n,r,e)}}).sort(function(n,t){var r=n.criteria,e=t.criteria;if(r!==e){if(r>e||r===void 0)return 1;if(e>r||e===void 0)return-1}return n.index-t.index}),"value")};var m=function(n){return function(t,r,e){var u={};return r=h.iteratee(r,e),h.each(t,function(e,i){var a=r(e,i,t);n(u,e,a)}),u}};h.groupBy=m(function(n,t,r){h.has(n,r)?n[r].push(t):n[r]=[t]}),h.indexBy=m(function(n,t,r){n[r]=t}),h.countBy=m(function(n,t,r){h.has(n,r)?n[r]++:n[r]=1}),h.sortedIndex=function(n,t,r,e){r=h.iteratee(r,e,1);for(var u=r(t),i=0,a=n.length;a>i;){var o=i+a>>>1;r(n[o])<u?i=o+1:a=o}return i},h.toArray=function(n){return n?h.isArray(n)?a.call(n):n.length===+n.length?h.map(n,h.identity):h.values(n):[]},h.size=function(n){return null==n?0:n.length===+n.length?n.length:h.keys(n).length},h.partition=function(n,t,r){t=h.iteratee(t,r);var e=[],u=[];return h.each(n,function(n,r,i){(t(n,r,i)?e:u).push(n)}),[e,u]},h.first=h.head=h.take=function(n,t,r){return null==n?void 0:null==t||r?n[0]:0>t?[]:a.call(n,0,t)},h.initial=function(n,t,r){return a.call(n,0,Math.max(0,n.length-(null==t||r?1:t)))},h.last=function(n,t,r){return null==n?void 0:null==t||r?n[n.length-1]:a.call(n,Math.max(n.length-t,0))},h.rest=h.tail=h.drop=function(n,t,r){return a.call(n,null==t||r?1:t)},h.compact=function(n){return h.filter(n,h.identity)};var y=function(n,t,r,e){if(t&&h.every(n,h.isArray))return o.apply(e,n);for(var u=0,a=n.length;a>u;u++){var l=n[u];h.isArray(l)||h.isArguments(l)?t?i.apply(e,l):y(l,t,r,e):r||e.push(l)}return e};h.flatten=function(n,t){return y(n,t,!1,[])},h.without=function(n){return h.difference(n,a.call(arguments,1))},h.uniq=h.unique=function(n,t,r,e){if(null==n)return[];h.isBoolean(t)||(e=r,r=t,t=!1),null!=r&&(r=h.iteratee(r,e));for(var u=[],i=[],a=0,o=n.length;o>a;a++){var l=n[a];if(t)a&&i===l||u.push(l),i=l;else if(r){var c=r(l,a,n);h.indexOf(i,c)<0&&(i.push(c),u.push(l))}else h.indexOf(u,l)<0&&u.push(l)}return u},h.union=function(){return h.uniq(y(arguments,!0,!0,[]))},h.intersection=function(n){if(null==n)return[];for(var t=[],r=arguments.length,e=0,u=n.length;u>e;e++){var i=n[e];if(!h.contains(t,i)){for(var a=1;r>a&&h.contains(arguments[a],i);a++);a===r&&t.push(i)}}return t},h.difference=function(n){var t=y(a.call(arguments,1),!0,!0,[]);return h.filter(n,function(n){return!h.contains(t,n)})},h.zip=function(n){if(null==n)return[];for(var t=h.max(arguments,"length").length,r=Array(t),e=0;t>e;e++)r[e]=h.pluck(arguments,e);return r},h.object=function(n,t){if(null==n)return{};for(var r={},e=0,u=n.length;u>e;e++)t?r[n[e]]=t[e]:r[n[e][0]]=n[e][1];return r},h.indexOf=function(n,t,r){if(null==n)return-1;var e=0,u=n.length;if(r){if("number"!=typeof r)return e=h.sortedIndex(n,t),n[e]===t?e:-1;e=0>r?Math.max(0,u+r):r}for(;u>e;e++)if(n[e]===t)return e;return-1},h.lastIndexOf=function(n,t,r){if(null==n)return-1;var e=n.length;for("number"==typeof r&&(e=0>r?e+r+1:Math.min(e,r+1));--e>=0;)if(n[e]===t)return e;return-1},h.range=function(n,t,r){arguments.length<=1&&(t=n||0,n=0),r=r||1;for(var e=Math.max(Math.ceil((t-n)/r),0),u=Array(e),i=0;e>i;i++,n+=r)u[i]=n;return u};var d=function(){};h.bind=function(n,t){var r,e;if(p&&n.bind===p)return p.apply(n,a.call(arguments,1));if(!h.isFunction(n))throw new TypeError("Bind must be called on a function");return r=a.call(arguments,2),e=function(){if(!(this instanceof e))return n.apply(t,r.concat(a.call(arguments)));d.prototype=n.prototype;var u=new d;d.prototype=null;var i=n.apply(u,r.concat(a.call(arguments)));return h.isObject(i)?i:u}},h.partial=function(n){var t=a.call(arguments,1);return function(){for(var r=0,e=t.slice(),u=0,i=e.length;i>u;u++)e[u]===h&&(e[u]=arguments[r++]);for(;r<arguments.length;)e.push(arguments[r++]);return n.apply(this,e)}},h.bindAll=function(n){var t,r,e=arguments.length;if(1>=e)throw new Error("bindAll must be passed function names");for(t=1;e>t;t++)r=arguments[t],n[r]=h.bind(n[r],n);return n},h.memoize=function(n,t){var r=function(e){var u=r.cache,i=t?t.apply(this,arguments):e;return h.has(u,i)||(u[i]=n.apply(this,arguments)),u[i]};return r.cache={},r},h.delay=function(n,t){var r=a.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},t)},h.defer=function(n){return h.delay.apply(h,[n,1].concat(a.call(arguments,1)))},h.throttle=function(n,t,r){var e,u,i,a=null,o=0;r||(r={});var l=function(){o=r.leading===!1?0:h.now(),a=null,i=n.apply(e,u),a||(e=u=null)};return function(){var c=h.now();o||r.leading!==!1||(o=c);var f=t-(c-o);return e=this,u=arguments,0>=f||f>t?(clearTimeout(a),a=null,o=c,i=n.apply(e,u),a||(e=u=null)):a||r.trailing===!1||(a=setTimeout(l,f)),i}},h.debounce=function(n,t,r){var e,u,i,a,o,l=function(){var c=h.now()-a;t>c&&c>0?e=setTimeout(l,t-c):(e=null,r||(o=n.apply(i,u),e||(i=u=null)))};return function(){i=this,u=arguments,a=h.now();var c=r&&!e;return e||(e=setTimeout(l,t)),c&&(o=n.apply(i,u),i=u=null),o}},h.wrap=function(n,t){return h.partial(t,n)},h.negate=function(n){return function(){return!n.apply(this,arguments)}},h.compose=function(){var n=arguments,t=n.length-1;return function(){for(var r=t,e=n[t].apply(this,arguments);r--;)e=n[r].call(this,e);return e}},h.after=function(n,t){return function(){return--n<1?t.apply(this,arguments):void 0}},h.before=function(n,t){var r;return function(){return--n>0?r=t.apply(this,arguments):t=null,r}},h.once=h.partial(h.before,2),h.keys=function(n){if(!h.isObject(n))return[];if(s)return s(n);var t=[];for(var r in n)h.has(n,r)&&t.push(r);return t},h.values=function(n){for(var t=h.keys(n),r=t.length,e=Array(r),u=0;r>u;u++)e[u]=n[t[u]];return e},h.pairs=function(n){for(var t=h.keys(n),r=t.length,e=Array(r),u=0;r>u;u++)e[u]=[t[u],n[t[u]]];return e},h.invert=function(n){for(var t={},r=h.keys(n),e=0,u=r.length;u>e;e++)t[n[r[e]]]=r[e];return t},h.functions=h.methods=function(n){var t=[];for(var r in n)h.isFunction(n[r])&&t.push(r);return t.sort()},h.extend=function(n){if(!h.isObject(n))return n;for(var t,r,e=1,u=arguments.length;u>e;e++){t=arguments[e];for(r in t)c.call(t,r)&&(n[r]=t[r])}return n},h.pick=function(n,t,r){var e,u={};if(null==n)return u;if(h.isFunction(t)){t=g(t,r);for(e in n){var i=n[e];t(i,e,n)&&(u[e]=i)}}else{var l=o.apply([],a.call(arguments,1));n=new Object(n);for(var c=0,f=l.length;f>c;c++)e=l[c],e in n&&(u[e]=n[e])}return u},h.omit=function(n,t,r){if(h.isFunction(t))t=h.negate(t);else{var e=h.map(o.apply([],a.call(arguments,1)),String);t=function(n,t){return!h.contains(e,t)}}return h.pick(n,t,r)},h.defaults=function(n){if(!h.isObject(n))return n;for(var t=1,r=arguments.length;r>t;t++){var e=arguments[t];for(var u in e)n[u]===void 0&&(n[u]=e[u])}return n},h.clone=function(n){return h.isObject(n)?h.isArray(n)?n.slice():h.extend({},n):n},h.tap=function(n,t){return t(n),n};var b=function(n,t,r,e){if(n===t)return 0!==n||1/n===1/t;if(null==n||null==t)return n===t;n instanceof h&&(n=n._wrapped),t instanceof h&&(t=t._wrapped);var u=l.call(n);if(u!==l.call(t))return!1;switch(u){case"[object RegExp]":case"[object String]":return""+n==""+t;case"[object Number]":return+n!==+n?+t!==+t:0===+n?1/+n===1/t:+n===+t;case"[object Date]":case"[object Boolean]":return+n===+t}if("object"!=typeof n||"object"!=typeof t)return!1;for(var i=r.length;i--;)if(r[i]===n)return e[i]===t;var a=n.constructor,o=t.constructor;if(a!==o&&"constructor"in n&&"constructor"in t&&!(h.isFunction(a)&&a instanceof a&&h.isFunction(o)&&o instanceof o))return!1;r.push(n),e.push(t);var c,f;if("[object Array]"===u){if(c=n.length,f=c===t.length)for(;c--&&(f=b(n[c],t[c],r,e)););}else{var s,p=h.keys(n);if(c=p.length,f=h.keys(t).length===c)for(;c--&&(s=p[c],f=h.has(t,s)&&b(n[s],t[s],r,e)););}return r.pop(),e.pop(),f};h.isEqual=function(n,t){return b(n,t,[],[])},h.isEmpty=function(n){if(null==n)return!0;if(h.isArray(n)||h.isString(n)||h.isArguments(n))return 0===n.length;for(var t in n)if(h.has(n,t))return!1;return!0},h.isElement=function(n){return!(!n||1!==n.nodeType)},h.isArray=f||function(n){return"[object Array]"===l.call(n)},h.isObject=function(n){var t=typeof n;return"function"===t||"object"===t&&!!n},h.each(["Arguments","Function","String","Number","Date","RegExp"],function(n){h["is"+n]=function(t){return l.call(t)==="[object "+n+"]"}}),h.isArguments(arguments)||(h.isArguments=function(n){return h.has(n,"callee")}),"function"!=typeof/./&&(h.isFunction=function(n){return"function"==typeof n||!1}),h.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},h.isNaN=function(n){return h.isNumber(n)&&n!==+n},h.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"===l.call(n)},h.isNull=function(n){return null===n},h.isUndefined=function(n){return n===void 0},h.has=function(n,t){return null!=n&&c.call(n,t)},h.noConflict=function(){return n._=t,this},h.identity=function(n){return n},h.constant=function(n){return function(){return n}},h.noop=function(){},h.property=function(n){return function(t){return t[n]}},h.matches=function(n){var t=h.pairs(n),r=t.length;return function(n){if(null==n)return!r;n=new Object(n);for(var e=0;r>e;e++){var u=t[e],i=u[0];if(u[1]!==n[i]||!(i in n))return!1}return!0}},h.times=function(n,t,r){var e=Array(Math.max(0,n));t=g(t,r,1);for(var u=0;n>u;u++)e[u]=t(u);return e},h.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))},h.now=Date.now||function(){return(new Date).getTime()};var _={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},w=h.invert(_),j=function(n){var t=function(t){return n[t]},r="(?:"+h.keys(n).join("|")+")",e=RegExp(r),u=RegExp(r,"g");return function(n){return n=null==n?"":""+n,e.test(n)?n.replace(u,t):n}};h.escape=j(_),h.unescape=j(w),h.result=function(n,t){if(null==n)return void 0;var r=n[t];return h.isFunction(r)?n[t]():r};var x=0;h.uniqueId=function(n){var t=++x+"";return n?n+t:t},h.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var A=/(.)^/,k={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},O=/\\|'|\r|\n|\u2028|\u2029/g,F=function(n){return"\\"+k[n]};h.template=function(n,t,r){!t&&r&&(t=r),t=h.defaults({},t,h.templateSettings);var e=RegExp([(t.escape||A).source,(t.interpolate||A).source,(t.evaluate||A).source].join("|")+"|$","g"),u=0,i="__p+='";n.replace(e,function(t,r,e,a,o){return i+=n.slice(u,o).replace(O,F),u=o+t.length,r?i+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'":e?i+="'+\n((__t=("+e+"))==null?'':__t)+\n'":a&&(i+="';\n"+a+"\n__p+='"),t}),i+="';\n",t.variable||(i="with(obj||{}){\n"+i+"}\n"),i="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+i+"return __p;\n";try{var a=new Function(t.variable||"obj","_",i)}catch(o){throw o.source=i,o}var l=function(n){return a.call(this,n,h)},c=t.variable||"obj";return l.source="function("+c+"){\n"+i+"}",l},h.chain=function(n){var t=h(n);return t._chain=!0,t};var E=function(n){return this._chain?h(n).chain():n};h.mixin=function(n){h.each(h.functions(n),function(t){var r=h[t]=n[t];h.prototype[t]=function(){var n=[this._wrapped];return i.apply(n,arguments),E.call(this,r.apply(h,n))}})},h.mixin(h),h.each(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var t=r[n];h.prototype[n]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!==n&&"splice"!==n||0!==r.length||delete r[0],E.call(this,r)}}),h.each(["concat","join","slice"],function(n){var t=r[n];h.prototype[n]=function(){return E.call(this,t.apply(this._wrapped,arguments))}}),h.prototype.value=function(){return this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return h})}).call(this);
;;;
(function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)})(function(e){function t(t,s){var n,a,o,r=t.nodeName.toLowerCase();return"area"===r?(n=t.parentNode,a=n.name,t.href&&a&&"map"===n.nodeName.toLowerCase()?(o=e("img[usemap='#"+a+"']")[0],!!o&&i(o)):!1):(/^(input|select|textarea|button|object)$/.test(r)?!t.disabled:"a"===r?t.href||s:s)&&i(t)}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}function s(e){for(var t,i;e.length&&e[0]!==document;){if(t=e.css("position"),("absolute"===t||"relative"===t||"fixed"===t)&&(i=parseInt(e.css("zIndex"),10),!isNaN(i)&&0!==i))return i;e=e.parent()}return 0}function n(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[""]),this.regional.en=e.extend(!0,{},this.regional[""]),this.regional["en-US"]=e.extend(!0,{},this.regional.en),this.dpDiv=a(e("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function a(t){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.delegate(i,"mouseout",function(){e(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).removeClass("ui-datepicker-next-hover")}).delegate(i,"mouseover",o)}function o(){e.datepicker._isDisabledDatepicker(v.inline?v.dpDiv.parent()[0]:v.input[0])||(e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),e(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).addClass("ui-datepicker-next-hover"))}function r(t,i){e.extend(t,i);for(var s in i)null==i[s]&&(t[s]=i[s]);return t}function h(e){return function(){var t=this.element.val();e.apply(this,arguments),this._refresh(),t!==this.element.val()&&this._trigger("change")}}e.ui=e.ui||{},e.extend(e.ui,{version:"1.11.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({scrollParent:function(t){var i=this.css("position"),s="absolute"===i,n=t?/(auto|scroll|hidden)/:/(auto|scroll)/,a=this.parents().filter(function(){var t=e(this);return s&&"static"===t.css("position")?!1:n.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==i&&a.length?a:e(this[0].ownerDocument||document)},uniqueId:function(){var e=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,s){return!!e.data(t,s[3])},focusable:function(i){return t(i,!isNaN(e.attr(i,"tabindex")))},tabbable:function(i){var s=e.attr(i,"tabindex"),n=isNaN(s);return(n||s>=0)&&t(i,!n)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(t,i){function s(t,i,s,a){return e.each(n,function(){i-=parseFloat(e.css(t,"padding"+this))||0,s&&(i-=parseFloat(e.css(t,"border"+this+"Width"))||0),a&&(i-=parseFloat(e.css(t,"margin"+this))||0)}),i}var n="Width"===i?["Left","Right"]:["Top","Bottom"],a=i.toLowerCase(),o={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+i]=function(t){return void 0===t?o["inner"+i].call(this):this.each(function(){e(this).css(a,s(this,t)+"px")})},e.fn["outer"+i]=function(t,n){return"number"!=typeof t?o["outer"+i].call(this,t):this.each(function(){e(this).css(a,s(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(i){return arguments.length?t.call(this,e.camelCase(i)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.fn.extend({focus:function(t){return function(i,s){return"number"==typeof i?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),s&&s.call(t)},i)}):t.apply(this,arguments)}}(e.fn.focus),disableSelection:function(){var e="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(e+".ui-disableSelection",function(e){e.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(t){if(void 0!==t)return this.css("zIndex",t);if(this.length)for(var i,s,n=e(this[0]);n.length&&n[0]!==document;){if(i=n.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(s=parseInt(n.css("zIndex"),10),!isNaN(s)&&0!==s))return s;n=n.parent()}return 0}}),e.ui.plugin={add:function(t,i,s){var n,a=e.ui[t].prototype;for(n in s)a.plugins[n]=a.plugins[n]||[],a.plugins[n].push([i,s[n]])},call:function(e,t,i,s){var n,a=e.plugins[t];if(a&&(s||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(n=0;a.length>n;n++)e.options[a[n][0]]&&a[n][1].apply(e.element,i)}};var l=0,u=Array.prototype.slice;e.cleanData=function(t){return function(i){var s,n,a;for(a=0;null!=(n=i[a]);a++)try{s=e._data(n,"events"),s&&s.remove&&e(n).triggerHandler("remove")}catch(o){}t(i)}}(e.cleanData),e.widget=function(t,i,s){var n,a,o,r,h={},l=t.split(".")[0];return t=t.split(".")[1],n=l+"-"+t,s||(s=i,i=e.Widget),e.expr[":"][n.toLowerCase()]=function(t){return!!e.data(t,n)},e[l]=e[l]||{},a=e[l][t],o=e[l][t]=function(e,t){return this._createWidget?(arguments.length&&this._createWidget(e,t),void 0):new o(e,t)},e.extend(o,a,{version:s.version,_proto:e.extend({},s),_childConstructors:[]}),r=new i,r.options=e.widget.extend({},r.options),e.each(s,function(t,s){return e.isFunction(s)?(h[t]=function(){var e=function(){return i.prototype[t].apply(this,arguments)},n=function(e){return i.prototype[t].apply(this,e)};return function(){var t,i=this._super,a=this._superApply;return this._super=e,this._superApply=n,t=s.apply(this,arguments),this._super=i,this._superApply=a,t}}(),void 0):(h[t]=s,void 0)}),o.prototype=e.widget.extend(r,{widgetEventPrefix:a?r.widgetEventPrefix||t:t},h,{constructor:o,namespace:l,widgetName:t,widgetFullName:n}),a?(e.each(a._childConstructors,function(t,i){var s=i.prototype;e.widget(s.namespace+"."+s.widgetName,o,i._proto)}),delete a._childConstructors):i._childConstructors.push(o),e.widget.bridge(t,o),o},e.widget.extend=function(t){for(var i,s,n=u.call(arguments,1),a=0,o=n.length;o>a;a++)for(i in n[a])s=n[a][i],n[a].hasOwnProperty(i)&&void 0!==s&&(t[i]=e.isPlainObject(s)?e.isPlainObject(t[i])?e.widget.extend({},t[i],s):e.widget.extend({},s):s);return t},e.widget.bridge=function(t,i){var s=i.prototype.widgetFullName||t;e.fn[t]=function(n){var a="string"==typeof n,o=u.call(arguments,1),r=this;return a?this.each(function(){var i,a=e.data(this,s);return"instance"===n?(r=a,!1):a?e.isFunction(a[n])&&"_"!==n.charAt(0)?(i=a[n].apply(a,o),i!==a&&void 0!==i?(r=i&&i.jquery?r.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+n+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; "+"attempted to call method '"+n+"'")}):(o.length&&(n=e.widget.extend.apply(null,[n].concat(o))),this.each(function(){var t=e.data(this,s);t?(t.option(n||{}),t._init&&t._init()):e.data(this,s,new i(n,this))})),r}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=l++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=e(),this.hoverable=e(),this.focusable=e(),i!==this&&(e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(t,i){var s,n,a,o=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(o={},s=t.split("."),t=s.shift(),s.length){for(n=o[t]=e.widget.extend({},this.options[t]),a=0;s.length-1>a;a++)n[s[a]]=n[s[a]]||{},n=n[s[a]];if(t=s.pop(),1===arguments.length)return void 0===n[t]?null:n[t];n[t]=i}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];o[t]=i}return this._setOptions(o),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,i,s){var n,a=this;"boolean"!=typeof t&&(s=i,i=t,t=!1),s?(i=n=e(i),this.bindings=this.bindings.add(i)):(s=i,i=this.element,n=this.widget()),e.each(s,function(s,o){function r(){return t||a.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof o?a[o]:o).apply(a,arguments):void 0}"string"!=typeof o&&(r.guid=o.guid=o.guid||r.guid||e.guid++);var h=s.match(/^([\w:-]*)\s*(.*)$/),l=h[1]+a.eventNamespace,u=h[2];u?n.delegate(u,l,r):i.bind(l,r)})},_off:function(t,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(i).undelegate(i),this.bindings=e(this.bindings.not(t).get()),this.focusable=e(this.focusable.not(t).get()),this.hoverable=e(this.hoverable.not(t).get())},_delay:function(e,t){function i(){return("string"==typeof e?s[e]:e).apply(s,arguments)}var s=this;return setTimeout(i,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,s){var n,a,o=this.options[t];if(s=s||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],a=i.originalEvent)for(n in a)n in i||(i[n]=a[n]);return this.element.trigger(i,s),!(e.isFunction(o)&&o.apply(this.element[0],[i].concat(s))===!1||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(s,n,a){"string"==typeof n&&(n={effect:n});var o,r=n?n===!0||"number"==typeof n?i:n.effect||i:t;n=n||{},"number"==typeof n&&(n={duration:n}),o=!e.isEmptyObject(n),n.complete=a,n.delay&&s.delay(n.delay),o&&e.effects&&e.effects.effect[r]?s[t](n):r!==t&&s[r]?s[r](n.duration,n.easing,a):s.queue(function(i){e(this)[t](),a&&a.call(s[0]),i()})}}),e.widget;var d=!1;e(document).mouseup(function(){d=!1}),e.widget("ui.mouse",{version:"1.11.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(i){return!0===e.data(i.target,t.widgetName+".preventClickEvent")?(e.removeData(i.target,t.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!d){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var i=this,s=1===t.which,n="string"==typeof this.options.cancel&&t.target.nodeName?e(t.target).closest(this.options.cancel).length:!1;return s&&!n&&this._mouseCapture(t)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(t)!==!1,!this._mouseStarted)?(t.preventDefault(),!0):(!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return i._mouseMove(e)},this._mouseUpDelegate=function(e){return i._mouseUp(e)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),d=!0,!0)):!0}},_mouseMove:function(t){if(this._mouseMoved){if(e.ui.ie&&(!document.documentMode||9>document.documentMode)&&!t.button)return this._mouseUp(t);if(!t.which)return this._mouseUp(t)}return(t.which||t.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),d=!1,!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),function(){function t(e,t,i){return[parseFloat(e[0])*(p.test(e[0])?t/100:1),parseFloat(e[1])*(p.test(e[1])?i/100:1)]}function i(t,i){return parseInt(e.css(t,i),10)||0}function s(t){var i=t[0];return 9===i.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(i)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var n,a,o=Math.max,r=Math.abs,h=Math.round,l=/left|center|right/,u=/top|center|bottom/,d=/[\+\-]\d+(\.[\d]+)?%?/,c=/^\w+/,p=/%$/,f=e.fn.position;e.position={scrollbarWidth:function(){if(void 0!==n)return n;var t,i,s=e("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),a=s.children()[0];return e("body").append(s),t=a.offsetWidth,s.css("overflow","scroll"),i=a.offsetWidth,t===i&&(i=s[0].clientWidth),s.remove(),n=t-i},getScrollInfo:function(t){var i=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),s=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),n="scroll"===i||"auto"===i&&t.width<t.element[0].scrollWidth,a="scroll"===s||"auto"===s&&t.height<t.element[0].scrollHeight;return{width:a?e.position.scrollbarWidth():0,height:n?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var i=e(t||window),s=e.isWindow(i[0]),n=!!i[0]&&9===i[0].nodeType;return{element:i,isWindow:s,isDocument:n,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:s||n?i.width():i.outerWidth(),height:s||n?i.height():i.outerHeight()}}},e.fn.position=function(n){if(!n||!n.of)return f.apply(this,arguments);n=e.extend({},n);var p,m,g,v,y,b,_=e(n.of),x=e.position.getWithinInfo(n.within),w=e.position.getScrollInfo(x),k=(n.collision||"flip").split(" "),T={};return b=s(_),_[0].preventDefault&&(n.at="left top"),m=b.width,g=b.height,v=b.offset,y=e.extend({},v),e.each(["my","at"],function(){var e,t,i=(n[this]||"").split(" ");1===i.length&&(i=l.test(i[0])?i.concat(["center"]):u.test(i[0])?["center"].concat(i):["center","center"]),i[0]=l.test(i[0])?i[0]:"center",i[1]=u.test(i[1])?i[1]:"center",e=d.exec(i[0]),t=d.exec(i[1]),T[this]=[e?e[0]:0,t?t[0]:0],n[this]=[c.exec(i[0])[0],c.exec(i[1])[0]]}),1===k.length&&(k[1]=k[0]),"right"===n.at[0]?y.left+=m:"center"===n.at[0]&&(y.left+=m/2),"bottom"===n.at[1]?y.top+=g:"center"===n.at[1]&&(y.top+=g/2),p=t(T.at,m,g),y.left+=p[0],y.top+=p[1],this.each(function(){var s,l,u=e(this),d=u.outerWidth(),c=u.outerHeight(),f=i(this,"marginLeft"),b=i(this,"marginTop"),D=d+f+i(this,"marginRight")+w.width,S=c+b+i(this,"marginBottom")+w.height,M=e.extend({},y),C=t(T.my,u.outerWidth(),u.outerHeight());"right"===n.my[0]?M.left-=d:"center"===n.my[0]&&(M.left-=d/2),"bottom"===n.my[1]?M.top-=c:"center"===n.my[1]&&(M.top-=c/2),M.left+=C[0],M.top+=C[1],a||(M.left=h(M.left),M.top=h(M.top)),s={marginLeft:f,marginTop:b},e.each(["left","top"],function(t,i){e.ui.position[k[t]]&&e.ui.position[k[t]][i](M,{targetWidth:m,targetHeight:g,elemWidth:d,elemHeight:c,collisionPosition:s,collisionWidth:D,collisionHeight:S,offset:[p[0]+C[0],p[1]+C[1]],my:n.my,at:n.at,within:x,elem:u})}),n.using&&(l=function(e){var t=v.left-M.left,i=t+m-d,s=v.top-M.top,a=s+g-c,h={target:{element:_,left:v.left,top:v.top,width:m,height:g},element:{element:u,left:M.left,top:M.top,width:d,height:c},horizontal:0>i?"left":t>0?"right":"center",vertical:0>a?"top":s>0?"bottom":"middle"};d>m&&m>r(t+i)&&(h.horizontal="center"),c>g&&g>r(s+a)&&(h.vertical="middle"),h.important=o(r(t),r(i))>o(r(s),r(a))?"horizontal":"vertical",n.using.call(this,e,h)}),u.offset(e.extend(M,{using:l}))})},e.ui.position={fit:{left:function(e,t){var i,s=t.within,n=s.isWindow?s.scrollLeft:s.offset.left,a=s.width,r=e.left-t.collisionPosition.marginLeft,h=n-r,l=r+t.collisionWidth-a-n;t.collisionWidth>a?h>0&&0>=l?(i=e.left+h+t.collisionWidth-a-n,e.left+=h-i):e.left=l>0&&0>=h?n:h>l?n+a-t.collisionWidth:n:h>0?e.left+=h:l>0?e.left-=l:e.left=o(e.left-r,e.left)},top:function(e,t){var i,s=t.within,n=s.isWindow?s.scrollTop:s.offset.top,a=t.within.height,r=e.top-t.collisionPosition.marginTop,h=n-r,l=r+t.collisionHeight-a-n;t.collisionHeight>a?h>0&&0>=l?(i=e.top+h+t.collisionHeight-a-n,e.top+=h-i):e.top=l>0&&0>=h?n:h>l?n+a-t.collisionHeight:n:h>0?e.top+=h:l>0?e.top-=l:e.top=o(e.top-r,e.top)}},flip:{left:function(e,t){var i,s,n=t.within,a=n.offset.left+n.scrollLeft,o=n.width,h=n.isWindow?n.scrollLeft:n.offset.left,l=e.left-t.collisionPosition.marginLeft,u=l-h,d=l+t.collisionWidth-o-h,c="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,p="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,f=-2*t.offset[0];0>u?(i=e.left+c+p+f+t.collisionWidth-o-a,(0>i||r(u)>i)&&(e.left+=c+p+f)):d>0&&(s=e.left-t.collisionPosition.marginLeft+c+p+f-h,(s>0||d>r(s))&&(e.left+=c+p+f))},top:function(e,t){var i,s,n=t.within,a=n.offset.top+n.scrollTop,o=n.height,h=n.isWindow?n.scrollTop:n.offset.top,l=e.top-t.collisionPosition.marginTop,u=l-h,d=l+t.collisionHeight-o-h,c="top"===t.my[1],p=c?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,f="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,m=-2*t.offset[1];0>u?(s=e.top+p+f+m+t.collisionHeight-o-a,(0>s||r(u)>s)&&(e.top+=p+f+m)):d>0&&(i=e.top-t.collisionPosition.marginTop+p+f+m-h,(i>0||d>r(i))&&(e.top+=p+f+m))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,i,s,n,o,r=document.getElementsByTagName("body")[0],h=document.createElement("div");t=document.createElement(r?"div":"body"),s={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},r&&e.extend(s,{position:"absolute",left:"-1000px",top:"-1000px"});for(o in s)t.style[o]=s[o];t.appendChild(h),i=r||document.documentElement,i.insertBefore(t,i.firstChild),h.style.cssText="position: absolute; left: 10.7432222px;",n=e(h).offset().left,a=n>10&&11>n,t.innerHTML="",i.removeChild(t)}()}(),e.ui.position,e.widget("ui.accordion",{version:"1.11.4",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var t=this.options;this.prevShow=this.prevHide=e(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),t.collapsible||t.active!==!1&&null!=t.active||(t.active=0),this._processPanels(),0>t.active&&(t.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():e()}},_createIcons:function(){var t=this.options.icons;t&&(e("<span>").addClass("ui-accordion-header-icon ui-icon "+t.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(t.header).addClass(t.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").removeUniqueId(),this._destroyIcons(),e=this.headers.next().removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&e.css("height","")},_setOption:function(e,t){return"active"===e?(this._activate(t),void 0):("event"===e&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(t)),this._super(e,t),"collapsible"!==e||t||this.options.active!==!1||this._activate(0),"icons"===e&&(this._destroyIcons(),t&&this._createIcons()),"disabled"===e&&(this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!t)),void 0)},_keydown:function(t){if(!t.altKey&&!t.ctrlKey){var i=e.ui.keyCode,s=this.headers.length,n=this.headers.index(t.target),a=!1;switch(t.keyCode){case i.RIGHT:case i.DOWN:a=this.headers[(n+1)%s];break;case i.LEFT:case i.UP:a=this.headers[(n-1+s)%s];break;case i.SPACE:case i.ENTER:this._eventHandler(t);break;case i.HOME:a=this.headers[0];break;case i.END:a=this.headers[s-1]}a&&(e(t.target).attr("tabIndex",-1),e(a).attr("tabIndex",0),a.focus(),t.preventDefault())}},_panelKeyDown:function(t){t.keyCode===e.ui.keyCode.UP&&t.ctrlKey&&e(t.currentTarget).prev().focus()},refresh:function(){var t=this.options;this._processPanels(),t.active===!1&&t.collapsible===!0||!this.headers.length?(t.active=!1,this.active=e()):t.active===!1?this._activate(0):this.active.length&&!e.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(t.active=!1,this.active=e()):this._activate(Math.max(0,t.active-1)):t.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var e=this.headers,t=this.panels;this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-state-default ui-corner-all"),this.panels=this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide(),t&&(this._off(e.not(this.headers)),this._off(t.not(this.panels)))},_refresh:function(){var t,i=this.options,s=i.heightStyle,n=this.element.parent();this.active=this._findActive(i.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(){var t=e(this),i=t.uniqueId().attr("id"),s=t.next(),n=s.uniqueId().attr("id");t.attr("aria-controls",n),s.attr("aria-labelledby",i)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(i.event),"fill"===s?(t=n.height(),this.element.siblings(":visible").each(function(){var i=e(this),s=i.css("position");"absolute"!==s&&"fixed"!==s&&(t-=i.outerHeight(!0))}),this.headers.each(function(){t-=e(this).outerHeight(!0)}),this.headers.next().each(function(){e(this).height(Math.max(0,t-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===s&&(t=0,this.headers.next().each(function(){t=Math.max(t,e(this).css("height","").height())}).height(t))},_activate:function(t){var i=this._findActive(t)[0];i!==this.active[0]&&(i=i||this.active[0],this._eventHandler({target:i,currentTarget:i,preventDefault:e.noop}))},_findActive:function(t){return"number"==typeof t?this.headers.eq(t):e()},_setupEvents:function(t){var i={keydown:"_keydown"};t&&e.each(t.split(" "),function(e,t){i[t]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,i),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(t){var i=this.options,s=this.active,n=e(t.currentTarget),a=n[0]===s[0],o=a&&i.collapsible,r=o?e():n.next(),h=s.next(),l={oldHeader:s,oldPanel:h,newHeader:o?e():n,newPanel:r};t.preventDefault(),a&&!i.collapsible||this._trigger("beforeActivate",t,l)===!1||(i.active=o?!1:this.headers.index(n),this.active=a?e():n,this._toggle(l),s.removeClass("ui-accordion-header-active ui-state-active"),i.icons&&s.children(".ui-accordion-header-icon").removeClass(i.icons.activeHeader).addClass(i.icons.header),a||(n.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),i.icons&&n.children(".ui-accordion-header-icon").removeClass(i.icons.header).addClass(i.icons.activeHeader),n.next().addClass("ui-accordion-content-active")))},_toggle:function(t){var i=t.newPanel,s=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=i,this.prevHide=s,this.options.animate?this._animate(i,s,t):(s.hide(),i.show(),this._toggleComplete(t)),s.attr({"aria-hidden":"true"}),s.prev().attr({"aria-selected":"false","aria-expanded":"false"}),i.length&&s.length?s.prev().attr({tabIndex:-1,"aria-expanded":"false"}):i.length&&this.headers.filter(function(){return 0===parseInt(e(this).attr("tabIndex"),10)}).attr("tabIndex",-1),i.attr("aria-hidden","false").prev().attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_animate:function(e,t,i){var s,n,a,o=this,r=0,h=e.css("box-sizing"),l=e.length&&(!t.length||e.index()<t.index()),u=this.options.animate||{},d=l&&u.down||u,c=function(){o._toggleComplete(i)};return"number"==typeof d&&(a=d),"string"==typeof d&&(n=d),n=n||d.easing||u.easing,a=a||d.duration||u.duration,t.length?e.length?(s=e.show().outerHeight(),t.animate(this.hideProps,{duration:a,easing:n,step:function(e,t){t.now=Math.round(e)}}),e.hide().animate(this.showProps,{duration:a,easing:n,complete:c,step:function(e,i){i.now=Math.round(e),"height"!==i.prop?"content-box"===h&&(r+=i.now):"content"!==o.options.heightStyle&&(i.now=Math.round(s-t.outerHeight()-r),r=0)}}),void 0):t.animate(this.hideProps,a,n,c):e.animate(this.showProps,a,n,c)},_toggleComplete:function(e){var t=e.oldPanel;t.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),t.length&&(t.parent()[0].className=t.parent()[0].className),this._trigger("activate",null,e)}}),e.widget("ui.menu",{version:"1.11.4",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},items:"> *",menus:"ul",position:{my:"left-1 top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item":function(e){e.preventDefault()},"click .ui-menu-item":function(t){var i=e(t.target);!this.mouseHandled&&i.not(".ui-state-disabled").length&&(this.select(t),t.isPropagationStopped()||(this.mouseHandled=!0),i.has(".ui-menu").length?this.expand(t):!this.element.is(":focus")&&e(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){if(!this.previousFilter){var i=e(t.currentTarget);i.siblings(".ui-state-active").removeClass("ui-state-active"),this.focus(t,i)}},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var i=this.active||this.element.find(this.options.items).eq(0);t||this.focus(e,i)},blur:function(t){this._delay(function(){e.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(e){this._closeOnDocumentClick(e)&&this.collapseAll(e),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-menu-icons ui-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var t=e(this);t.data("ui-menu-submenu-carat")&&t.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(t){var i,s,n,a,o=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move("first","first",t);break;case e.ui.keyCode.END:this._move("last","last",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:o=!1,s=this.previousFilter||"",n=String.fromCharCode(t.keyCode),a=!1,clearTimeout(this.filterTimer),n===s?a=!0:n=s+n,i=this._filterMenuItems(n),i=a&&-1!==i.index(this.active.next())?this.active.nextAll(".ui-menu-item"):i,i.length||(n=String.fromCharCode(t.keyCode),i=this._filterMenuItems(n)),i.length?(this.focus(t,i),this.previousFilter=n,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}o&&t.preventDefault()},_activate:function(e){this.active.is(".ui-state-disabled")||(this.active.is("[aria-haspopup='true']")?this.expand(e):this.select(e))},refresh:function(){var t,i,s=this,n=this.options.icons.submenu,a=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),a.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-front").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=e(this),i=t.parent(),s=e("<span>").addClass("ui-menu-icon ui-icon "+n).data("ui-menu-submenu-carat",!0);i.attr("aria-haspopup","true").prepend(s),t.attr("aria-labelledby",i.attr("id"))}),t=a.add(this.element),i=t.find(this.options.items),i.not(".ui-menu-item").each(function(){var t=e(this);s._isDivider(t)&&t.addClass("ui-widget-content ui-menu-divider")}),i.not(".ui-menu-item, .ui-menu-divider").addClass("ui-menu-item").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),i.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){"icons"===e&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this._super(e,t)},focus:function(e,t){var i,s;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),s=this.active.addClass("ui-state-focus").removeClass("ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",s.attr("id")),this.active.parent().closest(".ui-menu-item").addClass("ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),i=t.children(".ui-menu"),i.length&&e&&/^mouse/.test(e.type)&&this._startOpening(i),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(t){var i,s,n,a,o,r;this._hasScroll()&&(i=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,s=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,n=t.offset().top-this.activeMenu.offset().top-i-s,a=this.activeMenu.scrollTop(),o=this.activeMenu.height(),r=t.outerHeight(),0>n?this.activeMenu.scrollTop(a+n):n+r>o&&this.activeMenu.scrollTop(a+n-o+r))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this.active.removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active}))},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(e)},this.delay))},_open:function(t){var i=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(i)},collapseAll:function(t,i){clearTimeout(this.timer),this.timer=this._delay(function(){var s=i?this.element:e(t&&t.target).closest(this.element.find(".ui-menu"));s.length||(s=this.element),this._close(s),this.blur(t),this.activeMenu=s},this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find(".ui-state-active").not(".ui-state-focus").removeClass("ui-state-active")},_closeOnDocumentClick:function(t){return!e(t.target).closest(".ui-menu").length},_isDivider:function(e){return!/[^\-\u2014\u2013\s]/.test(e.text())},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,i){var s;this.active&&(s="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[e+"All"](".ui-menu-item").eq(0)),s&&s.length&&this.active||(s=this.activeMenu.find(this.options.items)[t]()),this.focus(i,s)},nextPage:function(t){var i,s,n;return this.active?(this.isLastItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return i=e(this),0>i.offset().top-s-n}),this.focus(t,i)):this.focus(t,this.activeMenu.find(this.options.items)[this.active?"last":"first"]())),void 0):(this.next(t),void 0)},previousPage:function(t){var i,s,n;return this.active?(this.isFirstItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return i=e(this),i.offset().top-s+n>0}),this.focus(t,i)):this.focus(t,this.activeMenu.find(this.options.items).first())),void 0):(this.next(t),void 0)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||e(t.target).closest(".ui-menu-item");var i={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,i)},_filterMenuItems:function(t){var i=t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),s=RegExp("^"+i,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return s.test(e.trim(e(this).text()))})}}),e.widget("ui.autocomplete",{version:"1.11.4",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var t,i,s,n=this.element[0].nodeName.toLowerCase(),a="textarea"===n,o="input"===n;this.isMultiLine=a?!0:o?!1:this.element.prop("isContentEditable"),this.valueMethod=this.element[a||o?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(n){if(this.element.prop("readOnly"))return t=!0,s=!0,i=!0,void 0;t=!1,s=!1,i=!1;var a=e.ui.keyCode;switch(n.keyCode){case a.PAGE_UP:t=!0,this._move("previousPage",n);break;case a.PAGE_DOWN:t=!0,this._move("nextPage",n);break;case a.UP:t=!0,this._keyEvent("previous",n);break;case a.DOWN:t=!0,this._keyEvent("next",n);break;case a.ENTER:this.menu.active&&(t=!0,n.preventDefault(),this.menu.select(n));break;case a.TAB:this.menu.active&&this.menu.select(n);break;case a.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(n),n.preventDefault());break;default:i=!0,this._searchTimeout(n)}},keypress:function(s){if(t)return t=!1,(!this.isMultiLine||this.menu.element.is(":visible"))&&s.preventDefault(),void 0;if(!i){var n=e.ui.keyCode;switch(s.keyCode){case n.PAGE_UP:this._move("previousPage",s);break;case n.PAGE_DOWN:this._move("nextPage",s);break;case n.UP:this._keyEvent("previous",s);break;case n.DOWN:this._keyEvent("next",s)}}},input:function(e){return s?(s=!1,e.preventDefault(),void 0):(this._searchTimeout(e),void 0)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){return this.cancelBlur?(delete this.cancelBlur,void 0):(clearTimeout(this.searching),this.close(e),this._change(e),void 0)}}),this._initSource(),this.menu=e("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var i=this.menu.element[0];e(t.target).closest(".ui-menu-item").length||this._delay(function(){var t=this;this.document.one("mousedown",function(s){s.target===t.element[0]||s.target===i||e.contains(i,s.target)||t.close()})})},menufocus:function(t,i){var s,n;return this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type))?(this.menu.blur(),this.document.one("mousemove",function(){e(t.target).trigger(t.originalEvent)}),void 0):(n=i.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",t,{item:n})&&t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(n.value),s=i.item.attr("aria-label")||n.value,s&&e.trim(s).length&&(this.liveRegion.children().hide(),e("<div>").text(s).appendTo(this.liveRegion)),void 0)},menuselect:function(e,t){var i=t.item.data("ui-autocomplete-item"),s=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=s,this._delay(function(){this.previous=s,this.selectedItem=i})),!1!==this._trigger("select",e,{item:i})&&this._value(i.value),this.term=this._value(),this.close(e),this.selectedItem=i}}),this.liveRegion=e("<span>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this._appendTo()),"disabled"===e&&t&&this.xhr&&this.xhr.abort()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t&&t[0]||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_initSource:function(){var t,i,s=this;e.isArray(this.options.source)?(t=this.options.source,this.source=function(i,s){s(e.ui.autocomplete.filter(t,i.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(t,n){s.xhr&&s.xhr.abort(),s.xhr=e.ajax({url:i,data:t,dataType:"json",success:function(e){n(e)},error:function(){n([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay(function(){var t=this.term===this._value(),i=this.menu.element.is(":visible"),s=e.altKey||e.ctrlKey||e.metaKey||e.shiftKey;(!t||t&&!i&&!s)&&(this.selectedItem=null,this.search(null,e))},this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):this._trigger("search",t)!==!1?this._search(e):void 0},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var t=++this.requestIndex;return e.proxy(function(e){t===this.requestIndex&&this.__response(e),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},this)},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,function(t){return"string"==typeof t?{label:t,value:t}:e.extend({},t,{label:t.label||t.value,value:t.value||t.label})})},_suggest:function(t){var i=this.menu.element.empty();this._renderMenu(i,t),this.isNewMenu=!0,this.menu.refresh(),i.show(),this._resizeMenu(),i.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,i){var s=this;e.each(i,function(e,i){s._renderItemData(t,i)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(t,i){return e("<li>").text(i.label).appendTo(t)},_move:function(e,t){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this.isMultiLine||this._value(this.term),this.menu.blur(),void 0):(this.menu[e](t),void 0):(this.search(null,t),void 0)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(e,t),t.preventDefault())}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,i){var s=RegExp(e.ui.autocomplete.escapeRegex(i),"i");return e.grep(t,function(e){return s.test(e.label||e.value||e)})}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(t){var i;this._superApply(arguments),this.options.disabled||this.cancelSearch||(i=t&&t.length?this.options.messages.results(t.length):this.options.messages.noResults,this.liveRegion.children().hide(),e("<div>").text(i).appendTo(this.liveRegion))}}),e.ui.autocomplete;var c,p="ui-button ui-widget ui-state-default ui-corner-all",f="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",m=function(){var t=e(this);setTimeout(function(){t.find(":ui-button").button("refresh")},1)},g=function(t){var i=t.name,s=t.form,n=e([]);return i&&(i=i.replace(/'/g,"\\'"),n=s?e(s).find("[name='"+i+"'][type=radio]"):e("[name='"+i+"'][type=radio]",t.ownerDocument).filter(function(){return!this.form})),n};e.widget("ui.button",{version:"1.11.4",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,m),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var t=this,i=this.options,s="checkbox"===this.type||"radio"===this.type,n=s?"":"ui-state-active";null===i.label&&(i.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(p).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){i.disabled||this===c&&e(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){i.disabled||e(this).removeClass(n)}).bind("click"+this.eventNamespace,function(e){i.disabled&&(e.preventDefault(),e.stopImmediatePropagation())}),this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}}),s&&this.element.bind("change"+this.eventNamespace,function(){t.refresh()}),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return i.disabled?!1:void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(i.disabled)return!1;e(this).addClass("ui-state-active"),t.buttonElement.attr("aria-pressed","true");var s=t.element[0];g(s).not(s).map(function(){return e(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return i.disabled?!1:(e(this).addClass("ui-state-active"),c=this,t.document.one("mouseup",function(){c=null}),void 0)}).bind("mouseup"+this.eventNamespace,function(){return i.disabled?!1:(e(this).removeClass("ui-state-active"),void 0)}).bind("keydown"+this.eventNamespace,function(t){return i.disabled?!1:((t.keyCode===e.ui.keyCode.SPACE||t.keyCode===e.ui.keyCode.ENTER)&&e(this).addClass("ui-state-active"),void 0)}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){e(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(t){t.keyCode===e.ui.keyCode.SPACE&&e(this).click()})),this._setOption("disabled",i.disabled),this._resetButton()},_determineButtonType:function(){var e,t,i;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(e=this.element.parents().last(),t="label[for='"+this.element.attr("id")+"']",this.buttonElement=e.find(t),this.buttonElement.length||(e=e.length?e.siblings():this.element.siblings(),this.buttonElement=e.filter(t),this.buttonElement.length||(this.buttonElement=e.find(t))),this.element.addClass("ui-helper-hidden-accessible"),i=this.element.is(":checked"),i&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",i)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(p+" ui-state-active "+f).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(e,t){return this._super(e,t),"disabled"===e?(this.widget().toggleClass("ui-state-disabled",!!t),this.element.prop("disabled",!!t),t&&("checkbox"===this.type||"radio"===this.type?this.buttonElement.removeClass("ui-state-focus"):this.buttonElement.removeClass("ui-state-focus ui-state-active")),void 0):(this._resetButton(),void 0)},refresh:function(){var t=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");t!==this.options.disabled&&this._setOption("disabled",t),"radio"===this.type?g(this.element[0]).each(function(){e(this).is(":checked")?e(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):e(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return this.options.label&&this.element.val(this.options.label),void 0;var t=this.buttonElement.removeClass(f),i=e("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(),s=this.options.icons,n=s.primary&&s.secondary,a=[];s.primary||s.secondary?(this.options.text&&a.push("ui-button-text-icon"+(n?"s":s.primary?"-primary":"-secondary")),s.primary&&t.prepend("<span class='ui-button-icon-primary ui-icon "+s.primary+"'></span>"),s.secondary&&t.append("<span class='ui-button-icon-secondary ui-icon "+s.secondary+"'></span>"),this.options.text||(a.push(n?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||t.attr("title",e.trim(i)))):a.push("ui-button-text-only"),t.addClass(a.join(" "))}}),e.widget("ui.buttonset",{version:"1.11.4",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(e,t){"disabled"===e&&this.buttons.button("option",e,t),this._super(e,t)},refresh:function(){var t="rtl"===this.element.css("direction"),i=this.element.find(this.options.items),s=i.filter(":ui-button");i.not(":ui-button").button(),s.button("refresh"),this.buttons=i.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(t?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}}),e.ui.button,e.extend(e.ui,{datepicker:{version:"1.11.4"}});var v;e.extend(n.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return r(this._defaults,e||{}),this},_attachDatepicker:function(t,i){var s,n,a;s=t.nodeName.toLowerCase(),n="div"===s||"span"===s,t.id||(this.uuid+=1,t.id="dp"+this.uuid),a=this._newInst(e(t),n),a.settings=e.extend({},i||{}),"input"===s?this._connectDatepicker(t,a):n&&this._inlineDatepicker(t,a)},_newInst:function(t,i){var s=t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:s,input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:i?a(e("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,i){var s=e(t);i.append=e([]),i.trigger=e([]),s.hasClass(this.markerClassName)||(this._attachments(s,i),s.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(i),e.data(t,"datepicker",i),i.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,i){var s,n,a,o=this._get(i,"appendText"),r=this._get(i,"isRTL");i.append&&i.append.remove(),o&&(i.append=e("<span class='"+this._appendClass+"'>"+o+"</span>"),t[r?"before":"after"](i.append)),t.unbind("focus",this._showDatepicker),i.trigger&&i.trigger.remove(),s=this._get(i,"showOn"),("focus"===s||"both"===s)&&t.focus(this._showDatepicker),("button"===s||"both"===s)&&(n=this._get(i,"buttonText"),a=this._get(i,"buttonImage"),i.trigger=e(this._get(i,"buttonImageOnly")?e("<img/>").addClass(this._triggerClass).attr({src:a,alt:n,title:n}):e("<button type='button'></button>").addClass(this._triggerClass).html(a?e("<img/>").attr({src:a,alt:n,title:n}):n)),t[r?"before":"after"](i.trigger),i.trigger.click(function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1}))},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,i,s,n,a=new Date(2009,11,20),o=this._get(e,"dateFormat");o.match(/[DM]/)&&(t=function(e){for(i=0,s=0,n=0;e.length>n;n++)e[n].length>i&&(i=e[n].length,s=n);return s},a.setMonth(t(this._get(e,o.match(/MM/)?"monthNames":"monthNamesShort"))),a.setDate(t(this._get(e,o.match(/DD/)?"dayNames":"dayNamesShort"))+20-a.getDay())),e.input.attr("size",this._formatDate(e,a).length)}},_inlineDatepicker:function(t,i){var s=e(t);s.hasClass(this.markerClassName)||(s.addClass(this.markerClassName).append(i.dpDiv),e.data(t,"datepicker",i),this._setDate(i,this._getDefaultDate(i),!0),this._updateDatepicker(i),this._updateAlternate(i),i.settings.disabled&&this._disableDatepicker(t),i.dpDiv.css("display","block"))},_dialogDatepicker:function(t,i,s,n,a){var o,h,l,u,d,c=this._dialogInst;return c||(this.uuid+=1,o="dp"+this.uuid,this._dialogInput=e("<input type='text' id='"+o+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),e("body").append(this._dialogInput),c=this._dialogInst=this._newInst(this._dialogInput,!1),c.settings={},e.data(this._dialogInput[0],"datepicker",c)),r(c.settings,n||{}),i=i&&i.constructor===Date?this._formatDate(c,i):i,this._dialogInput.val(i),this._pos=a?a.length?a:[a.pageX,a.pageY]:null,this._pos||(h=document.documentElement.clientWidth,l=document.documentElement.clientHeight,u=document.documentElement.scrollLeft||document.body.scrollLeft,d=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[h/2-100+u,l/2-150+d]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),c.settings.onSelect=s,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],"datepicker",c),this},_destroyDatepicker:function(t){var i,s=e(t),n=e.data(t,"datepicker");s.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),e.removeData(t,"datepicker"),"input"===i?(n.append.remove(),n.trigger.remove(),s.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===i||"span"===i)&&s.removeClass(this.markerClassName).empty(),v===n&&(v=null))},_enableDatepicker:function(t){var i,s,n=e(t),a=e.data(t,"datepicker");n.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),"input"===i?(t.disabled=!1,a.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().removeClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}))},_disableDatepicker:function(t){var i,s,n=e(t),a=e.data(t,"datepicker");n.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),"input"===i?(t.disabled=!0,a.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().addClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t)},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;this._disabledInputs.length>t;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,"datepicker")}catch(i){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(t,i,s){var n,a,o,h,l=this._getInst(t);return 2===arguments.length&&"string"==typeof i?"defaults"===i?e.extend({},e.datepicker._defaults):l?"all"===i?e.extend({},l.settings):this._get(l,i):null:(n=i||{},"string"==typeof i&&(n={},n[i]=s),l&&(this._curInst===l&&this._hideDatepicker(),a=this._getDateDatepicker(t,!0),o=this._getMinMaxDate(l,"min"),h=this._getMinMaxDate(l,"max"),r(l.settings,n),null!==o&&void 0!==n.dateFormat&&void 0===n.minDate&&(l.settings.minDate=this._formatDate(l,o)),null!==h&&void 0!==n.dateFormat&&void 0===n.maxDate&&(l.settings.maxDate=this._formatDate(l,h)),"disabled"in n&&(n.disabled?this._disableDatepicker(t):this._enableDatepicker(t)),this._attachments(e(t),l),this._autoSize(l),this._setDate(l,a),this._updateAlternate(l),this._updateDatepicker(l)),void 0)},_changeDatepicker:function(e,t,i){this._optionDatepicker(e,t,i)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var i=this._getInst(e);i&&(this._setDate(i,t),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(e,t){var i=this._getInst(e);return i&&!i.inline&&this._setDateFromField(i,t),i?this._getDate(i):null},_doKeyDown:function(t){var i,s,n,a=e.datepicker._getInst(t.target),o=!0,r=a.dpDiv.is(".ui-datepicker-rtl");if(a._keyEvent=!0,e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),o=!1;break;case 13:return n=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",a.dpDiv),n[0]&&e.datepicker._selectDay(t.target,a.selectedMonth,a.selectedYear,n[0]),i=e.datepicker._get(a,"onSelect"),i?(s=e.datepicker._formatDate(a),i.apply(a.input?a.input[0]:null,[s,a])):e.datepicker._hideDatepicker(),!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(a,"stepBigMonths"):-e.datepicker._get(a,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(a,"stepBigMonths"):+e.datepicker._get(a,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),o=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),o=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,r?1:-1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(a,"stepBigMonths"):-e.datepicker._get(a,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,"D"),o=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,r?-1:1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(a,"stepBigMonths"):+e.datepicker._get(a,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,"D"),o=t.ctrlKey||t.metaKey;break;default:o=!1}else 36===t.keyCode&&t.ctrlKey?e.datepicker._showDatepicker(this):o=!1;o&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var i,s,n=e.datepicker._getInst(t.target);return e.datepicker._get(n,"constrainInput")?(i=e.datepicker._possibleChars(e.datepicker._get(n,"dateFormat")),s=String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||" ">s||!i||i.indexOf(s)>-1):void 0},_doKeyUp:function(t){var i,s=e.datepicker._getInst(t.target);if(s.input.val()!==s.lastVal)try{i=e.datepicker.parseDate(e.datepicker._get(s,"dateFormat"),s.input?s.input.val():null,e.datepicker._getFormatConfig(s)),i&&(e.datepicker._setDateFromField(s),e.datepicker._updateAlternate(s),e.datepicker._updateDatepicker(s))}catch(n){}return!0},_showDatepicker:function(t){if(t=t.target||t,"input"!==t.nodeName.toLowerCase()&&(t=e("input",t.parentNode)[0]),!e.datepicker._isDisabledDatepicker(t)&&e.datepicker._lastInput!==t){var i,n,a,o,h,l,u;i=e.datepicker._getInst(t),e.datepicker._curInst&&e.datepicker._curInst!==i&&(e.datepicker._curInst.dpDiv.stop(!0,!0),i&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),n=e.datepicker._get(i,"beforeShow"),a=n?n.apply(t,[t,i]):{},a!==!1&&(r(i.settings,a),i.lastVal=null,e.datepicker._lastInput=t,e.datepicker._setDateFromField(i),e.datepicker._inDialog&&(t.value=""),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(t),e.datepicker._pos[1]+=t.offsetHeight),o=!1,e(t).parents().each(function(){return o|="fixed"===e(this).css("position"),!o}),h={left:e.datepicker._pos[0],top:e.datepicker._pos[1]},e.datepicker._pos=null,i.dpDiv.empty(),i.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),e.datepicker._updateDatepicker(i),h=e.datepicker._checkOffset(i,h,o),i.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":o?"fixed":"absolute",display:"none",left:h.left+"px",top:h.top+"px"}),i.inline||(l=e.datepicker._get(i,"showAnim"),u=e.datepicker._get(i,"duration"),i.dpDiv.css("z-index",s(e(t))+1),e.datepicker._datepickerShowing=!0,e.effects&&e.effects.effect[l]?i.dpDiv.show(l,e.datepicker._get(i,"showOptions"),u):i.dpDiv[l||"show"](l?u:null),e.datepicker._shouldFocusInput(i)&&i.input.focus(),e.datepicker._curInst=i))}},_updateDatepicker:function(t){this.maxRows=4,v=t,t.dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t);var i,s=this._getNumberOfMonths(t),n=s[1],a=17,r=t.dpDiv.find("."+this._dayOverClass+" a");r.length>0&&o.apply(r.get(0)),t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),n>1&&t.dpDiv.addClass("ui-datepicker-multi-"+n).css("width",a*n+"em"),t.dpDiv[(1!==s[0]||1!==s[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===e.datepicker._curInst&&e.datepicker._datepickerShowing&&e.datepicker._shouldFocusInput(t)&&t.input.focus(),t.yearshtml&&(i=t.yearshtml,setTimeout(function(){i===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),i=t.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(t,i,s){var n=t.dpDiv.outerWidth(),a=t.dpDiv.outerHeight(),o=t.input?t.input.outerWidth():0,r=t.input?t.input.outerHeight():0,h=document.documentElement.clientWidth+(s?0:e(document).scrollLeft()),l=document.documentElement.clientHeight+(s?0:e(document).scrollTop());return i.left-=this._get(t,"isRTL")?n-o:0,i.left-=s&&i.left===t.input.offset().left?e(document).scrollLeft():0,i.top-=s&&i.top===t.input.offset().top+r?e(document).scrollTop():0,i.left-=Math.min(i.left,i.left+n>h&&h>n?Math.abs(i.left+n-h):0),i.top-=Math.min(i.top,i.top+a>l&&l>a?Math.abs(a+r):0),i},_findPos:function(t){for(var i,s=this._getInst(t),n=this._get(s,"isRTL");t&&("hidden"===t.type||1!==t.nodeType||e.expr.filters.hidden(t));)t=t[n?"previousSibling":"nextSibling"];return i=e(t).offset(),[i.left,i.top]},_hideDatepicker:function(t){var i,s,n,a,o=this._curInst;!o||t&&o!==e.data(t,"datepicker")||this._datepickerShowing&&(i=this._get(o,"showAnim"),s=this._get(o,"duration"),n=function(){e.datepicker._tidyDialog(o)},e.effects&&(e.effects.effect[i]||e.effects[i])?o.dpDiv.hide(i,e.datepicker._get(o,"showOptions"),s,n):o.dpDiv["slideDown"===i?"slideUp":"fadeIn"===i?"fadeOut":"hide"](i?s:null,n),i||n(),this._datepickerShowing=!1,a=this._get(o,"onClose"),a&&a.apply(o.input?o.input[0]:null,[o.input?o.input.val():"",o]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),e.blockUI&&(e.unblockUI(),e("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(e.datepicker._curInst){var i=e(t.target),s=e.datepicker._getInst(i[0]);(i[0].id!==e.datepicker._mainDivId&&0===i.parents("#"+e.datepicker._mainDivId).length&&!i.hasClass(e.datepicker.markerClassName)&&!i.closest("."+e.datepicker._triggerClass).length&&e.datepicker._datepickerShowing&&(!e.datepicker._inDialog||!e.blockUI)||i.hasClass(e.datepicker.markerClassName)&&e.datepicker._curInst!==s)&&e.datepicker._hideDatepicker()}},_adjustDate:function(t,i,s){var n=e(t),a=this._getInst(n[0]);this._isDisabledDatepicker(n[0])||(this._adjustInstDate(a,i+("M"===s?this._get(a,"showCurrentAtPos"):0),s),this._updateDatepicker(a))},_gotoToday:function(t){var i,s=e(t),n=this._getInst(s[0]);this._get(n,"gotoCurrent")&&n.currentDay?(n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear):(i=new Date,n.selectedDay=i.getDate(),n.drawMonth=n.selectedMonth=i.getMonth(),n.drawYear=n.selectedYear=i.getFullYear()),this._notifyChange(n),this._adjustDate(s)},_selectMonthYear:function(t,i,s){var n=e(t),a=this._getInst(n[0]);a["selected"+("M"===s?"Month":"Year")]=a["draw"+("M"===s?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10),this._notifyChange(a),this._adjustDate(n)},_selectDay:function(t,i,s,n){var a,o=e(t);e(n).hasClass(this._unselectableClass)||this._isDisabledDatepicker(o[0])||(a=this._getInst(o[0]),a.selectedDay=a.currentDay=e("a",n).html(),a.selectedMonth=a.currentMonth=i,a.selectedYear=a.currentYear=s,this._selectDate(t,this._formatDate(a,a.currentDay,a.currentMonth,a.currentYear)))},_clearDate:function(t){var i=e(t);this._selectDate(i,"")},_selectDate:function(t,i){var s,n=e(t),a=this._getInst(n[0]);i=null!=i?i:this._formatDate(a),a.input&&a.input.val(i),this._updateAlternate(a),s=this._get(a,"onSelect"),s?s.apply(a.input?a.input[0]:null,[i,a]):a.input&&a.input.trigger("change"),a.inline?this._updateDatepicker(a):(this._hideDatepicker(),this._lastInput=a.input[0],"object"!=typeof a.input[0]&&a.input.focus(),this._lastInput=null)},_updateAlternate:function(t){var i,s,n,a=this._get(t,"altField");a&&(i=this._get(t,"altFormat")||this._get(t,"dateFormat"),s=this._getDate(t),n=this.formatDate(i,s,this._getFormatConfig(t)),e(a).each(function(){e(this).val(n)}))},noWeekends:function(e){var t=e.getDay();return[t>0&&6>t,""]},iso8601Week:function(e){var t,i=new Date(e.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),t=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((t-i)/864e5)/7)+1},parseDate:function(t,i,s){if(null==t||null==i)throw"Invalid arguments";if(i="object"==typeof i?""+i:i+"",""===i)return null;var n,a,o,r,h=0,l=(s?s.shortYearCutoff:null)||this._defaults.shortYearCutoff,u="string"!=typeof l?l:(new Date).getFullYear()%100+parseInt(l,10),d=(s?s.dayNamesShort:null)||this._defaults.dayNamesShort,c=(s?s.dayNames:null)||this._defaults.dayNames,p=(s?s.monthNamesShort:null)||this._defaults.monthNamesShort,f=(s?s.monthNames:null)||this._defaults.monthNames,m=-1,g=-1,v=-1,y=-1,b=!1,_=function(e){var i=t.length>n+1&&t.charAt(n+1)===e;return i&&n++,i},x=function(e){var t=_(e),s="@"===e?14:"!"===e?20:"y"===e&&t?4:"o"===e?3:2,n="y"===e?s:1,a=RegExp("^\\d{"+n+","+s+"}"),o=i.substring(h).match(a);if(!o)throw"Missing number at position "+h;return h+=o[0].length,parseInt(o[0],10)},w=function(t,s,n){var a=-1,o=e.map(_(t)?n:s,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});if(e.each(o,function(e,t){var s=t[1];return i.substr(h,s.length).toLowerCase()===s.toLowerCase()?(a=t[0],h+=s.length,!1):void 0}),-1!==a)return a+1;throw"Unknown name at position "+h},k=function(){if(i.charAt(h)!==t.charAt(n))throw"Unexpected literal at position "+h;h++};for(n=0;t.length>n;n++)if(b)"'"!==t.charAt(n)||_("'")?k():b=!1;else switch(t.charAt(n)){case"d":v=x("d");break;case"D":w("D",d,c);break;case"o":y=x("o");break;case"m":g=x("m");break;case"M":g=w("M",p,f);break;case"y":m=x("y");break;case"@":r=new Date(x("@")),m=r.getFullYear(),g=r.getMonth()+1,v=r.getDate();break;case"!":r=new Date((x("!")-this._ticksTo1970)/1e4),m=r.getFullYear(),g=r.getMonth()+1,v=r.getDate();break;case"'":_("'")?k():b=!0;break;default:k()}if(i.length>h&&(o=i.substr(h),!/^\s+/.test(o)))throw"Extra/unparsed characters found in date: "+o;if(-1===m?m=(new Date).getFullYear():100>m&&(m+=(new Date).getFullYear()-(new Date).getFullYear()%100+(u>=m?0:-100)),y>-1)for(g=1,v=y;;){if(a=this._getDaysInMonth(m,g-1),a>=v)break;g++,v-=a}if(r=this._daylightSavingAdjust(new Date(m,g-1,v)),r.getFullYear()!==m||r.getMonth()+1!==g||r.getDate()!==v)throw"Invalid date";return r},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:1e7*60*60*24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(e,t,i){if(!t)return"";var s,n=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,a=(i?i.dayNames:null)||this._defaults.dayNames,o=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,r=(i?i.monthNames:null)||this._defaults.monthNames,h=function(t){var i=e.length>s+1&&e.charAt(s+1)===t;return i&&s++,i},l=function(e,t,i){var s=""+t;if(h(e))for(;i>s.length;)s="0"+s;return s},u=function(e,t,i,s){return h(e)?s[t]:i[t]},d="",c=!1;if(t)for(s=0;e.length>s;s++)if(c)"'"!==e.charAt(s)||h("'")?d+=e.charAt(s):c=!1;else switch(e.charAt(s)){case"d":d+=l("d",t.getDate(),2);break;case"D":d+=u("D",t.getDay(),n,a);break;case"o":d+=l("o",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case"m":d+=l("m",t.getMonth()+1,2);break;case"M":d+=u("M",t.getMonth(),o,r);break;case"y":d+=h("y")?t.getFullYear():(10>t.getYear()%100?"0":"")+t.getYear()%100;break;case"@":d+=t.getTime();break;case"!":d+=1e4*t.getTime()+this._ticksTo1970;break;case"'":h("'")?d+="'":c=!0;break;default:d+=e.charAt(s)}return d},_possibleChars:function(e){var t,i="",s=!1,n=function(i){var s=e.length>t+1&&e.charAt(t+1)===i;return s&&t++,s};for(t=0;e.length>t;t++)if(s)"'"!==e.charAt(t)||n("'")?i+=e.charAt(t):s=!1;else switch(e.charAt(t)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":n("'")?i+="'":s=!0;break;default:i+=e.charAt(t)}return i},_get:function(e,t){return void 0!==e.settings[t]?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()!==e.lastVal){var i=this._get(e,"dateFormat"),s=e.lastVal=e.input?e.input.val():null,n=this._getDefaultDate(e),a=n,o=this._getFormatConfig(e);try{a=this.parseDate(i,s,o)||n}catch(r){s=t?"":s}e.selectedDay=a.getDate(),e.drawMonth=e.selectedMonth=a.getMonth(),e.drawYear=e.selectedYear=a.getFullYear(),e.currentDay=s?a.getDate():0,e.currentMonth=s?a.getMonth():0,e.currentYear=s?a.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,i,s){var n=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},a=function(i){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),i,e.datepicker._getFormatConfig(t))}catch(s){}for(var n=(i.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,a=n.getFullYear(),o=n.getMonth(),r=n.getDate(),h=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,l=h.exec(i);l;){switch(l[2]||"d"){case"d":case"D":r+=parseInt(l[1],10);break;case"w":case"W":r+=7*parseInt(l[1],10);break;case"m":case"M":o+=parseInt(l[1],10),r=Math.min(r,e.datepicker._getDaysInMonth(a,o));break;case"y":case"Y":a+=parseInt(l[1],10),r=Math.min(r,e.datepicker._getDaysInMonth(a,o))}l=h.exec(i)}return new Date(a,o,r)},o=null==i||""===i?s:"string"==typeof i?a(i):"number"==typeof i?isNaN(i)?s:n(i):new Date(i.getTime());return o=o&&"Invalid Date"==""+o?s:o,o&&(o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)),this._daylightSavingAdjust(o)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,i){var s=!t,n=e.selectedMonth,a=e.selectedYear,o=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=o.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=o.getMonth(),e.drawYear=e.selectedYear=e.currentYear=o.getFullYear(),n===e.selectedMonth&&a===e.selectedYear||i||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(s?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&""===e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(t){var i=this._get(t,"stepMonths"),s="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){e.datepicker._adjustDate(s,-i,"M")},next:function(){e.datepicker._adjustDate(s,+i,"M")},hide:function(){e.datepicker._hideDatepicker()},today:function(){e.datepicker._gotoToday(s)},selectDay:function(){return e.datepicker._selectDay(s,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return e.datepicker._selectMonthYear(s,this,"M"),!1},selectYear:function(){return e.datepicker._selectMonthYear(s,this,"Y"),!1}};e(this).bind(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,i,s,n,a,o,r,h,l,u,d,c,p,f,m,g,v,y,b,_,x,w,k,T,D,S,M,C,N,A,P,I,H,z,F,E,O,j,W,L=new Date,R=this._daylightSavingAdjust(new Date(L.getFullYear(),L.getMonth(),L.getDate())),Y=this._get(e,"isRTL"),B=this._get(e,"showButtonPanel"),J=this._get(e,"hideIfNoPrevNext"),q=this._get(e,"navigationAsDateFormat"),K=this._getNumberOfMonths(e),V=this._get(e,"showCurrentAtPos"),U=this._get(e,"stepMonths"),Q=1!==K[0]||1!==K[1],G=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),X=this._getMinMaxDate(e,"min"),$=this._getMinMaxDate(e,"max"),Z=e.drawMonth-V,et=e.drawYear;if(0>Z&&(Z+=12,et--),$)for(t=this._daylightSavingAdjust(new Date($.getFullYear(),$.getMonth()-K[0]*K[1]+1,$.getDate())),t=X&&X>t?X:t;this._daylightSavingAdjust(new Date(et,Z,1))>t;)Z--,0>Z&&(Z=11,et--);for(e.drawMonth=Z,e.drawYear=et,i=this._get(e,"prevText"),i=q?this.formatDate(i,this._daylightSavingAdjust(new Date(et,Z-U,1)),this._getFormatConfig(e)):i,s=this._canAdjustMonth(e,-1,et,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"e":"w")+"'>"+i+"</span></a>":J?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"e":"w")+"'>"+i+"</span></a>",n=this._get(e,"nextText"),n=q?this.formatDate(n,this._daylightSavingAdjust(new Date(et,Z+U,1)),this._getFormatConfig(e)):n,a=this._canAdjustMonth(e,1,et,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"w":"e")+"'>"+n+"</span></a>":J?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"w":"e")+"'>"+n+"</span></a>",o=this._get(e,"currentText"),r=this._get(e,"gotoCurrent")&&e.currentDay?G:R,o=q?this.formatDate(o,r,this._getFormatConfig(e)):o,h=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",l=B?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(Y?h:"")+(this._isInRange(e,r)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+o+"</button>":"")+(Y?"":h)+"</div>":"",u=parseInt(this._get(e,"firstDay"),10),u=isNaN(u)?0:u,d=this._get(e,"showWeek"),c=this._get(e,"dayNames"),p=this._get(e,"dayNamesMin"),f=this._get(e,"monthNames"),m=this._get(e,"monthNamesShort"),g=this._get(e,"beforeShowDay"),v=this._get(e,"showOtherMonths"),y=this._get(e,"selectOtherMonths"),b=this._getDefaultDate(e),_="",w=0;K[0]>w;w++){for(k="",this.maxRows=4,T=0;K[1]>T;T++){if(D=this._daylightSavingAdjust(new Date(et,Z,e.selectedDay)),S=" ui-corner-all",M="",Q){if(M+="<div class='ui-datepicker-group",K[1]>1)switch(T){case 0:M+=" ui-datepicker-group-first",S=" ui-corner-"+(Y?"right":"left");break;case K[1]-1:M+=" ui-datepicker-group-last",S=" ui-corner-"+(Y?"left":"right");break;default:M+=" ui-datepicker-group-middle",S=""}M+="'>"}for(M+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+S+"'>"+(/all|left/.test(S)&&0===w?Y?a:s:"")+(/all|right/.test(S)&&0===w?Y?s:a:"")+this._generateMonthYearHeader(e,Z,et,X,$,w>0||T>0,f,m)+"</div><table class='ui-datepicker-calendar'><thead>"+"<tr>",C=d?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"",x=0;7>x;x++)N=(x+u)%7,C+="<th scope='col'"+((x+u+6)%7>=5?" class='ui-datepicker-week-end'":"")+">"+"<span title='"+c[N]+"'>"+p[N]+"</span></th>";for(M+=C+"</tr></thead><tbody>",A=this._getDaysInMonth(et,Z),et===e.selectedYear&&Z===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,A)),P=(this._getFirstDayOfMonth(et,Z)-u+7)%7,I=Math.ceil((P+A)/7),H=Q?this.maxRows>I?this.maxRows:I:I,this.maxRows=H,z=this._daylightSavingAdjust(new Date(et,Z,1-P)),F=0;H>F;F++){for(M+="<tr>",E=d?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(z)+"</td>":"",x=0;7>x;x++)O=g?g.apply(e.input?e.input[0]:null,[z]):[!0,""],j=z.getMonth()!==Z,W=j&&!y||!O[0]||X&&X>z||$&&z>$,E+="<td class='"+((x+u+6)%7>=5?" ui-datepicker-week-end":"")+(j?" ui-datepicker-other-month":"")+(z.getTime()===D.getTime()&&Z===e.selectedMonth&&e._keyEvent||b.getTime()===z.getTime()&&b.getTime()===D.getTime()?" "+this._dayOverClass:"")+(W?" "+this._unselectableClass+" ui-state-disabled":"")+(j&&!v?"":" "+O[1]+(z.getTime()===G.getTime()?" "+this._currentClass:"")+(z.getTime()===R.getTime()?" ui-datepicker-today":""))+"'"+(j&&!v||!O[2]?"":" title='"+O[2].replace(/'/g,"&#39;")+"'")+(W?"":" data-handler='selectDay' data-event='click' data-month='"+z.getMonth()+"' data-year='"+z.getFullYear()+"'")+">"+(j&&!v?"&#xa0;":W?"<span class='ui-state-default'>"+z.getDate()+"</span>":"<a class='ui-state-default"+(z.getTime()===R.getTime()?" ui-state-highlight":"")+(z.getTime()===G.getTime()?" ui-state-active":"")+(j?" ui-priority-secondary":"")+"' href='#'>"+z.getDate()+"</a>")+"</td>",z.setDate(z.getDate()+1),z=this._daylightSavingAdjust(z);M+=E+"</tr>"}Z++,Z>11&&(Z=0,et++),M+="</tbody></table>"+(Q?"</div>"+(K[0]>0&&T===K[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),k+=M}_+=k}return _+=l,e._keyEvent=!1,_},_generateMonthYearHeader:function(e,t,i,s,n,a,o,r){var h,l,u,d,c,p,f,m,g=this._get(e,"changeMonth"),v=this._get(e,"changeYear"),y=this._get(e,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",_="";if(a||!g)_+="<span class='ui-datepicker-month'>"+o[t]+"</span>";else{for(h=s&&s.getFullYear()===i,l=n&&n.getFullYear()===i,_+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",u=0;12>u;u++)(!h||u>=s.getMonth())&&(!l||n.getMonth()>=u)&&(_+="<option value='"+u+"'"+(u===t?" selected='selected'":"")+">"+r[u]+"</option>");_+="</select>"}if(y||(b+=_+(!a&&g&&v?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",a||!v)b+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(d=this._get(e,"yearRange").split(":"),c=(new Date).getFullYear(),p=function(e){var t=e.match(/c[+\-].*/)?i+parseInt(e.substring(1),10):e.match(/[+\-].*/)?c+parseInt(e,10):parseInt(e,10);return isNaN(t)?c:t},f=p(d[0]),m=Math.max(f,p(d[1]||"")),f=s?Math.max(f,s.getFullYear()):f,m=n?Math.min(m,n.getFullYear()):m,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";m>=f;f++)e.yearshtml+="<option value='"+f+"'"+(f===i?" selected='selected'":"")+">"+f+"</option>";e.yearshtml+="</select>",b+=e.yearshtml,e.yearshtml=null}return b+=this._get(e,"yearSuffix"),y&&(b+=(!a&&g&&v?"":"&#xa0;")+_),b+="</div>"},_adjustInstDate:function(e,t,i){var s=e.drawYear+("Y"===i?t:0),n=e.drawMonth+("M"===i?t:0),a=Math.min(e.selectedDay,this._getDaysInMonth(s,n))+("D"===i?t:0),o=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(s,n,a)));e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),("M"===i||"Y"===i)&&this._notifyChange(e)},_restrictMinMax:function(e,t){var i=this._getMinMaxDate(e,"min"),s=this._getMinMaxDate(e,"max"),n=i&&i>t?i:t;return s&&n>s?s:n},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return null==t?[1,1]:"number"==typeof t?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,i,s){var n=this._getNumberOfMonths(e),a=this._daylightSavingAdjust(new Date(i,s+(0>t?t:n[0]*n[1]),1));return 0>t&&a.setDate(this._getDaysInMonth(a.getFullYear(),a.getMonth())),this._isInRange(e,a)},_isInRange:function(e,t){var i,s,n=this._getMinMaxDate(e,"min"),a=this._getMinMaxDate(e,"max"),o=null,r=null,h=this._get(e,"yearRange");return h&&(i=h.split(":"),s=(new Date).getFullYear(),o=parseInt(i[0],10),r=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(o+=s),i[1].match(/[+\-].*/)&&(r+=s)),(!n||t.getTime()>=n.getTime())&&(!a||t.getTime()<=a.getTime())&&(!o||t.getFullYear()>=o)&&(!r||r>=t.getFullYear())},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,i,s){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var n=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(s,i,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),n,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).mousedown(e.datepicker._checkExternalClick),e.datepicker.initialized=!0),0===e("#"+e.datepicker._mainDivId).length&&e("body").append(e.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);return"string"!=typeof t||"isDisabled"!==t&&"getDate"!==t&&"widget"!==t?"option"===t&&2===arguments.length&&"string"==typeof arguments[1]?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i)):this.each(function(){"string"==typeof t?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(i)):e.datepicker._attachDatepicker(this,t)}):e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i))},e.datepicker=new n,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version="1.11.4",e.datepicker,e.widget("ui.draggable",e.ui.mouse,{version:"1.11.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),"handle"===e&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?(this.destroyOnClear=!0,void 0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),this._mouseDestroy(),void 0)},_mouseCapture:function(t){var i=this.options;return this._blurActiveElement(t),this.helper||i.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(this._blockFrames(i.iframeFix===!0?"iframe":i.iframeFix),!0):!1)},_blockFrames:function(t){this.iframeBlocks=this.document.find(t).map(function(){var t=e(this);return e("<div>").css("position","absolute").appendTo(t.parent()).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(t){var i=this.document[0];if(this.handleElement.is(t.target))try{i.activeElement&&"body"!==i.activeElement.nodeName.toLowerCase()&&e(i.activeElement).blur()}catch(s){}},_mouseStart:function(t){var i=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===e(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(t),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._normalizeRightBottom(),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_refreshOffsets:function(e){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:e.pageX-this.offset.left,top:e.pageY-this.offset.top}},_mouseDrag:function(t,i){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute"),!i){var s=this._uiHash();if(this._trigger("drag",t,s)===!1)return this._mouseUp({}),!1;this.position=s.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var i=this,s=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(s=e.ui.ddmanager.drop(this,t)),this.dropped&&(s=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!s||"valid"===this.options.revert&&s||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,s)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",t)!==!1&&i._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1},_mouseUp:function(t){return this._unblockFrames(),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),this.handleElement.is(t.target)&&this.element.focus(),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(t){var i=this.options,s=e.isFunction(i.helper),n=s?e(i.helper.apply(this.element[0],[t])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return n.parents("body").length||n.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),s&&n[0]===this.element[0]&&this._setPositionRelative(),n[0]===this.element[0]||/(fixed|absolute)/.test(n.css("position"))||n.css("position","absolute"),n},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var t=this.offsetParent.offset(),i=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==i&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,s,n=this.options,a=this.document[0];return this.relativeContainer=null,n.containment?"window"===n.containment?(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||a.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):"document"===n.containment?(this.containment=[0,0,e(a).width()-this.helperProportions.width-this.margins.left,(e(a).height()||a.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):n.containment.constructor===Array?(this.containment=n.containment,void 0):("parent"===n.containment&&(n.containment=this.helper[0].parentNode),i=e(n.containment),s=i[0],s&&(t=/(scroll|auto)/.test(i.css("overflow")),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(t?Math.max(s.scrollWidth,s.offsetWidth):s.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(s.scrollHeight,s.offsetHeight):s.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=i),void 0):(this.containment=null,void 0)},_convertPositionTo:function(e,t){t||(t=this.position);var i="absolute"===e?1:-1,s=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:s?0:this.offset.scroll.top)*i,left:t.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:s?0:this.offset.scroll.left)*i}},_generatePosition:function(e,t){var i,s,n,a,o=this.options,r=this._isRootNode(this.scrollParent[0]),h=e.pageX,l=e.pageY;return r&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(this.relativeContainer?(s=this.relativeContainer.offset(),i=[this.containment[0]+s.left,this.containment[1]+s.top,this.containment[2]+s.left,this.containment[3]+s.top]):i=this.containment,e.pageX-this.offset.click.left<i[0]&&(h=i[0]+this.offset.click.left),e.pageY-this.offset.click.top<i[1]&&(l=i[1]+this.offset.click.top),e.pageX-this.offset.click.left>i[2]&&(h=i[2]+this.offset.click.left),e.pageY-this.offset.click.top>i[3]&&(l=i[3]+this.offset.click.top)),o.grid&&(n=o.grid[1]?this.originalPageY+Math.round((l-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,l=i?n-this.offset.click.top>=i[1]||n-this.offset.click.top>i[3]?n:n-this.offset.click.top>=i[1]?n-o.grid[1]:n+o.grid[1]:n,a=o.grid[0]?this.originalPageX+Math.round((h-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,h=i?a-this.offset.click.left>=i[0]||a-this.offset.click.left>i[2]?a:a-this.offset.click.left>=i[0]?a-o.grid[0]:a+o.grid[0]:a),"y"===o.axis&&(h=this.originalPageX),"x"===o.axis&&(l=this.originalPageY)),{top:l-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:r?0:this.offset.scroll.top),left:h-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:r?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(t,i,s){return s=s||this._uiHash(),e.ui.plugin.call(this,t,[i,s,this],!0),/^(drag|start|stop)/.test(t)&&(this.positionAbs=this._convertPositionTo("absolute"),s.offset=this.positionAbs),e.Widget.prototype._trigger.call(this,t,i,s)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,i,s){var n=e.extend({},i,{item:s.element});s.sortables=[],e(s.options.connectToSortable).each(function(){var i=e(this).sortable("instance");i&&!i.options.disabled&&(s.sortables.push(i),i.refreshPositions(),i._trigger("activate",t,n))})},stop:function(t,i,s){var n=e.extend({},i,{item:s.element});s.cancelHelperRemoval=!1,e.each(s.sortables,function(){var e=this;e.isOver?(e.isOver=0,s.cancelHelperRemoval=!0,e.cancelHelperRemoval=!1,e._storedCSS={position:e.placeholder.css("position"),top:e.placeholder.css("top"),left:e.placeholder.css("left")},e._mouseStop(t),e.options.helper=e.options._helper):(e.cancelHelperRemoval=!0,e._trigger("deactivate",t,n))})},drag:function(t,i,s){e.each(s.sortables,function(){var n=!1,a=this;a.positionAbs=s.positionAbs,a.helperProportions=s.helperProportions,a.offset.click=s.offset.click,a._intersectsWith(a.containerCache)&&(n=!0,e.each(s.sortables,function(){return this.positionAbs=s.positionAbs,this.helperProportions=s.helperProportions,this.offset.click=s.offset.click,this!==a&&this._intersectsWith(this.containerCache)&&e.contains(a.element[0],this.element[0])&&(n=!1),n})),n?(a.isOver||(a.isOver=1,s._parent=i.helper.parent(),a.currentItem=i.helper.appendTo(a.element).data("ui-sortable-item",!0),a.options._helper=a.options.helper,a.options.helper=function(){return i.helper[0]},t.target=a.currentItem[0],a._mouseCapture(t,!0),a._mouseStart(t,!0,!0),a.offset.click.top=s.offset.click.top,a.offset.click.left=s.offset.click.left,a.offset.parent.left-=s.offset.parent.left-a.offset.parent.left,a.offset.parent.top-=s.offset.parent.top-a.offset.parent.top,s._trigger("toSortable",t),s.dropped=a.element,e.each(s.sortables,function(){this.refreshPositions()}),s.currentItem=s.element,a.fromOutside=s),a.currentItem&&(a._mouseDrag(t),i.position=a.position)):a.isOver&&(a.isOver=0,a.cancelHelperRemoval=!0,a.options._revert=a.options.revert,a.options.revert=!1,a._trigger("out",t,a._uiHash(a)),a._mouseStop(t,!0),a.options.revert=a.options._revert,a.options.helper=a.options._helper,a.placeholder&&a.placeholder.remove(),i.helper.appendTo(s._parent),s._refreshOffsets(t),i.position=s._generatePosition(t,!0),s._trigger("fromSortable",t),s.dropped=!1,e.each(s.sortables,function(){this.refreshPositions()}))})}}),e.ui.plugin.add("draggable","cursor",{start:function(t,i,s){var n=e("body"),a=s.options;n.css("cursor")&&(a._cursor=n.css("cursor")),n.css("cursor",a.cursor)},stop:function(t,i,s){var n=s.options;n._cursor&&e("body").css("cursor",n._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,i,s){var n=e(i.helper),a=s.options;n.css("opacity")&&(a._opacity=n.css("opacity")),n.css("opacity",a.opacity)},stop:function(t,i,s){var n=s.options;n._opacity&&e(i.helper).css("opacity",n._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(e,t,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(t,i,s){var n=s.options,a=!1,o=s.scrollParentNotHidden[0],r=s.document[0];o!==r&&"HTML"!==o.tagName?(n.axis&&"x"===n.axis||(s.overflowOffset.top+o.offsetHeight-t.pageY<n.scrollSensitivity?o.scrollTop=a=o.scrollTop+n.scrollSpeed:t.pageY-s.overflowOffset.top<n.scrollSensitivity&&(o.scrollTop=a=o.scrollTop-n.scrollSpeed)),n.axis&&"y"===n.axis||(s.overflowOffset.left+o.offsetWidth-t.pageX<n.scrollSensitivity?o.scrollLeft=a=o.scrollLeft+n.scrollSpeed:t.pageX-s.overflowOffset.left<n.scrollSensitivity&&(o.scrollLeft=a=o.scrollLeft-n.scrollSpeed))):(n.axis&&"x"===n.axis||(t.pageY-e(r).scrollTop()<n.scrollSensitivity?a=e(r).scrollTop(e(r).scrollTop()-n.scrollSpeed):e(window).height()-(t.pageY-e(r).scrollTop())<n.scrollSensitivity&&(a=e(r).scrollTop(e(r).scrollTop()+n.scrollSpeed))),n.axis&&"y"===n.axis||(t.pageX-e(r).scrollLeft()<n.scrollSensitivity?a=e(r).scrollLeft(e(r).scrollLeft()-n.scrollSpeed):e(window).width()-(t.pageX-e(r).scrollLeft())<n.scrollSensitivity&&(a=e(r).scrollLeft(e(r).scrollLeft()+n.scrollSpeed)))),a!==!1&&e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(s,t)}}),e.ui.plugin.add("draggable","snap",{start:function(t,i,s){var n=s.options;s.snapElements=[],e(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var t=e(this),i=t.offset();this!==s.element[0]&&s.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:i.top,left:i.left})})},drag:function(t,i,s){var n,a,o,r,h,l,u,d,c,p,f=s.options,m=f.snapTolerance,g=i.offset.left,v=g+s.helperProportions.width,y=i.offset.top,b=y+s.helperProportions.height;for(c=s.snapElements.length-1;c>=0;c--)h=s.snapElements[c].left-s.margins.left,l=h+s.snapElements[c].width,u=s.snapElements[c].top-s.margins.top,d=u+s.snapElements[c].height,h-m>v||g>l+m||u-m>b||y>d+m||!e.contains(s.snapElements[c].item.ownerDocument,s.snapElements[c].item)?(s.snapElements[c].snapping&&s.options.snap.release&&s.options.snap.release.call(s.element,t,e.extend(s._uiHash(),{snapItem:s.snapElements[c].item})),s.snapElements[c].snapping=!1):("inner"!==f.snapMode&&(n=m>=Math.abs(u-b),a=m>=Math.abs(d-y),o=m>=Math.abs(h-v),r=m>=Math.abs(l-g),n&&(i.position.top=s._convertPositionTo("relative",{top:u-s.helperProportions.height,left:0}).top),a&&(i.position.top=s._convertPositionTo("relative",{top:d,left:0}).top),o&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h-s.helperProportions.width}).left),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l}).left)),p=n||a||o||r,"outer"!==f.snapMode&&(n=m>=Math.abs(u-y),a=m>=Math.abs(d-b),o=m>=Math.abs(h-g),r=m>=Math.abs(l-v),n&&(i.position.top=s._convertPositionTo("relative",{top:u,left:0}).top),a&&(i.position.top=s._convertPositionTo("relative",{top:d-s.helperProportions.height,left:0}).top),o&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h}).left),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l-s.helperProportions.width}).left)),!s.snapElements[c].snapping&&(n||a||o||r||p)&&s.options.snap.snap&&s.options.snap.snap.call(s.element,t,e.extend(s._uiHash(),{snapItem:s.snapElements[c].item})),s.snapElements[c].snapping=n||a||o||r||p)}}),e.ui.plugin.add("draggable","stack",{start:function(t,i,s){var n,a=s.options,o=e.makeArray(e(a.stack)).sort(function(t,i){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(i).css("zIndex"),10)||0)});o.length&&(n=parseInt(e(o[0]).css("zIndex"),10)||0,e(o).each(function(t){e(this).css("zIndex",n+t)}),this.css("zIndex",n+o.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,i,s){var n=e(i.helper),a=s.options;n.css("zIndex")&&(a._zIndex=n.css("zIndex")),n.css("zIndex",a.zIndex)},stop:function(t,i,s){var n=s.options;n._zIndex&&e(i.helper).css("zIndex",n._zIndex)}}),e.ui.draggable,e.widget("ui.resizable",e.ui.mouse,{version:"1.11.4",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(e){return parseInt(e,10)||0},_isNumber:function(e){return!isNaN(parseInt(e,10))},_hasScroll:function(t,i){if("hidden"===e(t).css("overflow"))return!1;var s=i&&"left"===i?"scrollLeft":"scrollTop",n=!1;return t[s]>0?!0:(t[s]=1,n=t[s]>0,t[s]=0,n)},_create:function(){var t,i,s,n,a,o=this,r=this.options;if(this.element.addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!r.aspectRatio,aspectRatio:r.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:r.helper||r.ghost||r.animate?r.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(e("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=r.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=e(),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),t=this.handles.split(","),this.handles={},i=0;t.length>i;i++)s=e.trim(t[i]),a="ui-resizable-"+s,n=e("<div class='ui-resizable-handle "+a+"'></div>"),n.css({zIndex:r.zIndex}),"se"===s&&n.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[s]=".ui-resizable-"+s,this.element.append(n);this._renderAxis=function(t){var i,s,n,a;t=t||this.element;for(i in this.handles)this.handles[i].constructor===String?this.handles[i]=this.element.children(this.handles[i]).first().show():(this.handles[i].jquery||this.handles[i].nodeType)&&(this.handles[i]=e(this.handles[i]),this._on(this.handles[i],{mousedown:o._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(s=e(this.handles[i],this.element),a=/sw|ne|nw|se|n|s/.test(i)?s.outerHeight():s.outerWidth(),n=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),t.css(n,a),this._proportionallyResize()),this._handles=this._handles.add(this.handles[i])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.mouseover(function(){o.resizing||(this.className&&(n=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),o.axis=n&&n[1]?n[1]:"se")}),r.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").mouseenter(function(){r.disabled||(e(this).removeClass("ui-resizable-autohide"),o._handles.show())}).mouseleave(function(){r.disabled||o.resizing||(e(this).addClass("ui-resizable-autohide"),o._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t,i=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(i(this.element),t=this.element,this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t),t.remove()),this.originalElement.css("resize",this.originalResizeStyle),i(this.originalElement),this},_mouseCapture:function(t){var i,s,n=!1;for(i in this.handles)s=e(this.handles[i])[0],(s===t.target||e.contains(s,t.target))&&(n=!0);return!this.options.disabled&&n},_mouseStart:function(t){var i,s,n,a=this.options,o=this.element;return this.resizing=!0,this._renderProxy(),i=this._num(this.helper.css("left")),s=this._num(this.helper.css("top")),a.containment&&(i+=e(a.containment).scrollLeft()||0,s+=e(a.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:i,top:s},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:o.width(),height:o.height()},this.originalSize=this._helper?{width:o.outerWidth(),height:o.outerHeight()}:{width:o.width(),height:o.height()},this.sizeDiff={width:o.outerWidth()-o.width(),height:o.outerHeight()-o.height()},this.originalPosition={left:i,top:s},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio="number"==typeof a.aspectRatio?a.aspectRatio:this.originalSize.width/this.originalSize.height||1,n=e(".ui-resizable-"+this.axis).css("cursor"),e("body").css("cursor","auto"===n?this.axis+"-resize":n),o.addClass("ui-resizable-resizing"),this._propagate("start",t),!0},_mouseDrag:function(t){var i,s,n=this.originalMousePosition,a=this.axis,o=t.pageX-n.left||0,r=t.pageY-n.top||0,h=this._change[a];return this._updatePrevProperties(),h?(i=h.apply(this,[t,o,r]),this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(i=this._updateRatio(i,t)),i=this._respectSize(i,t),this._updateCache(i),this._propagate("resize",t),s=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),e.isEmptyObject(s)||(this._updatePrevProperties(),this._trigger("resize",t,this.ui()),this._applyChanges()),!1):!1},_mouseStop:function(t){this.resizing=!1;var i,s,n,a,o,r,h,l=this.options,u=this;return this._helper&&(i=this._proportionallyResizeElements,s=i.length&&/textarea/i.test(i[0].nodeName),n=s&&this._hasScroll(i[0],"left")?0:u.sizeDiff.height,a=s?0:u.sizeDiff.width,o={width:u.helper.width()-a,height:u.helper.height()-n},r=parseInt(u.element.css("left"),10)+(u.position.left-u.originalPosition.left)||null,h=parseInt(u.element.css("top"),10)+(u.position.top-u.originalPosition.top)||null,l.animate||this.element.css(e.extend(o,{top:h,left:r})),u.helper.height(u.size.height),u.helper.width(u.size.width),this._helper&&!l.animate&&this._proportionallyResize()),e("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var e={};return this.position.top!==this.prevPosition.top&&(e.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(e.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(e.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(e.height=this.size.height+"px"),this.helper.css(e),e},_updateVirtualBoundaries:function(e){var t,i,s,n,a,o=this.options;a={minWidth:this._isNumber(o.minWidth)?o.minWidth:0,maxWidth:this._isNumber(o.maxWidth)?o.maxWidth:1/0,minHeight:this._isNumber(o.minHeight)?o.minHeight:0,maxHeight:this._isNumber(o.maxHeight)?o.maxHeight:1/0},(this._aspectRatio||e)&&(t=a.minHeight*this.aspectRatio,s=a.minWidth/this.aspectRatio,i=a.maxHeight*this.aspectRatio,n=a.maxWidth/this.aspectRatio,t>a.minWidth&&(a.minWidth=t),s>a.minHeight&&(a.minHeight=s),a.maxWidth>i&&(a.maxWidth=i),a.maxHeight>n&&(a.maxHeight=n)),this._vBoundaries=a},_updateCache:function(e){this.offset=this.helper.offset(),this._isNumber(e.left)&&(this.position.left=e.left),this._isNumber(e.top)&&(this.position.top=e.top),this._isNumber(e.height)&&(this.size.height=e.height),this._isNumber(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,i=this.size,s=this.axis;return this._isNumber(e.height)?e.width=e.height*this.aspectRatio:this._isNumber(e.width)&&(e.height=e.width/this.aspectRatio),"sw"===s&&(e.left=t.left+(i.width-e.width),e.top=null),"nw"===s&&(e.top=t.top+(i.height-e.height),e.left=t.left+(i.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,i=this.axis,s=this._isNumber(e.width)&&t.maxWidth&&t.maxWidth<e.width,n=this._isNumber(e.height)&&t.maxHeight&&t.maxHeight<e.height,a=this._isNumber(e.width)&&t.minWidth&&t.minWidth>e.width,o=this._isNumber(e.height)&&t.minHeight&&t.minHeight>e.height,r=this.originalPosition.left+this.originalSize.width,h=this.position.top+this.size.height,l=/sw|nw|w/.test(i),u=/nw|ne|n/.test(i);return a&&(e.width=t.minWidth),o&&(e.height=t.minHeight),s&&(e.width=t.maxWidth),n&&(e.height=t.maxHeight),a&&l&&(e.left=r-t.minWidth),s&&l&&(e.left=r-t.maxWidth),o&&u&&(e.top=h-t.minHeight),n&&u&&(e.top=h-t.maxHeight),e.width||e.height||e.left||!e.top?e.width||e.height||e.top||!e.left||(e.left=null):e.top=null,e},_getPaddingPlusBorderDimensions:function(e){for(var t=0,i=[],s=[e.css("borderTopWidth"),e.css("borderRightWidth"),e.css("borderBottomWidth"),e.css("borderLeftWidth")],n=[e.css("paddingTop"),e.css("paddingRight"),e.css("paddingBottom"),e.css("paddingLeft")];4>t;t++)i[t]=parseInt(s[t],10)||0,i[t]+=parseInt(n[t],10)||0;return{height:i[0]+i[2],width:i[1]+i[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var e,t=0,i=this.helper||this.element;this._proportionallyResizeElements.length>t;t++)e=this._proportionallyResizeElements[t],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(e)),e.css({height:i.height()-this.outerDimensions.height||0,width:i.width()-this.outerDimensions.width||0})},_renderProxy:function(){var t=this.element,i=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||e("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++i.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var i=this.originalSize,s=this.originalPosition;return{left:s.left+t,width:i.width-t}},n:function(e,t,i){var s=this.originalSize,n=this.originalPosition;return{top:n.top+i,height:s.height-i}},s:function(e,t,i){return{height:this.originalSize.height+i}},se:function(t,i,s){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,i,s]))},sw:function(t,i,s){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,i,s]))},ne:function(t,i,s){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,i,s]))},nw:function(t,i,s){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,i,s]))}},_propagate:function(t,i){e.ui.plugin.call(this,t,[i,this.ui()]),"resize"!==t&&this._trigger(t,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.ui.plugin.add("resizable","animate",{stop:function(t){var i=e(this).resizable("instance"),s=i.options,n=i._proportionallyResizeElements,a=n.length&&/textarea/i.test(n[0].nodeName),o=a&&i._hasScroll(n[0],"left")?0:i.sizeDiff.height,r=a?0:i.sizeDiff.width,h={width:i.size.width-r,height:i.size.height-o},l=parseInt(i.element.css("left"),10)+(i.position.left-i.originalPosition.left)||null,u=parseInt(i.element.css("top"),10)+(i.position.top-i.originalPosition.top)||null;i.element.animate(e.extend(h,u&&l?{top:u,left:l}:{}),{duration:s.animateDuration,easing:s.animateEasing,step:function(){var s={width:parseInt(i.element.css("width"),10),height:parseInt(i.element.css("height"),10),top:parseInt(i.element.css("top"),10),left:parseInt(i.element.css("left"),10)};n&&n.length&&e(n[0]).css({width:s.width,height:s.height}),i._updateCache(s),i._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(){var t,i,s,n,a,o,r,h=e(this).resizable("instance"),l=h.options,u=h.element,d=l.containment,c=d instanceof e?d.get(0):/parent/.test(d)?u.parent().get(0):d;c&&(h.containerElement=e(c),/document/.test(d)||d===document?(h.containerOffset={left:0,top:0},h.containerPosition={left:0,top:0},h.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}):(t=e(c),i=[],e(["Top","Right","Left","Bottom"]).each(function(e,s){i[e]=h._num(t.css("padding"+s))}),h.containerOffset=t.offset(),h.containerPosition=t.position(),h.containerSize={height:t.innerHeight()-i[3],width:t.innerWidth()-i[1]},s=h.containerOffset,n=h.containerSize.height,a=h.containerSize.width,o=h._hasScroll(c,"left")?c.scrollWidth:a,r=h._hasScroll(c)?c.scrollHeight:n,h.parentData={element:c,left:s.left,top:s.top,width:o,height:r}))},resize:function(t){var i,s,n,a,o=e(this).resizable("instance"),r=o.options,h=o.containerOffset,l=o.position,u=o._aspectRatio||t.shiftKey,d={top:0,left:0},c=o.containerElement,p=!0;c[0]!==document&&/static/.test(c.css("position"))&&(d=h),l.left<(o._helper?h.left:0)&&(o.size.width=o.size.width+(o._helper?o.position.left-h.left:o.position.left-d.left),u&&(o.size.height=o.size.width/o.aspectRatio,p=!1),o.position.left=r.helper?h.left:0),l.top<(o._helper?h.top:0)&&(o.size.height=o.size.height+(o._helper?o.position.top-h.top:o.position.top),u&&(o.size.width=o.size.height*o.aspectRatio,p=!1),o.position.top=o._helper?h.top:0),n=o.containerElement.get(0)===o.element.parent().get(0),a=/relative|absolute/.test(o.containerElement.css("position")),n&&a?(o.offset.left=o.parentData.left+o.position.left,o.offset.top=o.parentData.top+o.position.top):(o.offset.left=o.element.offset().left,o.offset.top=o.element.offset().top),i=Math.abs(o.sizeDiff.width+(o._helper?o.offset.left-d.left:o.offset.left-h.left)),s=Math.abs(o.sizeDiff.height+(o._helper?o.offset.top-d.top:o.offset.top-h.top)),i+o.size.width>=o.parentData.width&&(o.size.width=o.parentData.width-i,u&&(o.size.height=o.size.width/o.aspectRatio,p=!1)),s+o.size.height>=o.parentData.height&&(o.size.height=o.parentData.height-s,u&&(o.size.width=o.size.height*o.aspectRatio,p=!1)),p||(o.position.left=o.prevPosition.left,o.position.top=o.prevPosition.top,o.size.width=o.prevSize.width,o.size.height=o.prevSize.height)},stop:function(){var t=e(this).resizable("instance"),i=t.options,s=t.containerOffset,n=t.containerPosition,a=t.containerElement,o=e(t.helper),r=o.offset(),h=o.outerWidth()-t.sizeDiff.width,l=o.outerHeight()-t.sizeDiff.height;t._helper&&!i.animate&&/relative/.test(a.css("position"))&&e(this).css({left:r.left-n.left-s.left,width:h,height:l}),t._helper&&!i.animate&&/static/.test(a.css("position"))&&e(this).css({left:r.left-n.left-s.left,width:h,height:l})}}),e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).resizable("instance"),i=t.options;e(i.alsoResize).each(function(){var t=e(this);t.data("ui-resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})},resize:function(t,i){var s=e(this).resizable("instance"),n=s.options,a=s.originalSize,o=s.originalPosition,r={height:s.size.height-a.height||0,width:s.size.width-a.width||0,top:s.position.top-o.top||0,left:s.position.left-o.left||0};e(n.alsoResize).each(function(){var t=e(this),s=e(this).data("ui-resizable-alsoresize"),n={},a=t.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(a,function(e,t){var i=(s[t]||0)+(r[t]||0);i&&i>=0&&(n[t]=i||null)}),t.css(n)})},stop:function(){e(this).removeData("resizable-alsoresize")}}),e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).resizable("instance"),i=t.options,s=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:s.height,width:s.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof i.ghost?i.ghost:""),t.ghost.appendTo(t.helper)},resize:function(){var t=e(this).resizable("instance");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=e(this).resizable("instance");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(){var t,i=e(this).resizable("instance"),s=i.options,n=i.size,a=i.originalSize,o=i.originalPosition,r=i.axis,h="number"==typeof s.grid?[s.grid,s.grid]:s.grid,l=h[0]||1,u=h[1]||1,d=Math.round((n.width-a.width)/l)*l,c=Math.round((n.height-a.height)/u)*u,p=a.width+d,f=a.height+c,m=s.maxWidth&&p>s.maxWidth,g=s.maxHeight&&f>s.maxHeight,v=s.minWidth&&s.minWidth>p,y=s.minHeight&&s.minHeight>f;s.grid=h,v&&(p+=l),y&&(f+=u),m&&(p-=l),g&&(f-=u),/^(se|s|e)$/.test(r)?(i.size.width=p,i.size.height=f):/^(ne)$/.test(r)?(i.size.width=p,i.size.height=f,i.position.top=o.top-c):/^(sw)$/.test(r)?(i.size.width=p,i.size.height=f,i.position.left=o.left-d):((0>=f-u||0>=p-l)&&(t=i._getPaddingPlusBorderDimensions(this)),f-u>0?(i.size.height=f,i.position.top=o.top-c):(f=u-t.height,i.size.height=f,i.position.top=o.top+a.height-f),p-l>0?(i.size.width=p,i.position.left=o.left-d):(p=l-t.width,i.size.width=p,i.position.left=o.left+a.width-p))}}),e.ui.resizable,e.widget("ui.dialog",{version:"1.11.4",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"Close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var i=e(this).css(t).offset().top;0>i&&e(this).css("top",t.top-i)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&e.fn.draggable&&this._makeDraggable(),this.options.resizable&&e.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var t=this.options.appendTo;return t&&(t.jquery||t.nodeType)?e(t):this.document.find(t||"body").eq(0)},_destroy:function(){var e,t=this.originalPosition;this._untrackInstance(),this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),e=t.parent.children().eq(t.index),e.length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},disable:e.noop,enable:e.noop,close:function(t){var i,s=this;if(this._isOpen&&this._trigger("beforeClose",t)!==!1){if(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),!this.opener.filter(":focusable").focus().length)try{i=this.document[0].activeElement,i&&"body"!==i.nodeName.toLowerCase()&&e(i).blur()}catch(n){}this._hide(this.uiDialog,this.options.hide,function(){s._trigger("close",t)})}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(t,i){var s=!1,n=this.uiDialog.siblings(".ui-front:visible").map(function(){return+e(this).css("z-index")}).get(),a=Math.max.apply(null,n);return a>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",a+1),s=!0),s&&!i&&this._trigger("focus",t),s},open:function(){var t=this;return this._isOpen?(this._moveToTop()&&this._focusTabbable(),void 0):(this._isOpen=!0,this.opener=e(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){t._focusTabbable(),t._trigger("focus")}),this._makeFocusTarget(),this._trigger("open"),void 0)},_focusTabbable:function(){var e=this._focusedElement;e||(e=this.element.find("[autofocus]")),e.length||(e=this.element.find(":tabbable")),e.length||(e=this.uiDialogButtonPane.find(":tabbable")),e.length||(e=this.uiDialogTitlebarClose.filter(":tabbable")),e.length||(e=this.uiDialog),e.eq(0).focus()},_keepFocus:function(t){function i(){var t=this.document[0].activeElement,i=this.uiDialog[0]===t||e.contains(this.uiDialog[0],t);i||this._focusTabbable()}t.preventDefault(),i.call(this),this._delay(i)},_createWrapper:function(){this.uiDialog=e("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(t){if(this.options.closeOnEscape&&!t.isDefaultPrevented()&&t.keyCode&&t.keyCode===e.ui.keyCode.ESCAPE)return t.preventDefault(),this.close(t),void 0;if(t.keyCode===e.ui.keyCode.TAB&&!t.isDefaultPrevented()){var i=this.uiDialog.find(":tabbable"),s=i.filter(":first"),n=i.filter(":last");t.target!==n[0]&&t.target!==this.uiDialog[0]||t.shiftKey?t.target!==s[0]&&t.target!==this.uiDialog[0]||!t.shiftKey||(this._delay(function(){n.focus()}),t.preventDefault()):(this._delay(function(){s.focus()}),t.preventDefault())}},mousedown:function(e){this._moveToTop(e)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var t;this.uiDialogTitlebar=e("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(t){e(t.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=e("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(e){e.preventDefault(),this.close(e)}}),t=e("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(t),this.uiDialog.attr({"aria-labelledby":t.attr("id")})},_title:function(e){this.options.title||e.html("&#160;"),e.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=e("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=e("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var t=this,i=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),e.isEmptyObject(i)||e.isArray(i)&&!i.length?(this.uiDialog.removeClass("ui-dialog-buttons"),void 0):(e.each(i,function(i,s){var n,a;s=e.isFunction(s)?{click:s,text:i}:s,s=e.extend({type:"button"},s),n=s.click,s.click=function(){n.apply(t.element[0],arguments)},a={icons:s.icons,text:s.showText},delete s.icons,delete s.showText,e("<button></button>",s).button(a).appendTo(t.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog),void 0)},_makeDraggable:function(){function t(e){return{position:e.position,offset:e.offset}}var i=this,s=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(s,n){e(this).addClass("ui-dialog-dragging"),i._blockFrames(),i._trigger("dragStart",s,t(n))},drag:function(e,s){i._trigger("drag",e,t(s))},stop:function(n,a){var o=a.offset.left-i.document.scrollLeft(),r=a.offset.top-i.document.scrollTop();s.position={my:"left top",at:"left"+(o>=0?"+":"")+o+" "+"top"+(r>=0?"+":"")+r,of:i.window},e(this).removeClass("ui-dialog-dragging"),i._unblockFrames(),i._trigger("dragStop",n,t(a))}})},_makeResizable:function(){function t(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}var i=this,s=this.options,n=s.resizable,a=this.uiDialog.css("position"),o="string"==typeof n?n:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:s.maxWidth,maxHeight:s.maxHeight,minWidth:s.minWidth,minHeight:this._minHeight(),handles:o,start:function(s,n){e(this).addClass("ui-dialog-resizing"),i._blockFrames(),i._trigger("resizeStart",s,t(n))},resize:function(e,s){i._trigger("resize",e,t(s))},stop:function(n,a){var o=i.uiDialog.offset(),r=o.left-i.document.scrollLeft(),h=o.top-i.document.scrollTop();s.height=i.uiDialog.height(),s.width=i.uiDialog.width(),s.position={my:"left top",at:"left"+(r>=0?"+":"")+r+" "+"top"+(h>=0?"+":"")+h,of:i.window},e(this).removeClass("ui-dialog-resizing"),i._unblockFrames(),i._trigger("resizeStop",n,t(a))}}).css("position",a)},_trackFocus:function(){this._on(this.widget(),{focusin:function(t){this._makeFocusTarget(),this._focusedElement=e(t.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var t=this._trackingInstances(),i=e.inArray(this,t);-1!==i&&t.splice(i,1)},_trackingInstances:function(){var e=this.document.data("ui-dialog-instances");return e||(e=[],this.document.data("ui-dialog-instances",e)),e},_minHeight:function(){var e=this.options;return"auto"===e.height?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(){var e=this.uiDialog.is(":visible");e||this.uiDialog.show(),this.uiDialog.position(this.options.position),e||this.uiDialog.hide()},_setOptions:function(t){var i=this,s=!1,n={};e.each(t,function(e,t){i._setOption(e,t),e in i.sizeRelatedOptions&&(s=!0),e in i.resizableRelatedOptions&&(n[e]=t)}),s&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",n)},_setOption:function(e,t){var i,s,n=this.uiDialog;"dialogClass"===e&&n.removeClass(this.options.dialogClass).addClass(t),"disabled"!==e&&(this._super(e,t),"appendTo"===e&&this.uiDialog.appendTo(this._appendTo()),"buttons"===e&&this._createButtons(),"closeText"===e&&this.uiDialogTitlebarClose.button({label:""+t}),"draggable"===e&&(i=n.is(":data(ui-draggable)"),i&&!t&&n.draggable("destroy"),!i&&t&&this._makeDraggable()),"position"===e&&this._position(),"resizable"===e&&(s=n.is(":data(ui-resizable)"),s&&!t&&n.resizable("destroy"),s&&"string"==typeof t&&n.resizable("option","handles",t),s||t===!1||this._makeResizable()),"title"===e&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var e,t,i,s=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),s.minWidth>s.width&&(s.width=s.minWidth),e=this.uiDialog.css({height:"auto",width:s.width}).outerHeight(),t=Math.max(0,s.minHeight-e),i="number"==typeof s.maxHeight?Math.max(0,s.maxHeight-e):"none","auto"===s.height?this.element.css({minHeight:t,maxHeight:i,height:"auto"}):this.element.height(Math.max(0,s.height-e)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var t=e(this);return e("<div>").css({position:"absolute",width:t.outerWidth(),height:t.outerHeight()}).appendTo(t.parent()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(t){return e(t.target).closest(".ui-dialog").length?!0:!!e(t.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var t=!0;this._delay(function(){t=!1}),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(e){t||this._allowInteraction(e)||(e.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=e("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var e=this.document.data("ui-dialog-overlays")-1;e?this.document.data("ui-dialog-overlays",e):this.document.unbind("focusin").removeData("ui-dialog-overlays"),this.overlay.remove(),this.overlay=null}}}),e.widget("ui.droppable",{version:"1.11.4",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t,i=this.options,s=i.accept;this.isover=!1,this.isout=!0,this.accept=e.isFunction(s)?s:function(e){return e.is(s)},this.proportions=function(){return arguments.length?(t=arguments[0],void 0):t?t:t={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},this._addToManager(i.scope),i.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(t){e.ui.ddmanager.droppables[t]=e.ui.ddmanager.droppables[t]||[],e.ui.ddmanager.droppables[t].push(this)},_splice:function(e){for(var t=0;e.length>t;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var t=e.ui.ddmanager.droppables[this.options.scope];this._splice(t),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,i){if("accept"===t)this.accept=e.isFunction(i)?i:function(e){return e.is(i)};else if("scope"===t){var s=e.ui.ddmanager.droppables[this.options.scope];this._splice(s),this._addToManager(i)}this._super(t,i)},_activate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),i&&this._trigger("activate",t,this.ui(i))},_deactivate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),i&&this._trigger("deactivate",t,this.ui(i))},_over:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(i)))},_out:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(i)))},_drop:function(t,i){var s=i||e.ui.ddmanager.current,n=!1;return s&&(s.currentItem||s.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var i=e(this).droppable("instance");return i.options.greedy&&!i.options.disabled&&i.options.scope===s.options.scope&&i.accept.call(i.element[0],s.currentItem||s.element)&&e.ui.intersect(s,e.extend(i,{offset:i.element.offset()}),i.options.tolerance,t)?(n=!0,!1):void 0}),n?!1:this.accept.call(this.element[0],s.currentItem||s.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(s)),this.element):!1):!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),e.ui.intersect=function(){function e(e,t,i){return e>=t&&t+i>e}return function(t,i,s,n){if(!i.offset)return!1;var a=(t.positionAbs||t.position.absolute).left+t.margins.left,o=(t.positionAbs||t.position.absolute).top+t.margins.top,r=a+t.helperProportions.width,h=o+t.helperProportions.height,l=i.offset.left,u=i.offset.top,d=l+i.proportions().width,c=u+i.proportions().height;switch(s){case"fit":return a>=l&&d>=r&&o>=u&&c>=h;case"intersect":return a+t.helperProportions.width/2>l&&d>r-t.helperProportions.width/2&&o+t.helperProportions.height/2>u&&c>h-t.helperProportions.height/2;case"pointer":return e(n.pageY,u,i.proportions().height)&&e(n.pageX,l,i.proportions().width);case"touch":return(o>=u&&c>=o||h>=u&&c>=h||u>o&&h>c)&&(a>=l&&d>=a||r>=l&&d>=r||l>a&&r>d);default:return!1}}}(),e.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,i){var s,n,a=e.ui.ddmanager.droppables[t.options.scope]||[],o=i?i.type:null,r=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(s=0;a.length>s;s++)if(!(a[s].options.disabled||t&&!a[s].accept.call(a[s].element[0],t.currentItem||t.element))){for(n=0;r.length>n;n++)if(r[n]===a[s].element[0]){a[s].proportions().height=0;continue e}a[s].visible="none"!==a[s].element.css("display"),a[s].visible&&("mousedown"===o&&a[s]._activate.call(a[s],i),a[s].offset=a[s].element.offset(),a[s].proportions({width:a[s].element[0].offsetWidth,height:a[s].element[0].offsetHeight}))}},drop:function(t,i){var s=!1;return e.each((e.ui.ddmanager.droppables[t.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance,i)&&(s=this._drop.call(this,i)||s),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))}),s},dragStart:function(t,i){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)})},drag:function(t,i){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,i),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var s,n,a,o=e.ui.intersect(t,this,this.options.tolerance,i),r=!o&&this.isover?"isout":o&&!this.isover?"isover":null;r&&(this.options.greedy&&(n=this.options.scope,a=this.element.parents(":data(ui-droppable)").filter(function(){return e(this).droppable("instance").options.scope===n}),a.length&&(s=e(a[0]).droppable("instance"),s.greedyChild="isover"===r)),s&&"isover"===r&&(s.isover=!1,s.isout=!0,s._out.call(s,i)),this[r]=!0,this["isout"===r?"isover":"isout"]=!1,this["isover"===r?"_over":"_out"].call(this,i),s&&"isout"===r&&(s.isout=!1,s.isover=!0,s._over.call(s,i)))}})},dragStop:function(t,i){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)}},e.ui.droppable;var y="ui-effects-",b=e;e.effects={effect:{}},function(e,t){function i(e,t,i){var s=d[t.type]||{};return null==e?i||!t.def?null:t.def:(e=s.floor?~~e:parseFloat(e),isNaN(e)?t.def:s.mod?(e+s.mod)%s.mod:0>e?0:e>s.max?s.max:e)}function s(i){var s=l(),n=s._rgba=[];return i=i.toLowerCase(),f(h,function(e,a){var o,r=a.re.exec(i),h=r&&a.parse(r),l=a.space||"rgba";return h?(o=s[l](h),s[u[l].cache]=o[u[l].cache],n=s._rgba=o._rgba,!1):t}),n.length?("0,0,0,0"===n.join()&&e.extend(n,a.transparent),s):a[i]}function n(e,t,i){return i=(i+1)%1,1>6*i?e+6*(t-e)*i:1>2*i?t:2>3*i?e+6*(t-e)*(2/3-i):e}var a,o="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",r=/^([\-+])=\s*(\d+\.?\d*)/,h=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],l=e.Color=function(t,i,s,n){return new e.Color.fn.parse(t,i,s,n)},u={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},d={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},c=l.support={},p=e("<p>")[0],f=e.each;p.style.cssText="background-color:rgba(1,1,1,.5)",c.rgba=p.style.backgroundColor.indexOf("rgba")>-1,f(u,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),l.fn=e.extend(l.prototype,{parse:function(n,o,r,h){if(n===t)return this._rgba=[null,null,null,null],this;(n.jquery||n.nodeType)&&(n=e(n).css(o),o=t);var d=this,c=e.type(n),p=this._rgba=[];return o!==t&&(n=[n,o,r,h],c="array"),"string"===c?this.parse(s(n)||a._default):"array"===c?(f(u.rgba.props,function(e,t){p[t.idx]=i(n[t.idx],t)}),this):"object"===c?(n instanceof l?f(u,function(e,t){n[t.cache]&&(d[t.cache]=n[t.cache].slice())}):f(u,function(t,s){var a=s.cache;f(s.props,function(e,t){if(!d[a]&&s.to){if("alpha"===e||null==n[e])return;d[a]=s.to(d._rgba)}d[a][t.idx]=i(n[e],t,!0)}),d[a]&&0>e.inArray(null,d[a].slice(0,3))&&(d[a][3]=1,s.from&&(d._rgba=s.from(d[a])))}),this):t},is:function(e){var i=l(e),s=!0,n=this;return f(u,function(e,a){var o,r=i[a.cache];return r&&(o=n[a.cache]||a.to&&a.to(n._rgba)||[],f(a.props,function(e,i){return null!=r[i.idx]?s=r[i.idx]===o[i.idx]:t})),s}),s},_space:function(){var e=[],t=this;return f(u,function(i,s){t[s.cache]&&e.push(i)}),e.pop()},transition:function(e,t){var s=l(e),n=s._space(),a=u[n],o=0===this.alpha()?l("transparent"):this,r=o[a.cache]||a.to(o._rgba),h=r.slice();return s=s[a.cache],f(a.props,function(e,n){var a=n.idx,o=r[a],l=s[a],u=d[n.type]||{};null!==l&&(null===o?h[a]=l:(u.mod&&(l-o>u.mod/2?o+=u.mod:o-l>u.mod/2&&(o-=u.mod)),h[a]=i((l-o)*t+o,n)))}),this[n](h)},blend:function(t){if(1===this._rgba[3])return this;var i=this._rgba.slice(),s=i.pop(),n=l(t)._rgba;return l(e.map(i,function(e,t){return(1-s)*n[t]+s*e}))},toRgbaString:function(){var t="rgba(",i=e.map(this._rgba,function(e,t){return null==e?t>2?1:0:e});return 1===i[3]&&(i.pop(),t="rgb("),t+i.join()+")"},toHslaString:function(){var t="hsla(",i=e.map(this.hsla(),function(e,t){return null==e&&(e=t>2?1:0),t&&3>t&&(e=Math.round(100*e)+"%"),e});return 1===i[3]&&(i.pop(),t="hsl("),t+i.join()+")"},toHexString:function(t){var i=this._rgba.slice(),s=i.pop();return t&&i.push(~~(255*s)),"#"+e.map(i,function(e){return e=(e||0).toString(16),1===e.length?"0"+e:e}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),l.fn.parse.prototype=l.fn,u.hsla.to=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t,i,s=e[0]/255,n=e[1]/255,a=e[2]/255,o=e[3],r=Math.max(s,n,a),h=Math.min(s,n,a),l=r-h,u=r+h,d=.5*u;return t=h===r?0:s===r?60*(n-a)/l+360:n===r?60*(a-s)/l+120:60*(s-n)/l+240,i=0===l?0:.5>=d?l/u:l/(2-u),[Math.round(t)%360,i,d,null==o?1:o]},u.hsla.from=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t=e[0]/360,i=e[1],s=e[2],a=e[3],o=.5>=s?s*(1+i):s+i-s*i,r=2*s-o;return[Math.round(255*n(r,o,t+1/3)),Math.round(255*n(r,o,t)),Math.round(255*n(r,o,t-1/3)),a]},f(u,function(s,n){var a=n.props,o=n.cache,h=n.to,u=n.from;l.fn[s]=function(s){if(h&&!this[o]&&(this[o]=h(this._rgba)),s===t)return this[o].slice();var n,r=e.type(s),d="array"===r||"object"===r?s:arguments,c=this[o].slice();return f(a,function(e,t){var s=d["object"===r?e:t.idx];null==s&&(s=c[t.idx]),c[t.idx]=i(s,t)}),u?(n=l(u(c)),n[o]=c,n):l(c)},f(a,function(t,i){l.fn[t]||(l.fn[t]=function(n){var a,o=e.type(n),h="alpha"===t?this._hsla?"hsla":"rgba":s,l=this[h](),u=l[i.idx];return"undefined"===o?u:("function"===o&&(n=n.call(this,u),o=e.type(n)),null==n&&i.empty?this:("string"===o&&(a=r.exec(n),a&&(n=u+parseFloat(a[2])*("+"===a[1]?1:-1))),l[i.idx]=n,this[h](l)))})})}),l.hook=function(t){var i=t.split(" ");f(i,function(t,i){e.cssHooks[i]={set:function(t,n){var a,o,r="";if("transparent"!==n&&("string"!==e.type(n)||(a=s(n)))){if(n=l(a||n),!c.rgba&&1!==n._rgba[3]){for(o="backgroundColor"===i?t.parentNode:t;(""===r||"transparent"===r)&&o&&o.style;)try{r=e.css(o,"backgroundColor"),o=o.parentNode}catch(h){}n=n.blend(r&&"transparent"!==r?r:"_default")}n=n.toRgbaString()}try{t.style[i]=n}catch(h){}}},e.fx.step[i]=function(t){t.colorInit||(t.start=l(t.elem,i),t.end=l(t.end),t.colorInit=!0),e.cssHooks[i].set(t.elem,t.start.transition(t.end,t.pos))}})},l.hook(o),e.cssHooks.borderColor={expand:function(e){var t={};return f(["Top","Right","Bottom","Left"],function(i,s){t["border"+s+"Color"]=e}),t}},a=e.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(b),function(){function t(t){var i,s,n=t.ownerDocument.defaultView?t.ownerDocument.defaultView.getComputedStyle(t,null):t.currentStyle,a={};if(n&&n.length&&n[0]&&n[n[0]])for(s=n.length;s--;)i=n[s],"string"==typeof n[i]&&(a[e.camelCase(i)]=n[i]);else for(i in n)"string"==typeof n[i]&&(a[i]=n[i]);return a}function i(t,i){var s,a,o={};for(s in i)a=i[s],t[s]!==a&&(n[s]||(e.fx.step[s]||!isNaN(parseFloat(a)))&&(o[s]=a));return o}var s=["add","remove","toggle"],n={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};e.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(t,i){e.fx.step[i]=function(e){("none"!==e.end&&!e.setAttr||1===e.pos&&!e.setAttr)&&(b.style(e.elem,i,e.end),e.setAttr=!0)}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e.effects.animateClass=function(n,a,o,r){var h=e.speed(a,o,r);return this.queue(function(){var a,o=e(this),r=o.attr("class")||"",l=h.children?o.find("*").addBack():o;l=l.map(function(){var i=e(this);return{el:i,start:t(this)}}),a=function(){e.each(s,function(e,t){n[t]&&o[t+"Class"](n[t])})},a(),l=l.map(function(){return this.end=t(this.el[0]),this.diff=i(this.start,this.end),this}),o.attr("class",r),l=l.map(function(){var t=this,i=e.Deferred(),s=e.extend({},h,{queue:!1,complete:function(){i.resolve(t)}});return this.el.animate(this.diff,s),i.promise()}),e.when.apply(e,l.get()).done(function(){a(),e.each(arguments,function(){var t=this.el;e.each(this.diff,function(e){t.css(e,"")})}),h.complete.call(o[0])})})},e.fn.extend({addClass:function(t){return function(i,s,n,a){return s?e.effects.animateClass.call(this,{add:i},s,n,a):t.apply(this,arguments)}}(e.fn.addClass),removeClass:function(t){return function(i,s,n,a){return arguments.length>1?e.effects.animateClass.call(this,{remove:i},s,n,a):t.apply(this,arguments)}}(e.fn.removeClass),toggleClass:function(t){return function(i,s,n,a,o){return"boolean"==typeof s||void 0===s?n?e.effects.animateClass.call(this,s?{add:i}:{remove:i},n,a,o):t.apply(this,arguments):e.effects.animateClass.call(this,{toggle:i},s,n,a)}}(e.fn.toggleClass),switchClass:function(t,i,s,n,a){return e.effects.animateClass.call(this,{add:i,remove:t},s,n,a)}})}(),function(){function t(t,i,s,n){return e.isPlainObject(t)&&(i=t,t=t.effect),t={effect:t},null==i&&(i={}),e.isFunction(i)&&(n=i,s=null,i={}),("number"==typeof i||e.fx.speeds[i])&&(n=s,s=i,i={}),e.isFunction(s)&&(n=s,s=null),i&&e.extend(t,i),s=s||i.duration,t.duration=e.fx.off?0:"number"==typeof s?s:s in e.fx.speeds?e.fx.speeds[s]:e.fx.speeds._default,t.complete=n||i.complete,t}function i(t){return!t||"number"==typeof t||e.fx.speeds[t]?!0:"string"!=typeof t||e.effects.effect[t]?e.isFunction(t)?!0:"object"!=typeof t||t.effect?!1:!0:!0}e.extend(e.effects,{version:"1.11.4",save:function(e,t){for(var i=0;t.length>i;i++)null!==t[i]&&e.data(y+t[i],e[0].style[t[i]])},restore:function(e,t){var i,s;for(s=0;t.length>s;s++)null!==t[s]&&(i=e.data(y+t[s]),void 0===i&&(i=""),e.css(t[s],i))},setMode:function(e,t){return"toggle"===t&&(t=e.is(":hidden")?"show":"hide"),t},getBaseline:function(e,t){var i,s;switch(e[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=e[0]/t.height}switch(e[1]){case"left":s=0;break;case"center":s=.5;break;case"right":s=1;break;default:s=e[1]/t.width}return{x:s,y:i}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var i={width:t.outerWidth(!0),height:t.outerHeight(!0),"float":t.css("float")},s=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),n={width:t.width(),height:t.height()},a=document.activeElement;try{a.id}catch(o){a=document.body}return t.wrap(s),(t[0]===a||e.contains(t[0],a))&&e(a).focus(),s=t.parent(),"static"===t.css("position")?(s.css({position:"relative"}),t.css({position:"relative"})):(e.extend(i,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],function(e,s){i[s]=t.css(s),isNaN(parseInt(i[s],10))&&(i[s]="auto")}),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),t.css(n),s.css(i).show()},removeWrapper:function(t){var i=document.activeElement;return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),(t[0]===i||e.contains(t[0],i))&&e(i).focus()),t},setTransition:function(t,i,s,n){return n=n||{},e.each(i,function(e,i){var a=t.cssUnit(i);a[0]>0&&(n[i]=a[0]*s+a[1])}),n}}),e.fn.extend({effect:function(){function i(t){function i(){e.isFunction(a)&&a.call(n[0]),e.isFunction(t)&&t()}var n=e(this),a=s.complete,r=s.mode;(n.is(":hidden")?"hide"===r:"show"===r)?(n[r](),i()):o.call(n[0],s,i)}var s=t.apply(this,arguments),n=s.mode,a=s.queue,o=e.effects.effect[s.effect];return e.fx.off||!o?n?this[n](s.duration,s.complete):this.each(function(){s.complete&&s.complete.call(this)}):a===!1?this.each(i):this.queue(a||"fx",i)},show:function(e){return function(s){if(i(s))return e.apply(this,arguments);var n=t.apply(this,arguments);return n.mode="show",this.effect.call(this,n)}}(e.fn.show),hide:function(e){return function(s){if(i(s))return e.apply(this,arguments);var n=t.apply(this,arguments);return n.mode="hide",this.effect.call(this,n)}}(e.fn.hide),toggle:function(e){return function(s){if(i(s)||"boolean"==typeof s)return e.apply(this,arguments);var n=t.apply(this,arguments);return n.mode="toggle",this.effect.call(this,n)}}(e.fn.toggle),cssUnit:function(t){var i=this.css(t),s=[];return e.each(["em","px","%","pt"],function(e,t){i.indexOf(t)>0&&(s=[parseFloat(i),t])}),s}})}(),function(){var t={};e.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,i){t[i]=function(t){return Math.pow(t,e+2)}}),e.extend(t,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return 0===e||1===e?e:-Math.pow(2,8*(e-1))*Math.sin((80*(e-1)-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){for(var t,i=4;((t=Math.pow(2,--i))-1)/11>e;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*t-2)/22-e,2)}}),e.each(t,function(t,i){e.easing["easeIn"+t]=i,e.easing["easeOut"+t]=function(e){return 1-i(1-e)},e.easing["easeInOut"+t]=function(e){return.5>e?i(2*e)/2:1-i(-2*e+2)/2}})}(),e.effects,e.effects.effect.blind=function(t,i){var s,n,a,o=e(this),r=/up|down|vertical/,h=/up|left|vertical|horizontal/,l=["position","top","bottom","left","right","height","width"],u=e.effects.setMode(o,t.mode||"hide"),d=t.direction||"up",c=r.test(d),p=c?"height":"width",f=c?"top":"left",m=h.test(d),g={},v="show"===u;o.parent().is(".ui-effects-wrapper")?e.effects.save(o.parent(),l):e.effects.save(o,l),o.show(),s=e.effects.createWrapper(o).css({overflow:"hidden"}),n=s[p](),a=parseFloat(s.css(f))||0,g[p]=v?n:0,m||(o.css(c?"bottom":"right",0).css(c?"top":"left","auto").css({position:"absolute"}),g[f]=v?a:n+a),v&&(s.css(p,0),m||s.css(f,a+n)),s.animate(g,{duration:t.duration,easing:t.easing,queue:!1,complete:function(){"hide"===u&&o.hide(),e.effects.restore(o,l),e.effects.removeWrapper(o),i()}})},e.effects.effect.bounce=function(t,i){var s,n,a,o=e(this),r=["position","top","bottom","left","right","height","width"],h=e.effects.setMode(o,t.mode||"effect"),l="hide"===h,u="show"===h,d=t.direction||"up",c=t.distance,p=t.times||5,f=2*p+(u||l?1:0),m=t.duration/f,g=t.easing,v="up"===d||"down"===d?"top":"left",y="up"===d||"left"===d,b=o.queue(),_=b.length;for((u||l)&&r.push("opacity"),e.effects.save(o,r),o.show(),e.effects.createWrapper(o),c||(c=o["top"===v?"outerHeight":"outerWidth"]()/3),u&&(a={opacity:1},a[v]=0,o.css("opacity",0).css(v,y?2*-c:2*c).animate(a,m,g)),l&&(c/=Math.pow(2,p-1)),a={},a[v]=0,s=0;p>s;s++)n={},n[v]=(y?"-=":"+=")+c,o.animate(n,m,g).animate(a,m,g),c=l?2*c:c/2;l&&(n={opacity:0},n[v]=(y?"-=":"+=")+c,o.animate(n,m,g)),o.queue(function(){l&&o.hide(),e.effects.restore(o,r),e.effects.removeWrapper(o),i()}),_>1&&b.splice.apply(b,[1,0].concat(b.splice(_,f+1))),o.dequeue()},e.effects.effect.clip=function(t,i){var s,n,a,o=e(this),r=["position","top","bottom","left","right","height","width"],h=e.effects.setMode(o,t.mode||"hide"),l="show"===h,u=t.direction||"vertical",d="vertical"===u,c=d?"height":"width",p=d?"top":"left",f={};e.effects.save(o,r),o.show(),s=e.effects.createWrapper(o).css({overflow:"hidden"}),n="IMG"===o[0].tagName?s:o,a=n[c](),l&&(n.css(c,0),n.css(p,a/2)),f[c]=l?a:0,f[p]=l?0:a/2,n.animate(f,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){l||o.hide(),e.effects.restore(o,r),e.effects.removeWrapper(o),i()}})},e.effects.effect.drop=function(t,i){var s,n=e(this),a=["position","top","bottom","left","right","opacity","height","width"],o=e.effects.setMode(n,t.mode||"hide"),r="show"===o,h=t.direction||"left",l="up"===h||"down"===h?"top":"left",u="up"===h||"left"===h?"pos":"neg",d={opacity:r?1:0};e.effects.save(n,a),n.show(),e.effects.createWrapper(n),s=t.distance||n["top"===l?"outerHeight":"outerWidth"](!0)/2,r&&n.css("opacity",0).css(l,"pos"===u?-s:s),d[l]=(r?"pos"===u?"+=":"-=":"pos"===u?"-=":"+=")+s,n.animate(d,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===o&&n.hide(),e.effects.restore(n,a),e.effects.removeWrapper(n),i()}})},e.effects.effect.explode=function(t,i){function s(){b.push(this),b.length===d*c&&n()}function n(){p.css({visibility:"visible"}),e(b).remove(),m||p.hide(),i()}var a,o,r,h,l,u,d=t.pieces?Math.round(Math.sqrt(t.pieces)):3,c=d,p=e(this),f=e.effects.setMode(p,t.mode||"hide"),m="show"===f,g=p.show().css("visibility","hidden").offset(),v=Math.ceil(p.outerWidth()/c),y=Math.ceil(p.outerHeight()/d),b=[];for(a=0;d>a;a++)for(h=g.top+a*y,u=a-(d-1)/2,o=0;c>o;o++)r=g.left+o*v,l=o-(c-1)/2,p.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-o*v,top:-a*y}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:v,height:y,left:r+(m?l*v:0),top:h+(m?u*y:0),opacity:m?0:1}).animate({left:r+(m?0:l*v),top:h+(m?0:u*y),opacity:m?1:0},t.duration||500,t.easing,s)},e.effects.effect.fade=function(t,i){var s=e(this),n=e.effects.setMode(s,t.mode||"toggle");s.animate({opacity:n},{queue:!1,duration:t.duration,easing:t.easing,complete:i})},e.effects.effect.fold=function(t,i){var s,n,a=e(this),o=["position","top","bottom","left","right","height","width"],r=e.effects.setMode(a,t.mode||"hide"),h="show"===r,l="hide"===r,u=t.size||15,d=/([0-9]+)%/.exec(u),c=!!t.horizFirst,p=h!==c,f=p?["width","height"]:["height","width"],m=t.duration/2,g={},v={};e.effects.save(a,o),a.show(),s=e.effects.createWrapper(a).css({overflow:"hidden"}),n=p?[s.width(),s.height()]:[s.height(),s.width()],d&&(u=parseInt(d[1],10)/100*n[l?0:1]),h&&s.css(c?{height:0,width:u}:{height:u,width:0}),g[f[0]]=h?n[0]:u,v[f[1]]=h?n[1]:0,s.animate(g,m,t.easing).animate(v,m,t.easing,function(){l&&a.hide(),e.effects.restore(a,o),e.effects.removeWrapper(a),i()})},e.effects.effect.highlight=function(t,i){var s=e(this),n=["backgroundImage","backgroundColor","opacity"],a=e.effects.setMode(s,t.mode||"show"),o={backgroundColor:s.css("backgroundColor")};"hide"===a&&(o.opacity=0),e.effects.save(s,n),s.show().css({backgroundImage:"none",backgroundColor:t.color||"#ffff99"}).animate(o,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===a&&s.hide(),e.effects.restore(s,n),i()}})},e.effects.effect.size=function(t,i){var s,n,a,o=e(this),r=["position","top","bottom","left","right","width","height","overflow","opacity"],h=["position","top","bottom","left","right","overflow","opacity"],l=["width","height","overflow"],u=["fontSize"],d=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],c=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],p=e.effects.setMode(o,t.mode||"effect"),f=t.restore||"effect"!==p,m=t.scale||"both",g=t.origin||["middle","center"],v=o.css("position"),y=f?r:h,b={height:0,width:0,outerHeight:0,outerWidth:0};"show"===p&&o.show(),s={height:o.height(),width:o.width(),outerHeight:o.outerHeight(),outerWidth:o.outerWidth()},"toggle"===t.mode&&"show"===p?(o.from=t.to||b,o.to=t.from||s):(o.from=t.from||("show"===p?b:s),o.to=t.to||("hide"===p?b:s)),a={from:{y:o.from.height/s.height,x:o.from.width/s.width},to:{y:o.to.height/s.height,x:o.to.width/s.width}},("box"===m||"both"===m)&&(a.from.y!==a.to.y&&(y=y.concat(d),o.from=e.effects.setTransition(o,d,a.from.y,o.from),o.to=e.effects.setTransition(o,d,a.to.y,o.to)),a.from.x!==a.to.x&&(y=y.concat(c),o.from=e.effects.setTransition(o,c,a.from.x,o.from),o.to=e.effects.setTransition(o,c,a.to.x,o.to))),("content"===m||"both"===m)&&a.from.y!==a.to.y&&(y=y.concat(u).concat(l),o.from=e.effects.setTransition(o,u,a.from.y,o.from),o.to=e.effects.setTransition(o,u,a.to.y,o.to)),e.effects.save(o,y),o.show(),e.effects.createWrapper(o),o.css("overflow","hidden").css(o.from),g&&(n=e.effects.getBaseline(g,s),o.from.top=(s.outerHeight-o.outerHeight())*n.y,o.from.left=(s.outerWidth-o.outerWidth())*n.x,o.to.top=(s.outerHeight-o.to.outerHeight)*n.y,o.to.left=(s.outerWidth-o.to.outerWidth)*n.x),o.css(o.from),("content"===m||"both"===m)&&(d=d.concat(["marginTop","marginBottom"]).concat(u),c=c.concat(["marginLeft","marginRight"]),l=r.concat(d).concat(c),o.find("*[width]").each(function(){var i=e(this),s={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()};f&&e.effects.save(i,l),i.from={height:s.height*a.from.y,width:s.width*a.from.x,outerHeight:s.outerHeight*a.from.y,outerWidth:s.outerWidth*a.from.x},i.to={height:s.height*a.to.y,width:s.width*a.to.x,outerHeight:s.height*a.to.y,outerWidth:s.width*a.to.x},a.from.y!==a.to.y&&(i.from=e.effects.setTransition(i,d,a.from.y,i.from),i.to=e.effects.setTransition(i,d,a.to.y,i.to)),a.from.x!==a.to.x&&(i.from=e.effects.setTransition(i,c,a.from.x,i.from),i.to=e.effects.setTransition(i,c,a.to.x,i.to)),i.css(i.from),i.animate(i.to,t.duration,t.easing,function(){f&&e.effects.restore(i,l)})})),o.animate(o.to,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){0===o.to.opacity&&o.css("opacity",o.from.opacity),"hide"===p&&o.hide(),e.effects.restore(o,y),f||("static"===v?o.css({position:"relative",top:o.to.top,left:o.to.left}):e.each(["top","left"],function(e,t){o.css(t,function(t,i){var s=parseInt(i,10),n=e?o.to.left:o.to.top;return"auto"===i?n+"px":s+n+"px"})})),e.effects.removeWrapper(o),i()}})},e.effects.effect.scale=function(t,i){var s=e(this),n=e.extend(!0,{},t),a=e.effects.setMode(s,t.mode||"effect"),o=parseInt(t.percent,10)||(0===parseInt(t.percent,10)?0:"hide"===a?0:100),r=t.direction||"both",h=t.origin,l={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()},u={y:"horizontal"!==r?o/100:1,x:"vertical"!==r?o/100:1};n.effect="size",n.queue=!1,n.complete=i,"effect"!==a&&(n.origin=h||["middle","center"],n.restore=!0),n.from=t.from||("show"===a?{height:0,width:0,outerHeight:0,outerWidth:0}:l),n.to={height:l.height*u.y,width:l.width*u.x,outerHeight:l.outerHeight*u.y,outerWidth:l.outerWidth*u.x},n.fade&&("show"===a&&(n.from.opacity=0,n.to.opacity=1),"hide"===a&&(n.from.opacity=1,n.to.opacity=0)),s.effect(n)},e.effects.effect.puff=function(t,i){var s=e(this),n=e.effects.setMode(s,t.mode||"hide"),a="hide"===n,o=parseInt(t.percent,10)||150,r=o/100,h={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()};e.extend(t,{effect:"scale",queue:!1,fade:!0,mode:n,complete:i,percent:a?o:100,from:a?h:{height:h.height*r,width:h.width*r,outerHeight:h.outerHeight*r,outerWidth:h.outerWidth*r}}),s.effect(t)},e.effects.effect.pulsate=function(t,i){var s,n=e(this),a=e.effects.setMode(n,t.mode||"show"),o="show"===a,r="hide"===a,h=o||"hide"===a,l=2*(t.times||5)+(h?1:0),u=t.duration/l,d=0,c=n.queue(),p=c.length;for((o||!n.is(":visible"))&&(n.css("opacity",0).show(),d=1),s=1;l>s;s++)n.animate({opacity:d},u,t.easing),d=1-d;n.animate({opacity:d},u,t.easing),n.queue(function(){r&&n.hide(),i()}),p>1&&c.splice.apply(c,[1,0].concat(c.splice(p,l+1))),n.dequeue()},e.effects.effect.shake=function(t,i){var s,n=e(this),a=["position","top","bottom","left","right","height","width"],o=e.effects.setMode(n,t.mode||"effect"),r=t.direction||"left",h=t.distance||20,l=t.times||3,u=2*l+1,d=Math.round(t.duration/u),c="up"===r||"down"===r?"top":"left",p="up"===r||"left"===r,f={},m={},g={},v=n.queue(),y=v.length;for(e.effects.save(n,a),n.show(),e.effects.createWrapper(n),f[c]=(p?"-=":"+=")+h,m[c]=(p?"+=":"-=")+2*h,g[c]=(p?"-=":"+=")+2*h,n.animate(f,d,t.easing),s=1;l>s;s++)n.animate(m,d,t.easing).animate(g,d,t.easing);n.animate(m,d,t.easing).animate(f,d/2,t.easing).queue(function(){"hide"===o&&n.hide(),e.effects.restore(n,a),e.effects.removeWrapper(n),i()}),y>1&&v.splice.apply(v,[1,0].concat(v.splice(y,u+1))),n.dequeue()},e.effects.effect.slide=function(t,i){var s,n=e(this),a=["position","top","bottom","left","right","width","height"],o=e.effects.setMode(n,t.mode||"show"),r="show"===o,h=t.direction||"left",l="up"===h||"down"===h?"top":"left",u="up"===h||"left"===h,d={};e.effects.save(n,a),n.show(),s=t.distance||n["top"===l?"outerHeight":"outerWidth"](!0),e.effects.createWrapper(n).css({overflow:"hidden"}),r&&n.css(l,u?isNaN(s)?"-"+s:-s:s),d[l]=(r?u?"+=":"-=":u?"-=":"+=")+s,n.animate(d,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===o&&n.hide(),e.effects.restore(n,a),e.effects.removeWrapper(n),i()}})},e.effects.effect.transfer=function(t,i){var s=e(this),n=e(t.to),a="fixed"===n.css("position"),o=e("body"),r=a?o.scrollTop():0,h=a?o.scrollLeft():0,l=n.offset(),u={top:l.top-r,left:l.left-h,height:n.innerHeight(),width:n.innerWidth()},d=s.offset(),c=e("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(t.className).css({top:d.top-r,left:d.left-h,height:s.innerHeight(),width:s.innerWidth(),position:a?"fixed":"absolute"}).animate(u,t.duration,t.easing,function(){c.remove(),i()})},e.widget("ui.progressbar",{version:"1.11.4",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=e("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(e){return void 0===e?this.options.value:(this.options.value=this._constrainedValue(e),this._refreshValue(),void 0)},_constrainedValue:function(e){return void 0===e&&(e=this.options.value),this.indeterminate=e===!1,"number"!=typeof e&&(e=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,e))},_setOptions:function(e){var t=e.value;delete e.value,this._super(e),this.options.value=this._constrainedValue(t),this._refreshValue()},_setOption:function(e,t){"max"===e&&(t=Math.max(this.min,t)),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this._super(e,t)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var t=this.options.value,i=this._percentage();this.valueDiv.toggle(this.indeterminate||t>this.min).toggleClass("ui-corner-right",t===this.options.max).width(i.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=e("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":t}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==t&&(this.oldValue=t,this._trigger("change")),t===this.options.max&&this._trigger("complete")}}),e.widget("ui.selectable",e.ui.mouse,{version:"1.11.4",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var t,i=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){t=e(i.options.filter,i.element[0]),t.addClass("ui-selectee"),t.each(function(){var t=e(this),i=t.offset();e.data(this,"selectable-item",{element:this,$element:t,left:i.left,top:i.top,right:i.left+t.outerWidth(),bottom:i.top+t.outerHeight(),startselected:!1,selected:t.hasClass("ui-selected"),selecting:t.hasClass("ui-selecting"),unselecting:t.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=t.addClass("ui-selectee"),this._mouseInit(),this.helper=e("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(t){var i=this,s=this.options;this.opos=[t.pageX,t.pageY],this.options.disabled||(this.selectees=e(s.filter,this.element[0]),this._trigger("start",t),e(s.appendTo).append(this.helper),this.helper.css({left:t.pageX,top:t.pageY,width:0,height:0}),s.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var s=e.data(this,"selectable-item");s.startselected=!0,t.metaKey||t.ctrlKey||(s.$element.removeClass("ui-selected"),s.selected=!1,s.$element.addClass("ui-unselecting"),s.unselecting=!0,i._trigger("unselecting",t,{unselecting:s.element}))}),e(t.target).parents().addBack().each(function(){var s,n=e.data(this,"selectable-item");return n?(s=!t.metaKey&&!t.ctrlKey||!n.$element.hasClass("ui-selected"),n.$element.removeClass(s?"ui-unselecting":"ui-selected").addClass(s?"ui-selecting":"ui-unselecting"),n.unselecting=!s,n.selecting=s,n.selected=s,s?i._trigger("selecting",t,{selecting:n.element}):i._trigger("unselecting",t,{unselecting:n.element}),!1):void 0}))},_mouseDrag:function(t){if(this.dragged=!0,!this.options.disabled){var i,s=this,n=this.options,a=this.opos[0],o=this.opos[1],r=t.pageX,h=t.pageY;return a>r&&(i=r,r=a,a=i),o>h&&(i=h,h=o,o=i),this.helper.css({left:a,top:o,width:r-a,height:h-o}),this.selectees.each(function(){var i=e.data(this,"selectable-item"),l=!1;i&&i.element!==s.element[0]&&("touch"===n.tolerance?l=!(i.left>r||a>i.right||i.top>h||o>i.bottom):"fit"===n.tolerance&&(l=i.left>a&&r>i.right&&i.top>o&&h>i.bottom),l?(i.selected&&(i.$element.removeClass("ui-selected"),i.selected=!1),i.unselecting&&(i.$element.removeClass("ui-unselecting"),i.unselecting=!1),i.selecting||(i.$element.addClass("ui-selecting"),i.selecting=!0,s._trigger("selecting",t,{selecting:i.element}))):(i.selecting&&((t.metaKey||t.ctrlKey)&&i.startselected?(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.$element.addClass("ui-selected"),i.selected=!0):(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.startselected&&(i.$element.addClass("ui-unselecting"),i.unselecting=!0),s._trigger("unselecting",t,{unselecting:i.element}))),i.selected&&(t.metaKey||t.ctrlKey||i.startselected||(i.$element.removeClass("ui-selected"),i.selected=!1,i.$element.addClass("ui-unselecting"),i.unselecting=!0,s._trigger("unselecting",t,{unselecting:i.element})))))}),!1}},_mouseStop:function(t){var i=this;return this.dragged=!1,e(".ui-unselecting",this.element[0]).each(function(){var s=e.data(this,"selectable-item");s.$element.removeClass("ui-unselecting"),s.unselecting=!1,s.startselected=!1,i._trigger("unselected",t,{unselected:s.element})}),e(".ui-selecting",this.element[0]).each(function(){var s=e.data(this,"selectable-item");s.$element.removeClass("ui-selecting").addClass("ui-selected"),s.selecting=!1,s.selected=!0,s.startselected=!0,i._trigger("selected",t,{selected:s.element})}),this._trigger("stop",t),this.helper.remove(),!1}}),e.widget("ui.selectmenu",{version:"1.11.4",defaultElement:"<select>",options:{appendTo:null,disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:null,change:null,close:null,focus:null,open:null,select:null},_create:function(){var e=this.element.uniqueId().attr("id");this.ids={element:e,button:e+"-button",menu:e+"-menu"},this._drawButton(),this._drawMenu(),this.options.disabled&&this.disable()},_drawButton:function(){var t=this;this.label=e("label[for='"+this.ids.element+"']").attr("for",this.ids.button),this._on(this.label,{click:function(e){this.button.focus(),e.preventDefault()}}),this.element.hide(),this.button=e("<span>",{"class":"ui-selectmenu-button ui-widget ui-state-default ui-corner-all",tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true"}).insertAfter(this.element),e("<span>",{"class":"ui-icon "+this.options.icons.button}).prependTo(this.button),this.buttonText=e("<span>",{"class":"ui-selectmenu-text"}).appendTo(this.button),this._setText(this.buttonText,this.element.find("option:selected").text()),this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){t.menuItems||t._refreshMenu()}),this._hoverable(this.button),this._focusable(this.button)},_drawMenu:function(){var t=this;this.menu=e("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=e("<div>",{"class":"ui-selectmenu-menu ui-front"}).append(this.menu).appendTo(this._appendTo()),this.menuInstance=this.menu.menu({role:"listbox",select:function(e,i){e.preventDefault(),t._setSelection(),t._select(i.item.data("ui-selectmenu-item"),e)},focus:function(e,i){var s=i.item.data("ui-selectmenu-item");null!=t.focusIndex&&s.index!==t.focusIndex&&(t._trigger("focus",e,{item:s}),t.isOpen||t._select(s,e)),t.focusIndex=s.index,t.button.attr("aria-activedescendant",t.menuItems.eq(s.index).attr("id"))}}).menu("instance"),this.menu.addClass("ui-corner-bottom").removeClass("ui-corner-all"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this._setText(this.buttonText,this._getSelectedItem().text()),this.options.width||this._resizeButton()},_refreshMenu:function(){this.menu.empty();var e,t=this.element.find("option");t.length&&(this._parseOptions(t),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup"),e=this._getSelectedItem(),this.menuInstance.focus(null,e),this._setAria(e.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(e){this.options.disabled||(this.menuItems?(this.menu.find(".ui-state-focus").removeClass("ui-state-focus"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",e))},_position:function(){this.menuWrap.position(e.extend({of:this.button},this.options.position))},close:function(e){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",e))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderMenu:function(t,i){var s=this,n="";e.each(i,function(i,a){a.optgroup!==n&&(e("<li>",{"class":"ui-selectmenu-optgroup ui-menu-divider"+(a.element.parent("optgroup").prop("disabled")?" ui-state-disabled":""),text:a.optgroup}).appendTo(t),n=a.optgroup),s._renderItemData(t,a)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-selectmenu-item",t)},_renderItem:function(t,i){var s=e("<li>");return i.disabled&&s.addClass("ui-state-disabled"),this._setText(s,i.label),s.appendTo(t)},_setText:function(e,t){t?e.text(t):e.html("&#160;")},_move:function(e,t){var i,s,n=".ui-menu-item";this.isOpen?i=this.menuItems.eq(this.focusIndex):(i=this.menuItems.eq(this.element[0].selectedIndex),n+=":not(.ui-state-disabled)"),s="first"===e||"last"===e?i["first"===e?"prevAll":"nextAll"](n).eq(-1):i[e+"All"](n).eq(0),s.length&&this.menuInstance.focus(t,s)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex)},_toggle:function(e){this[this.isOpen?"close":"open"](e)},_setSelection:function(){var e;this.range&&(window.getSelection?(e=window.getSelection(),e.removeAllRanges(),e.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(t){this.isOpen&&(e(t.target).closest(".ui-selectmenu-menu, #"+this.ids.button).length||this.close(t))}},_buttonEvents:{mousedown:function(){var e;window.getSelection?(e=window.getSelection(),e.rangeCount&&(this.range=e.getRangeAt(0))):this.range=document.selection.createRange()},click:function(e){this._setSelection(),this._toggle(e)},keydown:function(t){var i=!0;switch(t.keyCode){case e.ui.keyCode.TAB:case e.ui.keyCode.ESCAPE:this.close(t),i=!1;break;case e.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(t);break;case e.ui.keyCode.UP:t.altKey?this._toggle(t):this._move("prev",t);break;case e.ui.keyCode.DOWN:t.altKey?this._toggle(t):this._move("next",t);break;case e.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(t):this._toggle(t);break;case e.ui.keyCode.LEFT:this._move("prev",t);break;case e.ui.keyCode.RIGHT:this._move("next",t);break;case e.ui.keyCode.HOME:case e.ui.keyCode.PAGE_UP:this._move("first",t);break;case e.ui.keyCode.END:case e.ui.keyCode.PAGE_DOWN:this._move("last",t);break;default:this.menu.trigger(t),i=!1}i&&t.preventDefault()}},_selectFocusedItem:function(e){var t=this.menuItems.eq(this.focusIndex);t.hasClass("ui-state-disabled")||this._select(t.data("ui-selectmenu-item"),e)},_select:function(e,t){var i=this.element[0].selectedIndex;this.element[0].selectedIndex=e.index,this._setText(this.buttonText,e.label),this._setAria(e),this._trigger("select",t,{item:e}),e.index!==i&&this._trigger("change",t,{item:e}),this.close(t)},_setAria:function(e){var t=this.menuItems.eq(e.index).attr("id");this.button.attr({"aria-labelledby":t,"aria-activedescendant":t}),this.menu.attr("aria-activedescendant",t)},_setOption:function(e,t){"icons"===e&&this.button.find("span.ui-icon").removeClass(this.options.icons.button).addClass(t.button),this._super(e,t),"appendTo"===e&&this.menuWrap.appendTo(this._appendTo()),"disabled"===e&&(this.menuInstance.option("disabled",t),this.button.toggleClass("ui-state-disabled",t).attr("aria-disabled",t),this.element.prop("disabled",t),t?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)),"width"===e&&this._resizeButton()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t&&t[0]||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_toggleAttr:function(){this.button.toggleClass("ui-corner-top",this.isOpen).toggleClass("ui-corner-all",!this.isOpen).attr("aria-expanded",this.isOpen),this.menuWrap.toggleClass("ui-selectmenu-open",this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var e=this.options.width;e||(e=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(e)},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){return{disabled:this.element.prop("disabled")}},_parseOptions:function(t){var i=[];t.each(function(t,s){var n=e(s),a=n.parent("optgroup");i.push({element:n,index:t,value:n.val(),label:n.text(),optgroup:a.attr("label")||"",disabled:a.prop("disabled")||n.prop("disabled")})}),this.items=i},_destroy:function(){this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.label.attr("for",this.ids.element)}}),e.widget("ui.slider",e.ui.mouse,{version:"1.11.4",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var t,i,s=this.options,n=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),a="<span class='ui-slider-handle ui-state-default ui-corner-all' tabindex='0'></span>",o=[];for(i=s.values&&s.values.length||1,n.length>i&&(n.slice(i).remove(),n=n.slice(0,i)),t=n.length;i>t;t++)o.push(a);this.handles=n.add(e(o.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(t){e(this).data("ui-slider-handle-index",t)})},_createRange:function(){var t=this.options,i="";t.range?(t.range===!0&&(t.values?t.values.length&&2!==t.values.length?t.values=[t.values[0],t.values[0]]:e.isArray(t.values)&&(t.values=t.values.slice(0)):t.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=e("<div></div>").appendTo(this.element),i="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(i+("min"===t.range||"max"===t.range?" ui-slider-range-"+t.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(t){var i,s,n,a,o,r,h,l,u=this,d=this.options;return d.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:t.pageX,y:t.pageY},s=this._normValueFromMouse(i),n=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var i=Math.abs(s-u.values(t));(n>i||n===i&&(t===u._lastChangedValue||u.values(t)===d.min))&&(n=i,a=e(this),o=t)}),r=this._start(t,o),r===!1?!1:(this._mouseSliding=!0,this._handleIndex=o,a.addClass("ui-state-active").focus(),h=a.offset(),l=!e(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:t.pageX-h.left-a.width()/2,top:t.pageY-h.top-a.height()/2-(parseInt(a.css("borderTopWidth"),10)||0)-(parseInt(a.css("borderBottomWidth"),10)||0)+(parseInt(a.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,o,s),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},i=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,i),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,i,s,n,a;return"horizontal"===this.orientation?(t=this.elementSize.width,i=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,i=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),s=i/t,s>1&&(s=1),0>s&&(s=0),"vertical"===this.orientation&&(s=1-s),n=this._valueMax()-this._valueMin(),a=this._valueMin()+s*n,this._trimAlignValue(a)},_start:function(e,t){var i={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("start",e,i)},_slide:function(e,t,i){var s,n,a;this.options.values&&this.options.values.length?(s=this.values(t?0:1),2===this.options.values.length&&this.options.range===!0&&(0===t&&i>s||1===t&&s>i)&&(i=s),i!==this.values(t)&&(n=this.values(),n[t]=i,a=this._trigger("slide",e,{handle:this.handles[t],value:i,values:n}),s=this.values(t?0:1),a!==!1&&this.values(t,i))):i!==this.value()&&(a=this._trigger("slide",e,{handle:this.handles[t],value:i}),a!==!1&&this.value(i))},_stop:function(e,t){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("stop",e,i)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._lastChangedValue=t,this._trigger("change",e,i)}},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),this._change(null,0),void 0):this._value()},values:function(t,i){var s,n,a;if(arguments.length>1)return this.options.values[t]=this._trimAlignValue(i),this._refreshValue(),this._change(null,t),void 0;if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();for(s=this.options.values,n=arguments[0],a=0;s.length>a;a+=1)s[a]=this._trimAlignValue(n[a]),this._change(null,a);this._refreshValue()},_setOption:function(t,i){var s,n=0;switch("range"===t&&this.options.range===!0&&("min"===i?(this.options.value=this._values(0),this.options.values=null):"max"===i&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),e.isArray(this.options.values)&&(n=this.options.values.length),"disabled"===t&&this.element.toggleClass("ui-state-disabled",!!i),this._super(t,i),t){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue(),this.handles.css("horizontal"===i?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),s=0;n>s;s+=1)this._change(null,s);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e)},_values:function(e){var t,i,s;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t);if(this.options.values&&this.options.values.length){for(i=this.options.values.slice(),s=0;i.length>s;s+=1)i[s]=this._trimAlignValue(i[s]);return i}return[]},_trimAlignValue:function(e){if(this._valueMin()>=e)return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,i=(e-this._valueMin())%t,s=e-i;return 2*Math.abs(i)>=t&&(s+=i>0?t:-t),parseFloat(s.toFixed(5))},_calculateNewMax:function(){var e=this.options.max,t=this._valueMin(),i=this.options.step,s=Math.floor(+(e-t).toFixed(this._precision())/i)*i;e=s+t,this.max=parseFloat(e.toFixed(this._precision()))},_precision:function(){var e=this._precisionOf(this.options.step);return null!==this.options.min&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=""+e,i=t.indexOf(".");return-1===i?0:t.length-i-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshValue:function(){var t,i,s,n,a,o=this.options.range,r=this.options,h=this,l=this._animateOff?!1:r.animate,u={};this.options.values&&this.options.values.length?this.handles.each(function(s){i=100*((h.values(s)-h._valueMin())/(h._valueMax()-h._valueMin())),u["horizontal"===h.orientation?"left":"bottom"]=i+"%",e(this).stop(1,1)[l?"animate":"css"](u,r.animate),h.options.range===!0&&("horizontal"===h.orientation?(0===s&&h.range.stop(1,1)[l?"animate":"css"]({left:i+"%"},r.animate),1===s&&h.range[l?"animate":"css"]({width:i-t+"%"},{queue:!1,duration:r.animate})):(0===s&&h.range.stop(1,1)[l?"animate":"css"]({bottom:i+"%"},r.animate),1===s&&h.range[l?"animate":"css"]({height:i-t+"%"},{queue:!1,duration:r.animate}))),t=i}):(s=this.value(),n=this._valueMin(),a=this._valueMax(),i=a!==n?100*((s-n)/(a-n)):0,u["horizontal"===this.orientation?"left":"bottom"]=i+"%",this.handle.stop(1,1)[l?"animate":"css"](u,r.animate),"min"===o&&"horizontal"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({width:i+"%"},r.animate),"max"===o&&"horizontal"===this.orientation&&this.range[l?"animate":"css"]({width:100-i+"%"},{queue:!1,duration:r.animate}),"min"===o&&"vertical"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({height:i+"%"},r.animate),"max"===o&&"vertical"===this.orientation&&this.range[l?"animate":"css"]({height:100-i+"%"},{queue:!1,duration:r.animate}))},_handleEvents:{keydown:function(t){var i,s,n,a,o=e(t.target).data("ui-slider-handle-index");switch(t.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(t.preventDefault(),!this._keySliding&&(this._keySliding=!0,e(t.target).addClass("ui-state-active"),i=this._start(t,o),i===!1))return}switch(a=this.options.step,s=n=this.options.values&&this.options.values.length?this.values(o):this.value(),t.keyCode){case e.ui.keyCode.HOME:n=this._valueMin();break;case e.ui.keyCode.END:n=this._valueMax();break;case e.ui.keyCode.PAGE_UP:n=this._trimAlignValue(s+(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.PAGE_DOWN:n=this._trimAlignValue(s-(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(s===this._valueMax())return;n=this._trimAlignValue(s+a);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(s===this._valueMin())return;n=this._trimAlignValue(s-a)}this._slide(t,o,n)},keyup:function(t){var i=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,i),this._change(t,i),e(t.target).removeClass("ui-state-active"))}}}),e.widget("ui.sortable",e.ui.mouse,{version:"1.11.4",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(e,t,i){return e>=t&&t+i>e},_isFloating:function(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))},_create:function(){this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(e,t){this._super(e,t),"handle"===e&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"),e.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(t,i){var s=null,n=!1,a=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(t),e(t.target).parents().each(function(){return e.data(this,a.widgetName+"-item")===a?(s=e(this),!1):void 0}),e.data(t.target,a.widgetName+"-item")===a&&(s=e(t.target)),s?!this.options.handle||i||(e(this.options.handle,s).find("*").addBack().each(function(){this===t.target&&(n=!0)}),n)?(this.currentItem=s,this._removeCurrentsFromItems(),!0):!1:!1)},_mouseStart:function(t,i,s){var n,a,o=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&"auto"!==o.cursor&&(a=this.document.find("body"),this.storedCursor=a.css("cursor"),a.css("cursor",o.cursor),this.storedStylesheet=e("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(a)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!s)for(n=this.containers.length-1;n>=0;n--)this.containers[n]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var i,s,n,a,o=this.options,r=!1;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop+o.scrollSpeed:t.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft+o.scrollSpeed:t.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(t.pageY-this.document.scrollTop()<o.scrollSensitivity?r=this.document.scrollTop(this.document.scrollTop()-o.scrollSpeed):this.window.height()-(t.pageY-this.document.scrollTop())<o.scrollSensitivity&&(r=this.document.scrollTop(this.document.scrollTop()+o.scrollSpeed)),t.pageX-this.document.scrollLeft()<o.scrollSensitivity?r=this.document.scrollLeft(this.document.scrollLeft()-o.scrollSpeed):this.window.width()-(t.pageX-this.document.scrollLeft())<o.scrollSensitivity&&(r=this.document.scrollLeft(this.document.scrollLeft()+o.scrollSpeed))),r!==!1&&e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(s=this.items[i],n=s.item[0],a=this._intersectsWithPointer(s),a&&s.instance===this.currentContainer&&n!==this.currentItem[0]&&this.placeholder[1===a?"next":"prev"]()[0]!==n&&!e.contains(this.placeholder[0],n)&&("semi-dynamic"===this.options.type?!e.contains(this.element[0],n):!0)){if(this.direction=1===a?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(s))break;this._rearrange(t,s),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,i){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var s=this,n=this.placeholder.offset(),a=this.options.axis,o={};a&&"x"!==a||(o.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),a&&"y"!==a||(o.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,e(this.helper).animate(o,parseInt(this.options.revert,10)||500,function(){s._clear(t)})}else this._clear(t,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var i=this._getItemsAsjQuery(t&&t.connected),s=[];return t=t||{},e(i).each(function(){var i=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);i&&s.push((t.key||i[1]+"[]")+"="+(t.key&&t.expression?i[1]:i[2]))}),!s.length&&t.key&&s.push(t.key+"="),s.join("&")},toArray:function(t){var i=this._getItemsAsjQuery(t&&t.connected),s=[];return t=t||{},i.each(function(){s.push(e(t.item||this).attr(t.attribute||"id")||"")}),s},_intersectsWith:function(e){var t=this.positionAbs.left,i=t+this.helperProportions.width,s=this.positionAbs.top,n=s+this.helperProportions.height,a=e.left,o=a+e.width,r=e.top,h=r+e.height,l=this.offset.click.top,u=this.offset.click.left,d="x"===this.options.axis||s+l>r&&h>s+l,c="y"===this.options.axis||t+u>a&&o>t+u,p=d&&c;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?p:t+this.helperProportions.width/2>a&&o>i-this.helperProportions.width/2&&s+this.helperProportions.height/2>r&&h>n-this.helperProportions.height/2},_intersectsWithPointer:function(e){var t="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height),i="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width),s=t&&i,n=this._getDragVerticalDirection(),a=this._getDragHorizontalDirection();return s?this.floating?a&&"right"===a||"down"===n?2:1:n&&("down"===n?2:1):!1},_intersectsWithSides:function(e){var t=this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),s=this._getDragVerticalDirection(),n=this._getDragHorizontalDirection();return this.floating&&n?"right"===n&&i||"left"===n&&!i:s&&("down"===s&&t||"up"===s&&!t)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){function i(){r.push(this)}var s,n,a,o,r=[],h=[],l=this._connectWith();if(l&&t)for(s=l.length-1;s>=0;s--)for(a=e(l[s],this.document[0]),n=a.length-1;n>=0;n--)o=e.data(a[n],this.widgetFullName),o&&o!==this&&!o.options.disabled&&h.push([e.isFunction(o.options.items)?o.options.items.call(o.element):e(o.options.items,o.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),o]);for(h.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),s=h.length-1;s>=0;s--)h[s][0].each(i);return e(r)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var i=0;t.length>i;i++)if(t[i]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var i,s,n,a,o,r,h,l,u=this.items,d=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],c=this._connectWith();if(c&&this.ready)for(i=c.length-1;i>=0;i--)for(n=e(c[i],this.document[0]),s=n.length-1;s>=0;s--)a=e.data(n[s],this.widgetFullName),a&&a!==this&&!a.options.disabled&&(d.push([e.isFunction(a.options.items)?a.options.items.call(a.element[0],t,{item:this.currentItem}):e(a.options.items,a.element),a]),this.containers.push(a));for(i=d.length-1;i>=0;i--)for(o=d[i][1],r=d[i][0],s=0,l=r.length;l>s;s++)h=e(r[s]),h.data(this.widgetName+"-item",o),u.push({item:h,instance:o,width:0,height:0,left:0,top:0})},refreshPositions:function(t){this.floating=this.items.length?"x"===this.options.axis||this._isFloating(this.items[0].item):!1,this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,s,n,a;for(i=this.items.length-1;i>=0;i--)s=this.items[i],s.instance!==this.currentContainer&&this.currentContainer&&s.item[0]!==this.currentItem[0]||(n=this.options.toleranceElement?e(this.options.toleranceElement,s.item):s.item,t||(s.width=n.outerWidth(),s.height=n.outerHeight()),a=n.offset(),s.left=a.left,s.top=a.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)a=this.containers[i].element.offset(),this.containers[i].containerCache.left=a.left,this.containers[i].containerCache.top=a.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(t){t=t||this;var i,s=t.options;s.placeholder&&s.placeholder.constructor!==String||(i=s.placeholder,s.placeholder={element:function(){var s=t.currentItem[0].nodeName.toLowerCase(),n=e("<"+s+">",t.document[0]).addClass(i||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tbody"===s?t._createTrPlaceholder(t.currentItem.find("tr").eq(0),e("<tr>",t.document[0]).appendTo(n)):"tr"===s?t._createTrPlaceholder(t.currentItem,n):"img"===s&&n.attr("src",t.currentItem.attr("src")),i||n.css("visibility","hidden"),n},update:function(e,n){(!i||s.forcePlaceholderSize)&&(n.height()||n.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),n.width()||n.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}),t.placeholder=e(s.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),s.placeholder.update(t,t.placeholder)},_createTrPlaceholder:function(t,i){var s=this;t.children().each(function(){e("<td>&#160;</td>",s.document[0]).attr("colspan",e(this).attr("colspan")||1).appendTo(i)})},_contactContainers:function(t){var i,s,n,a,o,r,h,l,u,d,c=null,p=null;for(i=this.containers.length-1;i>=0;i--)if(!e.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(c&&e.contains(this.containers[i].element[0],c.element[0]))continue;c=this.containers[i],p=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",t,this._uiHash(this)),this.containers[i].containerCache.over=0);if(c)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(n=1e4,a=null,u=c.floating||this._isFloating(this.currentItem),o=u?"left":"top",r=u?"width":"height",d=u?"clientX":"clientY",s=this.items.length-1;s>=0;s--)e.contains(this.containers[p].element[0],this.items[s].item[0])&&this.items[s].item[0]!==this.currentItem[0]&&(h=this.items[s].item.offset()[o],l=!1,t[d]-h>this.items[s][r]/2&&(l=!0),n>Math.abs(t[d]-h)&&(n=Math.abs(t[d]-h),a=this.items[s],this.direction=l?"up":"down"));if(!a&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return this.currentContainer.containerCache.over||(this.containers[p]._trigger("over",t,this._uiHash()),this.currentContainer.containerCache.over=1),void 0;a?this._rearrange(t,a,null,!0):this._rearrange(t,null,this.containers[p].element,!0),this._trigger("change",t,this._uiHash()),this.containers[p]._trigger("change",t,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(t){var i=this.options,s=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return s.parents("body").length||e("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(s[0]),s[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!s[0].style.width||i.forceHelperSize)&&s.width(this.currentItem.width()),(!s[0].style.height||i.forceHelperSize)&&s.height(this.currentItem.height()),s},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,s,n=this.options;"parent"===n.containment&&(n.containment=this.helper[0].parentNode),("document"===n.containment||"window"===n.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===n.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===n.containment?this.document.width():this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(n.containment)||(t=e(n.containment)[0],i=e(n.containment).offset(),s="hidden"!==e(t).css("overflow"),this.containment=[i.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,i.left+(s?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(s?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,i){i||(i=this.position);var s="absolute"===t?1:-1,n="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=/(html|body)/i.test(n[0].tagName);return{top:i.top+this.offset.relative.top*s+this.offset.parent.top*s-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():a?0:n.scrollTop())*s,left:i.left+this.offset.relative.left*s+this.offset.parent.left*s-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():a?0:n.scrollLeft())*s}},_generatePosition:function(t){var i,s,n=this.options,a=t.pageX,o=t.pageY,r="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,h=/(html|body)/i.test(r[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(a=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(a=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),n.grid&&(i=this.originalPageY+Math.round((o-this.originalPageY)/n.grid[1])*n.grid[1],o=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-n.grid[1]:i+n.grid[1]:i,s=this.originalPageX+Math.round((a-this.originalPageX)/n.grid[0])*n.grid[0],a=this.containment?s-this.offset.click.left>=this.containment[0]&&s-this.offset.click.left<=this.containment[2]?s:s-this.offset.click.left>=this.containment[0]?s-n.grid[0]:s+n.grid[0]:s)),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():h?0:r.scrollTop()),left:a-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():h?0:r.scrollLeft())}},_rearrange:function(e,t,i,s){i?i[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var n=this.counter;this._delay(function(){n===this.counter&&this.refreshPositions(!s)})},_clear:function(e,t){function i(e,t,i){return function(s){i._trigger(e,s,t._uiHash(t))}}this.reverting=!1;var s,n=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(s in this._storedCSS)("auto"===this._storedCSS[s]||"static"===this._storedCSS[s])&&(this._storedCSS[s]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!t&&n.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||n.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(t||(n.push(function(e){this._trigger("remove",e,this._uiHash())}),n.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),n.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),s=this.containers.length-1;s>=0;s--)t||n.push(i("deactivate",this,this.containers[s])),this.containers[s].containerCache.over&&(n.push(i("out",this,this.containers[s])),this.containers[s].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!t){for(s=0;n.length>s;s++)n[s].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var i=t||this;return{helper:i.helper,placeholder:i.placeholder||e([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:t?t.element:null}}}),e.widget("ui.spinner",{version:"1.11.4",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var t={},i=this.element;return e.each(["min","max","step"],function(e,s){var n=i.attr(s);void 0!==n&&n.length&&(t[s]=n)}),t},_events:{keydown:function(e){this._start(e)&&this._keydown(e)&&e.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(e){return this.cancelBlur?(delete this.cancelBlur,void 0):(this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger("change",e),void 0)},mousewheel:function(e,t){if(t){if(!this.spinning&&!this._start(e))return!1;this._spin((t>0?1:-1)*this.options.step,e),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(e)},100),e.preventDefault()}},"mousedown .ui-spinner-button":function(t){function i(){var e=this.element[0]===this.document[0].activeElement;e||(this.element.focus(),this.previous=s,this._delay(function(){this.previous=s}))}var s;s=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),t.preventDefault(),i.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,i.call(this)}),this._start(t)!==!1&&this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(t){return e(t.currentTarget).hasClass("ui-state-active")?this._start(t)===!1?!1:(this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t),void 0):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var e=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=e.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*e.height())&&e.height()>0&&e.height(e.height()),this.options.disabled&&this.disable()},_keydown:function(t){var i=this.options,s=e.ui.keyCode;switch(t.keyCode){case s.UP:return this._repeat(null,1,t),!0;case s.DOWN:return this._repeat(null,-1,t),!0;case s.PAGE_UP:return this._repeat(null,i.page,t),!0;case s.PAGE_DOWN:return this._repeat(null,-i.page,t),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span>"+"</a>"+"<a class='ui-spinner-button ui-spinner-down ui-corner-br'>"+"<span class='ui-icon "+this.options.icons.down+"'>&#9660;</span>"+"</a>"},_start:function(e){return this.spinning||this._trigger("start",e)!==!1?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(e,t,i){e=e||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,t,i)},e),this._spin(t*this.options.step,i)},_spin:function(e,t){var i=this.value()||0;this.counter||(this.counter=1),i=this._adjustValue(i+e*this._increment(this.counter)),this.spinning&&this._trigger("spin",t,{value:i})===!1||(this._value(i),this.counter++)},_increment:function(t){var i=this.options.incremental;return i?e.isFunction(i)?i(t):Math.floor(t*t*t/5e4-t*t/500+17*t/200+1):1},_precision:function(){var e=this._precisionOf(this.options.step);return null!==this.options.min&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=""+e,i=t.indexOf(".");return-1===i?0:t.length-i-1},_adjustValue:function(e){var t,i,s=this.options;return t=null!==s.min?s.min:0,i=e-t,i=Math.round(i/s.step)*s.step,e=t+i,e=parseFloat(e.toFixed(this._precision())),null!==s.max&&e>s.max?s.max:null!==s.min&&s.min>e?s.min:e},_stop:function(e){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",e))},_setOption:function(e,t){if("culture"===e||"numberFormat"===e){var i=this._parse(this.element.val());return this.options[e]=t,this.element.val(this._format(i)),void 0}("max"===e||"min"===e||"step"===e)&&"string"==typeof t&&(t=this._parse(t)),"icons"===e&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(t.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(t.down)),this._super(e,t),"disabled"===e&&(this.widget().toggleClass("ui-state-disabled",!!t),this.element.prop("disabled",!!t),this.buttons.button(t?"disable":"enable"))},_setOptions:h(function(e){this._super(e)}),_parse:function(e){return"string"==typeof e&&""!==e&&(e=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(e,10,this.options.culture):+e),""===e||isNaN(e)?null:e},_format:function(e){return""===e?"":window.Globalize&&this.options.numberFormat?Globalize.format(e,this.options.numberFormat,this.options.culture):e},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var e=this.value();return null===e?!1:e===this._adjustValue(e)},_value:function(e,t){var i;""!==e&&(i=this._parse(e),null!==i&&(t||(i=this._adjustValue(i)),e=this._format(i))),this.element.val(e),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:h(function(e){this._stepUp(e)}),_stepUp:function(e){this._start()&&(this._spin((e||1)*this.options.step),this._stop())},stepDown:h(function(e){this._stepDown(e)}),_stepDown:function(e){this._start()&&(this._spin((e||1)*-this.options.step),this._stop())},pageUp:h(function(e){this._stepUp((e||1)*this.options.page)}),pageDown:h(function(e){this._stepDown((e||1)*this.options.page)}),value:function(e){return arguments.length?(h(this._value).call(this,e),void 0):this._parse(this.element.val())},widget:function(){return this.uiSpinner}}),e.widget("ui.tabs",{version:"1.11.4",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var e=/#.*$/;return function(t){var i,s;t=t.cloneNode(!1),i=t.href.replace(e,""),s=location.href.replace(e,"");try{i=decodeURIComponent(i)}catch(n){}try{s=decodeURIComponent(s)}catch(n){}return t.hash.length>1&&i===s}}(),_create:function(){var t=this,i=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",i.collapsible),this._processTabs(),i.active=this._initialActive(),e.isArray(i.disabled)&&(i.disabled=e.unique(i.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"),function(e){return t.tabs.index(e)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(i.active):e(),this._refresh(),this.active.length&&this.load(i.active)},_initialActive:function(){var t=this.options.active,i=this.options.collapsible,s=location.hash.substring(1);return null===t&&(s&&this.tabs.each(function(i,n){return e(n).attr("aria-controls")===s?(t=i,!1):void 0}),null===t&&(t=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===t||-1===t)&&(t=this.tabs.length?0:!1)),t!==!1&&(t=this.tabs.index(this.tabs.eq(t)),-1===t&&(t=i?!1:0)),!i&&t===!1&&this.anchors.length&&(t=0),t},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):e()}},_tabKeydown:function(t){var i=e(this.document[0].activeElement).closest("li"),s=this.tabs.index(i),n=!0;if(!this._handlePageNav(t)){switch(t.keyCode){case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:s++;break;case e.ui.keyCode.UP:case e.ui.keyCode.LEFT:n=!1,s--;break;case e.ui.keyCode.END:s=this.anchors.length-1;break;case e.ui.keyCode.HOME:s=0;break;case e.ui.keyCode.SPACE:return t.preventDefault(),clearTimeout(this.activating),this._activate(s),void 0;case e.ui.keyCode.ENTER:return t.preventDefault(),clearTimeout(this.activating),this._activate(s===this.options.active?!1:s),void 0;default:return}t.preventDefault(),clearTimeout(this.activating),s=this._focusNextTab(s,n),t.ctrlKey||t.metaKey||(i.attr("aria-selected","false"),this.tabs.eq(s).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",s)},this.delay))}},_panelKeydown:function(t){this._handlePageNav(t)||t.ctrlKey&&t.keyCode===e.ui.keyCode.UP&&(t.preventDefault(),this.active.focus())},_handlePageNav:function(t){return t.altKey&&t.keyCode===e.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):t.altKey&&t.keyCode===e.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(t,i){function s(){return t>n&&(t=0),0>t&&(t=n),t}for(var n=this.tabs.length-1;-1!==e.inArray(s(),this.options.disabled);)t=i?t+1:t-1;return t},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).focus(),e},_setOption:function(e,t){return"active"===e?(this._activate(t),void 0):"disabled"===e?(this._setupDisabled(t),void 0):(this._super(e,t),"collapsible"===e&&(this.element.toggleClass("ui-tabs-collapsible",t),t||this.options.active!==!1||this._activate(0)),"event"===e&&this._setupEvents(t),"heightStyle"===e&&this._setupHeightStyle(t),void 0)},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,i=this.tablist.children(":has(a[href])");t.disabled=e.map(i.filter(".ui-state-disabled"),function(e){return i.index(e)}),this._processTabs(),t.active!==!1&&this.anchors.length?this.active.length&&!e.contains(this.tablist[0],this.active[0])?this.tabs.length===t.disabled.length?(t.active=!1,this.active=e()):this._activate(this._findNextTab(Math.max(0,t.active-1),!1)):t.active=this.tabs.index(this.active):(t.active=!1,this.active=e()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var t=this,i=this.tabs,s=this.anchors,n=this.panels;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist").delegate("> li","mousedown"+this.eventNamespace,function(t){e(this).is(".ui-state-disabled")&&t.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){e(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return e("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=e(),this.anchors.each(function(i,s){var n,a,o,r=e(s).uniqueId().attr("id"),h=e(s).closest("li"),l=h.attr("aria-controls");t._isLocal(s)?(n=s.hash,o=n.substring(1),a=t.element.find(t._sanitizeSelector(n))):(o=h.attr("aria-controls")||e({}).uniqueId()[0].id,n="#"+o,a=t.element.find(n),a.length||(a=t._createPanel(o),a.insertAfter(t.panels[i-1]||t.tablist)),a.attr("aria-live","polite")),a.length&&(t.panels=t.panels.add(a)),l&&h.data("ui-tabs-aria-controls",l),h.attr({"aria-controls":o,"aria-labelledby":r}),a.attr("aria-labelledby",r)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel"),i&&(this._off(i.not(this.tabs)),this._off(s.not(this.anchors)),this._off(n.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0)},_createPanel:function(t){return e("<div>").attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(t){e.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1);for(var i,s=0;i=this.tabs[s];s++)t===!0||-1!==e.inArray(s,t)?e(i).addClass("ui-state-disabled").attr("aria-disabled","true"):e(i).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=t},_setupEvents:function(t){var i={};t&&e.each(t.split(" "),function(e,t){i[t]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(e){e.preventDefault()}}),this._on(this.anchors,i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(t){var i,s=this.element.parent();"fill"===t?(i=s.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var t=e(this),s=t.css("position");"absolute"!==s&&"fixed"!==s&&(i-=t.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){i-=e(this).outerHeight(!0)}),this.panels.each(function(){e(this).height(Math.max(0,i-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===t&&(i=0,this.panels.each(function(){i=Math.max(i,e(this).height("").height())}).height(i))},_eventHandler:function(t){var i=this.options,s=this.active,n=e(t.currentTarget),a=n.closest("li"),o=a[0]===s[0],r=o&&i.collapsible,h=r?e():this._getPanelForTab(a),l=s.length?this._getPanelForTab(s):e(),u={oldTab:s,oldPanel:l,newTab:r?e():a,newPanel:h};t.preventDefault(),a.hasClass("ui-state-disabled")||a.hasClass("ui-tabs-loading")||this.running||o&&!i.collapsible||this._trigger("beforeActivate",t,u)===!1||(i.active=r?!1:this.tabs.index(a),this.active=o?e():a,this.xhr&&this.xhr.abort(),l.length||h.length||e.error("jQuery UI Tabs: Mismatching fragment identifier."),h.length&&this.load(this.tabs.index(a),t),this._toggle(t,u))},_toggle:function(t,i){function s(){a.running=!1,a._trigger("activate",t,i)}function n(){i.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),o.length&&a.options.show?a._show(o,a.options.show,s):(o.show(),s())}var a=this,o=i.newPanel,r=i.oldPanel;this.running=!0,r.length&&this.options.hide?this._hide(r,this.options.hide,function(){i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),n()}):(i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),r.hide(),n()),r.attr("aria-hidden","true"),i.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),o.length&&r.length?i.oldTab.attr("tabIndex",-1):o.length&&this.tabs.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),o.attr("aria-hidden","false"),i.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(t){var i,s=this._findActive(t);s[0]!==this.active[0]&&(s.length||(s=this.active),i=s.find(".ui-tabs-anchor")[0],this._eventHandler({target:i,currentTarget:i,preventDefault:e.noop}))},_findActive:function(t){return t===!1?e():this.tabs.eq(t)},_getIndex:function(e){return"string"==typeof e&&(e=this.anchors.index(this.anchors.filter("[href$='"+e+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tablist.unbind(this.eventNamespace),this.tabs.add(this.panels).each(function(){e.data(this,"ui-tabs-destroy")?e(this).remove():e(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var t=e(this),i=t.data("ui-tabs-aria-controls");i?t.attr("aria-controls",i).removeData("ui-tabs-aria-controls"):t.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(t){var i=this.options.disabled;i!==!1&&(void 0===t?i=!1:(t=this._getIndex(t),i=e.isArray(i)?e.map(i,function(e){return e!==t?e:null}):e.map(this.tabs,function(e,i){return i!==t?i:null})),this._setupDisabled(i))},disable:function(t){var i=this.options.disabled;if(i!==!0){if(void 0===t)i=!0;else{if(t=this._getIndex(t),-1!==e.inArray(t,i))return;i=e.isArray(i)?e.merge([t],i).sort():[t]}this._setupDisabled(i)}},load:function(t,i){t=this._getIndex(t);var s=this,n=this.tabs.eq(t),a=n.find(".ui-tabs-anchor"),o=this._getPanelForTab(n),r={tab:n,panel:o},h=function(e,t){"abort"===t&&s.panels.stop(!1,!0),n.removeClass("ui-tabs-loading"),o.removeAttr("aria-busy"),e===s.xhr&&delete s.xhr};this._isLocal(a[0])||(this.xhr=e.ajax(this._ajaxSettings(a,i,r)),this.xhr&&"canceled"!==this.xhr.statusText&&(n.addClass("ui-tabs-loading"),o.attr("aria-busy","true"),this.xhr.done(function(e,t,n){setTimeout(function(){o.html(e),s._trigger("load",i,r),h(n,t)},1)}).fail(function(e,t){setTimeout(function(){h(e,t)},1)})))},_ajaxSettings:function(t,i,s){var n=this;return{url:t.attr("href"),beforeSend:function(t,a){return n._trigger("beforeLoad",i,e.extend({jqXHR:t,ajaxSettings:a},s))}}},_getPanelForTab:function(t){var i=e(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+i))}}),e.widget("ui.tooltip",{version:"1.11.4",options:{content:function(){var t=e(this).attr("title")||"";return e("<a>").text(t).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_addDescribedBy:function(t,i){var s=(t.attr("aria-describedby")||"").split(/\s+/);s.push(i),t.data("ui-tooltip-id",i).attr("aria-describedby",e.trim(s.join(" ")))},_removeDescribedBy:function(t){var i=t.data("ui-tooltip-id"),s=(t.attr("aria-describedby")||"").split(/\s+/),n=e.inArray(i,s);-1!==n&&s.splice(n,1),t.removeData("ui-tooltip-id"),s=e.trim(s.join(" ")),s?t.attr("aria-describedby",s):t.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable(),this.liveRegion=e("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body)},_setOption:function(t,i){var s=this;return"disabled"===t?(this[i?"_disable":"_enable"](),this.options[t]=i,void 0):(this._super(t,i),"content"===t&&e.each(this.tooltips,function(e,t){s._updateContent(t.element)}),void 0)},_disable:function(){var t=this;e.each(this.tooltips,function(i,s){var n=e.Event("blur");n.target=n.currentTarget=s.element[0],t.close(n,!0)}),this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.is("[title]")&&t.data("ui-tooltip-title",t.attr("title")).removeAttr("title")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.data("ui-tooltip-title")&&t.attr("title",t.data("ui-tooltip-title"))})},open:function(t){var i=this,s=e(t?t.target:this.element).closest(this.options.items);s.length&&!s.data("ui-tooltip-id")&&(s.attr("title")&&s.data("ui-tooltip-title",s.attr("title")),s.data("ui-tooltip-open",!0),t&&"mouseover"===t.type&&s.parents().each(function(){var t,s=e(this);s.data("ui-tooltip-open")&&(t=e.Event("blur"),t.target=t.currentTarget=this,i.close(t,!0)),s.attr("title")&&(s.uniqueId(),i.parents[this.id]={element:this,title:s.attr("title")},s.attr("title",""))}),this._registerCloseHandlers(t,s),this._updateContent(s,t))},_updateContent:function(e,t){var i,s=this.options.content,n=this,a=t?t.type:null;return"string"==typeof s?this._open(t,e,s):(i=s.call(e[0],function(i){n._delay(function(){e.data("ui-tooltip-open")&&(t&&(t.type=a),this._open(t,e,i))})}),i&&this._open(t,e,i),void 0)},_open:function(t,i,s){function n(e){l.of=e,o.is(":hidden")||o.position(l)}var a,o,r,h,l=e.extend({},this.options.position);if(s){if(a=this._find(i))return a.tooltip.find(".ui-tooltip-content").html(s),void 0;i.is("[title]")&&(t&&"mouseover"===t.type?i.attr("title",""):i.removeAttr("title")),a=this._tooltip(i),o=a.tooltip,this._addDescribedBy(i,o.attr("id")),o.find(".ui-tooltip-content").html(s),this.liveRegion.children().hide(),s.clone?(h=s.clone(),h.removeAttr("id").find("[id]").removeAttr("id")):h=s,e("<div>").html(h).appendTo(this.liveRegion),this.options.track&&t&&/^mouse/.test(t.type)?(this._on(this.document,{mousemove:n}),n(t)):o.position(e.extend({of:i},this.options.position)),o.hide(),this._show(o,this.options.show),this.options.show&&this.options.show.delay&&(r=this.delayedShow=setInterval(function(){o.is(":visible")&&(n(l.of),clearInterval(r))},e.fx.interval)),this._trigger("open",t,{tooltip:o})}},_registerCloseHandlers:function(t,i){var s={keyup:function(t){if(t.keyCode===e.ui.keyCode.ESCAPE){var s=e.Event(t);s.currentTarget=i[0],this.close(s,!0)}}};i[0]!==this.element[0]&&(s.remove=function(){this._removeTooltip(this._find(i).tooltip)}),t&&"mouseover"!==t.type||(s.mouseleave="close"),t&&"focusin"!==t.type||(s.focusout="close"),this._on(!0,i,s)},close:function(t){var i,s=this,n=e(t?t.currentTarget:this.element),a=this._find(n);return a?(i=a.tooltip,a.closing||(clearInterval(this.delayedShow),n.data("ui-tooltip-title")&&!n.attr("title")&&n.attr("title",n.data("ui-tooltip-title")),this._removeDescribedBy(n),a.hiding=!0,i.stop(!0),this._hide(i,this.options.hide,function(){s._removeTooltip(e(this))}),n.removeData("ui-tooltip-open"),this._off(n,"mouseleave focusout keyup"),n[0]!==this.element[0]&&this._off(n,"remove"),this._off(this.document,"mousemove"),t&&"mouseleave"===t.type&&e.each(this.parents,function(t,i){e(i.element).attr("title",i.title),delete s.parents[t]}),a.closing=!0,this._trigger("close",t,{tooltip:i}),a.hiding||(a.closing=!1)),void 0):(n.removeData("ui-tooltip-open"),void 0)},_tooltip:function(t){var i=e("<div>").attr("role","tooltip").addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||"")),s=i.uniqueId().attr("id");return e("<div>").addClass("ui-tooltip-content").appendTo(i),i.appendTo(this.document[0].body),this.tooltips[s]={element:t,tooltip:i}},_find:function(e){var t=e.data("ui-tooltip-id");return t?this.tooltips[t]:null},_removeTooltip:function(e){e.remove(),delete this.tooltips[e.attr("id")]},_destroy:function(){var t=this;e.each(this.tooltips,function(i,s){var n=e.Event("blur"),a=s.element;n.target=n.currentTarget=a[0],t.close(n,!0),e("#"+i).remove(),a.data("ui-tooltip-title")&&(a.attr("title")||a.attr("title",a.data("ui-tooltip-title")),a.removeData("ui-tooltip-title"))}),this.liveRegion.remove()}})});
;;;
(function($){$.support.touch='ontouchend'in document;if(!$.support.touch){return;}
var mouseProto=$.ui.mouse.prototype,_mouseInit=mouseProto._mouseInit,_mouseDestroy=mouseProto._mouseDestroy,touchHandled;function simulateMouseEvent(event,simulatedType){if(event.originalEvent.touches.length>1){return;}
event.preventDefault();var touch=event.originalEvent.changedTouches[0],simulatedEvent=document.createEvent('MouseEvents');simulatedEvent.initMouseEvent(simulatedType,true,true,window,1,touch.screenX,touch.screenY,touch.clientX,touch.clientY,false,false,false,false,0,null);event.target.dispatchEvent(simulatedEvent);}
mouseProto._touchStart=function(event){var self=this;if(touchHandled||!self._mouseCapture(event.originalEvent.changedTouches[0])){return;}
touchHandled=true;self._touchMoved=false;simulateMouseEvent(event,'mouseover');simulateMouseEvent(event,'mousemove');simulateMouseEvent(event,'mousedown');};mouseProto._touchMove=function(event){if(!touchHandled){return;}
this._touchMoved=true;simulateMouseEvent(event,'mousemove');};mouseProto._touchEnd=function(event){if(!touchHandled){return;}
simulateMouseEvent(event,'mouseup');simulateMouseEvent(event,'mouseout');if(!this._touchMoved){simulateMouseEvent(event,'click');}
touchHandled=false;};mouseProto._mouseInit=function(){var self=this;self.element.bind({touchstart:$.proxy(self,'_touchStart'),touchmove:$.proxy(self,'_touchMove'),touchend:$.proxy(self,'_touchEnd')});_mouseInit.call(self);};mouseProto._mouseDestroy=function(){var self=this;self.element.unbind({touchstart:$.proxy(self,'_touchStart'),touchmove:$.proxy(self,'_touchMove'),touchend:$.proxy(self,'_touchEnd')});_mouseDestroy.call(self);};})(jQuery);
;;;
(function(m,f,l){'use strict';f.module("ngCookies",["ng"]).factory("$cookies",["$rootScope","$browser",function(d,b){var c={},g={},h,i=!1,j=f.copy,k=f.isUndefined;b.addPollFn(function(){var a=b.cookies();h!=a&&(h=a,j(a,g),j(a,c),i&&d.$apply())})();i=!0;d.$watch(function(){var a,e,d;for(a in g)k(c[a])&&b.cookies(a,l);for(a in c)e=c[a],f.isString(e)?e!==g[a]&&(b.cookies(a,e),d=!0):f.isDefined(g[a])?c[a]=g[a]:delete c[a];if(d)for(a in e=b.cookies(),c)c[a]!==e[a]&&(k(e[a])?delete c[a]:c[a]=e[a])});return c}]).factory("$cookieStore",["$cookies",function(d){return{get:function(b){return(b=d[b])?f.fromJson(b):b},put:function(b,c){d[b]=f.toJson(c)},remove:function(b){delete d[b]}}}])})(window,window.angular);
;;;
(function(window,angular,undefined){'use strict';var ngMobile=angular.module('ngMobile',[]);ngMobile.config(['$provide',function($provide){$provide.decorator('ngClickDirective',['$delegate',function($delegate){$delegate.shift();return $delegate;}]);}]);ngMobile.directive('ngClick',['$parse','$timeout','$rootElement',function($parse,$timeout,$rootElement){var TAP_DURATION=750;var MOVE_TOLERANCE=12;var PREVENT_DURATION=2500;var CLICKBUSTER_THRESHOLD=25;var ACTIVE_CLASS_NAME='ng-click-active';var lastPreventedTime;var touchCoordinates;function hit(x1,y1,x2,y2){return Math.abs(x1-x2)<CLICKBUSTER_THRESHOLD&&Math.abs(y1-y2)<CLICKBUSTER_THRESHOLD;}
function checkAllowableRegions(touchCoordinates,x,y){for(var i=0;i<touchCoordinates.length;i+=2){if(hit(touchCoordinates[i],touchCoordinates[i+1],x,y)){touchCoordinates.splice(i,i+2);return true;}}
return false;}
function onClick(event){if(Date.now()-lastPreventedTime>PREVENT_DURATION){return;}
var touches=event.touches&&event.touches.length?event.touches:[event];var x=touches[0].clientX;var y=touches[0].clientY;if(x<1&&y<1){return;}
if(checkAllowableRegions(touchCoordinates,x,y)){return;}
event.stopPropagation();event.preventDefault();}
function onTouchStart(event){var touches=event.touches&&event.touches.length?event.touches:[event];var x=touches[0].clientX;var y=touches[0].clientY;touchCoordinates.push(x,y);$timeout(function(){for(var i=0;i<touchCoordinates.length;i+=2){if(touchCoordinates[i]==x&&touchCoordinates[i+1]==y){touchCoordinates.splice(i,i+2);return;}}},PREVENT_DURATION,false);}
function preventGhostClick(x,y){if(!touchCoordinates){$rootElement[0].addEventListener('click',onClick,true);$rootElement[0].addEventListener('touchstart',onTouchStart,true);touchCoordinates=[];}
lastPreventedTime=Date.now();checkAllowableRegions(touchCoordinates,x,y);}
return function(scope,element,attr){var clickHandler=$parse(attr.ngClick),tapping=false,tapElement,startTime,touchStartX,touchStartY;function resetState(){tapping=false;element.removeClass(ACTIVE_CLASS_NAME);}
element.bind('touchstart',function(event){tapping=true;tapElement=event.target?event.target:event.srcElement;if(tapElement.nodeType==3){tapElement=tapElement.parentNode;}
element.addClass(ACTIVE_CLASS_NAME);startTime=Date.now();var touches=event.touches&&event.touches.length?event.touches:[event];var e=touches[0].originalEvent||touches[0];touchStartX=e.clientX;touchStartY=e.clientY;});element.bind('touchmove',function(event){resetState();});element.bind('touchcancel',function(event){resetState();});element.bind('touchend',function(event){var diff=Date.now()-startTime;var touches=(event.changedTouches&&event.changedTouches.length)?event.changedTouches:((event.touches&&event.touches.length)?event.touches:[event]);var e=touches[0].originalEvent||touches[0];var x=e.clientX;var y=e.clientY;var dist=Math.sqrt(Math.pow(x-touchStartX,2)+Math.pow(y-touchStartY,2));if(tapping&&diff<TAP_DURATION&&dist<MOVE_TOLERANCE){preventGhostClick(x,y);if(tapElement){tapElement.blur();}
scope.$apply(function(){clickHandler(scope,{$event:event});});}
resetState();});element.onclick=function(event){};element.bind('click',function(event){scope.$apply(function(){clickHandler(scope,{$event:event});});});};}]);function makeSwipeDirective(directiveName,direction){ngMobile.directive(directiveName,['$parse',function($parse){var MAX_VERTICAL_DISTANCE=75;var MAX_VERTICAL_RATIO=0.3;var MIN_HORIZONTAL_DISTANCE=30;var MOVE_BUFFER_RADIUS=10;function getCoordinates(event){var touches=event.touches&&event.touches.length?event.touches:[event];var e=(event.changedTouches&&event.changedTouches[0])||(event.originalEvent&&event.originalEvent.changedTouches&&event.originalEvent.changedTouches[0])||touches[0].originalEvent||touches[0];return{x:e.clientX,y:e.clientY};}
return function(scope,element,attr){var swipeHandler=$parse(attr[directiveName]);var startCoords,valid;var totalX,totalY;var lastX,lastY;function validSwipe(event){if(!startCoords)return false;var coords=getCoordinates(event);var deltaY=Math.abs(coords.y-startCoords.y);var deltaX=(coords.x-startCoords.x)*direction;return valid&&deltaY<MAX_VERTICAL_DISTANCE&&deltaX>0&&deltaX>MIN_HORIZONTAL_DISTANCE&&deltaY/deltaX<MAX_VERTICAL_RATIO;}
element.bind('touchstart mousedown',function(event){startCoords=getCoordinates(event);valid=true;totalX=0;totalY=0;lastX=startCoords.x;lastY=startCoords.y;});element.bind('touchcancel',function(event){valid=false;});element.bind('touchmove mousemove',function(event){if(!valid)return;if(!startCoords)return;var coords=getCoordinates(event);if(Math.abs(coords.y-startCoords.y)>MAX_VERTICAL_DISTANCE){valid=false;return;}
totalX+=Math.abs(coords.x-lastX);totalY+=Math.abs(coords.y-lastY);lastX=coords.x;lastY=coords.y;if(totalX<MOVE_BUFFER_RADIUS&&totalY<MOVE_BUFFER_RADIUS){return;}
if(totalY>totalX){valid=false;return;}else{event.preventDefault();}});element.bind('touchend mouseup',function(event){if(validSwipe(event)){event.stopPropagation();scope.$apply(function(){swipeHandler(scope,{$event:event});});}});};}]);}
makeSwipeDirective('ngSwipeLeft',-1);makeSwipeDirective('ngSwipeRight',1);})(window,window.angular);
;;;
(function(I,h){'use strict';function i(a){var d={},a=a.split(","),c;for(c=0;c<a.length;c++)d[a[c]]=!0;return d}function z(a,d){function c(a,b,c,f){b=h.lowercase(b);if(m[b])for(;e.last()&&n[e.last()];)g("",e.last());o[b]&&e.last()==b&&g("",b);(f=p[b]||!!f)||e.push(b);var j={};c.replace(A,function(a,b,d,c,g){j[b]=k(d||c||g||"")});d.start&&d.start(b,j,f)}function g(a,b){var c=0,g;if(b=h.lowercase(b))for(c=e.length-1;c>=0;c--)if(e[c]==b)break;if(c>=0){for(g=e.length-1;g>=c;g--)d.end&&d.end(e[g]);e.length=c}}var b,f,e=[],j=a;for(e.last=function(){return e[e.length-1]};a;){f=!0;if(!e.last()||!q[e.last()]){if(a.indexOf("<\!--")===0)b=a.indexOf("--\>"),b>=0&&(d.comment&&d.comment(a.substring(4,b)),a=a.substring(b+3),f=!1);else if(B.test(a)){if(b=a.match(r))a=a.substring(b[0].length),b[0].replace(r,g),f=!1}else if(C.test(a)&&(b=a.match(s)))a=a.substring(b[0].length),b[0].replace(s,c),f=!1;f&&(b=a.indexOf("<"),f=b<0?a:a.substring(0,b),a=b<0?"":a.substring(b),d.chars&&d.chars(k(f)))}else a=a.replace(RegExp("(.*)<\\s*\\/\\s*"+
e.last()+"[^>]*>","i"),function(a,b){b=b.replace(D,"$1").replace(E,"$1");d.chars&&d.chars(k(b));return""}),g("",e.last());if(a==j)throw"Parse Error: "+a;j=a}g()}function k(a){l.innerHTML=a.replace(/</g,"&lt;");return l.innerText||l.textContent||""}function t(a){return a.replace(/&/g,"&amp;").replace(F,function(a){return"&#"+a.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function u(a){var d=!1,c=h.bind(a,a.push);return{start:function(a,b,f){a=h.lowercase(a);!d&&q[a]&&(d=a);!d&&v[a]==!0&&(c("<"),c(a),h.forEach(b,function(a,b){var d=h.lowercase(b);if(G[d]==!0&&(w[d]!==!0||a.match(H)))c(" "),c(b),c('="'),c(t(a)),c('"')}),c(f?"/>":">"))},end:function(a){a=h.lowercase(a);!d&&v[a]==!0&&(c("</"),c(a),c(">"));a==d&&(d=!1)},chars:function(a){d||c(t(a))}}}var s=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,r=/^<\s*\/\s*([\w:-]+)[^>]*>/,A=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,C=/^</,B=/^<\s*\//,D=/<\!--(.*?)--\>/g,E=/<!\[CDATA\[(.*?)]]\>/g,H=/^((ftp|https?):\/\/|mailto:|tel:|#)/,F=/([^\#-~| |!])/g,p=i("area,br,col,hr,img,wbr"),x=i("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),y=i("rp,rt"),o=h.extend({},y,x),m=h.extend({},x,i("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),n=h.extend({},y,i("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),q=i("script,style"),v=h.extend({},p,m,n,o),w=i("background,cite,href,longdesc,src,usemap"),G=h.extend({},w,i("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,span,start,summary,target,title,type,valign,value,vspace,width")),l=document.createElement("pre");h.module("ngSanitize",[]).value("$sanitize",function(a){var d=[];z(a,u(d));return d.join("")});h.module("ngSanitize").directive("ngBindHtml",["$sanitize",function(a){return function(d,c,g){c.addClass("ng-binding").data("$binding",g.ngBindHtml);d.$watch(g.ngBindHtml,function(b){b=a(b);c.html(b||"")})}}]);h.module("ngSanitize").filter("linky",function(){var a=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s\.\;\,\(\)\{\}\<\>]/,d=/^mailto:/;return function(c,g){if(!c)return c;var b,f=c,e=[],j=u(e),i,k,l={};if(h.isDefined(g))l.target=g;for(;b=f.match(a);)i=b[0],b[2]==b[3]&&(i="mailto:"+i),k=b.index,j.chars(f.substr(0,k)),l.href=i,j.start("a",l),j.chars(b[0].replace(d,"")),j.end("a"),f=f.substring(k+b[0].length);j.chars(f);return e.join("")}})})(window,window.angular);
;;;
angular.module('ui.sortable',[]).value('uiSortableConfig',{}).directive('uiSortable',['uiSortableConfig','$timeout','$log',function(uiSortableConfig,$timeout,$log){return{require:'?ngModel',link:function(scope,element,attrs,ngModel){var savedNodes;function combineCallbacks(first,second){if(second&&(typeof second==='function')){return function(e,ui){first(e,ui);second(e,ui);};}
return first;}
function hasSortingHelper(element,ui){var helperOption=element.sortable('option','helper');return helperOption==='clone'||(typeof helperOption==='function'&&ui.item.sortable.isCustomHelperUsed());}
var opts={};var callbacks={receive:null,remove:null,start:null,stop:null,update:null};var wrappers={helper:null};angular.extend(opts,uiSortableConfig,scope.$eval(attrs.uiSortable));if(!angular.element.fn||!angular.element.fn.jquery){$log.error('ui.sortable: jQuery should be included before AngularJS!');return;}
if(ngModel){scope.$watch(attrs.ngModel+'.length',function(){$timeout(function(){if(!!element.data('ui-sortable')){element.sortable('refresh');}});});callbacks.start=function(e,ui){ui.item.sortable={index:ui.item.index(),cancel:function(){ui.item.sortable._isCanceled=true;},isCanceled:function(){return ui.item.sortable._isCanceled;},isCustomHelperUsed:function(){return!!ui.item.sortable._isCustomHelperUsed;},_isCanceled:false,_isCustomHelperUsed:ui.item.sortable._isCustomHelperUsed};};callbacks.activate=function(){savedNodes=element.contents();var placeholder=element.sortable('option','placeholder');if(placeholder&&placeholder.element&&typeof placeholder.element==='function'){var phElement=placeholder.element();phElement=angular.element(phElement);var excludes=element.find('[class="'+phElement.attr('class')+'"]');savedNodes=savedNodes.not(excludes);}};callbacks.update=function(e,ui){if(!ui.item.sortable.received){ui.item.sortable.dropindex=ui.item.index();ui.item.sortable.droptarget=ui.item.parent();element.sortable('cancel');}
if(hasSortingHelper(element,ui)&&!ui.item.sortable.received&&element.sortable('option','appendTo')==='parent'){savedNodes=savedNodes.not(savedNodes.last());}
savedNodes.appendTo(element);if(ui.item.sortable.received){savedNodes=null;}
if(ui.item.sortable.received&&!ui.item.sortable.isCanceled()){scope.$apply(function(){ngModel.$modelValue.splice(ui.item.sortable.dropindex,0,ui.item.sortable.moved);});}};callbacks.stop=function(e,ui){if(!ui.item.sortable.received&&('dropindex'in ui.item.sortable)&&!ui.item.sortable.isCanceled()){scope.$apply(function(){ngModel.$modelValue.splice(ui.item.sortable.dropindex,0,ngModel.$modelValue.splice(ui.item.sortable.index,1)[0]);});}else{if((!('dropindex'in ui.item.sortable)||ui.item.sortable.isCanceled())&&!hasSortingHelper(element,ui)){savedNodes.appendTo(element);}}
savedNodes=null;};callbacks.receive=function(e,ui){ui.item.sortable.received=true;};callbacks.remove=function(e,ui){if(!('dropindex'in ui.item.sortable)){element.sortable('cancel');ui.item.sortable.cancel();}
if(!ui.item.sortable.isCanceled()){scope.$apply(function(){ui.item.sortable.moved=ngModel.$modelValue.splice(ui.item.sortable.index,1)[0];});}};wrappers.helper=function(inner){if(inner&&typeof inner==='function'){return function(e,item){var innerResult=inner(e,item);item.sortable._isCustomHelperUsed=item!==innerResult;return innerResult;};}
return inner;};scope.$watch(attrs.uiSortable,function(newVal){if(!!element.data('ui-sortable')){angular.forEach(newVal,function(value,key){if(callbacks[key]){if(key==='stop'){value=combineCallbacks(value,function(){scope.$apply();});}
value=combineCallbacks(callbacks[key],value);}else if(wrappers[key]){value=wrappers[key](value);}
element.sortable('option',key,value);});}},true);angular.forEach(callbacks,function(value,key){opts[key]=combineCallbacks(value,opts[key]);});}else{$log.info('ui.sortable: ngModel not provided!',element);}
element.sortable(opts);}};}]);
;;;
!function(a,b){"function"==typeof define&&define.amd?define([],function(){return b()}):"object"==typeof exports?module.exports=b():b()}(this,function(){"use strict";return angular.module("tmh.dynamicLocale",[]).config(["$provide",function(a){function b(a){return a.$stateful=!0,a}a.decorator("dateFilter",["$delegate",b]),a.decorator("numberFilter",["$delegate",b]),a.decorator("currencyFilter",["$delegate",b])}]).constant("tmhDynamicLocale.STORAGE_KEY","tmhDynamicLocale.locale").provider("tmhDynamicLocale",["tmhDynamicLocale.STORAGE_KEY",function(a){function b(a,b,c,d){var e=document.createElement("script"),f=document.getElementsByTagName("body")[0],g=!1;e.type="text/javascript",e.readyState?e.onreadystatechange=function(){("complete"===e.readyState||"loaded"===e.readyState)&&(e.onreadystatechange=null,d(function(){g||(g=!0,f.removeChild(e),b())},30,!1))}:(e.onload=function(){g||(g=!0,f.removeChild(e),b())},e.onerror=function(){g||(g=!0,f.removeChild(e),c())}),e.src=a,e.async=!0,f.appendChild(e)}function c(a,c,d,g,h,k,l){function m(a,b){f===d&&(angular.forEach(a,function(c,d){b[d]?angular.isArray(b[d])&&(a[d].length=b[d].length):delete a[d]}),angular.forEach(b,function(c,d){angular.isArray(b[d])||angular.isObject(b[d])?(a[d]||(a[d]=angular.isArray(b[d])?[]:{}),m(a[d],b[d])):a[d]=b[d]}))}if(j[d])return f=d,j[d];var n,o=h.defer();return d===f?o.resolve(c):(n=k.get(d))?(f=d,g.$evalAsync(function(){m(c,n),e.put(i,d),g.$broadcast("$localeChangeSuccess",d,c),o.resolve(c)})):(f=d,j[d]=o.promise,b(a,function(){var a=angular.injector(["ngLocale"]),b=a.get("$locale");m(c,b),k.put(d,b),delete j[d],g.$apply(function(){e.put(i,d),g.$broadcast("$localeChangeSuccess",d,c),o.resolve(c)})},function(){delete j[d],g.$apply(function(){f===d&&(f=c.id),g.$broadcast("$localeChangeError",d),o.reject(d)})},l)),o.promise}var d,e,f,g="angular/i18n/angular-locale_{{locale}}.js",h="tmhDynamicLocaleStorageCache",i=a,j={};this.localeLocationPattern=function(a){return a?(g=a,this):g},this.useStorage=function(a){h=a},this.useCookieStorage=function(){this.useStorage("$cookieStore")},this.defaultLocale=function(a){d=a},this.storageKey=function(a){return a?(i=a,this):i},this.$get=["$rootScope","$injector","$interpolate","$locale","$q","tmhDynamicLocaleCache","$timeout",function(a,b,j,k,l,m,n){function o(b){return c(p({locale:b,angularVersion:angular.version.full}),k,b,a,l,m,n)}var p=j(g);return e=b.get(h),a.$evalAsync(function(){var a;(a=e.get(i)||d)&&o(a)}),{set:o,get:function(){return f}}}]}]).provider("tmhDynamicLocaleCache",function(){this.$get=["$cacheFactory",function(a){return a("tmh.dynamicLocales")}]}).provider("tmhDynamicLocaleStorageCache",function(){this.$get=["$cacheFactory",function(a){return a("tmh.dynamicLocales.store")}]}).run(["tmhDynamicLocale",angular.noop]),"tmh.dynamicLocale"});
;;;
!window.XMLHttpRequest||window.FileAPI&&FileAPI.shouldLoad||(window.XMLHttpRequest.prototype.setRequestHeader=function(a){return function(b,c){if("__setXHR_"===b){var d=c(this);d instanceof Function&&d(this)}else a.apply(this,arguments)}}(window.XMLHttpRequest.prototype.setRequestHeader));var ngFileUpload=angular.module("ngFileUpload",[]);ngFileUpload.version="7.3.9",ngFileUpload.service("UploadBase",["$http","$q","$timeout",function(a,b,c){function d(d){function g(a){j.notify&&j.notify(a),k.progressFunc&&c(function(){k.progressFunc(a)})}function h(a){return null!=d._start&&f?{loaded:a.loaded+d._start,total:d._file.size,type:a.type,config:d,lengthComputable:!0,target:a.target}:a}function i(){a(d).then(function(a){f&&d._chunkSize&&!d._finished?(g({loaded:d._end,total:d._file.size,config:d,type:"progress"}),e.upload(d)):(d._finished&&delete d._finished,j.resolve(a))},function(a){j.reject(a)},function(a){j.notify(a)})}d.method=d.method||"POST",d.headers=d.headers||{};var j=d._deferred=d._deferred||b.defer(),k=j.promise;return d.headers.__setXHR_=function(){return function(a){a&&(d.__XHR=a,d.xhrFn&&d.xhrFn(a),a.upload.addEventListener("progress",function(a){a.config=d,g(h(a))},!1),a.upload.addEventListener("load",function(a){a.lengthComputable&&(a.config=d,g(h(a)))},!1))}},f?d._chunkSize&&d._end&&!d._finished?(d._start=d._end,d._end+=d._chunkSize,i()):d.resumeSizeUrl?a.get(d.resumeSizeUrl).then(function(a){d._start=d.resumeSizeResponseReader?d.resumeSizeResponseReader(a.data):parseInt((null==a.data.size?a.data:a.data.size).toString()),d._chunkSize&&(d._end=d._start+d._chunkSize),i()},function(a){throw a}):d.resumeSize?d.resumeSize().then(function(a){d._start=a,i()},function(a){throw a}):i():i(),k.success=function(a){return k.then(function(b){a(b.data,b.status,b.headers,d)}),k},k.error=function(a){return k.then(null,function(b){a(b.data,b.status,b.headers,d)}),k},k.progress=function(a){return k.progressFunc=a,k.then(null,null,function(b){a(b)}),k},k.abort=k.pause=function(){return d.__XHR&&c(function(){d.__XHR.abort()}),k},k.xhr=function(a){return d.xhrFn=function(b){return function(){b&&b.apply(k,arguments),a.apply(k,arguments)}}(d.xhrFn),k},k}var e=this;this.isResumeSupported=function(){return window.Blob&&(new Blob).slice};var f=this.isResumeSupported();this.upload=function(a){function b(c,d,e){if(void 0!==d)if(angular.isDate(d)&&(d=d.toISOString()),angular.isString(d))c.append(e,d);else if("form"===a.sendFieldsAs)if(angular.isObject(d))for(var f in d)d.hasOwnProperty(f)&&b(c,d[f],e+"["+f+"]");else c.append(e,d);else d=angular.isString(d)?d:angular.toJson(d),"json-blob"===a.sendFieldsAs?c.append(e,new Blob([d],{type:"application/json"})):c.append(e,d)}function c(a){return a instanceof Blob||a.flashId&&a.name&&a.size}function g(b,d,e){if(c(d)){if(a._file=a._file||d,null!=a._start&&f){a._end&&a._end>=d.size&&(a._finished=!0,a._end=d.size);var h=d.slice(a._start,a._end||d.size);h.name=d.name,d=h,a._chunkSize&&(b.append("chunkSize",a._end-a._start),b.append("chunkNumber",Math.floor(a._start/a._chunkSize)),b.append("totalSize",a._file.size))}b.append(e,d,d.fileName||d.name)}else{if(!angular.isObject(d))throw"Expected file object in Upload.upload file option: "+d.toString();for(var i in d)if(d.hasOwnProperty(i)){var j=i.split(",");j[1]&&(d[i].fileName=j[1].replace(/^\s+|\s+$/g,"")),g(b,d[i],j[0])}}}return a._chunkSize=e.translateScalars(a.resumeChunkSize),a._chunkSize=a._chunkSize?parseInt(a._chunkSize.toString()):null,a.headers=a.headers||{},a.headers["Content-Type"]=void 0,a.transformRequest=a.transformRequest?angular.isArray(a.transformRequest)?a.transformRequest:[a.transformRequest]:[],a.transformRequest.push(function(c){var d,e=new FormData,f={};for(d in a.fields)a.fields.hasOwnProperty(d)&&(f[d]=a.fields[d]);c&&(f.data=c);for(d in f)if(f.hasOwnProperty(d)){var h=f[d];a.formDataAppender?a.formDataAppender(e,d,h):b(e,h,d)}if(null!=a.file)if(angular.isArray(a.file))for(var i=0;i<a.file.length;i++)g(e,a.file[i],"file");else g(e,a.file,"file");return e}),d(a)},this.http=function(b){return b.transformRequest=b.transformRequest||function(b){return window.ArrayBuffer&&b instanceof window.ArrayBuffer||b instanceof Blob?b:a.defaults.transformRequest[0].apply(this,arguments)},b._chunkSize=e.translateScalars(b.resumeChunkSize),b._chunkSize=b._chunkSize?parseInt(b._chunkSize.toString()):null,d(b)},this.translateScalars=function(a){if(angular.isString(a)){if(a.search(/kb/i)===a.length-2)return parseFloat(1e3*a.substring(0,a.length-2));if(a.search(/mb/i)===a.length-2)return parseFloat(1e6*a.substring(0,a.length-2));if(a.search(/gb/i)===a.length-2)return parseFloat(1e9*a.substring(0,a.length-2));if(a.search(/b/i)===a.length-1)return parseFloat(a.substring(0,a.length-1));if(a.search(/s/i)===a.length-1)return parseFloat(a.substring(0,a.length-1));if(a.search(/m/i)===a.length-1)return parseFloat(60*a.substring(0,a.length-1));if(a.search(/h/i)===a.length-1)return parseFloat(3600*a.substring(0,a.length-1))}return a},this.setDefaults=function(a){this.defaults=a||{}},this.defaults={},this.version=ngFileUpload.version}]),ngFileUpload.service("Upload",["$parse","$timeout","$compile","UploadResize",function(a,b,c,d){var e=d;return e.getAttrWithDefaults=function(a,b){return null!=a[b]?a[b]:null==e.defaults[b]?e.defaults[b]:e.defaults[b].toString()},e.attrGetter=function(b,c,d,e){if(!d)return this.getAttrWithDefaults(c,b);try{return e?a(this.getAttrWithDefaults(c,b))(d,e):a(this.getAttrWithDefaults(c,b))(d)}catch(f){if(b.search(/min|max|pattern/i))return this.getAttrWithDefaults(c,b);throw f}},e.updateModel=function(c,d,f,g,h,i,j){function k(){var j=h&&h.length?h[0]:null;if(c){var k=!e.attrGetter("ngfMultiple",d,f)&&!e.attrGetter("multiple",d)&&!p;a(e.attrGetter("ngModel",d)).assign(f,k?j:h)}var l=e.attrGetter("ngfModel",d);l&&a(l).assign(f,h),g&&a(g)(f,{$files:h,$file:j,$newFiles:m,$duplicateFiles:n,$event:i}),b(function(){})}function l(a,b){var c=e.attrGetter("ngfResize",d,f);if(!c||!e.isResizeSupported())return b();for(var g=a.length,h=function(){g--,0===g&&b()},i=function(b){return function(c){a.splice(b,1,c),h()}},j=function(a){return function(b){h(),a.$error="resize",a.$errorParam=(b?(b.message?b.message:b)+": ":"")+(a&&a.name)}},k=0;k<a.length;k++){var l=a[k];l.$error||0!==l.type.indexOf("image")?h():e.resize(l,c.width,c.height,c.quality).then(i(k),j(l))}}var m=h,n=[],o=(c&&c.$modelValue||d.$$ngfPrevFiles||[]).slice(0),p=e.attrGetter("ngfKeep",d,f);if(p===!0){if(!h||!h.length)return;var q=!1;if(e.attrGetter("ngfKeepDistinct",d,f)===!0){for(var r=o.length,s=0;s<h.length;s++){for(var t=0;r>t;t++)if(h[s].name===o[t].name){n.push(h[s]);break}t===r&&(o.push(h[s]),q=!0)}if(!q)return;h=o}else h=o.concat(h)}d.$$ngfPrevFiles=h,j?k():e.validate(h,c,d,f,e.attrGetter("ngfValidateLater",d),function(){l(h,function(){b(function(){k()})})});for(var u=o.length;u--;){var v=o[u];window.URL&&v.blobUrl&&(URL.revokeObjectURL(v.blobUrl),delete v.blobUrl)}},e}]),ngFileUpload.directive("ngfSelect",["$parse","$timeout","$compile","Upload",function(a,b,c,d){function e(a){var b=a.match(/Android[^\d]*(\d+)\.(\d+)/);if(b&&b.length>2){var c=d.defaults.androidFixMinorVersion||4;return parseInt(b[1])<4||parseInt(b[1])===c&&parseInt(b[2])<c}return-1===a.indexOf("Chrome")&&/.*Windows.*Safari.*/.test(a)}function f(a,b,c,d,f,h,i,j){function k(){return"input"===b[0].tagName.toLowerCase()&&c.type&&"file"===c.type.toLowerCase()}function l(){return t("ngfChange")||t("ngfSelect")}function m(b){for(var e=b.__files_||b.target&&b.target.files,f=[],g=0;g<e.length;g++)f.push(e[g]);j.updateModel(d,c,a,l(),f.length?f:null,b)}function n(a){if(b!==a)for(var c=0;c<b[0].attributes.length;c++){var d=b[0].attributes[c];"type"!==d.name&&"class"!==d.name&&"id"!==d.name&&"style"!==d.name&&((null==d.value||""===d.value)&&("required"===d.name&&(d.value="required"),"multiple"===d.name&&(d.value="multiple")),a.attr(d.name,d.value))}}function o(){if(k())return b;var a=angular.element('<input type="file">');return n(a),a.css("visibility","hidden").css("position","absolute").css("overflow","hidden").css("width","0px").css("height","0px").css("border","none").css("margin","0px").css("padding","0px").attr("tabindex","-1"),g.push({el:b,ref:a}),document.body.appendChild(a[0]),a}function p(c){if(b.attr("disabled")||t("ngfSelectDisabled",a))return!1;var d=q(c);return null!=d?d:(r(c),e(navigator.userAgent)?setTimeout(function(){w[0].click()},0):w[0].click(),!1)}function q(a){var b=a.changedTouches||a.originalEvent&&a.originalEvent.changedTouches;if("touchstart"===a.type)return v=b?b[0].clientY:0,!0;if(a.stopPropagation(),a.preventDefault(),"touchend"===a.type){var c=b?b[0].clientY:0;if(Math.abs(c-v)>20)return!1}}function r(b){w.val()&&(w.val(null),j.updateModel(d,c,a,l(),null,b,!0))}function s(a){if(w&&!w.attr("__ngf_ie10_Fix_")){if(!w[0].parentNode)return void(w=null);a.preventDefault(),a.stopPropagation(),w.unbind("click");var b=w.clone();return w.replaceWith(b),w=b,w.attr("__ngf_ie10_Fix_","true"),w.bind("change",m),w.bind("click",s),w[0].click(),!1}w.removeAttr("__ngf_ie10_Fix_")}var t=function(a,b){return j.attrGetter(a,c,b)},u=[];u.push(a.$watch(t("ngfMultiple"),function(){w.attr("multiple",t("ngfMultiple",a))})),u.push(a.$watch(t("ngfCapture"),function(){w.attr("capture",t("ngfCapture",a))})),c.$observe("accept",function(){w.attr("accept",t("accept"))}),u.push(function(){c.$$observers&&delete c.$$observers.accept});var v=0,w=b;k()||(w=o()),w.bind("change",m),k()?b.bind("click",r):b.bind("click touchstart touchend",p),j.registerValidators(d,w,c,a),-1!==navigator.appVersion.indexOf("MSIE 10")&&w.bind("click",s),a.$on("$destroy",function(){k()||w.remove(),angular.forEach(u,function(a){a()})}),h(function(){for(var a=0;a<g.length;a++){var b=g[a];document.body.contains(b.el[0])||(g.splice(a,1),b.ref.remove())}}),window.FileAPI&&window.FileAPI.ngfFixIE&&window.FileAPI.ngfFixIE(b,w,m)}var g=[];return{restrict:"AEC",require:"?ngModel",link:function(e,g,h,i){f(e,g,h,i,a,b,c,d)}}}]),function(){function a(a){return"img"===a.tagName.toLowerCase()?"image":"audio"===a.tagName.toLowerCase()?"audio":"video"===a.tagName.toLowerCase()?"video":/./}function b(b,c,d,e,f,g,h,i){function j(a){var g=b.attrGetter("ngfNoObjectUrl",f,d);b.dataUrl(a,g)["finally"](function(){c(function(){var b=(g?a.dataUrl:a.blobUrl)||a.dataUrl;i?e.css("background-image","url('"+(b||"")+"')"):e.attr("src",b),b?e.removeClass("ngf-hide"):e.addClass("ngf-hide")})})}c(function(){var c=d.$watch(f[g],function(c){var d=h;if("ngfThumbnail"===g&&(d||(d={width:e[0].clientWidth,height:e[0].clientHeight}),0===d.width&&window.getComputedStyle)){var f=getComputedStyle(e[0]);d={width:parseInt(f.width.slice(0,-2)),height:parseInt(f.height.slice(0,-2))}}return angular.isString(c)?(e.removeClass("ngf-hide"),i?e.css("background-image","url('"+c+"')"):e.attr("src",c)):void(!c||!c.type||0!==c.type.search(a(e[0]))||i&&0!==c.type.indexOf("image")?e.addClass("ngf-hide"):d&&b.isResizeSupported()?b.resize(c,d.width,d.height,d.quality).then(function(a){j(a)},function(a){throw a}):j(c))});d.$on("$destroy",function(){c()})})}ngFileUpload.service("UploadDataUrl",["UploadBase","$timeout","$q",function(a,b,c){var d=a;return d.dataUrl=function(a,d){if(d&&null!=a.dataUrl||!d&&null!=a.blobUrl){var e=c.defer();return b(function(){e.resolve(d?a.dataUrl:a.blobUrl)}),e.promise}var f=d?a.$ngfDataUrlPromise:a.$ngfBlobUrlPromise;if(f)return f;var g=c.defer();return b(function(){if(window.FileReader&&a&&(!window.FileAPI||-1===navigator.userAgent.indexOf("MSIE 8")||a.size<2e4)&&(!window.FileAPI||-1===navigator.userAgent.indexOf("MSIE 9")||a.size<4e6)){var c=window.URL||window.webkitURL;if(c&&c.createObjectURL&&!d){var e;try{e=c.createObjectURL(a)}catch(f){return void b(function(){a.blobUrl="",g.reject()})}b(function(){a.blobUrl=e,e&&g.resolve(e)})}else{var h=new FileReader;h.onload=function(c){b(function(){a.dataUrl=c.target.result,g.resolve(c.target.result)})},h.onerror=function(){b(function(){a.dataUrl="",g.reject()})},h.readAsDataURL(a)}}else b(function(){a[d?"dataUrl":"blobUrl"]="",g.reject()})}),f=d?a.$ngfDataUrlPromise=g.promise:a.$ngfBlobUrlPromise=g.promise,f["finally"](function(){delete a[d?"$ngfDataUrlPromise":"$ngfBlobUrlPromise"]}),f},d}]);var c=angular.element("<style>.ngf-hide{display:none !important}</style>");document.getElementsByTagName("head")[0].appendChild(c[0]),ngFileUpload.directive("ngfSrc",["Upload","$timeout",function(a,c){return{restrict:"AE",link:function(d,e,f){b(a,c,d,e,f,"ngfSrc",a.attrGetter("ngfResize",f,d),!1)}}}]),ngFileUpload.directive("ngfBackground",["Upload","$timeout",function(a,c){return{restrict:"AE",link:function(d,e,f){b(a,c,d,e,f,"ngfBackground",a.attrGetter("ngfResize",f,d),!0)}}}]),ngFileUpload.directive("ngfThumbnail",["Upload","$timeout",function(a,c){return{restrict:"AE",link:function(d,e,f){var g=a.attrGetter("ngfSize",f,d);b(a,c,d,e,f,"ngfThumbnail",g,a.attrGetter("ngfAsBackground",f,d))}}}])}(),ngFileUpload.service("UploadValidate",["UploadDataUrl","$q","$timeout",function(a,b,c){function d(a){var b="",c=[];if(a.length>2&&"/"===a[0]&&"/"===a[a.length-1])b=a.substring(1,a.length-1);else{var e=a.split(",");if(e.length>1)for(var f=0;f<e.length;f++){var g=d(e[f]);g.regexp?(b+="("+g.regexp+")",f<e.length-1&&(b+="|")):c=c.concat(g.excludes)}else 0===a.indexOf("!")?c.push("^((?!"+d(a.substring(1)).regexp+").)*$"):(0===a.indexOf(".")&&(a="*"+a),b="^"+a.replace(new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\-]","g"),"\\$&")+"$",b=b.replace(/\\\*/g,".*").replace(/\\\?/g,"."))}return{regexp:b,excludes:c}}var e=a;return e.registerValidators=function(a,b,c,d){function f(a){angular.forEach(a.$ngfValidations,function(b){a.$setValidity(b.name,b.valid)})}a&&(a.$ngfValidations=[],a.$formatters.push(function(g){return e.attrGetter("ngfValidateLater",c,d)||!a.$$ngfValidated?(e.validate(g,a,c,d,!1,function(){f(a),a.$$ngfValidated=!1}),g&&0===g.length&&(g=null),!b||null!=g&&0!==g.length||b.val()&&b.val(null)):(f(a),a.$$ngfValidated=!1),g}))},e.validatePattern=function(a,b){if(!b)return!0;var c=d(b),e=!0;if(c.regexp&&c.regexp.length){var f=new RegExp(c.regexp,"i");e=null!=a.type&&f.test(a.type)||null!=a.name&&f.test(a.name)}for(var g=c.excludes.length;g--;){var h=new RegExp(c.excludes[g],"i");e=e&&(null==a.type||h.test(a.type))&&(null==a.name||h.test(a.name))}return e},e.validate=function(a,b,c,d,f,g){function h(c,d,e){if(a){for(var f="ngf"+c[0].toUpperCase()+c.substr(1),g=a.length,h=null;g--;){var i=a[g],k=j(f,{$file:i});null==k&&(k=d(j("ngfValidate")||{}),h=null==h?!0:h),null!=k&&(e(i,k)||(i.$error=c,i.$errorParam=k,a.splice(g,1),h=!1))}null!==h&&b.$ngfValidations.push({name:c,valid:h})}}function i(c,d,e,f,h){if(a){var i=0,l=!1,m="ngf"+c[0].toUpperCase()+c.substr(1);a=void 0===a.length?[a]:a,angular.forEach(a,function(a){if(0!==a.type.search(e))return!0;var n=j(m,{$file:a})||d(j("ngfValidate",{$file:a})||{});n&&(k++,i++,f(a,n).then(function(b){h(b,n)||(a.$error=c,a.$errorParam=n,l=!0)},function(){j("ngfValidateForce",{$file:a})&&(a.$error=c,a.$errorParam=n,l=!0)})["finally"](function(){k--,i--,i||b.$ngfValidations.push({name:c,valid:!l}),k||g.call(b,b.$ngfValidations)}))})}}b=b||{},b.$ngfValidations=b.$ngfValidations||[],angular.forEach(b.$ngfValidations,function(a){a.valid=!0});var j=function(a,b){return e.attrGetter(a,c,d,b)};if(f)return void g.call(b);if(b.$$ngfValidated=!0,null==a||0===a.length)return void g.call(b);if(a=void 0===a.length?[a]:a.slice(0),h("pattern",function(a){return a.pattern},e.validatePattern),h("minSize",function(a){return a.size&&a.size.min},function(a,b){return a.size>=e.translateScalars(b)}),h("maxSize",function(a){return a.size&&a.size.max},function(a,b){return a.size<=e.translateScalars(b)}),h("validateFn",function(){return null},function(a,b){return b===!0||null===b||""===b}),!a.length)return void g.call(b,b.$ngfValidations);var k=0;i("maxHeight",function(a){return a.height&&a.height.max},/image/,this.imageDimensions,function(a,b){return a.height<=b}),i("minHeight",function(a){return a.height&&a.height.min},/image/,this.imageDimensions,function(a,b){return a.height>=b}),i("maxWidth",function(a){return a.width&&a.width.max},/image/,this.imageDimensions,function(a,b){return a.width<=b}),i("minWidth",function(a){return a.width&&a.width.min},/image/,this.imageDimensions,function(a,b){return a.width>=b}),i("ratio",function(a){return a.ratio},/image/,this.imageDimensions,function(a,b){for(var c=b.toString().split(","),d=!1,e=0;e<c.length;e++){var f=c[e],g=f.search(/x/i);f=g>-1?parseFloat(f.substring(0,g))/parseFloat(f.substring(g+1)):parseFloat(f),Math.abs(a.width/a.height-f)<1e-4&&(d=!0)}return d}),i("maxDuration",function(a){return a.duration&&a.duration.max},/audio|video/,this.mediaDuration,function(a,b){return a<=e.translateScalars(b)}),i("minDuration",function(a){return a.duration&&a.duration.min},/audio|video/,this.mediaDuration,function(a,b){return a>=e.translateScalars(b)}),i("validateAsyncFn",function(){return null},/./,function(a,b){return b},function(a){return a===!0||null===a||""===a}),k||g.call(b,b.$ngfValidations)},e.imageDimensions=function(a){if(a.width&&a.height){var d=b.defer();return c(function(){d.resolve({width:a.width,height:a.height})}),d.promise}if(a.$ngfDimensionPromise)return a.$ngfDimensionPromise;var f=b.defer();return c(function(){return 0!==a.type.indexOf("image")?void f.reject("not image"):void e.dataUrl(a).then(function(b){function d(){var b=h[0].clientWidth,c=h[0].clientHeight;h.remove(),a.width=b,a.height=c,f.resolve({width:b,height:c})}function e(){h.remove(),f.reject("load error")}function g(){c(function(){h[0].parentNode&&(h[0].clientWidth?d():i>10?e():g())},1e3)}var h=angular.element("<img>").attr("src",b).css("visibility","hidden").css("position","fixed");h.on("load",d),h.on("error",e);var i=0;g(),angular.element(document.getElementsByTagName("body")[0]).append(h)},function(){f.reject("load error")})}),a.$ngfDimensionPromise=f.promise,a.$ngfDimensionPromise["finally"](function(){delete a.$ngfDimensionPromise}),a.$ngfDimensionPromise},e.mediaDuration=function(a){if(a.duration){var d=b.defer();return c(function(){d.resolve(a.duration)}),d.promise}if(a.$ngfDurationPromise)return a.$ngfDurationPromise;var f=b.defer();return c(function(){return 0!==a.type.indexOf("audio")&&0!==a.type.indexOf("video")?void f.reject("not media"):void e.dataUrl(a).then(function(b){function d(){var b=h[0].duration;a.duration=b,h.remove(),f.resolve(b)}function e(){h.remove(),f.reject("load error")}function g(){c(function(){h[0].parentNode&&(h[0].duration?d():i>10?e():g())},1e3)}var h=angular.element(0===a.type.indexOf("audio")?"<audio>":"<video>").attr("src",b).css("visibility","none").css("position","fixed");h.on("loadedmetadata",d),h.on("error",e);var i=0;g(),angular.element(document.body).append(h)},function(){f.reject("load error")})}),a.$ngfDurationPromise=f.promise,a.$ngfDurationPromise["finally"](function(){delete a.$ngfDurationPromise}),a.$ngfDurationPromise},e}]),ngFileUpload.service("UploadResize",["UploadValidate","$q","$timeout",function(a,b,c){var d=a,e=function(a,b,c,d){var e=Math.min(c/a,d/b);return{width:a*e,height:b*e}},f=function(a,c,d,f,g){var h=b.defer(),i=document.createElement("canvas"),j=document.createElement("img");return 0===c&&(c=j.width,d=j.height),j.onload=function(){try{var a=e(j.width,j.height,c,d);i.width=a.width,i.height=a.height;var b=i.getContext("2d");b.drawImage(j,0,0,a.width,a.height),h.resolve(i.toDataURL(g||"image/WebP",f||1))}catch(k){h.reject(k)}},j.onerror=function(){h.reject()},j.src=a,h.promise},g=function(a){for(var b=a.split(","),c=b[0].match(/:(.*?);/)[1],d=atob(b[1]),e=d.length,f=new Uint8Array(e);e--;)f[e]=d.charCodeAt(e);return new Blob([f],{type:c})};return d.isResizeSupported=function(){var a=document.createElement("canvas");return window.atob&&a.getContext&&a.getContext("2d")},d.resize=function(a,e,h,i){var j=b.defer();return 0!==a.type.indexOf("image")?(c(function(){j.resolve("Only images are allowed for resizing!")}),j.promise):(d.dataUrl(a,!0).then(function(b){f(b,e,h,i,a.type).then(function(b){var c=g(b);c.name=a.name,j.resolve(c)},function(){j.reject()})},function(){j.reject()}),j.promise)},d}]),function(){function a(a,c,d,e,f,g,h,i){function j(){return c.attr("disabled")||n("ngfDropDisabled",a)}function k(a,b,c,d){var e=n("ngfDragOverClass",a,{$event:c}),f=n("ngfDragOverClass")||"dragover";if(angular.isString(e))return void d(e);if(e&&(e.delay&&(r=e.delay),e.accept||e.reject)){var g=c.dataTransfer.items;if(null!=g)for(var h=n("ngfPattern",a,{$event:c}),j=0;j<g.length;j++)if("file"===g[j].kind||""===g[j].kind){if(!i.validatePattern(g[j],h)){f=e.reject;break}f=e.accept}}d(f)}function l(a,b,c,d){function e(a,b,c){if(null!=b)if(b.isDirectory){var d=(c||"")+b.name;a.push({name:b.name,type:"directory",path:d});var f=b.createReader(),g=[];i++;var h=function(){f.readEntries(function(d){try{if(d.length)g=g.concat(Array.prototype.slice.call(d||[],0)),h();else{for(var f=0;f<g.length;f++)e(a,g[f],(c?c:"")+b.name+"/");i--}}catch(j){i--,console.error(j)}},function(){i--})};h()}else i++,b.file(function(b){try{i--,b.path=(c?c:"")+b.name,a.push(b)}catch(d){i--,console.error(d)}},function(){i--})}var f=[],i=0,j=a.dataTransfer.items;if(j&&j.length>0&&"file"!==h.protocol())for(var k=0;k<j.length;k++){if(j[k].webkitGetAsEntry&&j[k].webkitGetAsEntry()&&j[k].webkitGetAsEntry().isDirectory){var l=j[k].webkitGetAsEntry();if(l.isDirectory&&!c)continue;null!=l&&e(f,l)}else{var m=j[k].getAsFile();null!=m&&f.push(m)}if(!d&&f.length>0)break}else{var n=a.dataTransfer.files;if(null!=n)for(var o=0;o<n.length&&(f.push(n.item(o)),d||!(f.length>0));o++);}var p=0;!function q(a){g(function(){if(i)10*p++<2e4&&q(10);else{if(!d&&f.length>1){for(k=0;"directory"===f[k].type;)k++;f=[f[k]]}b(f)}},a||0)}()}var m=b(),n=function(a,b,c){return i.attrGetter(a,d,b,c)};if(n("dropAvailable")&&g(function(){a[n("dropAvailable")]?a[n("dropAvailable")].value=m:a[n("dropAvailable")]=m}),!m)return void(n("ngfHideOnDropNotAvailable",a)===!0&&c.css("display","none"));i.registerValidators(e,null,d,a);var o,p=null,q=f(n("ngfStopPropagation")),r=1;c[0].addEventListener("dragover",function(b){if(!j()){if(b.preventDefault(),q(a)&&b.stopPropagation(),navigator.userAgent.indexOf("Chrome")>-1){var e=b.dataTransfer.effectAllowed;b.dataTransfer.dropEffect="move"===e||"linkMove"===e?"move":"copy"}g.cancel(p),o||(o="C",k(a,d,b,function(a){o=a,c.addClass(o)}))}},!1),c[0].addEventListener("dragenter",function(b){j()||(b.preventDefault(),q(a)&&b.stopPropagation())},!1),c[0].addEventListener("dragleave",function(){j()||(p=g(function(){o&&c.removeClass(o),o=null},r||1))},!1),c[0].addEventListener("drop",function(b){j()||(b.preventDefault(),q(a)&&b.stopPropagation(),o&&c.removeClass(o),o=null,l(b,function(c){i.updateModel(e,d,a,n("ngfChange")||n("ngfDrop"),c,b)},n("ngfAllowDir",a)!==!1,n("multiple")||n("ngfMultiple",a)))},!1),c[0].addEventListener("paste",function(b){if(!j()){var c=[],f=b.clipboardData||b.originalEvent.clipboardData;if(f&&f.items){for(var g=0;g<f.items.length;g++)-1!==f.items[g].type.indexOf("image")&&c.push(f.items[g].getAsFile());i.updateModel(e,d,a,n("ngfChange")||n("ngfDrop"),c,b)}}},!1)}function b(){var a=document.createElement("div");return"draggable"in a&&"ondrop"in a&&!/Edge\/12./i.test(navigator.userAgent)}ngFileUpload.directive("ngfDrop",["$parse","$timeout","$location","Upload",function(b,c,d,e){return{restrict:"AEC",require:"?ngModel",link:function(f,g,h,i){a(f,g,h,i,b,c,d,e)}}}]),ngFileUpload.directive("ngfNoFileDrop",function(){return function(a,c){b()&&c.css("display","none")}}),ngFileUpload.directive("ngfDropAvailable",["$parse","$timeout","Upload",function(a,c,d){return function(e,f,g){if(b()){var h=a(d.attrGetter("ngfDropAvailable",g));c(function(){h(e),h.assign&&h.assign(e,!0)})}}}])}();
;;;
!function(a,b){var c=b.isDefined,d=b.isUndefined,e=b.isNumber,f=b.isObject,g=b.isArray,h=b.extend,i=b.toJson;b.module("LocalStorageModule",[]).provider("localStorageService",function(){this.prefix="ls",this.storageType="localStorage",this.cookie={expiry:30,path:"/"},this.notify={setItem:!0,removeItem:!1},this.setPrefix=function(a){return this.prefix=a,this},this.setStorageType=function(a){return this.storageType=a,this},this.setStorageCookie=function(a,b){return this.cookie.expiry=a,this.cookie.path=b,this},this.setStorageCookieDomain=function(a){return this.cookie.domain=a,this},this.setNotify=function(a,b){return this.notify={setItem:a,removeItem:b},this},this.$get=["$rootScope","$window","$document","$parse",function(a,b,j,k){var l,m=this,n=m.prefix,o=m.cookie,p=m.notify,q=m.storageType;j?j[0]&&(j=j[0]):j=document,"."!==n.substr(-1)&&(n=n?n+".":"");var r=function(a){return n+a},s=function(){try{var c=q in b&&null!==b[q],d=r("__"+Math.round(1e7*Math.random()));return c&&(l=b[q],l.setItem(d,""),l.removeItem(d)),c}catch(e){return q="cookie",a.$broadcast("LocalStorageModule.notification.error",e.message),!1}}(),t=function(b,c){if(c=d(c)?null:i(c),!s||"cookie"===m.storageType)return s||a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),p.setItem&&a.$broadcast("LocalStorageModule.notification.setitem",{key:b,newvalue:c,storageType:"cookie"}),z(b,c);try{l&&l.setItem(r(b),c),p.setItem&&a.$broadcast("LocalStorageModule.notification.setitem",{key:b,newvalue:c,storageType:m.storageType})}catch(e){return a.$broadcast("LocalStorageModule.notification.error",e.message),z(b,c)}return!0},u=function(b){if(!s||"cookie"===m.storageType)return s||a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),A(b);var c=l?l.getItem(r(b)):null;if(!c||"null"===c)return null;try{return JSON.parse(c)}catch(d){return c}},v=function(){var b,c;for(b=0;b<arguments.length;b++)if(c=arguments[b],s&&"cookie"!==m.storageType)try{l.removeItem(r(c)),p.removeItem&&a.$broadcast("LocalStorageModule.notification.removeitem",{key:c,storageType:m.storageType})}catch(d){a.$broadcast("LocalStorageModule.notification.error",d.message),B(c)}else s||a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),p.removeItem&&a.$broadcast("LocalStorageModule.notification.removeitem",{key:c,storageType:"cookie"}),B(c)},w=function(){if(!s)return a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),[];var b=n.length,c=[];for(var d in l)if(d.substr(0,b)===n)try{c.push(d.substr(b))}catch(e){return a.$broadcast("LocalStorageModule.notification.error",e.Description),[]}return c},x=function(b){var c=n?new RegExp("^"+n):new RegExp,d=b?new RegExp(b):new RegExp;if(!s||"cookie"===m.storageType)return s||a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),C();var e=n.length;for(var f in l)if(c.test(f)&&d.test(f.substr(e)))try{v(f.substr(e))}catch(g){return a.$broadcast("LocalStorageModule.notification.error",g.message),C()}return!0},y=function(){try{return b.navigator.cookieEnabled||"cookie"in j&&(j.cookie.length>0||(j.cookie="test").indexOf.call(j.cookie,"test")>-1)}catch(c){return a.$broadcast("LocalStorageModule.notification.error",c.message),!1}}(),z=function(b,c,h){if(d(c))return!1;if((g(c)||f(c))&&(c=i(c)),!y)return a.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;try{var k="",l=new Date,m="";if(null===c?(l.setTime(l.getTime()+-864e5),k="; expires="+l.toGMTString(),c=""):e(h)&&0!==h?(l.setTime(l.getTime()+24*h*60*60*1e3),k="; expires="+l.toGMTString()):0!==o.expiry&&(l.setTime(l.getTime()+24*o.expiry*60*60*1e3),k="; expires="+l.toGMTString()),b){var n="; path="+o.path;o.domain&&(m="; domain="+o.domain),j.cookie=r(b)+"="+encodeURIComponent(c)+k+n+m}}catch(p){return a.$broadcast("LocalStorageModule.notification.error",p.message),!1}return!0},A=function(b){if(!y)return a.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;for(var c=j.cookie&&j.cookie.split(";")||[],d=0;d<c.length;d++){for(var e=c[d];" "===e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(r(b)+"=")){var f=decodeURIComponent(e.substring(n.length+b.length+1,e.length));try{return JSON.parse(f)}catch(g){return f}}}return null},B=function(a){z(a,null)},C=function(){for(var a=null,b=n.length,c=j.cookie.split(";"),d=0;d<c.length;d++){for(a=c[d];" "===a.charAt(0);)a=a.substring(1,a.length);var e=a.substring(b,a.indexOf("="));B(e)}},D=function(){return q},E=function(a,b,d,e){e=e||b;var g=u(e);return null===g&&c(d)?g=d:f(g)&&f(d)&&(g=h(g,d)),k(b).assign(a,g),a.$watch(b,function(a){t(e,a)},f(a[b]))},F=function(){for(var a=0,c=b[q],d=0;d<c.length;d++)0===c.key(d).indexOf(n)&&a++;return a};return{isSupported:s,getStorageType:D,set:t,add:t,get:u,keys:w,remove:v,clearAll:x,bind:E,deriveKey:r,length:F,cookie:{isSupported:y,set:z,add:z,get:A,remove:B,clearAll:C}}}]})}(window,window.angular);
;;;
!function(e){"use strict";e(function(){e.support.transition=function(){var e=function(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},n;for(n in t)if(e.style[n]!==undefined)return t[n]}();return e&&{end:e}}()})}(window.jQuery),!function(e){"use strict";var t='[data-dismiss="alert"]',n=function(n){e(n).on("click",t,this.close)};n.prototype.close=function(t){function s(){i.trigger("closed").remove()}var n=e(this),r=n.attr("data-target"),i;r||(r=n.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,"")),i=e(r),t&&t.preventDefault(),i.length||(i=n.hasClass("alert")?n:n.parent()),i.trigger(t=e.Event("close"));if(t.isDefaultPrevented())return;i.removeClass("in"),e.support.transition&&i.hasClass("fade")?i.on(e.support.transition.end,s):s()};var r=e.fn.alert;e.fn.alert=function(t){return this.each(function(){var r=e(this),i=r.data("alert");i||r.data("alert",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.alert.Constructor=n,e.fn.alert.noConflict=function(){return e.fn.alert=r,this},e(document).on("click.alert.data-api",t,n.prototype.close)}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.button.defaults,n)};t.prototype.setState=function(e){var t="disabled",n=this.$element,r=n.data(),i=n.is("input")?"val":"html";e+="Text",r.resetText||n.data("resetText",n[i]()),n[i](r[e]||this.options[e]),setTimeout(function(){e=="loadingText"?n.addClass(t).attr(t,t):n.removeClass(t).removeAttr(t)},0)},t.prototype.toggle=function(){var e=this.$element.closest('[data-toggle="buttons-radio"]');e&&e.find(".active").removeClass("active"),this.$element.toggleClass("active")};var n=e.fn.button;e.fn.button=function(n){return this.each(function(){var r=e(this),i=r.data("button"),s=typeof n=="object"&&n;i||r.data("button",i=new t(this,s)),n=="toggle"?i.toggle():n&&i.setState(n)})},e.fn.button.defaults={loadingText:"loading..."},e.fn.button.Constructor=t,e.fn.button.noConflict=function(){return e.fn.button=n,this},e(document).on("click.button.data-api","[data-toggle^=button]",function(t){var n=e(t.target);n.hasClass("btn")||(n=n.closest(".btn")),n.button("toggle")})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.$indicators=this.$element.find(".carousel-indicators"),this.options=n,this.options.pause=="hover"&&this.$element.on("mouseenter",e.proxy(this.pause,this)).on("mouseleave",e.proxy(this.cycle,this))};t.prototype={cycle:function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},getActiveIndex:function(){return this.$active=this.$element.find(".item.active"),this.$items=this.$active.parent().children(),this.$items.index(this.$active)},to:function(t){var n=this.getActiveIndex(),r=this;if(t>this.$items.length-1||t<0)return;return this.sliding?this.$element.one("slid",function(){r.to(t)}):n==t?this.pause().cycle():this.slide(t>n?"next":"prev",e(this.$items[t]))},pause:function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&e.support.transition.end&&(this.$element.trigger(e.support.transition.end),this.cycle(!0)),clearInterval(this.interval),this.interval=null,this},next:function(){if(this.sliding)return;return this.slide("next")},prev:function(){if(this.sliding)return;return this.slide("prev")},slide:function(t,n){var r=this.$element.find(".item.active"),i=n||r[t](),s=this.interval,o=t=="next"?"left":"right",u=t=="next"?"first":"last",a=this,f;this.sliding=!0,s&&this.pause(),i=i.length?i:this.$element.find(".item")[u](),f=e.Event("slide",{relatedTarget:i[0],direction:o});if(i.hasClass("active"))return;this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),this.$element.one("slid",function(){var t=e(a.$indicators.children()[a.getActiveIndex()]);t&&t.addClass("active")}));if(e.support.transition&&this.$element.hasClass("slide")){this.$element.trigger(f);if(f.isDefaultPrevented())return;i.addClass(t),i[0].offsetWidth,r.addClass(o),i.addClass(o),this.$element.one(e.support.transition.end,function(){i.removeClass([t,o].join(" ")).addClass("active"),r.removeClass(["active",o].join(" ")),a.sliding=!1,setTimeout(function(){a.$element.trigger("slid")},0)})}else{this.$element.trigger(f);if(f.isDefaultPrevented())return;r.removeClass("active"),i.addClass("active"),this.sliding=!1,this.$element.trigger("slid")}return s&&this.cycle(),this}};var n=e.fn.carousel;e.fn.carousel=function(n){return this.each(function(){var r=e(this),i=r.data("carousel"),s=e.extend({},e.fn.carousel.defaults,typeof n=="object"&&n),o=typeof n=="string"?n:s.slide;i||r.data("carousel",i=new t(this,s)),typeof n=="number"?i.to(n):o?i[o]():s.interval&&i.pause().cycle()})},e.fn.carousel.defaults={interval:5e3,pause:"hover"},e.fn.carousel.Constructor=t,e.fn.carousel.noConflict=function(){return e.fn.carousel=n,this},e(document).on("click.carousel.data-api","[data-slide], [data-slide-to]",function(t){var n=e(this),r,i=e(n.attr("data-target")||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,"")),s=e.extend({},i.data(),n.data()),o;i.carousel(s),(o=n.attr("data-slide-to"))&&i.data("carousel").pause().to(o).cycle(),t.preventDefault()})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.collapse.defaults,n),this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};t.prototype={constructor:t,dimension:function(){var e=this.$element.hasClass("width");return e?"width":"height"},show:function(){var t,n,r,i;if(this.transitioning||this.$element.hasClass("in"))return;t=this.dimension(),n=e.camelCase(["scroll",t].join("-")),r=this.$parent&&this.$parent.find("> .accordion-group > .in");if(r&&r.length){i=r.data("collapse");if(i&&i.transitioning)return;r.collapse("hide"),i||r.data("collapse",null)}this.$element[t](0),this.transition("addClass",e.Event("show"),"shown"),e.support.transition&&this.$element[t](this.$element[0][n])},hide:function(){var t;if(this.transitioning||!this.$element.hasClass("in"))return;t=this.dimension(),this.reset(this.$element[t]()),this.transition("removeClass",e.Event("hide"),"hidden"),this.$element[t](0)},reset:function(e){var t=this.dimension();return this.$element.removeClass("collapse")[t](e||"auto")[0].offsetWidth,this.$element[e!==null?"addClass":"removeClass"]("collapse"),this},transition:function(t,n,r){var i=this,s=function(){n.type=="show"&&i.reset(),i.transitioning=0,i.$element.trigger(r)};this.$element.trigger(n);if(n.isDefaultPrevented())return;this.transitioning=1,this.$element[t]("in"),e.support.transition&&this.$element.hasClass("collapse")?this.$element.one(e.support.transition.end,s):s()},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}};var n=e.fn.collapse;e.fn.collapse=function(n){return this.each(function(){var r=e(this),i=r.data("collapse"),s=e.extend({},e.fn.collapse.defaults,r.data(),typeof n=="object"&&n);i||r.data("collapse",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.collapse.defaults={toggle:!0},e.fn.collapse.Constructor=t,e.fn.collapse.noConflict=function(){return e.fn.collapse=n,this},e(document).on("click.collapse.data-api","[data-toggle=collapse]",function(t){var n=e(this),r,i=n.attr("data-target")||t.preventDefault()||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,""),s=e(i).data("collapse")?"toggle":n.data();n[e(i).hasClass("in")?"addClass":"removeClass"]("collapsed"),e(i).collapse(s)})}(window.jQuery),!function(e){"use strict";function r(){e(".dropdown-backdrop").remove(),e(t).each(function(){i(e(this)).removeClass("open")})}function i(t){var n=t.attr("data-target"),r;n||(n=t.attr("href"),n=n&&/#/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,"")),r=n&&e(n);if(!r||!r.length)r=t.parent();return r}var t="[data-toggle=dropdown]",n=function(t){var n=e(t).on("click.dropdown.data-api",this.toggle);e("html").on("click.dropdown.data-api",function(){n.parent().removeClass("open")})};n.prototype={constructor:n,toggle:function(t){var n=e(this),s,o;if(n.is(".disabled, :disabled"))return;return s=i(n),o=s.hasClass("open"),r(),o||("ontouchstart"in document.documentElement&&e('<div class="dropdown-backdrop"/>').insertBefore(e(this)).on("click",r),s.toggleClass("open")),n.focus(),!1},keydown:function(n){var r,s,o,u,a,f;if(!/(38|40|27)/.test(n.keyCode))return;r=e(this),n.preventDefault(),n.stopPropagation();if(r.is(".disabled, :disabled"))return;u=i(r),a=u.hasClass("open");if(!a||a&&n.keyCode==27)return n.which==27&&u.find(t).focus(),r.click();s=e("[role=menu] li:not(.divider):visible a",u);if(!s.length)return;f=s.index(s.filter(":focus")),n.keyCode==38&&f>0&&f--,n.keyCode==40&&f<s.length-1&&f++,~f||(f=0),s.eq(f).focus()}};var s=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var r=e(this),i=r.data("dropdown");i||r.data("dropdown",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.dropdown.Constructor=n,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=s,this},e(document).on("click.dropdown.data-api",r).on("click.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.dropdown.data-api",t,n.prototype.toggle).on("keydown.dropdown.data-api",t+", [role=menu]",n.prototype.keydown)}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.options=n,this.$element=e(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",e.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};t.prototype={constructor:t,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this,n=e.Event("show");this.$element.trigger(n);if(this.isShown||n.isDefaultPrevented())return;this.isShown=!0,this.escape(),this.backdrop(function(){var n=e.support.transition&&t.$element.hasClass("fade");t.$element.parent().length||t.$element.appendTo(document.body),t.$element.show(),n&&t.$element[0].offsetWidth,t.$element.addClass("in").attr("aria-hidden",!1),t.enforceFocus(),n?t.$element.one(e.support.transition.end,function(){t.$element.focus().trigger("shown")}):t.$element.focus().trigger("shown")})},hide:function(t){t&&t.preventDefault();var n=this;t=e.Event("hide"),this.$element.trigger(t);if(!this.isShown||t.isDefaultPrevented())return;this.isShown=!1,this.escape(),e(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),e.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal()},enforceFocus:function(){var t=this;e(document).on("focusin.modal",function(e){t.$element[0]!==e.target&&!t.$element.has(e.target).length&&t.$element.focus()})},escape:function(){var e=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(t){t.which==27&&e.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var t=this,n=setTimeout(function(){t.$element.off(e.support.transition.end),t.hideModal()},500);this.$element.one(e.support.transition.end,function(){clearTimeout(n),t.hideModal()})},hideModal:function(){var e=this;this.$element.hide(),this.backdrop(function(){e.removeBackdrop(),e.$element.trigger("hidden")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(t){var n=this,r=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var i=e.support.transition&&r;this.$backdrop=e('<div class="modal-backdrop '+r+'" />').appendTo(document.body),this.$backdrop.click(this.options.backdrop=="static"?e.proxy(this.$element[0].focus,this.$element[0]):e.proxy(this.hide,this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in");if(!t)return;i?this.$backdrop.one(e.support.transition.end,t):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,t):t()):t&&t()}};var n=e.fn.modal;e.fn.modal=function(n){return this.each(function(){var r=e(this),i=r.data("modal"),s=e.extend({},e.fn.modal.defaults,r.data(),typeof n=="object"&&n);i||r.data("modal",i=new t(this,s)),typeof n=="string"?i[n]():s.show&&i.show()})},e.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=n,this},e(document).on("click.modal.data-api",'[data-toggle="modal"]',function(t){var n=e(this),r=n.attr("href"),i=e(n.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),s=i.data("modal")?"toggle":e.extend({remote:!/#/.test(r)&&r},i.data(),n.data());t.preventDefault(),i.modal(s).one("hide",function(){n.focus()})})}(window.jQuery),!function(e){"use strict";var t=function(e,t){this.init("tooltip",e,t)};t.prototype={constructor:t,init:function(t,n,r){var i,s,o,u,a;this.type=t,this.$element=e(n),this.options=this.getOptions(r),this.enabled=!0,o=this.options.trigger.split(" ");for(a=o.length;a--;)u=o[a],u=="click"?this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this)):u!="manual"&&(i=u=="hover"?"mouseenter":"focus",s=u=="hover"?"mouseleave":"blur",this.$element.on(i+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(s+"."+this.type,this.options.selector,e.proxy(this.leave,this)));this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){return t=e.extend({},e.fn[this.type].defaults,this.$element.data(),t),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},enter:function(t){var n=e.fn[this.type].defaults,r={},i;this._options&&e.each(this._options,function(e,t){n[e]!=t&&(r[e]=t)},this),i=e(t.currentTarget)[this.type](r).data(this.type);if(!i.options.delay||!i.options.delay.show)return i.show();clearTimeout(this.timeout),i.hoverState="in",this.timeout=setTimeout(function(){i.hoverState=="in"&&i.show()},i.options.delay.show)},leave:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);this.timeout&&clearTimeout(this.timeout);if(!n.options.delay||!n.options.delay.hide)return n.hide();n.hoverState="out",this.timeout=setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide)},show:function(){var t,n,r,i,s,o,u=e.Event("show");if(this.hasContent()&&this.enabled){this.$element.trigger(u);if(u.isDefaultPrevented())return;t=this.tip(),this.setContent(),this.options.animation&&t.addClass("fade"),s=typeof this.options.placement=="function"?this.options.placement.call(this,t[0],this.$element[0]):this.options.placement,t.detach().css({top:0,left:0,display:"block"}),this.options.container?t.appendTo(this.options.container):t.insertAfter(this.$element),n=this.getPosition(),r=t[0].offsetWidth,i=t[0].offsetHeight;switch(s){case"bottom":o={top:n.top+n.height,left:n.left+n.width/2-r/2};break;case"top":o={top:n.top-i,left:n.left+n.width/2-r/2};break;case"left":o={top:n.top+n.height/2-i/2,left:n.left-r};break;case"right":o={top:n.top+n.height/2-i/2,left:n.left+n.width}}this.applyPlacement(o,s),this.$element.trigger("shown")}},applyPlacement:function(e,t){var n=this.tip(),r=n[0].offsetWidth,i=n[0].offsetHeight,s,o,u,a;n.offset(e).addClass(t).addClass("in"),s=n[0].offsetWidth,o=n[0].offsetHeight,t=="top"&&o!=i&&(e.top=e.top+i-o,a=!0),t=="bottom"||t=="top"?(u=0,e.left<0&&(u=e.left*-2,e.left=0,n.offset(e),s=n[0].offsetWidth,o=n[0].offsetHeight),this.replaceArrow(u-r+s,s,"left")):this.replaceArrow(o-i,o,"top"),a&&n.offset(e)},replaceArrow:function(e,t,n){this.arrow().css(n,e?50*(1-e/t)+"%":"")},setContent:function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},hide:function(){function i(){var t=setTimeout(function(){n.off(e.support.transition.end).detach()},500);n.one(e.support.transition.end,function(){clearTimeout(t),n.detach()})}var t=this,n=this.tip(),r=e.Event("hide");this.$element.trigger(r);if(r.isDefaultPrevented())return;return n.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?i():n.detach(),this.$element.trigger("hidden"),this},fixTitle:function(){var e=this.$element;(e.attr("title")||typeof e.attr("data-original-title")!="string")&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},hasContent:function(){return this.getTitle()},getPosition:function(){var t=this.$element[0];return e.extend({},typeof t.getBoundingClientRect=="function"?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())},getTitle:function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title),e},tip:function(){return this.$tip=this.$tip||e(this.options.template)},arrow:function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(t){var n=t?e(t.currentTarget)[this.type](this._options).data(this.type):this;n.tip().hasClass("in")?n.hide():n.show()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}};var n=e.fn.tooltip;e.fn.tooltip=function(n){return this.each(function(){var r=e(this),i=r.data("tooltip"),s=typeof n=="object"&&n;i||r.data("tooltip",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},e.fn.tooltip.noConflict=function(){return e.fn.tooltip=n,this}}(window.jQuery),!function(e){"use strict";var t=function(e,t){this.init("popover",e,t)};t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype,{constructor:t,setContent:function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content")[this.options.html?"html":"text"](n),e.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var e,t=this.$element,n=this.options;return e=(typeof n.content=="function"?n.content.call(t[0]):n.content)||t.attr("data-content"),e},tip:function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}});var n=e.fn.popover;e.fn.popover=function(n){return this.each(function(){var r=e(this),i=r.data("popover"),s=typeof n=="object"&&n;i||r.data("popover",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.popover.Constructor=t,e.fn.popover.defaults=e.extend({},e.fn.tooltip.defaults,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),e.fn.popover.noConflict=function(){return e.fn.popover=n,this}}(window.jQuery),!function(e){"use strict";function t(t,n){var r=e.proxy(this.process,this),i=e(t).is("body")?e(window):e(t),s;this.options=e.extend({},e.fn.scrollspy.defaults,n),this.$scrollElement=i.on("scroll.scroll-spy.data-api",r),this.selector=(this.options.target||(s=e(t).attr("href"))&&s.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.$body=e("body"),this.refresh(),this.process()}t.prototype={constructor:t,refresh:function(){var t=this,n;this.offsets=e([]),this.targets=e([]),n=this.$body.find(this.selector).map(function(){var n=e(this),r=n.data("target")||n.attr("href"),i=/^#\w/.test(r)&&e(r);return i&&i.length&&[[i.position().top+(!e.isWindow(t.$scrollElement.get(0))&&t.$scrollElement.scrollTop()),r]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){t.offsets.push(this[0]),t.targets.push(this[1])})},process:function(){var e=this.$scrollElement.scrollTop()+this.options.offset,t=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,n=t-this.$scrollElement.height(),r=this.offsets,i=this.targets,s=this.activeTarget,o;if(e>=n)return s!=(o=i.last()[0])&&this.activate(o);for(o=r.length;o--;)s!=i[o]&&e>=r[o]&&(!r[o+1]||e<=r[o+1])&&this.activate(i[o])},activate:function(t){var n,r;this.activeTarget=t,e(this.selector).parent(".active").removeClass("active"),r=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',n=e(r).parent("li").addClass("active"),n.parent(".dropdown-menu").length&&(n=n.closest("li.dropdown").addClass("active")),n.trigger("activate")}};var n=e.fn.scrollspy;e.fn.scrollspy=function(n){return this.each(function(){var r=e(this),i=r.data("scrollspy"),s=typeof n=="object"&&n;i||r.data("scrollspy",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.scrollspy.Constructor=t,e.fn.scrollspy.defaults={offset:10},e.fn.scrollspy.noConflict=function(){return e.fn.scrollspy=n,this},e(window).on("load",function(){e('[data-spy="scroll"]').each(function(){var t=e(this);t.scrollspy(t.data())})})}(window.jQuery),!function(e){"use strict";var t=function(t){this.element=e(t)};t.prototype={constructor:t,show:function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),r=t.attr("data-target"),i,s,o;r||(r=t.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));if(t.parent("li").hasClass("active"))return;i=n.find(".active:last a")[0],o=e.Event("show",{relatedTarget:i}),t.trigger(o);if(o.isDefaultPrevented())return;s=e(r),this.activate(t.parent("li"),n),this.activate(s,s.parent(),function(){t.trigger({type:"shown",relatedTarget:i})})},activate:function(t,n,r){function o(){i.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),s?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),r&&r()}var i=n.find("> .active"),s=r&&e.support.transition&&i.hasClass("fade");s?i.one(e.support.transition.end,o):o(),i.removeClass("in")}};var n=e.fn.tab;e.fn.tab=function(n){return this.each(function(){var r=e(this),i=r.data("tab");i||r.data("tab",i=new t(this)),typeof n=="string"&&i[n]()})},e.fn.tab.Constructor=t,e.fn.tab.noConflict=function(){return e.fn.tab=n,this},e(document).on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault(),e(this).tab("show")})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.typeahead.defaults,n),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.source=this.options.source,this.$menu=e(this.options.menu),this.shown=!1,this.listen()};t.prototype={constructor:t,select:function(){var e=this.$menu.find(".active").attr("data-value");return this.$element.val(this.updater(e)).change(),this.hide()},updater:function(e){return e},show:function(){var t=e.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return this.$menu.insertAfter(this.$element).css({top:t.top+t.height,left:t.left}).show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(t){var n;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(n=e.isFunction(this.source)?this.source(this.query,e.proxy(this.process,this)):this.source,n?this.process(n):this)},process:function(t){var n=this;return t=e.grep(t,function(e){return n.matcher(e)}),t=this.sorter(t),t.length?this.render(t.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(e){return~e.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(e){var t=[],n=[],r=[],i;while(i=e.shift())i.toLowerCase().indexOf(this.query.toLowerCase())?~i.indexOf(this.query)?n.push(i):r.push(i):t.push(i);return t.concat(n,r)},highlighter:function(e){var t=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return e.replace(new RegExp("("+t+")","ig"),function(e,t){return"<strong>"+t+"</strong>"})},render:function(t){var n=this;return t=e(t).map(function(t,r){return t=e(n.options.item).attr("data-value",r),t.find("a").html(n.highlighter(r)),t[0]}),t.first().addClass("active"),this.$menu.html(t),this},next:function(t){var n=this.$menu.find(".active").removeClass("active"),r=n.next();r.length||(r=e(this.$menu.find("li")[0])),r.addClass("active")},prev:function(e){var t=this.$menu.find(".active").removeClass("active"),n=t.prev();n.length||(n=this.$menu.find("li").last()),n.addClass("active")},listen:function(){this.$element.on("focus",e.proxy(this.focus,this)).on("blur",e.proxy(this.blur,this)).on("keypress",e.proxy(this.keypress,this)).on("keyup",e.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",e.proxy(this.keydown,this)),this.$menu.on("click",e.proxy(this.click,this)).on("mouseenter","li",e.proxy(this.mouseenter,this)).on("mouseleave","li",e.proxy(this.mouseleave,this))},eventSupported:function(e){var t=e in this.$element;return t||(this.$element.setAttribute(e,"return;"),t=typeof this.$element[e]=="function"),t},move:function(e){if(!this.shown)return;switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:e.preventDefault(),this.prev();break;case 40:e.preventDefault(),this.next()}e.stopPropagation()},keydown:function(t){this.suppressKeyPressRepeat=~e.inArray(t.keyCode,[40,38,9,13,27]),this.move(t)},keypress:function(e){if(this.suppressKeyPressRepeat)return;this.move(e)},keyup:function(e){switch(e.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}e.stopPropagation(),e.preventDefault()},focus:function(e){this.focused=!0},blur:function(e){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(e){e.stopPropagation(),e.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(t){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),e(t.currentTarget).addClass("active")},mouseleave:function(e){this.mousedover=!1,!this.focused&&this.shown&&this.hide()}};var n=e.fn.typeahead;e.fn.typeahead=function(n){return this.each(function(){var r=e(this),i=r.data("typeahead"),s=typeof n=="object"&&n;i||r.data("typeahead",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},e.fn.typeahead.Constructor=t,e.fn.typeahead.noConflict=function(){return e.fn.typeahead=n,this},e(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var n=e(this);if(n.data("typeahead"))return;n.typeahead(n.data())})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.options=e.extend({},e.fn.affix.defaults,n),this.$window=e(window).on("scroll.affix.data-api",e.proxy(this.checkPosition,this)).on("click.affix.data-api",e.proxy(function(){setTimeout(e.proxy(this.checkPosition,this),1)},this)),this.$element=e(t),this.checkPosition()};t.prototype.checkPosition=function(){if(!this.$element.is(":visible"))return;var t=e(document).height(),n=this.$window.scrollTop(),r=this.$element.offset(),i=this.options.offset,s=i.bottom,o=i.top,u="affix affix-top affix-bottom",a;typeof i!="object"&&(s=o=i),typeof o=="function"&&(o=i.top()),typeof s=="function"&&(s=i.bottom()),a=this.unpin!=null&&n+this.unpin<=r.top?!1:s!=null&&r.top+this.$element.height()>=t-s?"bottom":o!=null&&n<=o?"top":!1;if(this.affixed===a)return;this.affixed=a,this.unpin=a=="bottom"?r.top-n:null,this.$element.removeClass(u).addClass("affix"+(a?"-"+a:""))};var n=e.fn.affix;e.fn.affix=function(n){return this.each(function(){var r=e(this),i=r.data("affix"),s=typeof n=="object"&&n;i||r.data("affix",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.affix.Constructor=t,e.fn.affix.defaults={offset:0},e.fn.affix.noConflict=function(){return e.fn.affix=n,this},e(window).on("load",function(){e('[data-spy="affix"]').each(function(){var t=e(this),n=t.data();n.offset=n.offset||{},n.offsetBottom&&(n.offset.bottom=n.offsetBottom),n.offsetTop&&(n.offset.top=n.offsetTop),t.affix(n)})})}(window.jQuery);
;;;
!function($){var WinReszier=(function(){var registered=[];var inited=false;var timer;var resize=function(ev){clearTimeout(timer);timer=setTimeout(notify,100);};var notify=function(){for(var i=0,cnt=registered.length;i<cnt;i++){registered[i].apply();}};return{register:function(fn){registered.push(fn);if(inited===false){$(window).bind('resize',resize);inited=true;}},unregister:function(fn){var index=registered.indexOf(fn);if(index>-1){registered.splice(index,1);}}};}());var TabDrop=function(element,options){this.element=$(element);this.dropdown=$('<li class="dropdown hide pull-right tabdrop">'+'<a class="dropdown-toggle" data-toggle="dropdown" href="#">'+
options.text+' <b class="caret"></b></a>'+'<ul class="dropdown-menu"></ul></li>').prependTo(this.element);if(this.element.parent().is('.tabs-below')){this.dropdown.addClass('dropup');}
this.resizeCallback=$.proxy(this.layout,this);WinReszier.register(this.resizeCallback);this.layout();};TabDrop.prototype={constructor:TabDrop,layout:function(){var collection=[];this.dropdown.removeClass('hide');this.element.append(this.dropdown.find('li')).find('>li').not('.tabdrop').each(function(){if(this.offsetTop>0){collection.push(this);}});if(collection.length>0){collection=$(collection);this.dropdown.find('ul').empty().append(collection);if(this.dropdown.find('.active').length==1){this.dropdown.addClass('active');}else{this.dropdown.removeClass('active');}}else{this.dropdown.addClass('hide');}},destroy:function(){this.dropdown.html();WinReszier.unregister(this.resizeCallback);}};$.fn.tabdrop=function(option){return this.each(function(){var $this=$(this),data=$this.data('tabdrop'),options=typeof option==='object'&&option;if(!data){$this.data('tabdrop',(data=new TabDrop(this,$.extend({},$.fn.tabdrop.defaults,options))));}
if(typeof option=='string'){data[option]();}});};$.fn.tabdrop.defaults={text:'<i class="icon-align-justify"></i>'};$.fn.tabdrop.Constructor=TabDrop;}(window.jQuery);
;;;
(function(){if(!Date.prototype.toIsoDateTimeString){Date.prototype.toIsoDateTimeString=function(str){var month=(this.getMonth()+1).toString();if(month.length===1){month="0"+month;}
var day=this.getDate().toString();if(day.length===1){day="0"+day;}
var hour=this.getHours().toString();if(hour.length===1){hour="0"+hour;}
var mins=this.getMinutes().toString();if(mins.length===1){mins="0"+mins;}
var secs=this.getSeconds().toString();if(secs.length===1){secs="0"+secs;}
return this.getFullYear()+"-"+month+"-"+day+" "+hour+":"+mins+":"+secs;};}
if(!Date.prototype.toIsoDateString){Date.prototype.toIsoDateString=function(str){var month=(this.getMonth()+1).toString();if(month.length===1){month="0"+month;}
var day=this.getDate().toString();if(day.length===1){day="0"+day;}
return this.getFullYear()+"-"+month+"-"+day;};}
if(String.CreateGuid==null){String.CreateGuid=function(){return'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c=='x'?r:(r&0x3|0x8);return v.toString(16);});};}
if(!window.__debug__){window.__debug__=function(msg,category,isErr){if(((typeof console)!="undefined")&&console.log&&console.error){if(isErr)console.error(category+": "+msg);else console.log(category+": "+msg);}};}
if(!String.prototype.startsWith){String.prototype.startsWith=function(str){return this.substr(0,str.length)===str;};}
if(!String.prototype.endsWith){String.prototype.endsWith=function(str){return this.substr(this.length-str.length)===str;};}
if(!String.prototype.trimStart){String.prototype.trimStart=function(str){if(this.startsWith(str)){return this.substring(str.length);}
return this;};}
if(!String.prototype.trimEnd){String.prototype.trimEnd=function(str){if(this.endsWith(str)){return this.substring(0,this.length-str.length);}
return this;};}
if(!String.prototype.utf8Encode){String.prototype.utf8Encode=function(){var str=this.replace(/\r\n/g,"\n");var utftext="";for(var n=0;n<str.length;n++){var c=str.charCodeAt(n);if(c<128){utftext+=String.fromCharCode(c);}
else if((c>127)&&(c<2048)){utftext+=String.fromCharCode((c>>6)|192);utftext+=String.fromCharCode((c&63)|128);}
else{utftext+=String.fromCharCode((c>>12)|224);utftext+=String.fromCharCode(((c>>6)&63)|128);utftext+=String.fromCharCode((c&63)|128);}}
return utftext;};}
if(!String.prototype.utf8Decode){String.prototype.utf8Decode=function(){var utftext=this;var string="";var i=0;var c=c1=c2=0;while(i<utftext.length){c=utftext.charCodeAt(i);if(c<128){string+=String.fromCharCode(c);i++;}
else if((c>191)&&(c<224)){c2=utftext.charCodeAt(i+1);string+=String.fromCharCode(((c&31)<<6)|(c2&63));i+=2;}
else{c2=utftext.charCodeAt(i+1);c3=utftext.charCodeAt(i+2);string+=String.fromCharCode(((c&15)<<12)|((c2&63)<<6)|(c3&63));i+=3;}}
return string;};}
if(!String.prototype.base64Encode){String.prototype.base64Encode=function(){var keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var output="";var chr1,chr2,chr3,enc1,enc2,enc3,enc4;var i=0;var input=this.utf8Encode();while(i<input.length){chr1=input.charCodeAt(i++);chr2=input.charCodeAt(i++);chr3=input.charCodeAt(i++);enc1=chr1>>2;enc2=((chr1&3)<<4)|(chr2>>4);enc3=((chr2&15)<<2)|(chr3>>6);enc4=chr3&63;if(isNaN(chr2)){enc3=enc4=64;}else if(isNaN(chr3)){enc4=64;}
output=output+
keyStr.charAt(enc1)+keyStr.charAt(enc2)+
keyStr.charAt(enc3)+keyStr.charAt(enc4);}
return output;};}
if(!String.prototype.base64Decode){String.prototype.base64Decode=function(){var input=this;var keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var output="";var chr1,chr2,chr3;var enc1,enc2,enc3,enc4;var i=0;input=input.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(i<input.length){enc1=keyStr.indexOf(input.charAt(i++));enc2=keyStr.indexOf(input.charAt(i++));enc3=keyStr.indexOf(input.charAt(i++));enc4=keyStr.indexOf(input.charAt(i++));chr1=(enc1<<2)|(enc2>>4);chr2=((enc2&15)<<4)|(enc3>>2);chr3=((enc3&3)<<6)|enc4;output=output+String.fromCharCode(chr1);if(enc3!=64){output=output+String.fromCharCode(chr2);}
if(enc4!=64){output=output+String.fromCharCode(chr3);}}
return output.utf8Decode();};}
if(!Math.randomRange){Math.randomRange=function(from,to){return Math.floor(Math.random()*(to-from+1)+from);};}
if(!String.prototype.toCamelCase){String.prototype.toCamelCase=function(){var s=this.toPascalCase();if($.trim(s)=="")
return"";if(s.length>1){var regex=/^([A-Z]*)([A-Z].*)/g;if(s.match(regex)){var match=regex.exec(s);s=match[1].toLowerCase()+match[2];s=s.substr(0,1).toLowerCase()+s.substr(1);}}else{s=s.toLowerCase();}
return s;};}
if(!String.prototype.toPascalCase){String.prototype.toPascalCase=function(){var s="";$.each($.trim(this).split(/[\s\.-]+/g),function(idx,val){if($.trim(val)=="")
return;if(val.length>1)
s+=val.substr(0,1).toUpperCase()+val.substr(1);else
s+=val.toUpperCase();});return s;};}
if(!String.prototype.toUmbracoAlias){String.prototype.toUmbracoAlias=function(){var s=this.replace(/[^a-zA-Z0-9\s\.-]+/g,'');return s.toCamelCase();};}
if(!String.prototype.toFunction){String.prototype.toFunction=function(){var arr=this.split(".");var fn=(window||this);for(var i=0,len=arr.length;i<len;i++){fn=fn[arr[i]];}
if(typeof fn!=="function"){throw new Error("function not found");}
return fn;};}
if(!String.prototype.detectIsJson){String.prototype.detectIsJson=function(){if((this.startsWith("{")&&this.endsWith("}"))||(this.startsWith("[")||this.endsWith("]"))){return true;}
return false;};}})();
;;;
if(typeof Umbraco=='undefined')var Umbraco={};if(!Umbraco.Sys)Umbraco.Sys={};Umbraco.Sys.registerNamespace=function(namespace){namespace=namespace.split('.');if(!window[namespace[0]])window[namespace[0]]={};var strFullNamespace=namespace[0];for(var i=1;i<namespace.length;i++){strFullNamespace+="."+namespace[i];eval("if(!window."+strFullNamespace+")window."+strFullNamespace+"={};");}};
;;;
Umbraco.Sys.registerNamespace("Umbraco.Application");(function($){Umbraco.Application.ClientManager=function(){var fakeFrame={};Object.defineProperty(fakeFrame,"href",{get:function(){return this._href?this._href:"";},set:function(value){this._href=value;UmbClientMgr.contentFrame(value);},});function getRootScope(){return angular.element(document.getElementById("umbracoMainPageBody")).scope();}
function getRootInjector(){return angular.element(document.getElementById("umbracoMainPageBody")).injector();}
return{_isDirty:false,_isDebug:false,_mainTree:null,_appActions:null,_historyMgr:null,_rootPath:"/umbraco",_modal:new Array(),historyManager:function(){throw"Not implemented!";},setUmbracoPath:function(strPath){this._debug("setUmbracoPath: "+strPath);this._rootPath=strPath;},mainWindow:function(){return top;},mainTree:function(){var injector=getRootInjector();var navService=injector.get("navigationService");var appState=injector.get("appState");var angularHelper=injector.get("angularHelper");var $rootScope=injector.get("$rootScope");var tree={setActiveTreeType:function(treeType){angularHelper.safeApply($rootScope,function(){navService._setActiveTreeType(treeType);});},syncTree:function(path,forceReload){angularHelper.safeApply($rootScope,function(){navService._syncPath(path,forceReload);});},clearTreeCache:function(){var treeService=injector.get("treeService");angularHelper.safeApply($rootScope,function(){treeService.clearCache();});},reloadActionNode:function(){angularHelper.safeApply($rootScope,function(){var currentMenuNode=appState.getMenuState("currentNode");if(currentMenuNode){navService.reloadNode(currentMenuNode);}});},refreshTree:function(treeAlias){angularHelper.safeApply($rootScope,function(){navService._setActiveTreeType(treeAlias,true);});},moveNode:function(id,path){angularHelper.safeApply($rootScope,function(){var currentMenuNode=appState.getMenuState("currentNode");if(currentMenuNode){var treeService=injector.get("treeService");var treeRoot=treeService.getTreeRoot(currentMenuNode);if(treeRoot){var found=treeService.getDescendantNode(treeRoot,id);if(found){treeService.removeNode(found);}}}
navService._syncPath(path,true);});},getActionNode:function(){var currentMenuNode=appState.getMenuState("currentNode");if(!currentMenuNode){return null;}
var legacyNode={nodeId:currentMenuNode.id,nodeName:currentMenuNode.name,nodeType:currentMenuNode.nodeType,treeType:currentMenuNode.nodeType,sourceUrl:currentMenuNode.childNodesUrl,updateDefinition:function(){throw"'updateDefinition' method is not supported in Umbraco 7, consider upgrading to the new v7 APIs";}};Object.defineProperty(legacyNode,"menu",{get:function(){throw"'menu' property is not supported in Umbraco 7, consider upgrading to the new v7 APIs";}});Object.defineProperty(legacyNode,"jsNode",{get:function(){throw"'jsNode' property is not supported in Umbraco 7, consider upgrading to the new v7 APIs";}});Object.defineProperty(legacyNode,"jsTree",{get:function(){throw"'jsTree' property is not supported in Umbraco 7, consider upgrading to the new v7 APIs";}});return legacyNode;}};return tree;},appActions:function(){var injector=getRootInjector();var navService=injector.get("navigationService");var localizationService=injector.get("localizationService");var userResource=injector.get("userResource");var angularHelper=injector.get("angularHelper");var $rootScope=injector.get("$rootScope");var actions={openDashboard:function(section){navService.changeSection(section);},actionDisable:function(){localizationService.localize("defaultdialogs_confirmdisable").then(function(txtConfirmDisable){var currentMenuNode=UmbClientMgr.mainTree().getActionNode();if(currentMenuNode){if(confirm(txtConfirmDisable+' "'+UmbClientMgr.mainTree().getActionNode().nodeName+'"?\n\n')){angularHelper.safeApply($rootScope,function(){userResource.disableUser(currentMenuNode.nodeId).then(function(){UmbClientMgr.mainTree().syncTree("-1,"+currentMenuNode.nodeId,true);});});}}});}};return actions;},uiKeys:function(){throw"Not implemented!";},contentFrameAndSection:function(app,rightFrameUrl){throw"Not implemented!";},contentFrame:function(strLocation){if(!strLocation||strLocation==""){if(typeof top.right!="undefined"){return top.right;}
else{return top;}}
this._debug("contentFrame: "+strLocation);var injector=getRootInjector();var rootScope=injector.get("$rootScope");var angularHelper=injector.get("angularHelper");var navService=injector.get("navigationService");var locationService=injector.get("$location");var self=this;angularHelper.safeApply(rootScope,function(){if(strLocation.startsWith("#")){locationService.path(strLocation.trimStart("#")).search("");}
else{if(!strLocation.startsWith("/")){strLocation=self._rootPath+"/"+strLocation;}
else if(strLocation.length>=self._rootPath.length&&strLocation.substr(0,self._rootPath.length)!=self._rootPath){strLocation=self._rootPath+"/"+strLocation;}
navService.loadLegacyIFrame(strLocation);}});},getFakeFrame:function(){return fakeFrame;},openAngularModalWindow:function(options){var injector=getRootInjector();var dialogService=injector.get("dialogService");var dialog=dialogService.open(options);},openModalWindow:function(url,name,showHeader,width,height,top,leftOffset,closeTriggers,onCloseCallback){var injector=getRootInjector();var navService=injector.get("navigationService");var dialogService=injector.get("dialogService");var self=this;var appState=injector.get("appState");var navMode=appState.getGlobalState("navMode");var dialog;if(navMode==="menu"){dialog=navService.showDialog({action:{name:name,metaData:{actionUrl:url}},node:{}});}
else{dialog=dialogService.open({template:url,width:width,height:height,iframe:true,show:true});}
dialog.element.data("modalCb",onCloseCallback);if(angular.isArray(closeTriggers)){for(var i=0;i<closeTriggers.length;i++){var e=dialog.find(closeTriggers[i]);if(e.length>0){e.click(function(){self.closeModalWindow();});}}}
this._modal.push(dialog);return dialog;},rootScope:function(){return getRootScope();},reloadLocation:function(){var injector=getRootInjector();var $route=injector.get("$route");$route.reload();},closeModalWindow:function(rVal){var injector=getRootInjector();var dialogService=injector.get("dialogService");if(this._modal!=null&&this._modal.length>0){var lastModal=this._modal.pop();var self=this;var onCloseCallback=lastModal.element.data("modalCb");if(typeof onCloseCallback=="function"){onCloseCallback.apply(self,[{outVal:rVal}]);}
lastModal.close();if(this._modal.length==0){getRootScope().$emit("app.closeDialogs",undefined);}}
else{getRootScope().$emit("app.closeDialogs",undefined);}},_packageInstalled:function(){var injector=getRootInjector();var packageHelper=injector.get("packageHelper");packageHelper.packageInstalled();},_debug:function(strMsg){if(this._isDebug){Sys.Debug.trace("UmbClientMgr: "+strMsg);}},get_isDirty:function(){return this._isDirty;},set_isDirty:function(value){this._isDirty=value;}};};})(jQuery);var UmbClientMgr=new Umbraco.Application.ClientManager();
;;;
Umbraco.Sys.registerNamespace("Umbraco.Application");(function($){Umbraco.Application.SpeechBubble=function(){function getRootScope(){return angular.element(document.getElementById("umbracoMainPageBody")).scope();}
function getRootInjector(){return angular.element(document.getElementById("umbracoMainPageBody")).injector();}
return{ShowMessage:function(icon,header,message){var injector=getRootInjector();var notifyService=injector.get("notificationsService");switch(icon){case"save":notifyService.success(header,message);break;case"success":notifyService.success(header,message);break;case"warning":notifyService.warning(header,message);break;case"error":notifyService.error(header,message);break;default:notifyService.info(header,message);}}};};})(jQuery);var UmbSpeechBubble=new Umbraco.Application.SpeechBubble();
;;;
var app=angular.module('umbraco',['umbraco.filters','umbraco.directives','umbraco.resources','umbraco.services','umbraco.packages','umbraco.views','ngCookies','ngSanitize','ngMobile','tmh.dynamicLocale','ngFileUpload','LocalStorageModule']);var packages=angular.module("umbraco.packages",[]);angular.module("umbraco.views",["umbraco.viewcache"]);angular.module("umbraco.viewcache",[]).run(function($rootScope,$templateCache){if(Umbraco.Sys.ServerVariables.isDebuggingEnabled){$templateCache.removeAll();}}).config(["$provide",function($provide){return $provide.decorator("$http",["$delegate",function($delegate){var get=$delegate.get;$delegate.get=function(url,config){if(Umbraco.Sys.ServerVariables.application&&url.startsWith("views/")&&url.endsWith(".html")){var rnd=Umbraco.Sys.ServerVariables.application.version+"."+Umbraco.Sys.ServerVariables.application.cdf;var _op=(url.indexOf("?")>0)?"&":"?";url+=_op+"umb__rnd="+rnd;}
return get(url,config);};return $delegate;}]);}]);if(angular.isFunction(document.angularReady)){document.angularReady.apply(this,[app]);}
;;;
(function(){angular.module("umbraco.resources",[]);function authResource($q,$http,umbRequestHelper,angularHelper){return{performLogin:function(username,password){if(!username||!password){return angularHelper.rejectedPromise({errorMsg:'Username or password cannot be empty'});}
return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("authenticationApiBaseUrl","PostLogin"),{username:username,password:password}),'Login failed for user '+username);},unlinkLogin:function(loginProvider,providerKey){if(!loginProvider||!providerKey){return angularHelper.rejectedPromise({errorMsg:'loginProvider or providerKey cannot be empty'});}
return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("authenticationApiBaseUrl","PostUnLinkLogin"),{loginProvider:loginProvider,providerKey:providerKey}),'Unlinking login provider failed');},performLogout:function(){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("authenticationApiBaseUrl","PostLogout")));},getCurrentUser:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("authenticationApiBaseUrl","GetCurrentUser")),'Server call failed for getting current user');},getCurrentUserLinkedLogins:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("authenticationApiBaseUrl","GetCurrentUserLinkedLogins")),'Server call failed for getting current users linked logins');},isAuthenticated:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("authenticationApiBaseUrl","IsAuthenticated")),{success:function(data,status,headers,config){if(data===false||data==="false"){return $q.reject('User is not logged in');}
return data;},error:function(data,status,headers,config){return{errorMsg:'Server call failed for checking authentication',data:data,status:status};}});},getRemainingTimeoutSeconds:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("authenticationApiBaseUrl","GetRemainingTimeoutSeconds")),'Server call failed for checking remaining seconds');}};}
angular.module('umbraco.resources').factory('authResource',authResource);function contentResource($q,$http,umbDataFormatter,umbRequestHelper){function saveContentItem(content,action,files){return umbRequestHelper.postSaveContent({restApiUrl:umbRequestHelper.getApiUrl("contentApiBaseUrl","PostSave"),content:content,action:action,files:files,dataFormatter:function(c,a){return umbDataFormatter.formatContentPostData(c,a);}});}
return{getRecycleBin:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("contentApiBaseUrl","GetRecycleBin")),'Failed to retrieve data for content recycle bin');},sort:function(args){if(!args){throw"args cannot be null";}
if(!args.parentId){throw"args.parentId cannot be null";}
if(!args.sortedIds){throw"args.sortedIds cannot be null";}
return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("contentApiBaseUrl","PostSort"),{parentId:args.parentId,idSortOrder:args.sortedIds}),'Failed to sort content');},move:function(args){if(!args){throw"args cannot be null";}
if(!args.parentId){throw"args.parentId cannot be null";}
if(!args.id){throw"args.id cannot be null";}
return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("contentApiBaseUrl","PostMove"),{parentId:args.parentId,id:args.id}),'Failed to move content');},copy:function(args){if(!args){throw"args cannot be null";}
if(!args.parentId){throw"args.parentId cannot be null";}
if(!args.id){throw"args.id cannot be null";}
return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("contentApiBaseUrl","PostCopy"),args),'Failed to copy content');},unPublish:function(id){if(!id){throw"id cannot be null";}
return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("contentApiBaseUrl","PostUnPublish",[{id:id}])),'Failed to publish content with id '+id);},emptyRecycleBin:function(){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("contentApiBaseUrl","EmptyRecycleBin")),'Failed to empty the recycle bin');},deleteById:function(id){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("contentApiBaseUrl","DeleteById",[{id:id}])),'Failed to delete item '+id);},getById:function(id){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("contentApiBaseUrl","GetById",[{id:id}])),'Failed to retrieve data for content id '+id);},getByIds:function(ids){var idQuery="";_.each(ids,function(item){idQuery+="ids="+item+"&";});return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("contentApiBaseUrl","GetByIds",idQuery)),'Failed to retrieve data for content with multiple ids');},getScaffold:function(parentId,alias){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("contentApiBaseUrl","GetEmpty",[{contentTypeAlias:alias},{parentId:parentId}])),'Failed to retrieve data for empty content item type '+alias);},getNiceUrl:function(id){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("contentApiBaseUrl","GetNiceUrl",[{id:id}])),'Failed to retrieve url for id:'+id);},getChildren:function(parentId,options){var defaults={pageSize:0,pageNumber:0,filter:'',orderDirection:"Ascending",orderBy:"SortOrder"};if(options===undefined){options={};}
angular.extend(defaults,options);options=defaults;if(options.orderDirection==="asc"){options.orderDirection="Ascending";}
else if(options.orderDirection==="desc"){options.orderDirection="Descending";}
return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("contentApiBaseUrl","GetChildren",[{id:parentId},{pageNumber:options.pageNumber},{pageSize:options.pageSize},{orderBy:options.orderBy},{orderDirection:options.orderDirection},{filter:options.filter}])),'Failed to retrieve children for content item '+parentId);},checkPermission:function(permission,id){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("contentApiBaseUrl","HasPermission",[{permissionToCheck:permission},{nodeId:id}])),'Failed to check permission for item '+id);},getPermissions:function(nodeIds){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("contentApiBaseUrl","GetPermissions"),nodeIds),'Failed to get permissions');},save:function(content,isNew,files){return saveContentItem(content,"save"+(isNew?"New":""),files);},publish:function(content,isNew,files){return saveContentItem(content,"publish"+(isNew?"New":""),files);},sendToPublish:function(content,isNew,files){return saveContentItem(content,"sendPublish"+(isNew?"New":""),files);},publishById:function(id){if(!id){throw"id cannot be null";}
return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("contentApiBaseUrl","PostPublishById",[{id:id}])),'Failed to publish content with id '+id);}};}
angular.module('umbraco.resources').factory('contentResource',contentResource);function contentTypeResource($q,$http,umbRequestHelper,umbDataFormatter){return{getCount:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("contentTypeApiBaseUrl","GetCount")),'Failed to retrieve count');},getAvailableCompositeContentTypes:function(contentTypeId,filterContentTypes,filterPropertyTypes){if(!filterContentTypes){filterContentTypes=[];}
if(!filterPropertyTypes){filterPropertyTypes=[];}
var query={contentTypeId:contentTypeId,filterContentTypes:filterContentTypes,filterPropertyTypes:filterPropertyTypes};return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("contentTypeApiBaseUrl","GetAvailableCompositeContentTypes"),query),'Failed to retrieve data for content type id '+contentTypeId);},getAllowedTypes:function(contentTypeId){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("contentTypeApiBaseUrl","GetAllowedChildren",[{contentId:contentTypeId}])),'Failed to retrieve data for content id '+contentTypeId);},getAllPropertyTypeAliases:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("contentTypeApiBaseUrl","GetAllPropertyTypeAliases")),'Failed to retrieve property type aliases');},getPropertyTypeScaffold:function(id){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("contentTypeApiBaseUrl","GetPropertyTypeScaffold",[{id:id}])),'Failed to retrieve property type scaffold');},getById:function(id){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("contentTypeApiBaseUrl","GetById",[{id:id}])),'Failed to retrieve content type');},deleteById:function(id){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("contentTypeApiBaseUrl","DeleteById",[{id:id}])),'Failed to delete content type');},deleteContainerById:function(id){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("contentTypeApiBaseUrl","DeleteContainer",[{id:id}])),'Failed to delete content type contaier');},getAll:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("contentTypeApiBaseUrl","GetAll")),'Failed to retrieve all content types');},getScaffold:function(parentId){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("contentTypeApiBaseUrl","GetEmpty",{parentId:parentId})),'Failed to retrieve content type scaffold');},save:function(contentType){var saveModel=umbDataFormatter.formatContentTypePostData(contentType);return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("contentTypeApiBaseUrl","PostSave"),saveModel),'Failed to save data for content type id '+contentType.id);},move:function(args){if(!args){throw"args cannot be null";}
if(!args.parentId){throw"args.parentId cannot be null";}
if(!args.id){throw"args.id cannot be null";}
return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("contentTypeApiBaseUrl","PostMove"),{parentId:args.parentId,id:args.id}),'Failed to move content');},copy:function(args){if(!args){throw"args cannot be null";}
if(!args.parentId){throw"args.parentId cannot be null";}
if(!args.id){throw"args.id cannot be null";}
return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("contentTypeApiBaseUrl","PostCopy"),{parentId:args.parentId,id:args.id}),'Failed to copy content');},createContainer:function(parentId,name){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("contentTypeApiBaseUrl","PostCreateContainer",{parentId:parentId,name:name})),'Failed to create a folder under parent id '+parentId);}};}
angular.module('umbraco.resources').factory('contentTypeResource',contentTypeResource);function currentUserResource($q,$http,umbRequestHelper){return{changePassword:function(changePasswordArgs){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("currentUserApiBaseUrl","PostChangePassword"),changePasswordArgs),'Failed to change password');},getMembershipProviderConfig:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("currentUserApiBaseUrl","GetMembershipProviderConfig")),'Failed to retrieve membership provider config');},};}
angular.module('umbraco.resources').factory('currentUserResource',currentUserResource);function dashboardResource($q,$http,umbRequestHelper){return{getDashboard:function(section){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("dashboardApiBaseUrl","GetDashboard",[{section:section}])),'Failed to get dashboard '+section);}};}
angular.module('umbraco.resources').factory('dashboardResource',dashboardResource);function dataTypeResource($q,$http,umbDataFormatter,umbRequestHelper){return{getPreValues:function(editorAlias,dataTypeId){if(!dataTypeId){dataTypeId=-1;}
return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("dataTypeApiBaseUrl","GetPreValues",[{editorAlias:editorAlias},{dataTypeId:dataTypeId}])),"Failed to retrieve pre values for editor alias "+editorAlias);},getById:function(id){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("dataTypeApiBaseUrl","GetById",[{id:id}])),"Failed to retrieve data for data type id "+id);},getByName:function(name){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("dataTypeApiBaseUrl","GetByName",[{name:name}])),"Failed to retrieve data for data type with name: "+name);},getAll:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("dataTypeApiBaseUrl","GetAll")),"Failed to retrieve data");},getGroupedDataTypes:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("dataTypeApiBaseUrl","GetGroupedDataTypes")),"Failed to retrieve data");},getGroupedPropertyEditors:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("dataTypeApiBaseUrl","GetGroupedPropertyEditors")),"Failed to retrieve data");},getAllPropertyEditors:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("dataTypeApiBaseUrl","GetAllPropertyEditors")),"Failed to retrieve data");},getScaffold:function(parentId){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("dataTypeApiBaseUrl","GetEmpty",{parentId:parentId})),"Failed to retrieve data for empty datatype");},deleteById:function(id){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("dataTypeApiBaseUrl","DeleteById",[{id:id}])),"Failed to delete item "+id);},deleteContainerById:function(id){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("dataTypeApiBaseUrl","DeleteContainer",[{id:id}])),'Failed to delete content type contaier');},getCustomListView:function(contentTypeAlias){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("dataTypeApiBaseUrl","GetCustomListView",{contentTypeAlias:contentTypeAlias})),"Failed to retrieve data for custom listview datatype");},createCustomListView:function(contentTypeAlias){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("dataTypeApiBaseUrl","PostCreateCustomListView",{contentTypeAlias:contentTypeAlias})),"Failed to create a custom listview datatype");},save:function(dataType,preValues,isNew){var saveModel=umbDataFormatter.formatDataTypePostData(dataType,preValues,"save"+(isNew?"New":""));return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("dataTypeApiBaseUrl","PostSave"),saveModel),"Failed to save data for data type id "+dataType.id);},move:function(args){if(!args){throw"args cannot be null";}
if(!args.parentId){throw"args.parentId cannot be null";}
if(!args.id){throw"args.id cannot be null";}
return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("dataTypeApiBaseUrl","PostMove"),{parentId:args.parentId,id:args.id}),'Failed to move content');},createContainer:function(parentId,name){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("dataTypeApiBaseUrl","PostCreateContainer",{parentId:parentId,name:name})),'Failed to create a folder under parent id '+parentId);}};}
angular.module("umbraco.resources").factory("dataTypeResource",dataTypeResource);function entityResource($q,$http,umbRequestHelper){return{getSafeAlias:function(value,camelCase){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("entityApiBaseUrl","GetSafeAlias",{value:value,camelCase:camelCase})),'Failed to retrieve content type scaffold');},getPath:function(id,type){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("entityApiBaseUrl","GetPath",[{id:id},{type:type}])),'Failed to retrieve path for id:'+id);},getById:function(id,type){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("entityApiBaseUrl","GetById",[{id:id},{type:type}])),'Failed to retrieve entity data for id '+id);},getByQuery:function(query,nodeContextId,type){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("entityApiBaseUrl","GetByQuery",[{query:query},{nodeContextId:nodeContextId},{type:type}])),'Failed to retrieve entity data for query '+query);},getByIds:function(ids,type){var query="";_.each(ids,function(item){query+="ids="+item+"&";});if(ids.length===0){query+="ids=&";}
query+="type="+type;return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("entityApiBaseUrl","GetByIds",query)),'Failed to retrieve entity data for ids '+ids);},getAll:function(type,postFilter,postFilterParams){var query="type="+type+"&postFilter="+(postFilter?postFilter:"");if(postFilter&&postFilterParams){var counter=0;_.each(postFilterParams,function(val,key){query+="&postFilterParams["+counter+"].key="+key+"&postFilterParams["+counter+"].value="+val;counter++;});}
return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("entityApiBaseUrl","GetAll",query)),'Failed to retrieve entity data for type '+type);},getAncestors:function(id,type){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("entityApiBaseUrl","GetAncestors",[{id:id},{type:type}])),'Failed to retrieve ancestor data for id '+id);},getChildren:function(id,type){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("entityApiBaseUrl","GetChildren",[{id:id},{type:type}])),'Failed to retrieve child data for id '+id);},search:function(query,type,searchFrom,canceler){var args=[{query:query},{type:type}];if(searchFrom){args.push({searchFrom:searchFrom});}
var httpConfig={};if(canceler){httpConfig["timeout"]=canceler;}
return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("entityApiBaseUrl","Search",args),httpConfig),'Failed to retrieve entity data for query '+query);},searchAll:function(query,canceler){var httpConfig={};if(canceler){httpConfig["timeout"]=canceler;}
return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("entityApiBaseUrl","SearchAll",[{query:query}]),httpConfig),'Failed to retrieve entity data for query '+query);}};}
angular.module('umbraco.resources').factory('entityResource',entityResource);function legacyResource($q,$http,umbRequestHelper){return{deleteItem:function(args){if(!args.nodeId||!args.nodeType||!args.alias){throw"The args parameter is not formatted correct, it requires properties: nodeId, nodeType, alias";}
return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("legacyApiBaseUrl","DeleteLegacyItem",[{nodeId:args.nodeId},{nodeType:args.nodeType},{alias:args.alias}])),'Failed to delete item '+args.nodeId);}};}
angular.module('umbraco.resources').factory('legacyResource',legacyResource);function logResource($q,$http,umbRequestHelper){return{getEntityLog:function(id){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("logApiBaseUrl","GetEntityLog",[{id:id}])),'Failed to retrieve user data for id '+id);},getUserLog:function(type,since){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("logApiBaseUrl","GetCurrentUserLog",[{logtype:type,sinceDate:since}])),'Failed to retrieve user data for id '+id);},getLog:function(type,since){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("logApiBaseUrl","GetLog",[{logtype:type,sinceDate:since}])),'Failed to retrieve user data for id '+id);}};}
angular.module('umbraco.resources').factory('logResource',logResource);function macroResource($q,$http,umbRequestHelper){return{getMacroParameters:function(macroId){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("macroApiBaseUrl","GetMacroParameters",[{macroId:macroId}])),'Failed to retrieve macro parameters for macro with id  '+macroId);},getMacroResultAsHtmlForEditor:function(macroAlias,pageId,macroParamDictionary){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("macroApiBaseUrl","GetMacroResultAsHtmlForEditor"),{macroAlias:macroAlias,pageId:pageId,macroParams:macroParamDictionary}),'Failed to retrieve macro result for macro with alias  '+macroAlias);}};}
angular.module('umbraco.resources').factory('macroResource',macroResource);function mediaResource($q,$http,umbDataFormatter,umbRequestHelper){function saveMediaItem(content,action,files){return umbRequestHelper.postSaveContent({restApiUrl:umbRequestHelper.getApiUrl("mediaApiBaseUrl","PostSave"),content:content,action:action,files:files,dataFormatter:function(c,a){return umbDataFormatter.formatMediaPostData(c,a);}});}
return{getRecycleBin:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("mediaApiBaseUrl","GetRecycleBin")),'Failed to retrieve data for media recycle bin');},sort:function(args){if(!args){throw"args cannot be null";}
if(!args.parentId){throw"args.parentId cannot be null";}
if(!args.sortedIds){throw"args.sortedIds cannot be null";}
return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("mediaApiBaseUrl","PostSort"),{parentId:args.parentId,idSortOrder:args.sortedIds}),'Failed to sort media');},move:function(args){if(!args){throw"args cannot be null";}
if(!args.parentId){throw"args.parentId cannot be null";}
if(!args.id){throw"args.id cannot be null";}
return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("mediaApiBaseUrl","PostMove"),{parentId:args.parentId,id:args.id}),'Failed to move media');},getById:function(id){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("mediaApiBaseUrl","GetById",[{id:id}])),'Failed to retrieve data for media id '+id);},deleteById:function(id){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("mediaApiBaseUrl","DeleteById",[{id:id}])),'Failed to delete item '+id);},getByIds:function(ids){var idQuery="";_.each(ids,function(item){idQuery+="ids="+item+"&";});return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("mediaApiBaseUrl","GetByIds",idQuery)),'Failed to retrieve data for media ids '+ids);},getScaffold:function(parentId,alias){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("mediaApiBaseUrl","GetEmpty",[{contentTypeAlias:alias},{parentId:parentId}])),'Failed to retrieve data for empty media item type '+alias);},rootMedia:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("mediaApiBaseUrl","GetRootMedia")),'Failed to retrieve data for root media');},getChildren:function(parentId,options){var defaults={pageSize:0,pageNumber:0,filter:'',orderDirection:"Ascending",orderBy:"SortOrder"};if(options===undefined){options={};}
angular.extend(defaults,options);options=defaults;if(options.orderDirection==="asc"){options.orderDirection="Ascending";}
else if(options.orderDirection==="desc"){options.orderDirection="Descending";}
return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("mediaApiBaseUrl","GetChildren",[{id:parentId},{pageNumber:options.pageNumber},{pageSize:options.pageSize},{orderBy:options.orderBy},{orderDirection:options.orderDirection},{filter:options.filter}])),'Failed to retrieve children for media item '+parentId);},save:function(media,isNew,files){return saveMediaItem(media,"save"+(isNew?"New":""),files);},addFolder:function(name,parentId){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("mediaApiBaseUrl","PostAddFolder"),{name:name,parentId:parentId}),'Failed to add folder');},getChildFolders:function(parentId){if(!parentId){parentId=-1;}
return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("mediaApiBaseUrl","GetChildFolders",[{id:parentId}])),'Failed to retrieve child folders for media item '+parentId);},emptyRecycleBin:function(){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("mediaApiBaseUrl","EmptyRecycleBin")),'Failed to empty the recycle bin');}};}
angular.module('umbraco.resources').factory('mediaResource',mediaResource);function mediaTypeResource($q,$http,umbRequestHelper,umbDataFormatter){return{getCount:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("mediaTypeApiBaseUrl","GetCount")),'Failed to retrieve count');},getAvailableCompositeContentTypes:function(contentTypeId,filterContentTypes,filterPropertyTypes){if(!filterContentTypes){filterContentTypes=[];}
if(!filterPropertyTypes){filterPropertyTypes=[];}
var query={contentTypeId:contentTypeId,filterContentTypes:filterContentTypes,filterPropertyTypes:filterPropertyTypes};return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("mediaTypeApiBaseUrl","GetAvailableCompositeMediaTypes"),query),'Failed to retrieve data for content type id '+contentTypeId);},getAllowedTypes:function(mediaId){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("mediaTypeApiBaseUrl","GetAllowedChildren",[{contentId:mediaId}])),'Failed to retrieve allowed types for media id '+mediaId);},getById:function(id){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("mediaTypeApiBaseUrl","GetById",[{id:id}])),'Failed to retrieve content type');},getAll:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("mediaTypeApiBaseUrl","GetAll")),'Failed to retrieve all content types');},getScaffold:function(parentId){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("mediaTypeApiBaseUrl","GetEmpty",{parentId:parentId})),'Failed to retrieve content type scaffold');},deleteById:function(id){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("mediaTypeApiBaseUrl","DeleteById",[{id:id}])),'Failed to retrieve content type');},deleteContainerById:function(id){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("mediaTypeApiBaseUrl","DeleteContainer",[{id:id}])),'Failed to delete content type contaier');},save:function(contentType){var saveModel=umbDataFormatter.formatContentTypePostData(contentType);return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("mediaTypeApiBaseUrl","PostSave"),saveModel),'Failed to save data for content type id '+contentType.id);},move:function(args){if(!args){throw"args cannot be null";}
if(!args.parentId){throw"args.parentId cannot be null";}
if(!args.id){throw"args.id cannot be null";}
return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("mediaTypeApiBaseUrl","PostMove"),{parentId:args.parentId,id:args.id}),'Failed to move content');},copy:function(args){if(!args){throw"args cannot be null";}
if(!args.parentId){throw"args.parentId cannot be null";}
if(!args.id){throw"args.id cannot be null";}
return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("mediaTypeApiBaseUrl","PostCopy"),{parentId:args.parentId,id:args.id}),'Failed to copy content');},createContainer:function(parentId,name){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("mediaTypeApiBaseUrl","PostCreateContainer",{parentId:parentId,name:name})),'Failed to create a folder under parent id '+parentId);}};}
angular.module('umbraco.resources').factory('mediaTypeResource',mediaTypeResource);function memberResource($q,$http,umbDataFormatter,umbRequestHelper){function saveMember(content,action,files){return umbRequestHelper.postSaveContent({restApiUrl:umbRequestHelper.getApiUrl("memberApiBaseUrl","PostSave"),content:content,action:action,files:files,dataFormatter:function(c,a){return umbDataFormatter.formatMemberPostData(c,a);}});}
return{getPagedResults:function(memberTypeAlias,options){if(memberTypeAlias==='all-members'){memberTypeAlias=null;}
var defaults={pageSize:25,pageNumber:1,filter:'',orderDirection:"Ascending",orderBy:"LoginName"};if(options===undefined){options={};}
angular.extend(defaults,options);options=defaults;if(options.orderDirection==="asc"){options.orderDirection="Ascending";}
else if(options.orderDirection==="desc"){options.orderDirection="Descending";}
var params=[{pageNumber:options.pageNumber},{pageSize:options.pageSize},{orderBy:options.orderBy},{orderDirection:options.orderDirection},{filter:options.filter}];if(memberTypeAlias!=null){params.push({memberTypeAlias:memberTypeAlias});}
return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("memberApiBaseUrl","GetPagedResults",params)),'Failed to retrieve member paged result');},getListNode:function(listName){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("memberApiBaseUrl","GetListNodeDisplay",[{listName:listName}])),'Failed to retrieve data for member list '+listName);},getByKey:function(key){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("memberApiBaseUrl","GetByKey",[{key:key}])),'Failed to retrieve data for member id '+key);},deleteByKey:function(key){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("memberApiBaseUrl","DeleteByKey",[{key:key}])),'Failed to delete item '+key);},getScaffold:function(alias){if(alias){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("memberApiBaseUrl","GetEmpty",[{contentTypeAlias:alias}])),'Failed to retrieve data for empty member item type '+alias);}
else{return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("memberApiBaseUrl","GetEmpty")),'Failed to retrieve data for empty member item type '+alias);}},save:function(member,isNew,files){return saveMember(member,"save"+(isNew?"New":""),files);}};}
angular.module('umbraco.resources').factory('memberResource',memberResource);function memberTypeResource($q,$http,umbRequestHelper,umbDataFormatter){return{getAvailableCompositeContentTypes:function(contentTypeId,filterContentTypes,filterPropertyTypes){if(!filterContentTypes){filterContentTypes=[];}
if(!filterPropertyTypes){filterPropertyTypes=[];}
var query="";_.each(filterContentTypes,function(item){query+="filterContentTypes="+item+"&";});if(filterContentTypes.length===0){query+="filterContentTypes=&";}
_.each(filterPropertyTypes,function(item){query+="filterPropertyTypes="+item+"&";});if(filterPropertyTypes.length===0){query+="filterPropertyTypes=&";}
query+="contentTypeId="+contentTypeId;return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("memberTypeApiBaseUrl","GetAvailableCompositeMemberTypes",query)),'Failed to retrieve data for content type id '+contentTypeId);},getTypes:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("memberTypeApiBaseUrl","GetAllTypes")),'Failed to retrieve data for member types id');},getById:function(id){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("memberTypeApiBaseUrl","GetById",[{id:id}])),'Failed to retrieve content type');},deleteById:function(id){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("memberTypeApiBaseUrl","DeleteById",[{id:id}])),'Failed to delete member type');},getScaffold:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("memberTypeApiBaseUrl","GetEmpty")),'Failed to retrieve content type scaffold');},save:function(contentType){var saveModel=umbDataFormatter.formatContentTypePostData(contentType);return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("memberTypeApiBaseUrl","PostSave"),saveModel),'Failed to save data for member type id '+contentType.id);}};}
angular.module('umbraco.resources').factory('memberTypeResource',memberTypeResource);function packageResource($q,$http,umbDataFormatter,umbRequestHelper){return{fetch:function(id){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("packageInstallApiBaseUrl","Fetch",[{packageGuid:id}])),'Failed to download package with guid '+id);},import:function(package){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("packageInstallApiBaseUrl","Import"),package),'Failed to create package manifest for zip file ');},installFiles:function(package){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("packageInstallApiBaseUrl","InstallFiles"),package),'Failed to create package manifest for zip file ');},installData:function(package){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("packageInstallApiBaseUrl","InstallData"),package),'Failed to create package manifest for zip file ');},cleanUp:function(package){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("packageInstallApiBaseUrl","CleanUp"),package),'Failed to create package manifest for zip file ');}};}
angular.module('umbraco.resources').factory('packageResource',packageResource);function relationResource($q,$http,umbRequestHelper){return{getByChildId:function(id,alias){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("relationApiBaseUrl","GetByChildId",[{childId:id,relationTypeAlias:alias}])),"Failed to get relation by child ID "+id+" and type of "+alias);},deleteById:function(id){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("relationApiBaseUrl","DeleteById",[{id:id}])),'Failed to delete item '+id);}};}
angular.module('umbraco.resources').factory('relationResource',relationResource);function sectionResource($q,$http,umbRequestHelper){function getSectionsUrl(section){return Umbraco.Sys.ServerVariables.sectionApiBaseUrl+"GetSections";}
return{getSections:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("sectionApiBaseUrl","GetSections")),'Failed to retrieve data for sections');}};}
angular.module('umbraco.resources').factory('sectionResource',sectionResource);function stylesheetResource($q,$http,umbRequestHelper){return{getAll:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("stylesheetApiBaseUrl","GetAll")),'Failed to retrieve stylesheets ');},getRulesByName:function(name){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("stylesheetApiBaseUrl","GetRulesByName",[{name:name}])),'Failed to retrieve stylesheets ');}};}
angular.module('umbraco.resources').factory('stylesheetResource',stylesheetResource);function treeResource($q,$http,umbRequestHelper){function getTreeNodesUrl(node){if(!node.childNodesUrl){throw"No childNodesUrl property found on the tree node, cannot load child nodes";}
return node.childNodesUrl;}
function getTreeMenuUrl(node){if(!node.menuUrl){return null;}
return node.menuUrl;}
return{loadMenu:function(node){var treeMenuUrl=getTreeMenuUrl(node);if(treeMenuUrl!==undefined&&treeMenuUrl!==null&&treeMenuUrl.length>0){return umbRequestHelper.resourcePromise($http.get(getTreeMenuUrl(node)),"Failed to retrieve data for a node's menu "+node.id);}else{return $q.reject({errorMsg:"No tree menu url defined for node "+node.id});}},loadApplication:function(options){if(!options||!options.section){throw"The object specified for does not contain a 'section' property";}
if(!options.tree){options.tree="";}
if(!options.isDialog){options.isDialog=false;}
var query="application="+options.section+"&tree="+options.tree+"&isDialog="+options.isDialog;if(options.queryString){query+="&"+options.queryString;}
return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("treeApplicationApiBaseUrl","GetApplicationTrees",query)),'Failed to retrieve data for application tree '+options.section);},loadNodes:function(options){if(!options||!options.node){throw"The options parameter object does not contain the required properties: 'node'";}
return umbRequestHelper.resourcePromise($http.get(getTreeNodesUrl(options.node)),'Failed to retrieve data for child nodes '+options.node.nodeId);}};}
angular.module('umbraco.resources').factory('treeResource',treeResource);function userResource($q,$http,umbDataFormatter,umbRequestHelper){return{disableUser:function(userId){if(!userId){throw"userId not specified";}
return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("userApiBaseUrl","PostDisableUser",[{userId:userId}])),'Failed to disable the user '+userId);}};}
angular.module('umbraco.resources').factory('userResource',userResource);})();
;;;
(function(){angular.module("umbraco.directives",["umbraco.directives.editors","umbraco.directives.html","umbraco.directives.validation","ui.sortable"]);angular.module("umbraco.directives.editors",[]);angular.module("umbraco.directives.html",[]);angular.module("umbraco.directives.validation",[]);angular.module("umbraco.directives").directive('autoScale',function($window){return function(scope,el,attrs){var totalOffset=0;var offsety=parseInt(attrs.autoScale,10);var window=angular.element($window);if(offsety!==undefined){totalOffset+=offsety;}
setTimeout(function(){el.height(window.height()-(el.offset().top+totalOffset));},500);window.bind("resize",function(){el.height(window.height()-(el.offset().top+totalOffset));});};});angular.module("umbraco.directives.html").directive('detectFold',function($timeout,$log,windowResizeListener){return{require:"^?umbTabs",restrict:'A',link:function(scope,el,attrs,tabsCtrl){var firstRun=false;var parent=$(".umb-panel-body");var winHeight=$(window).height();var calculate=function(){if(el&&el.is(":visible")&&!el.hasClass("umb-bottom-bar")){$timeout(function(){firstRun=true;},4000);var hasOverflow=parent.innerHeight()<parent[0].scrollHeight;if(hasOverflow){el.addClass("umb-bottom-bar");var wrapper=$("#mainwrapper");var contentPanel=$("#leftcolumn").next();var contentPanelLeftPx=contentPanel.css("left");el.css({left:contentPanelLeftPx});}}
return firstRun;};var resizeCallback=function(size){winHeight=size.height;el.removeClass("umb-bottom-bar");calculate();};windowResizeListener.register(resizeCallback);if(el.closest(".umb-tab-pane").index()===0){var listener=scope.$watch(_.throttle(calculate,1000),function(newVal,oldVal){if(newVal!==oldVal){listener();}});}
if(tabsCtrl!=null){tabsCtrl.onTabShown(function(args){calculate();});}
scope.$on('$destroy',function(){windowResizeListener.unregister(resizeCallback);});}};});function umbItemSorter(angularHelper){return{scope:{model:"="},restrict:"E",replace:true,templateUrl:'views/directives/_obsolete/umb-item-sorter.html',link:function(scope,element,attrs,ctrl){var defaultModel={okButton:"Ok",successMsg:"Sorting successful",complete:false};angular.extend(defaultModel,scope.model);scope.model=defaultModel;scope.performSort=function(){scope.$emit("umbItemSorter.sorting",{sortedItems:scope.model.itemsToSort});};scope.handleCancel=function(){scope.$emit("umbItemSorter.cancel");};scope.handleOk=function(){scope.$emit("umbItemSorter.ok");};scope.sortableOptions={axis:'y',cursor:"move",placeholder:"ui-sortable-placeholder",update:function(ev,ui){$(ui.item).effect("highlight",{color:"#049cdb"},500);},stop:function(ev,ui){angularHelper.safeApply(scope,function(){angular.forEach(scope.itemsToSort,function(val,index){val.sortOrder=index+1;});});}};}};}
angular.module('umbraco.directives').directive("umbItemSorter",umbItemSorter);angular.module("umbraco.directives").directive('umbContentName',function($timeout,localizationService){return{require:"ngModel",restrict:'E',replace:true,templateUrl:'views/directives/_obsolete/umb-content-name.html',scope:{placeholder:'@placeholder',model:'=ngModel',ngDisabled:'='},link:function(scope,element,attrs,ngModel){var inputElement=element.find("input");if(scope.placeholder&&scope.placeholder[0]==="@"){localizationService.localize(scope.placeholder.substring(1)).then(function(value){scope.placeholder=value;});}
var mX,mY,distance;function calculateDistance(elem,mouseX,mouseY){var cx=Math.max(Math.min(mouseX,elem.offset().left+elem.width()),elem.offset().left);var cy=Math.max(Math.min(mouseY,elem.offset().top+elem.height()),elem.offset().top);return Math.sqrt((mouseX-cx)*(mouseX-cx)+(mouseY-cy)*(mouseY-cy));}
var mouseMoveDebounce=_.throttle(function(e){mX=e.pageX;mY=e.pageY;if(!inputElement.is(":focus")&&!inputElement.hasClass("ng-invalid")){if(mX>=inputElement.offset().left){distance=calculateDistance(inputElement,mX,mY);if(distance<=155){distance=1-(100/150*distance/100);inputElement.css("border","1px solid rgba(175,175,175, "+distance+")");inputElement.css("background-color","rgba(255,255,255, "+distance+")");}}}},15);$(document).bind("mousemove",mouseMoveDebounce);$timeout(function(){if(!scope.model){scope.goEdit();}},100,false);scope.goEdit=function(){scope.editMode=true;$timeout(function(){inputElement.focus();},100,false);};scope.exitEdit=function(){if(scope.model&&scope.model!==""){scope.editMode=false;}};scope.$on('$destroy',function(){$(document).unbind("mousemove",mouseMoveDebounce);});}};});angular.module("umbraco.directives").directive('umbHeader',function($parse,$timeout){return{restrict:'E',replace:true,transclude:'true',templateUrl:'views/directives/_obsolete/umb-header.html',scope:{tabs:"="},link:function(scope,iElement,iAttrs){scope.showTabs=iAttrs.tabs?true:false;scope.visibleTabs=[];var tabWatch=scope.$watch("tabs",function(newValue,oldValue){angular.forEach(newValue,function(val,index){var tab={id:val.id,label:val.label};scope.visibleTabs.push(tab);});if(!newValue){return;}
if(!newValue.length||newValue.length===0){return;}
$timeout(function(){iElement.find(".nav-tabs a:first").tab('show');iElement.find('.nav-pills, .nav-tabs').tabdrop();scope.$on('$destroy',function(){iElement.find('.nav-pills, .nav-tabs').tabdrop("destroy");});tabWatch();},200);});}};});function loginDirective(){return{restrict:"E",replace:true,templateUrl:'views/directives/_obsolete/umb-login.html'};}
angular.module('umbraco.directives').directive("umbLogin",loginDirective);angular.module("umbraco.directives").directive('umbOptionsMenu',function($injector,treeService,navigationService,umbModelMapper,appState){return{scope:{currentSection:"@",currentNode:"="},restrict:'E',replace:true,templateUrl:'views/directives/_obsolete/umb-optionsmenu.html',link:function(scope,element,attrs,ctrl){scope.executeMenuItem=function(action){navigationService.executeMenuAction(action,scope.currentNode,scope.currentSection);};scope.getOptions=function(){if(!scope.currentNode){return;}
appState.setMenuState("currentNode",scope.currentNode);if(!scope.actions){treeService.getMenu({treeNode:scope.currentNode}).then(function(data){scope.actions=data.menuItems;});}};}};});angular.module("umbraco.directives.html").directive('umbPhotoFolder',function($compile,$log,$timeout,$filter,umbPhotoFolderHelper){return{restrict:'E',replace:true,require:'?ngModel',terminate:true,templateUrl:'views/directives/_obsolete/umb-photo-folder.html',link:function(scope,element,attrs,ngModel){var lastWatch=null;ngModel.$render=function(){if(ngModel.$modelValue){$timeout(function(){var photos=ngModel.$modelValue;scope.clickHandler=scope.$eval(element.attr('on-click'));var imagesOnly=element.attr('images-only')==="true";var margin=element.attr('border')?parseInt(element.attr('border'),10):5;var startingIndex=element.attr('baseline')?parseInt(element.attr('baseline'),10):0;var minWidth=element.attr('min-width')?parseInt(element.attr('min-width'),10):420;var minHeight=element.attr('min-height')?parseInt(element.attr('min-height'),10):100;var maxHeight=element.attr('max-height')?parseInt(element.attr('max-height'),10):300;var idealImgPerRow=element.attr('ideal-items-per-row')?parseInt(element.attr('ideal-items-per-row'),10):5;var fixedRowWidth=Math.max(element.width(),minWidth);scope.containerStyle={width:fixedRowWidth+"px"};scope.rows=umbPhotoFolderHelper.buildGrid(photos,fixedRowWidth,maxHeight,startingIndex,minHeight,idealImgPerRow,margin,imagesOnly);if(attrs.filterBy){if(lastWatch){lastWatch();}
lastWatch=scope.$watch(attrs.filterBy,function(newVal,oldVal){if(newVal&&newVal!==oldVal){var p=$filter('filter')(photos,newVal,false);scope.baseline=0;var m=umbPhotoFolderHelper.buildGrid(p,fixedRowWidth,maxHeight,startingIndex,minHeight,idealImgPerRow,margin,imagesOnly);scope.rows=m;}});}},500);}};}};});angular.module("umbraco.directives").value('umbSortContextInternal',{}).directive('umbSort',function($log,umbSortContextInternal){return{require:'?ngModel',link:function(scope,element,attrs,ngModel){var adjustment;var cfg=scope.$eval(element.attr('umb-sort'))||{};scope.model=ngModel;scope.opts=cfg;scope.opts.containerSelector=cfg.containerSelector||".umb-"+cfg.group+"-container",scope.opts.nested=cfg.nested||true,scope.opts.drop=cfg.drop||true,scope.opts.drag=cfg.drag||true,scope.opts.clone=cfg.clone||"<li/>";scope.opts.mode=cfg.mode||"list";scope.opts.itemSelectorFull=$.trim(scope.opts.itemPath+" "+scope.opts.itemSelector);element.addClass("umb-sort");element.addClass("umb-"+cfg.group+"-container");scope.opts.onDrag=function(item,position){if(scope.opts.mode==="list"){item.css({left:position.left-adjustment.left,top:position.top-adjustment.top});}};scope.opts.onDrop=function(item,targetContainer,_super){if(scope.opts.mode==="list"){var clonedItem=$(scope.opts.clone).css({height:0});item.after(clonedItem);clonedItem.animate({'height':item.height()});item.animate(clonedItem.position(),function(){clonedItem.detach();_super(item);});}
var children=$(scope.opts.itemSelectorFull,targetContainer.el);var targetIndex=children.index(item);var targetScope=$(targetContainer.el[0]).scope();if(targetScope===umbSortContextInternal.sourceScope){if(umbSortContextInternal.sourceScope.opts.onSortHandler){var _largs={oldIndex:umbSortContextInternal.sourceIndex,newIndex:targetIndex,scope:umbSortContextInternal.sourceScope};umbSortContextInternal.sourceScope.opts.onSortHandler.call(this,item,_largs);}}else{if(targetScope.opts.onDropHandler){var args={sourceScope:umbSortContextInternal.sourceScope,sourceIndex:umbSortContextInternal.sourceIndex,sourceContainer:umbSortContextInternal.sourceContainer,targetScope:targetScope,targetIndex:targetIndex,targetContainer:targetContainer};targetScope.opts.onDropHandler.call(this,item,args);}
if(umbSortContextInternal.sourceScope.opts.onReleaseHandler){var _args={sourceScope:umbSortContextInternal.sourceScope,sourceIndex:umbSortContextInternal.sourceIndex,sourceContainer:umbSortContextInternal.sourceContainer,targetScope:targetScope,targetIndex:targetIndex,targetContainer:targetContainer};umbSortContextInternal.sourceScope.opts.onReleaseHandler.call(this,item,_args);}}};scope.changeIndex=function(from,to){scope.$apply(function(){var i=ngModel.$modelValue.splice(from,1)[0];ngModel.$modelValue.splice(to,0,i);});};scope.move=function(args){var from=args.sourceIndex;var to=args.targetIndex;if(args.sourceContainer===args.targetContainer){scope.changeIndex(from,to);}else{scope.$apply(function(){var i=args.sourceScope.model.$modelValue.splice(from,1)[0];args.targetScope.model.$modelvalue.splice(to,0,i);});}};scope.opts.onDragStart=function(item,container,_super){var children=$(scope.opts.itemSelectorFull,container.el);var offset=item.offset();umbSortContextInternal.sourceIndex=children.index(item);umbSortContextInternal.sourceScope=$(container.el[0]).scope();umbSortContextInternal.sourceContainer=container;var pointer=container.rootGroup.pointer;adjustment={left:pointer.left-offset.left,top:pointer.top-offset.top};_super(item,container);};element.sortable(scope.opts);}};});angular.module("umbraco.directives").directive('umbTabView',function($timeout,$log){return{restrict:'E',replace:true,transclude:'true',templateUrl:'views/directives/_obsolete/umb-tab-view.html'};});angular.module("umbraco.directives.html").directive('umbUploadDropzone',function(){return{restrict:'E',replace:true,templateUrl:'views/directives/_obsolete/umb-upload-dropzone.html'};});angular.module("umbraco.directives").directive('navResize',function(appState,eventsService,windowResizeListener){return{restrict:'A',link:function(scope,element,attrs,ctrl){var minScreenSize=1100;var resizeEnabled=false;function setTreeMode(){appState.setGlobalState("showNavigation",appState.getGlobalState("isTablet")===false);}
function enableResize(){if(!resizeEnabled&&appState.getGlobalState("isTablet")===false){element.resizable({containment:$("#mainwrapper"),autoHide:true,handles:"e",alsoResize:".navigation-inner-container",resize:function(e,ui){var wrapper=$("#mainwrapper");var contentPanel=$("#contentwrapper");var umbNotification=$("#umb-notifications-wrapper");var apps=$("#applications");var bottomBar=contentPanel.find(".umb-bottom-bar");var navOffeset=$("#navOffset");var leftPanelWidth=ui.element.width()+apps.width();contentPanel.css({left:leftPanelWidth});bottomBar.css({left:leftPanelWidth});umbNotification.css({left:leftPanelWidth});navOffeset.css({"margin-left":ui.element.outerWidth()});},stop:function(e,ui){}});resizeEnabled=true;}}
function resetResize(){if(resizeEnabled){element.resizable("destroy");element.css("width","");var navInnerContainer=element.find(".navigation-inner-container");navInnerContainer.css("width","");$("#contentwrapper").css("left","");$("#umb-notifications-wrapper").css("left","");$("#navOffset").css("margin-left","");resizeEnabled=false;}}
var evts=[];evts.push(eventsService.on("appState.globalState.changed",function(e,args){if(args.key==="showNavigation"){if(args.value===false){resetResize();}
else{enableResize();}}}));var resizeCallback=function(size){appState.setGlobalState("isTablet",(size.width<=minScreenSize));setTreeMode();};windowResizeListener.register(resizeCallback);scope.$on('$destroy',function(){windowResizeListener.unregister(resizeCallback);for(var e in evts){eventsService.unsubscribe(evts[e]);}
var navInnerContainer=element.find(".navigation-inner-container");navInnerContainer.resizable("destroy");});appState.setGlobalState("isTablet",($(window).width()<=minScreenSize));setTreeMode();}};});angular.module("umbraco.directives").directive('sectionIcon',function($compile,iconHelper){return{restrict:'E',replace:true,link:function(scope,element,attrs){var icon=attrs.icon;if(iconHelper.isLegacyIcon(icon)){element.html("<i class='"+iconHelper.convertFromLegacyIcon(icon)+"'></i>");}
else if(iconHelper.isFileBasedIcon(icon)){var convert=iconHelper.convertFromLegacyImage(icon);if(convert){element.html("<i class='icon-section "+convert+"'></i>");}else{element.html("<img class='icon-section' src='images/tray/"+icon+"'>");}}
else{element.html("<i class='icon-section "+icon+"'></i>");}}};});angular.module("umbraco.directives").directive('umbContextMenu',function(navigationService){return{scope:{menuDialogTitle:"@",currentSection:"@",currentNode:"=",menuActions:"="},restrict:'E',replace:true,templateUrl:'views/components/application/umb-contextmenu.html',link:function(scope,element,attrs,ctrl){scope.executeMenuItem=function(action){navigationService.executeMenuAction(action,scope.currentNode,scope.currentSection);};}};});function umbNavigationDirective(){return{restrict:"E",replace:true,templateUrl:'views/components/application/umb-navigation.html'};}
angular.module('umbraco.directives').directive("umbNavigation",umbNavigationDirective);function sectionsDirective($timeout,$window,navigationService,treeService,sectionResource,appState,eventsService,$location){return{restrict:"E",replace:true,templateUrl:'views/components/application/umb-sections.html',link:function(scope,element,attr,ctrl){scope.maxSections=7;scope.overflowingSections=0;scope.sections=[];scope.currentSection=appState.getSectionState("currentSection");scope.showTray=false;scope.stickyNavigation=appState.getGlobalState("stickyNavigation");scope.needTray=false;scope.trayAnimation=function(){if(scope.showTray){return'slide';}
else if(scope.showTray===false){return'slide';}
else{return'';}};function loadSections(){sectionResource.getSections().then(function(result){scope.sections=result;calculateHeight();});}
function calculateHeight(){$timeout(function(){var height=$(window).height()-200;scope.totalSections=scope.sections.length;scope.maxSections=Math.floor(height/70);scope.needTray=false;if(scope.totalSections>scope.maxSections){scope.needTray=true;scope.overflowingSections=scope.maxSections-scope.totalSections;}});}
var evts=[];evts.push(eventsService.on("appState.globalState.changed",function(e,args){if(args.key==="showTray"){scope.showTray=args.value;}
if(args.key==="stickyNavigation"){scope.stickyNavigation=args.value;}}));evts.push(eventsService.on("appState.sectionState.changed",function(e,args){if(args.key==="currentSection"){scope.currentSection=args.value;}}));evts.push(eventsService.on("app.reInitialize",function(e,args){loadSections();}));scope.$on('$destroy',function(){for(var e in evts){eventsService.unsubscribe(evts[e]);}});window.onresize=calculateHeight;scope.avatarClick=function(){if(scope.helpDialog){closeHelpDialog();}
if(!scope.userDialog){scope.userDialog={view:"user",show:true,close:function(oldModel){closeUserDialog();}};}else{closeUserDialog();}};function closeUserDialog(){scope.userDialog.show=false;scope.userDialog=null;}
scope.helpClick=function(){if(scope.userDialog){closeUserDialog();}
if(!scope.helpDialog){scope.helpDialog={view:"help",show:true,close:function(oldModel){closeHelpDialog();}};}else{closeHelpDialog();}};function closeHelpDialog(){scope.helpDialog.show=false;scope.helpDialog=null;}
scope.sectionClick=function(event,section){if(event.ctrlKey||event.shiftKey||event.metaKey||(event.button&&event.button===1)){return;}
if(scope.userDialog){closeUserDialog();}
if(scope.helpDialog){closeHelpDialog();}
navigationService.hideSearch();navigationService.showTree(section.alias);$location.path("/"+section.alias);};scope.sectionDblClick=function(section){navigationService.reloadSection(section.alias);};scope.trayClick=function(){if(scope.userDialog){closeUserDialog();}
if(scope.helpDialog){closeHelpDialog();}
if(appState.getGlobalState("showTray")===true){navigationService.hideTray();}else{navigationService.showTray();}};loadSections();}};}
angular.module('umbraco.directives').directive("umbSections",sectionsDirective);(function(){'use strict';function ButtonDirective($timeout){function link(scope,el,attr,ctrl){scope.style=null;function activate(){if(!scope.state){scope.state="init";}
if(scope.buttonStyle){scope.style="btn-"+scope.buttonStyle;}}
activate();var unbindStateWatcher=scope.$watch('state',function(newValue,oldValue){if(newValue==='success'||newValue==='error'){$timeout(function(){scope.state='init';},2000);}});scope.$on('$destroy',function(){unbindStateWatcher();});}
var directive={transclude:true,restrict:'E',replace:true,templateUrl:'views/components/buttons/umb-button.html',link:link,scope:{action:"&?",href:"@?",type:"@",buttonStyle:"@?",state:"=?",shortcut:"@?",shortcutWhenHidden:"@",label:"@?",labelKey:"@?",icon:"@?",disabled:"="}};return directive;}
angular.module('umbraco.directives').directive('umbButton',ButtonDirective);})();(function(){'use strict';function ButtonGroupDirective(){var directive={restrict:'E',replace:true,templateUrl:'views/components/buttons/umb-button-group.html',scope:{defaultButton:"=",subButtons:"=",state:"=?",direction:"@?",float:"@?"}};return directive;}
angular.module('umbraco.directives').directive('umbButtonGroup',ButtonGroupDirective);})();(function(){'use strict';function EditorSubHeaderDirective(){var directive={transclude:true,restrict:'E',replace:true,templateUrl:'views/components/editor/subheader/umb-editor-sub-header.html'};return directive;}
angular.module('umbraco.directives').directive('umbEditorSubHeader',EditorSubHeaderDirective);})();(function(){'use strict';function EditorSubHeaderContentLeftDirective(){var directive={transclude:true,restrict:'E',replace:true,templateUrl:'views/components/editor/subheader/umb-editor-sub-header-content-left.html'};return directive;}
angular.module('umbraco.directives').directive('umbEditorSubHeaderContentLeft',EditorSubHeaderContentLeftDirective);})();(function(){'use strict';function EditorSubHeaderContentRightDirective(){var directive={transclude:true,restrict:'E',replace:true,templateUrl:'views/components/editor/subheader/umb-editor-sub-header-content-right.html'};return directive;}
angular.module('umbraco.directives').directive('umbEditorSubHeaderContentRight',EditorSubHeaderContentRightDirective);})();(function(){'use strict';function EditorSubHeaderSectionDirective(){var directive={transclude:true,restrict:'E',replace:true,templateUrl:'views/components/editor/subheader/umb-editor-sub-header-section.html'};return directive;}
angular.module('umbraco.directives').directive('umbEditorSubHeaderSection',EditorSubHeaderSectionDirective);})();(function(){'use strict';function BreadcrumbsDirective(){var directive={restrict:'E',replace:true,templateUrl:'views/components/editor/umb-breadcrumbs.html',scope:{ancestors:"=",entityType:"@"}};return directive;}
angular.module('umbraco.directives').directive('umbBreadcrumbs',BreadcrumbsDirective);})();(function(){'use strict';function EditorContainerDirective(overlayHelper){function link(scope,el,attr,ctrl){scope.numberOfOverlays=0;scope.$watch(function(){return overlayHelper.getNumberOfOverlays();},function(newValue){scope.numberOfOverlays=newValue;});}
var directive={transclude:true,restrict:'E',replace:true,templateUrl:'views/components/editor/umb-editor-container.html',link:link};return directive;}
angular.module('umbraco.directives').directive('umbEditorContainer',EditorContainerDirective);})();(function(){'use strict';function EditorFooterDirective(){var directive={transclude:true,restrict:'E',replace:true,templateUrl:'views/components/editor/umb-editor-footer.html'};return directive;}
angular.module('umbraco.directives').directive('umbEditorFooter',EditorFooterDirective);})();(function(){'use strict';function EditorFooterContentLeftDirective(){var directive={transclude:true,restrict:'E',replace:true,templateUrl:'views/components/editor/umb-editor-footer-content-left.html'};return directive;}
angular.module('umbraco.directives').directive('umbEditorFooterContentLeft',EditorFooterContentLeftDirective);})();(function(){'use strict';function EditorFooterContentRightDirective(){var directive={transclude:true,restrict:'E',replace:true,templateUrl:'views/components/editor/umb-editor-footer-content-right.html'};return directive;}
angular.module('umbraco.directives').directive('umbEditorFooterContentRight',EditorFooterContentRightDirective);})();(function(){'use strict';function EditorHeaderDirective(iconHelper){function link(scope,el,attr,ctrl){scope.openIconPicker=function(){scope.dialogModel={view:"iconpicker",show:true,submit:function(model){if(model.color){scope.icon=model.icon+" "+model.color;}else{scope.icon=model.icon;}
ctrl.$setDirty();scope.dialogModel.show=false;scope.dialogModel=null;}};};}
var directive={require:'^form',transclude:true,restrict:'E',replace:true,templateUrl:'views/components/editor/umb-editor-header.html',scope:{tabs:"=",actions:"=",name:"=",nameLocked:"=",menu:"=",icon:"=",hideIcon:"@",alias:"=",hideAlias:"@",description:"=",hideDescription:"@",navigation:"="},link:link};return directive;}
angular.module('umbraco.directives').directive('umbEditorHeader',EditorHeaderDirective);})();(function(){'use strict';function EditorMenuDirective($injector,treeService,navigationService,umbModelMapper,appState){function link(scope,el,attr,ctrl){scope.executeMenuItem=function(action){navigationService.executeMenuAction(action,scope.currentNode,scope.currentSection);};scope.getOptions=function(){if(!scope.currentNode){return;}
appState.setMenuState("currentNode",scope.currentNode);if(!scope.actions){treeService.getMenu({treeNode:scope.currentNode}).then(function(data){scope.actions=data.menuItems;});}};}
var directive={restrict:'E',replace:true,templateUrl:'views/components/editor/umb-editor-menu.html',link:link,scope:{currentNode:"=",currentSection:"@"}};return directive;}
angular.module('umbraco.directives').directive('umbEditorMenu',EditorMenuDirective);})();(function(){'use strict';function EditorNavigationDirective(){function link(scope,el,attr,ctrl){scope.showNavigation=true;scope.clickNavigationItem=function(selectedItem){setItemToActive(selectedItem);runItemAction(selectedItem);};function runItemAction(selectedItem){if(selectedItem.action){selectedItem.action(selectedItem);}}
function setItemToActive(selectedItem){if(selectedItem.view){for(var index=0;index<scope.navigation.length;index++){var item=scope.navigation[index];item.active=false;}
selectedItem.active=true;}}
function activate(){if(scope.navigation.length<=1){scope.showNavigation=false;}}
activate();}
var directive={restrict:'E',replace:true,templateUrl:'views/components/editor/umb-editor-navigation.html',scope:{navigation:"="},link:link};return directive;}
angular.module('umbraco.directives.html').directive('umbEditorNavigation',EditorNavigationDirective);})();(function(){'use strict';function EditorSubViewsDirective(){function link(scope,el,attr,ctrl){scope.activeView={};function setActiveView(items){for(var index=0;index<items.length;index++){var item=items[index];if(item.active&&item.view){scope.activeView=item;}}}
scope.$watch('subViews',function(newValue,oldValue){if(newValue){setActiveView(newValue);}},true);}
var directive={restrict:'E',replace:true,templateUrl:'views/components/editor/umb-editor-sub-views.html',scope:{subViews:"=",model:"="},link:link};return directive;}
angular.module('umbraco.directives').directive('umbEditorSubViews',EditorSubViewsDirective);})();(function(){'use strict';function EditorViewDirective(){function link(scope,el,attr){if(attr.footer){scope.footer=attr.footer;}}
var directive={transclude:true,restrict:'E',replace:true,templateUrl:'views/components/editor/umb-editor-view.html',link:link};return directive;}
angular.module('umbraco.directives').directive('umbEditorView',EditorViewDirective);})();angular.module('umbraco.directives').directive('onKeyup',function(){return{link:function(scope,elm,attrs){var f=function(){scope.$apply(attrs.onKeyup);};elm.on("keyup",f);scope.$on("$destroy",function(){elm.off("keyup",f);});}};}).directive('onKeydown',function(){return{link:function(scope,elm,attrs){var f=function(){scope.$apply(attrs.onKeydown);};elm.on("keydown",f);scope.$on("$destroy",function(){elm.off("keydown",f);});}};}).directive('onBlur',function(){return{link:function(scope,elm,attrs){var f=function(){scope.$apply(attrs.onBlur);};elm.on("blur",f);scope.$on("$destroy",function(){elm.off("blur",f);});}};}).directive('onFocus',function(){return{link:function(scope,elm,attrs){var f=function(){scope.$apply(attrs.onFocus);};elm.on("focus",f);scope.$on("$destroy",function(){elm.off("focus",f);});}};}).directive('onDragEnter',function(){return{link:function(scope,elm,attrs){var f=function(){scope.$apply(attrs.onDragEnter);};elm.on("dragenter",f);scope.$on("$destroy",function(){elm.off("dragenter",f);});}};}).directive('onDragLeave',function(){return function(scope,elm,attrs){var f=function(event){var rect=this.getBoundingClientRect();var getXY=function getCursorPosition(event){var x,y;if(typeof event.clientX==='undefined'){x=event.pageX+document.documentElement.scrollLeft;y=event.pageY+document.documentElement.scrollTop;}else{x=event.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;y=event.clientY+document.body.scrollTop+document.documentElement.scrollTop;}
return{x:x,y:y};};var e=getXY(event.originalEvent);if(e.x>rect.left+rect.width-1||e.x<rect.left||e.y>rect.top+rect.height-1||e.y<rect.top){scope.$apply(attrs.onDragLeave);}};elm.on("dragleave",f);scope.$on("$destroy",function(){elm.off("dragleave",f);});};}).directive('onDragOver',function(){return{link:function(scope,elm,attrs){var f=function(){scope.$apply(attrs.onDragOver);};elm.on("dragover",f);scope.$on("$destroy",function(){elm.off("dragover",f);});}};}).directive('onDragStart',function(){return{link:function(scope,elm,attrs){var f=function(){scope.$apply(attrs.onDragStart);};elm.on("dragstart",f);scope.$on("$destroy",function(){elm.off("dragstart",f);});}};}).directive('onDragEnd',function(){return{link:function(scope,elm,attrs){var f=function(){scope.$apply(attrs.onDragEnd);};elm.on("dragend",f);scope.$on("$destroy",function(){elm.off("dragend",f);});}};}).directive('onDrop',function(){return{link:function(scope,elm,attrs){var f=function(){scope.$apply(attrs.onDrop);};elm.on("drop",f);scope.$on("$destroy",function(){elm.off("drop",f);});}};}).directive('onOutsideClick',function($timeout){return function(scope,element,attrs){var eventBindings=[];function oneTimeClick(event){var el=event.target.nodeName;var els=["INPUT","A","BUTTON"];if(els.indexOf(el)>=0){return;}
var parents=$(event.target).parents("a,button,.umb-overlay");if(parents.length>0){return;}
var oldDialog=$(el).parents("#old-dialog-service");if(oldDialog.length===1){return;}
var floatpanel=$(el).parents(".mce-floatpanel");if(floatpanel.length===1){return;}
if($(element).has($(event.target)).length>0){return;}
scope.$apply(attrs.onOutsideClick);}
$timeout(function(){if("bindClickOn"in attrs){eventBindings.push(scope.$watch(function(){return attrs.bindClickOn;},function(newValue){if(newValue==="true"){$(document).on("click",oneTimeClick);}else{$(document).off("click",oneTimeClick);}}));}else{$(document).on("click",oneTimeClick);}
scope.$on("$destroy",function(){$(document).off("click",oneTimeClick);for(var e in eventBindings){eventBindings[e]();}});});};}).directive('onRightClick',function(){document.oncontextmenu=function(e){if(e.target.hasAttribute('on-right-click')){e.preventDefault();e.stopPropagation();return false;}};return function(scope,el,attrs){el.on('contextmenu',function(e){e.preventDefault();e.stopPropagation();scope.$apply(attrs.onRightClick);return false;});};}).directive('onDelayedMouseleave',function($timeout,$parse){return{restrict:'A',link:function(scope,element,attrs,ctrl){var active=false;var fn=$parse(attrs.onDelayedMouseleave);var leave_f=function(event){var callback=function(){fn(scope,{$event:event});};active=false;$timeout(function(){if(active===false){scope.$apply(callback);}},650);};var enter_f=function(event,args){active=true;};element.on("mouseleave",leave_f);element.on("mouseenter",enter_f);scope.$on("$destroy",function(){element.off("mouseleave",leave_f);element.off("mouseenter",enter_f);});}};});angular.module('umbraco.directives').directive('checklistModel',['$parse','$compile',function($parse,$compile){function contains(arr,item){if(angular.isArray(arr)){for(var i=0;i<arr.length;i++){if(angular.equals(arr[i],item)){return true;}}}
return false;}
function add(arr,item){arr=angular.isArray(arr)?arr:[];for(var i=0;i<arr.length;i++){if(angular.equals(arr[i],item)){return arr;}}
arr.push(item);return arr;}
function remove(arr,item){if(angular.isArray(arr)){for(var i=0;i<arr.length;i++){if(angular.equals(arr[i],item)){arr.splice(i,1);break;}}}
return arr;}
function postLinkFn(scope,elem,attrs){$compile(elem)(scope);var getter=$parse(attrs.checklistModel);var setter=getter.assign;var value=$parse(attrs.checklistValue)(scope.$parent);scope.$watch('checked',function(newValue,oldValue){if(newValue===oldValue){return;}
var current=getter(scope.$parent);if(newValue===true){setter(scope.$parent,add(current,value));}else{setter(scope.$parent,remove(current,value));}});scope.$parent.$watch(attrs.checklistModel,function(newArr,oldArr){scope.checked=contains(newArr,value);},true);}
return{restrict:'A',priority:1000,terminal:true,scope:true,compile:function(tElement,tAttrs){if(tElement[0].tagName!=='INPUT'||!tElement.attr('type','checkbox')){throw'checklist-model should be applied to `input[type="checkbox"]`.';}
if(!tAttrs.checklistValue){throw'You should provide `checklist-value`.';}
tElement.removeAttr('checklist-model');tElement.attr('ng-model','checked');return postLinkFn;}};}]);angular.module("umbraco.directives").directive("contenteditable",function(){return{require:"ngModel",link:function(scope,element,attrs,ngModel){function read(){ngModel.$setViewValue(element.html());}
ngModel.$render=function(){element.html(ngModel.$viewValue||"");};element.bind("focus",function(){var range=document.createRange();range.selectNodeContents(element[0]);var sel=window.getSelection();sel.removeAllRanges();sel.addRange(range);});element.bind("blur keyup change",function(){scope.$apply(read);});}};});function fixNumber($parse){return{restrict:"A",require:"ngModel",link:function(scope,elem,attrs,ctrl){var modelVal=scope.$eval(attrs.ngModel);if(modelVal){var asNum=parseFloat(modelVal,10);if(!isNaN(asNum)){$parse(attrs.ngModel).assign(scope,asNum);}}
ctrl.$parsers.push(function(value){if(value===0){return 0;}
return parseFloat(value||'',10);});ctrl.$formatters.push(function(value){if(angular.isString(value)){return parseFloat(value,10);}
return value;});if(typeof elem.prop('validity')==='undefined'){return;}
elem.bind('input',function(e){var validity=elem.prop('validity');scope.$apply(function(){ctrl.$setValidity('number',!validity.badInput);});});}};}
angular.module('umbraco.directives').directive("fixNumber",fixNumber);angular.module("umbraco.directives").directive('focusWhen',function($timeout){return{restrict:'A',link:function(scope,elm,attrs,ctrl){attrs.$observe("focusWhen",function(newValue){if(newValue==="true"){$timeout(function(){elm.focus();});}});}};});function hexBgColor(){return{restrict:"A",link:function(scope,element,attr,formCtrl){var origColor=null;if(attr.hexBgOrig){origColor=attr.hexBgOrig;}
attr.$observe("hexBgColor",function(newVal){if(newVal){if(!origColor){origColor=element.css("border-color");}
if(/^([0-9a-f]{3}|[0-9a-f]{6})$/i.test(newVal)){element.css("background-color","#"+newVal);return;}
if(/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(newVal)){element.css("background-color",newVal);return;}}
element.css("background-color",origColor);});}};}
angular.module('umbraco.directives').directive("hexBgColor",hexBgColor);angular.module("umbraco.directives").directive('hotkey',function($window,keyboardService,$log){return function(scope,el,attrs){var options={};var keyCombo=attrs.hotkey;if(!keyCombo){keyCombo=scope.$eval(attrs["hotkey"]);}
function activate(){if(keyCombo){if(keyCombo.length===1){options={inputDisabled:true};}
keyboardService.bind(keyCombo,function(){var element=$(el);var activeElementType=document.activeElement.tagName;var clickableElements=["A","BUTTON"];if(element.is("a,div,button,input[type='button'],input[type='submit'],input[type='checkbox']")&&!element.is(':disabled')){if(element.is(':visible')||attrs.hotkeyWhenHidden){if(attrs.hotkeyWhen&&attrs.hotkeyWhen==="false"){return;}
if(keyCombo==="enter"&&clickableElements.indexOf(activeElementType)===0){document.activeElement.click();}else{element.click();}}}else{element.focus();}},options);el.on('$destroy',function(){keyboardService.unbind(keyCombo);});}}
activate();};});angular.module("umbraco.directives").directive('preventDefault',function(){return function(scope,element,attrs){var enabled=true;if(attrs.preventDefault){attrs.$observe("preventDefault",function(newVal){enabled=(newVal==="false"||newVal===0||newVal===false)?false:true;});}
$(element).click(function(event){if(event.metaKey||event.ctrlKey){return;}
else{if(enabled===true){event.preventDefault();}}});};});angular.module("umbraco.directives").directive('preventEnterSubmit',function(){return function(scope,element,attrs){var enabled=true;if(attrs.preventEnterSubmit){attrs.$observe("preventEnterSubmit",function(newVal){enabled=(newVal==="false"||newVal===0||newVal===false)?false:true;});}
$(element).keypress(function(event){if(event.which===13){event.preventDefault();}});};});angular.module("umbraco.directives").directive('resizeToContent',function($window,$timeout){return function(scope,el,attrs){var iframe=el[0];var iframeWin=iframe.contentWindow||iframe.contentDocument.parentWindow;if(iframeWin.document.body){$timeout(function(){var height=iframeWin.document.documentElement.scrollHeight||iframeWin.document.body.scrollHeight;el.height(height);},3000);}};});angular.module("umbraco.directives").directive('selectOnFocus',function(){return function(scope,el,attrs){$(el).bind("click",function(){var editmode=$(el).data("editmode");if(!editmode){this.select();$(el).data("editmode",true);}}).bind("blur",function(){$(el).data("editmode",false);});};});angular.module("umbraco.directives").directive('umbAutoFocus',function($timeout){return function(scope,element,attr){var update=function(){if(element.val()===""||attr.focusOnFilled){element.focus();}};$timeout(function(){update();});};});angular.module("umbraco.directives").directive('umbAutoResize',function($timeout){return{require:["^?umbTabs","ngModel"],link:function(scope,element,attr,controllersArr){var domEl=element[0];var domElType=domEl.type;var umbTabsController=controllersArr[0];var ngModelController=controllersArr[1];var isIEFlag=false;var wrapper=angular.element('#umb-ie-resize-input-wrapper');var mirror=angular.element('<span style="white-space:pre;"></span>');function isIE(){var ua=window.navigator.userAgent;var msie=ua.indexOf("MSIE ");if(msie>0||!!navigator.userAgent.match(/Trident.*rv\:11\./)||navigator.userAgent.match(/Edge\/\d+/)){return true;}else{return false;}}
function activate(){isIEFlag=isIE();if(isIEFlag===true&&domElType==="text"){setupInternetExplorerElements();}}
function setupInternetExplorerElements(){if(!wrapper.length){wrapper=angular.element('<div id="umb-ie-resize-input-wrapper" style="position:fixed; top:-999px; left:0;"></div>');angular.element('body').append(wrapper);}
angular.forEach(['fontFamily','fontSize','fontWeight','fontStyle','letterSpacing','textTransform','wordSpacing','textIndent','boxSizing','borderRightWidth','borderLeftWidth','borderLeftStyle','borderRightStyle','paddingLeft','paddingRight','marginLeft','marginRight'],function(value){mirror.css(value,element.css(value));});wrapper.append(mirror);}
function resizeInternetExplorerInput(){mirror.text(element.val()||attr.placeholder);element.css('width',mirror.outerWidth()+1);}
function resizeInput(){if(domEl.scrollWidth!==domEl.clientWidth){if(ngModelController.$modelValue){element.width(domEl.scrollWidth);}}
if(!ngModelController.$modelValue&&attr.placeholder){attr.$set('size',attr.placeholder.length);element.width('auto');}}
function resizeTextarea(){if(domEl.scrollHeight!==domEl.clientHeight){element.height(domEl.scrollHeight);}}
var update=function(force){if(force===true){if(domElType==="textarea"){element.height(0);}else if(domElType==="text"){element.width(0);}}
if(isIEFlag===true&&domElType==="text"){resizeInternetExplorerInput();}else{if(domElType==="textarea"){resizeTextarea();}else if(domElType==="text"){resizeInput();}}};activate();if(umbTabsController!=null){umbTabsController.onTabShown(function(args){update();});}
var unbindModelWatcher=scope.$watch(function(){return ngModelController.$modelValue;},function(newValue){update(true);});scope.$on('$destroy',function(){element.unbind('keyup keydown keypress change',update);element.unbind('blur',update(true));unbindModelWatcher();if(isIEFlag===true&&domElType==="text"){mirror.remove();}});}};});angular.module("umbraco.directives").directive('umbRawModel',function(){return{restrict:'A',require:'ngModel',template:'<textarea ng-model="jsonEditing"></textarea>',replace:true,scope:{model:'=umbRawModel',validateOn:'='},link:function(scope,element,attrs,ngModelCtrl){function setEditing(value){scope.jsonEditing=angular.copy(jsonToString(value));}
function updateModel(value){scope.model=stringToJson(value);}
function setValid(){ngModelCtrl.$setValidity('json',true);}
function setInvalid(){ngModelCtrl.$setValidity('json',false);}
function stringToJson(text){try{return angular.fromJson(text);}catch(err){setInvalid();return text;}}
function jsonToString(object){return angular.toJson(object,true);}
function isValidJson(model){var flag=true;try{angular.fromJson(model);}catch(err){flag=false;}
return flag;}
setEditing(scope.model);var onInputChange=function(newval,oldval){if(newval!==oldval){if(isValidJson(newval)){setValid();updateModel(newval);}else{setInvalid();}}};if(scope.validateOn){element.on(scope.validateOn,function(){scope.$apply(function(){onInputChange(scope.jsonEditing);});});}else{scope.$watch('jsonEditing',onInputChange,true);}
scope.$watch('model',function(newval,oldval){if(newval!==oldval){setEditing(newval);}},true);}};});(function(){'use strict';function SelectWhen($timeout){function link(scope,el,attr,ctrl){attr.$observe("umbSelectWhen",function(newValue){if(newValue==="true"){$timeout(function(){el.select();});}});}
var directive={restrict:'A',link:link};return directive;}
angular.module('umbraco.directives').directive('umbSelectWhen',SelectWhen);})();angular.module("umbraco.directives").directive('gridRte',function(tinyMceService,stylesheetResource,angularHelper,assetsService,$q,$timeout){return{scope:{uniqueId:'=',value:'=',onClick:'&',onFocus:'&',onBlur:'&',configuration:"=",onMediaPickerClick:"=",onEmbedClick:"=",onMacroPickerClick:"=",onLinkPickerClick:"="},template:"<textarea ng-model=\"value\" rows=\"10\" class=\"mceNoEditor\" style=\"overflow:hidden\" id=\"{{uniqueId}}\"></textarea>",replace:true,link:function(scope,element,attrs){var initTiny=function(){tinyMceService.configuration().then(function(tinyMceConfig){var validElements=tinyMceConfig.validElements;var fallbackStyles=[{title:"Page header",block:"h2"},{title:"Section header",block:"h3"},{title:"Paragraph header",block:"h4"},{title:"Normal",block:"p"},{title:"Quote",block:"blockquote"},{title:"Code",block:"code"}];var extendedValidElements="@[id|class|style],-div[id|dir|class|align|style],ins[datetime|cite],-ul[class|style],-li[class|style],-h1[id|dir|class|align|style],-h2[id|dir|class|align|style],-h3[id|dir|class|align|style],-h4[id|dir|class|align|style],-h5[id|dir|class|align|style],-h6[id|style|dir|class|align],span[id|class|style]";var invalidElements=tinyMceConfig.inValidElements;var plugins=_.map(tinyMceConfig.plugins,function(plugin){if(plugin.useOnFrontend){return plugin.name;}}).join(" ")+" autoresize";var toolbar=["code","styleselect","bold","italic","alignleft","aligncenter","alignright","bullist","numlist","link","umbmediapicker","umbembeddialog"].join(" | ");var stylesheets=[];var styleFormats=[];var await=[];if(typeof(tinymce)==="undefined"){await.push(assetsService.loadJs("lib/tinymce/tinymce.min.js",scope));}
if(scope.configuration&&scope.configuration.toolbar){toolbar=scope.configuration.toolbar.join(' | ');}
if(scope.configuration&&scope.configuration.stylesheets){angular.forEach(scope.configuration.stylesheets,function(stylesheet,key){stylesheets.push(Umbraco.Sys.ServerVariables.umbracoSettings.cssPath+"/"+stylesheet+".css");await.push(stylesheetResource.getRulesByName(stylesheet).then(function(rules){angular.forEach(rules,function(rule){var r={};r.title=rule.name;if(rule.selector[0]==="."){r.inline="span";r.classes=rule.selector.substring(1);}else if(rule.selector[0]==="#"){r.inline="span";r.attributes={id:rule.selector.substring(1)};}else{r.block=rule.selector;}
styleFormats.push(r);});}));});}else{stylesheets.push("views/propertyeditors/grid/config/grid.default.rtestyles.css");styleFormats=fallbackStyles;}
var tinyMceEditor=null;$q.all(await).then(function(){var uniqueId=scope.uniqueId;var baseLineConfigObj={mode:"exact",skin:"umbraco",plugins:plugins,valid_elements:validElements,invalid_elements:invalidElements,extended_valid_elements:extendedValidElements,menubar:false,statusbar:false,relative_urls:false,toolbar:toolbar,content_css:stylesheets,style_formats:styleFormats,autoresize_bottom_margin:0};if(tinyMceConfig.customConfig){for(var i in tinyMceConfig.customConfig){var val=tinyMceConfig.customConfig[i];if(val){val=val.toString().trim();if(val.detectIsJson()){try{tinyMceConfig.customConfig[i]=JSON.parse(val);if(angular.isArray(baseLineConfigObj[i])&&angular.isArray(tinyMceConfig.customConfig[i])){tinyMceConfig.customConfig[i]=baseLineConfigObj[i].concat(tinyMceConfig.customConfig[i]);}}
catch(e){}}}}
angular.extend(baseLineConfigObj,tinyMceConfig.customConfig);}
baseLineConfigObj.elements=uniqueId;baseLineConfigObj.setup=function(editor){tinyMceEditor=editor;editor.on('init',function(e){editor.getBody().setAttribute('spellcheck',true);editor.getBody().style.overflow="hidden";$timeout(function(){if(scope.value===null){editor.focus();}},400);});editor.on('blur',function(e){editor.save();angularHelper.safeApply(scope,function(){scope.value=editor.getContent();var _toolbar=$(editor.editorContainer).find(".mce-toolbar");if(scope.onBlur){scope.onBlur();}});});editor.on('focus',function(e){angularHelper.safeApply(scope,function(){if(scope.onFocus){scope.onFocus();}});});editor.on('click',function(e){angularHelper.safeApply(scope,function(){if(scope.onClick){scope.onClick();}});});editor.on('ExecCommand',function(e){editor.save();angularHelper.safeApply(scope,function(){scope.value=editor.getContent();});});editor.on('KeyUp',function(e){editor.save();angularHelper.safeApply(scope,function(){scope.value=editor.getContent();});});editor.on('SetContent',function(e){if(!e.initial){editor.save();angularHelper.safeApply(scope,function(){scope.value=editor.getContent();});}});editor.on('ObjectResized',function(e){var qs="?width="+e.width+"&height="+e.height;var srcAttr=$(e.target).attr("src");var path=srcAttr.split("?")[0];$(e.target).attr("data-mce-src",path+qs);});tinyMceService.createLinkPicker(editor,scope,function(currentTarget,anchorElement){if(scope.onLinkPickerClick){scope.onLinkPickerClick(editor,currentTarget,anchorElement);}});tinyMceService.createMediaPicker(editor,scope,function(currentTarget,userData){if(scope.onMediaPickerClick){scope.onMediaPickerClick(editor,currentTarget,userData);}});tinyMceService.createInsertEmbeddedMedia(editor,scope,function(){if(scope.onEmbedClick){scope.onEmbedClick(editor);}});tinyMceService.createInsertMacro(editor,scope,function(dialogData){if(scope.onMacroPickerClick){scope.onMacroPickerClick(editor,dialogData);}});};function loadTinyMce(){$timeout(function(){tinymce.DOM.events.domLoaded=true;tinymce.init(baseLineConfigObj);},150,false);}
loadTinyMce();var unsubscribe=scope.$on("formSubmitting",function(){scope.value=tinyMceEditor.getContent();});scope.$on('$destroy',function(){unsubscribe();});});});};initTiny();}};});angular.module("umbraco.directives.html").directive('umbControlGroup',function(localizationService){return{scope:{label:"@label",description:"@",hideLabel:"@",alias:"@"},require:'?^form',transclude:true,restrict:'E',replace:true,templateUrl:'views/components/html/umb-control-group.html',link:function(scope,element,attr,formCtrl){scope.formValid=function(){if(formCtrl){return formCtrl.$valid;}
return true;};if(scope.label&&scope.label[0]==="@"){scope.labelstring=localizationService.localize(scope.label.substring(1));}
else{scope.labelstring=scope.label;}
if(scope.description&&scope.description[0]==="@"){scope.descriptionstring=localizationService.localize(scope.description.substring(1));}
else{scope.descriptionstring=scope.description;}}};});angular.module("umbraco.directives.html").directive('umbPane',function(){return{transclude:true,restrict:'E',replace:true,templateUrl:'views/components/html/umb-pane.html'};});angular.module("umbraco.directives.html").directive('umbPanel',function($timeout,$log){return{restrict:'E',replace:true,transclude:'true',templateUrl:'views/components/html/umb-panel.html'};});angular.module("umbraco.directives").directive('umbImageCrop',function($timeout,localizationService,cropperHelper,$log){return{restrict:'E',replace:true,templateUrl:'views/components/imaging/umb-image-crop.html',scope:{src:'=',width:'@',height:'@',crop:"=",center:"=",maxSize:'@'},link:function(scope,element,attrs){scope.width=400;scope.height=320;scope.dimensions={image:{},cropper:{},viewport:{},margin:20,scale:{min:0.3,max:3,current:1}};scope.style=function(){return{'height':(parseInt(scope.dimensions.viewport.height,10))+'px','width':(parseInt(scope.dimensions.viewport.width,10))+'px'};};var $viewport=element.find(".viewport");var $image=element.find("img");var $overlay=element.find(".overlay");var $container=element.find(".crop-container");var constraints={left:{max:scope.dimensions.margin,min:scope.dimensions.margin},top:{max:scope.dimensions.margin,min:scope.dimensions.margin},};scope.constraints=constraints;var setConstraints=function(){constraints.left.min=scope.dimensions.margin+scope.dimensions.cropper.width-scope.dimensions.image.width;constraints.top.min=scope.dimensions.margin+scope.dimensions.cropper.height-scope.dimensions.image.height;};var setDimensions=function(originalImage){originalImage.width("auto");originalImage.height("auto");var image={};image.originalWidth=originalImage.width();image.originalHeight=originalImage.height();image.width=image.originalWidth;image.height=image.originalHeight;image.left=originalImage[0].offsetLeft;image.top=originalImage[0].offsetTop;scope.dimensions.image=image;var _viewPortW=parseInt(scope.width,10);var _viewPortH=parseInt(scope.height,10);if(scope.maxSize){var ratioCalculation=cropperHelper.scaleToMaxSize(_viewPortW,_viewPortH,scope.maxSize);_viewPortW=ratioCalculation.width;_viewPortH=ratioCalculation.height;}
scope.dimensions.viewport.width=_viewPortW+2*scope.dimensions.margin;scope.dimensions.viewport.height=_viewPortH+2*scope.dimensions.margin;scope.dimensions.cropper.width=_viewPortW;scope.dimensions.cropper.height=_viewPortH;};var resizeImageToEditor=function(){var size=cropperHelper.calculateAspectRatioFit(scope.dimensions.image.width,scope.dimensions.image.height,scope.dimensions.cropper.width,scope.dimensions.cropper.height,true);scope.dimensions.image.width=size.width;scope.dimensions.image.height=size.height;scope.dimensions.scale.min=size.ratio;scope.dimensions.scale.max=2;scope.dimensions.scale.current=size.ratio;var position=cropperHelper.centerInsideViewPort(scope.dimensions.image,scope.dimensions.cropper);scope.dimensions.top=position.top;scope.dimensions.left=position.left;setConstraints();};var resizeImageToScale=function(ratio){var size=cropperHelper.calculateSizeToRatio(scope.dimensions.image.originalWidth,scope.dimensions.image.originalHeight,ratio);scope.dimensions.image.width=size.width;scope.dimensions.image.height=size.height;setConstraints();validatePosition(scope.dimensions.image.left,scope.dimensions.image.top);};var resizeImageToCrop=function(){scope.dimensions.image=cropperHelper.convertToStyle(scope.crop,{width:scope.dimensions.image.originalWidth,height:scope.dimensions.image.originalHeight},scope.dimensions.cropper,scope.dimensions.margin);var ratioCalculation=cropperHelper.calculateAspectRatioFit(scope.dimensions.image.originalWidth,scope.dimensions.image.originalHeight,scope.dimensions.cropper.width,scope.dimensions.cropper.height,true);scope.dimensions.scale.current=scope.dimensions.image.ratio;scope.dimensions.scale.min=ratioCalculation.ratio;scope.dimensions.scale.max=2;};var validatePosition=function(left,top){if(left>constraints.left.max)
{left=constraints.left.max;}
if(left<=constraints.left.min){left=constraints.left.min;}
if(top>constraints.top.max)
{top=constraints.top.max;}
if(top<=constraints.top.min){top=constraints.top.min;}
if(scope.dimensions.image.left!==left){scope.dimensions.image.left=left;}
if(scope.dimensions.image.top!==top){scope.dimensions.image.top=top;}};var calculateCropBox=function(){scope.crop=cropperHelper.pixelsToCoordinates(scope.dimensions.image,scope.dimensions.cropper.width,scope.dimensions.cropper.height,scope.dimensions.margin);};var onStartDragPosition,top,left;$overlay.draggable({drag:function(event,ui){scope.$apply(function(){validatePosition(ui.position.left,ui.position.top);});},stop:function(event,ui){scope.$apply(function(){validatePosition(ui.position.left,ui.position.top);calculateCropBox();scope.dimensions.image.rnd=Math.random();});}});var init=function(image){scope.loaded=false;setDimensions(image);if(scope.crop){resizeImageToCrop();}else{resizeImageToEditor();}
setConstraints();scope.loaded=true;};scope.$watchCollection('[width, height]',function(newValues,oldValues){if(newValues!==oldValues){setDimensions($image);setConstraints();}});var throttledResizing=_.throttle(function(){resizeImageToScale(scope.dimensions.scale.current);calculateCropBox();},100);scope.$watch("dimensions.scale.current",function(){if(scope.loaded){throttledResizing();}});if(window.navigator.userAgent.indexOf("MSIE ")){var ranger=element.find("input");ranger.bind("change",function(){scope.$apply(function(){scope.dimensions.scale.current=ranger.val();});});}
$image.load(function(){$timeout(function(){init($image);});});}};});angular.module("umbraco.directives").directive('umbImageGravity',function($timeout,localizationService,$log){return{restrict:'E',replace:true,templateUrl:'views/components/imaging/umb-image-gravity.html',scope:{src:'=',center:"=",onImageLoaded:"="},link:function(scope,element,attrs){scope.dimensions={width:0,height:0,left:0,top:0};scope.loaded=false;var $viewport=element.find(".viewport");var $image=element.find("img");var $overlay=element.find(".overlay");scope.style=function(){if(scope.dimensions.width<=0){setDimensions();}
return{'top':scope.dimensions.top+'px','left':scope.dimensions.left+'px'};};scope.setFocalPoint=function(event){scope.$emit("imageFocalPointStart");var offsetX=event.offsetX-10;var offsetY=event.offsetY-10;calculateGravity(offsetX,offsetY);lazyEndEvent();};var setDimensions=function(){scope.dimensions.width=$image.width();scope.dimensions.height=$image.height();if(scope.center){scope.dimensions.left=scope.center.left*scope.dimensions.width-10;scope.dimensions.top=scope.center.top*scope.dimensions.height-10;}else{scope.center={left:0.5,top:0.5};}};var calculateGravity=function(offsetX,offsetY){scope.dimensions.left=offsetX;scope.dimensions.top=offsetY;scope.center.left=(scope.dimensions.left+10)/scope.dimensions.width;scope.center.top=(scope.dimensions.top+10)/scope.dimensions.height;};var lazyEndEvent=_.debounce(function(){scope.$apply(function(){scope.$emit("imageFocalPointStop");});},2000);$overlay.draggable({containment:"parent",start:function(){scope.$apply(function(){scope.$emit("imageFocalPointStart");});},stop:function(){scope.$apply(function(){var offsetX=$overlay[0].offsetLeft;var offsetY=$overlay[0].offsetTop;calculateGravity(offsetX,offsetY);});lazyEndEvent();}});$image.load(function(){$timeout(function(){setDimensions();scope.loaded=true;scope.onImageLoaded();});});$(window).on('resize.umbImageGravity',function(){scope.$apply(function(){$timeout(function(){setDimensions();});var offsetX=$overlay[0].offsetLeft;var offsetY=$overlay[0].offsetTop;calculateGravity(offsetX,offsetY);});});scope.$on('$destroy',function(){$(window).off('.umbImageGravity');});}};});angular.module("umbraco.directives").directive('umbImageThumbnail',function($timeout,localizationService,cropperHelper,$log){return{restrict:'E',replace:true,templateUrl:'views/components/imaging/umb-image-thumbnail.html',scope:{src:'=',width:'@',height:'@',center:"=",crop:"=",maxSize:'@'},link:function(scope,element,attrs){var $image=element.find("img");scope.loaded=false;$image.load(function(){$timeout(function(){$image.width("auto");$image.height("auto");scope.image={};scope.image.width=$image[0].width;scope.image.height=$image[0].height;if(scope.maxSize){var ratioCalculation=cropperHelper.calculateAspectRatioFit(scope.width,scope.height,scope.maxSize,scope.maxSize,false);scope.width=ratioCalculation.width;scope.height=ratioCalculation.height;}
setPreviewStyle();scope.loaded=true;});});scope.$watchCollection('[crop, center]',function(newValues,oldValues){setPreviewStyle();});scope.$watch("center",function(){setPreviewStyle();},true);function setPreviewStyle(){if(scope.crop&&scope.image){scope.preview=cropperHelper.convertToStyle(scope.crop,scope.image,{width:scope.width,height:scope.height},0);}else if(scope.image){var p=cropperHelper.calculateAspectRatioFit(scope.image.width,scope.image.height,scope.width,scope.height,true);if(scope.center){var xy=cropperHelper.alignToCoordinates(p,scope.center,{width:scope.width,height:scope.height});p.top=xy.top;p.left=xy.left;}else{}
p.position="absolute";scope.preview=p;}}}};});angular.module("umbraco.directives").directive('localize',function($log,localizationService){return{restrict:'E',scope:{key:'@'},replace:true,link:function(scope,element,attrs){var key=scope.key;localizationService.localize(key).then(function(value){element.html(value);});}};}).directive('localize',function($log,localizationService){return{restrict:'A',link:function(scope,element,attrs){var keys=attrs.localize.split(',');angular.forEach(keys,function(value,key){var attr=element.attr(value);if(attr){if(attr[0]==='@'){var t=localizationService.tokenize(attr.substring(1),scope);localizationService.localize(t.key,t.tokens).then(function(val){element.attr(value,val);});}}});}};});(function(){'use strict';function NotificationDirective(notificationsService){function link(scope,el,attr,ctrl){scope.notifications=notificationsService.current;scope.$watch('notificationsService.current',function(newVal,oldVal,scope){if(newVal){scope.notifications=newVal;}});}
var directive={restrict:"E",replace:true,templateUrl:'views/components/notifications/umb-notifications.html',link:link};return directive;}
angular.module('umbraco.directives').directive('umbNotifications',NotificationDirective);})();(function(){'use strict';function OverlayDirective($timeout,formHelper,overlayHelper,localizationService){function link(scope,el,attr,ctrl){scope.directive={enableConfirmButton:false};var overlayNumber=0;var numberOfOverlays=0;var isRegistered=false;var modelCopy={};function activate(){setView();setButtonText();modelCopy=makeModelCopy(scope.model);$timeout(function(){if(scope.position==="target"){setTargetPosition();}
registerOverlay();setOverlayIndent();});}
function setView(){if(scope.view){if(scope.view.indexOf(".html")===-1){var viewAlias=scope.view.toLowerCase();scope.view="views/common/overlays/"+viewAlias+"/"+viewAlias+".html";}}}
function setButtonText(){if(!scope.model.closeButtonLabelKey&&!scope.model.closeButtonLabel){scope.model.closeButtonLabel=localizationService.localize("general_close");}
if(!scope.model.submitButtonLabelKey&&!scope.model.submitButtonLabel){scope.model.submitButtonLabel=localizationService.localize("general_submit");}}
function registerOverlay(){overlayNumber=overlayHelper.registerOverlay();$(document).bind("keydown.overlay-"+overlayNumber,function(event){if(event.which===27){numberOfOverlays=overlayHelper.getNumberOfOverlays();if(numberOfOverlays===overlayNumber){scope.closeOverLay();}
event.preventDefault();}
if(event.which===13){numberOfOverlays=overlayHelper.getNumberOfOverlays();if(numberOfOverlays===overlayNumber){var activeElementType=document.activeElement.tagName;var clickableElements=["A","BUTTON"];var submitOnEnter=document.activeElement.hasAttribute("overlay-submit-on-enter");if(clickableElements.indexOf(activeElementType)===0){document.activeElement.click();event.preventDefault();}else if(activeElementType==="TEXTAREA"&&!submitOnEnter){}else{scope.$apply(function(){scope.submitForm(scope.model);});event.preventDefault();}}}});isRegistered=true;}
function unregisterOverlay(){if(isRegistered){overlayHelper.unregisterOverlay();$(document).unbind("keydown.overlay-"+overlayNumber);isRegistered=false;}}
function makeModelCopy(object){var newObject={};for(var key in object){if(key!=="event"){newObject[key]=angular.copy(object[key]);}}
return newObject;}
function setOverlayIndent(){var overlayIndex=overlayNumber-1;var indentSize=overlayIndex*20;var overlayWidth=el.context.clientWidth;el.css('width',overlayWidth-indentSize);if(scope.position==="center"||scope.position==="target"){var overlayTopPosition=el.context.offsetTop;el.css('top',overlayTopPosition+indentSize);}}
function setTargetPosition(){var container=$("#contentwrapper");var containerLeft=container[0].offsetLeft;var containerRight=containerLeft+container[0].offsetWidth;var containerTop=container[0].offsetTop;var containerBottom=containerTop+container[0].offsetHeight;var mousePositionClickX=null;var mousePositionClickY=null;var elementHeight=null;var elementWidth=null;var position={right:"inherit",left:"inherit",top:"inherit",bottom:"inherit"};if(scope.model.event&&scope.model.event){mousePositionClickX=scope.model.event.pageX;mousePositionClickY=scope.model.event.pageY;elementHeight=el.context.clientHeight;elementWidth=el.context.clientWidth;position.left=mousePositionClickX-(elementWidth/2);position.top=mousePositionClickY-(elementHeight/2);if(position.left+elementWidth>containerRight){position.right=10;position.left="inherit";}
if(position.top+elementHeight>containerBottom){position.bottom=10;position.top="inherit";}
if(position.left<containerLeft){position.left=containerLeft+10;position.right="inherit";}
if(position.top<containerTop){position.top=10;position.bottom="inherit";}
el.css(position);}}
scope.submitForm=function(model){if(scope.model.submit){if(formHelper.submitForm({scope:scope})){formHelper.resetForm({scope:scope});if(scope.model.confirmSubmit&&scope.model.confirmSubmit.enable&&!scope.directive.enableConfirmButton){scope.model.submit(model,modelCopy,scope.directive.enableConfirmButton);}else{unregisterOverlay();scope.model.submit(model,modelCopy,scope.directive.enableConfirmButton);}}}};scope.cancelConfirmSubmit=function(){scope.model.confirmSubmit.show=false;};scope.closeOverLay=function(){unregisterOverlay();if(scope.model.close){scope.model=modelCopy;scope.model.close(scope.model);}else{scope.model.show=false;scope.model=null;}};if(attr.hasOwnProperty("ngShow")){scope.$watch("ngShow",function(value){if(value){el.show();activate();}else{unregisterOverlay();el.hide();}});}else{activate();}
scope.$on('$destroy',function(){unregisterOverlay();});}
var directive={transclude:true,restrict:'E',replace:true,templateUrl:'views/components/overlays/umb-overlay.html',scope:{ngShow:"=",model:"=",view:"=",position:"@"},link:link};return directive;}
angular.module('umbraco.directives').directive('umbOverlay',OverlayDirective);})();(function(){'use strict';function OverlayBackdropDirective(overlayHelper){function link(scope,el,attr,ctrl){scope.numberOfOverlays=0;scope.$watch(function(){return overlayHelper.getNumberOfOverlays();},function(newValue){scope.numberOfOverlays=newValue;});}
var directive={restrict:'E',replace:true,templateUrl:'views/components/overlays/umb-overlay-backdrop.html',link:link};return directive;}
angular.module('umbraco.directives').directive('umbOverlayBackdrop',OverlayBackdropDirective);})();angular.module("umbraco.directives").directive('umbProperty',function(umbPropEditorHelper){return{scope:{property:"="},transclude:true,restrict:'E',replace:true,templateUrl:'views/components/property/umb-property.html',link:function(scope){scope.propertyAlias=Umbraco.Sys.ServerVariables.isDebuggingEnabled===true?scope.property.alias:null;},controller:function($scope,$timeout){var self=this;self.property=$scope.property;self.setPropertyError=function(errorMsg){$scope.property.propertyErrorMessage=errorMsg;};}};});var _umbPropertyEditor=function(umbPropEditorHelper){return{scope:{model:"=",isPreValue:"@",preview:"@"},require:"^form",restrict:'E',replace:true,templateUrl:'views/components/property/umb-property-editor.html',link:function(scope,element,attrs,ctrl){scope[ctrl.$name]=ctrl;if(!scope.model.alias){scope.model.alias=Math.random().toString(36).slice(2);}
scope.$watch("model.view",function(val){scope.propertyEditorView=umbPropEditorHelper.getViewPath(scope.model.view,scope.isPreValue);});}};};angular.module("umbraco.directives").directive('umbPropertyEditor',_umbPropertyEditor);angular.module("umbraco.directives").directive('umbEditor',_umbPropertyEditor);angular.module("umbraco.directives.html").directive('umbPropertyGroup',function(){return{transclude:true,restrict:'E',replace:true,templateUrl:'views/components/property/umb-property-group.html'};});angular.module("umbraco.directives").directive('umbTab',function($parse,$timeout){return{restrict:'E',replace:true,transclude:'true',templateUrl:'views/components/tabs/umb-tab.html'};});angular.module("umbraco.directives").directive('umbTabs',function(){return{restrict:'A',controller:function($scope,$element,$attrs){var callbacks=[];this.onTabShown=function(cb){callbacks.push(cb);};function tabShown(event){var curr=$(event.target);var prev=$(event.relatedTarget);for(var c in callbacks){callbacks[c].apply(this,[{current:curr,previous:prev}]);}}
$element.on('shown','.nav-tabs a',tabShown);$scope.$on('$destroy',function(){$element.off('shown','.nav-tabs a',tabShown);for(var c in callbacks){delete callbacks[c];}
callbacks=null;});}};});(function(){'use strict';function UmbTabsContentDirective(){function link(scope,el,attr,ctrl){scope.view=attr.view;}
var directive={restrict:"E",replace:true,transclude:'true',templateUrl:"views/components/tabs/umb-tabs-content.html",link:link};return directive;}
angular.module('umbraco.directives').directive('umbTabsContent',UmbTabsContentDirective);})();(function(){'use strict';function UmbTabsNavDirective($timeout){function link(scope,el,attr){function activate(){$timeout(function(){el.find("a:first").tab('show');el.tabdrop();});}
var unbindModelWatch=scope.$watch('model',function(newValue,oldValue){activate();});scope.$on('$destroy',function(){el.tabdrop("destroy");unbindModelWatch();});}
var directive={restrict:"E",replace:true,templateUrl:"views/components/tabs/umb-tabs-nav.html",scope:{model:"=",tabdrop:"="},link:link};return directive;}
angular.module('umbraco.directives').directive('umbTabsNav',UmbTabsNavDirective);})();function umbTreeDirective($compile,$log,$q,$rootScope,treeService,notificationsService,$timeout,userService){return{restrict:'E',replace:true,terminal:false,scope:{section:'@',treealias:'@',hideoptions:'@',hideheader:'@',cachekey:'@',isdialog:'@',customtreeparams:'@',eventhandler:'=',enablecheckboxes:'@',enablelistviewsearch:'@'},compile:function(element,attrs){var hideoptions=(attrs.hideoptions==='true')?"hide-options":"";var template='<ul class="umb-tree '+hideoptions+'"><li class="root">';template+='<div ng-hide="hideheader" on-right-click="altSelect(tree.root, $event)">'+'<h5>'+'<a href="#/{{section}}" ng-click="select(tree.root, $event)"  class="root-link"><i ng-if="enablecheckboxes == \'true\'" ng-class="selectEnabledNodeClass(tree.root)"></i> {{tree.name}}</a></h5>'+'<a class="umb-options" ng-hide="tree.root.isContainer || !tree.root.menuUrl" ng-click="options(tree.root, $event)" ng-swipe-right="options(tree.root, $event)"><i></i><i></i><i></i></a>'+'</div>';template+='<ul>'+'<umb-tree-item ng-repeat="child in tree.root.children" eventhandler="eventhandler" node="child" current-node="currentNode" tree="this" section="{{section}}" ng-animate="animation()"></umb-tree-item>'+'</ul>'+'</li>'+'</ul>';element.replaceWith(template);return function(scope,elem,attr,controller){var lastSection="";if(!scope.eventhandler){scope.eventhandler=$({});}
var deleteAnimations=false;function emitEvent(eventName,args){if(scope.eventhandler){$(scope.eventhandler).trigger(eventName,args);}}
function enableDeleteAnimations(){$timeout(function(){deleteAnimations=true;},0,false);}
function setupExternalEvents(){if(scope.eventhandler){scope.eventhandler.clearCache=function(section){treeService.clearCache({section:section});};scope.eventhandler.load=function(section){scope.section=section;loadTree();};scope.eventhandler.reloadNode=function(node){if(!node){node=scope.currentNode;}
if(node){scope.loadChildren(node,true);}};scope.eventhandler.syncTree=function(args){if(!args){throw"args cannot be null";}
if(!args.path){throw"args.path cannot be null";}
var deferred=$q.defer();scope.eventhandler.one("treeSynced",function(e,syncArgs){deferred.resolve(syncArgs);});if(args.tree){loadActiveTree(args.tree);}
if(angular.isString(args.path)){args.path=args.path.replace('"','').split(',');}
args.path=_.filter(args.path,function(item){return(item!=="init"&&item!=="-1");});userService.getCurrentUser().then(function(userData){var startNodes=[userData.startContentId,userData.startMediaId];_.each(startNodes,function(i){var found=_.find(args.path,function(p){return String(p)===String(i);});if(found){args.path=args.path.splice(_.indexOf(args.path,found));}});loadPath(args.path,args.forceReload,args.activate);});return deferred.promise;};scope.eventhandler._setActiveTreeType=function(treeAlias,loadChildren){loadActiveTree(treeAlias,loadChildren);};}}
function loadPath(path,forceReload,activate){if(scope.activeTree){syncTree(scope.activeTree,path,forceReload,activate);}
else{scope.eventhandler.one("activeTreeLoaded",function(e,args){syncTree(args.tree,path,forceReload,activate);});}}
function loadActiveTree(treeAlias,loadChildren){if(!treeAlias){return;}
scope.activeTree=undefined;function doLoad(tree){var childrenAndSelf=[tree].concat(tree.children);scope.activeTree=_.find(childrenAndSelf,function(node){if(node&&node.metaData&&node.metaData.treeAlias){return node.metaData.treeAlias.toUpperCase()===treeAlias.toUpperCase();}
return false;});if(!scope.activeTree){throw"Could not find the tree "+treeAlias+", activeTree has not been set";}
if(loadChildren){scope.activeTree.expanded=true;scope.loadChildren(scope.activeTree,false).then(function(){emitEvent("activeTreeLoaded",{tree:scope.activeTree});});}
else{emitEvent("activeTreeLoaded",{tree:scope.activeTree});}}
if(scope.tree){doLoad(scope.tree.root);}
else{scope.eventhandler.one("treeLoaded",function(e,args){doLoad(args.tree.root);});}}
function loadTree(){if(!scope.loading&&scope.section){scope.loading=true;deleteAnimations=false;var args={section:scope.section,tree:scope.treealias,cacheKey:scope.cachekey,isDialog:scope.isdialog?scope.isdialog:false};if(scope.customtreeparams){args["queryString"]=scope.customtreeparams;}
treeService.getTree(args).then(function(data){scope.tree=data;enableDeleteAnimations();scope.loading=false;scope.activeTree=scope.tree.root;emitEvent("treeLoaded",{tree:scope.tree});emitEvent("treeNodeExpanded",{tree:scope.tree,node:scope.tree.root,children:scope.tree.root.children});},function(reason){scope.loading=false;notificationsService.error("Tree Error",reason);});}}
function syncTree(treeNode,path,forceReload,activate){deleteAnimations=false;treeService.syncTree({node:treeNode,path:path,forceReload:forceReload}).then(function(data){if(activate===undefined||activate===true){scope.currentNode=data;}
emitEvent("treeSynced",{node:data,activate:activate});enableDeleteAnimations();});}
scope.selectEnabledNodeClass=function(node){return node?node.selected?'icon umb-tree-icon sprTree icon-check blue temporary':'':'';};scope.animation=function(){if(deleteAnimations&&scope.tree&&scope.tree.root&&scope.tree.root.expanded){return{leave:'tree-node-delete-leave'};}
else{return{};}};scope.loadChildren=function(node,forceReload){var deferred=$q.defer();emitEvent("treeNodeExpanding",{tree:scope.tree,node:node});if(!node.children){node.children=[];}
if(forceReload||(node.hasChildren&&node.children.length===0)){treeService.loadNodeChildren({node:node,section:scope.section}).then(function(data){emitEvent("treeNodeExpanded",{tree:scope.tree,node:node,children:data});enableDeleteAnimations();deferred.resolve(data);});}
else{emitEvent("treeNodeExpanded",{tree:scope.tree,node:node,children:node.children});node.expanded=true;enableDeleteAnimations();deferred.resolve(node.children);}
return deferred.promise;};scope.options=function(n,ev){emitEvent("treeOptionsClick",{element:elem,node:n,event:ev});};scope.select=function(n,ev){scope.currentNode=null;emitEvent("treeNodeSelect",{element:elem,node:n,event:ev});};scope.altSelect=function(n,ev){emitEvent("treeNodeAltSelect",{element:elem,tree:scope.tree,node:n,event:ev});};scope.$watch("section",function(newVal,oldVal){if(!scope.tree){loadTree();}
if(!newVal){lastSection=oldVal;}
else if(newVal!==oldVal&&newVal!==lastSection){loadTree();lastSection=newVal;}});setupExternalEvents();loadTree();};}};}
angular.module("umbraco.directives").directive('umbTree',umbTreeDirective);angular.module("umbraco.directives").directive('umbTreeItem',function($compile,$http,$templateCache,$interpolate,$log,$location,$rootScope,$window,treeService,$timeout,localizationService){return{restrict:'E',replace:true,scope:{section:'@',eventhandler:'=',currentNode:'=',node:'=',tree:'='},template:'<li ng-class="{\'current\': (node == currentNode)}" on-right-click="altSelect(node, $event)">'+'<div ng-class="getNodeCssClass(node)" ng-swipe-right="options(node, $event)" >'+'<ins ng-class="{\'icon-navigation-right\': !node.expanded, \'icon-navigation-down\': node.expanded}" ng-click="load(node)">&nbsp;</ins>'+'<i class="icon umb-tree-icon sprTree" ng-click="select(node, $event)"></i>'+'<a href="#/{{node.routePath}}" ng-click="select(node, $event)"></a>'+'<a class="umb-options" ng-click="options(node, $event)"><i></i><i></i><i></i></a>'+'<div ng-show="node.loading" class="l"><div></div></div>'+'</div>'+'</li>',link:function(scope,element,attrs){localizationService.localize("general_search").then(function(value){scope.searchAltText=value;});var deleteAnimations=true;function emitEvent(eventName,args){if(scope.eventhandler){$(scope.eventhandler).trigger(eventName,args);}}
function setupNodeDom(node,tree){element.children(":first").css("padding-left",(node.level*20)+"px");if(!node.hasChildren){element.find("ins:first").remove();element.find("ins").last().hide();}
else{element.find("ins").last().show();}
var icon=element.find("i:first");icon.addClass(node.cssClass);icon.attr("title",node.routePath);element.find("a:first").text(node.name);if(!node.menuUrl){element.find("a.umb-options").remove();}
if(node.style){element.find("i:first").attr("style",node.style);}}
function enableDeleteAnimations(){$timeout(function(){deleteAnimations=true;},0,false);}
scope.getNodeCssClass=function(node){if(!node){return'';}
var css=[];if(node.cssClasses){_.each(node.cssClasses,function(c){css.push(c);});}
if(node.selected){css.push("umb-tree-node-checked");}
return css.join(" ");};scope.node.updateNodeData=function(newNode){_.extend(scope.node,newNode);setupNodeDom(scope.node,scope.tree);};scope.options=function(n,ev){emitEvent("treeOptionsClick",{element:element,tree:scope.tree,node:n,event:ev});};scope.select=function(n,ev){if(ev.ctrlKey||ev.shiftKey||ev.metaKey||(ev.button&&ev.button===1)){return;}
emitEvent("treeNodeSelect",{element:element,tree:scope.tree,node:n,event:ev});ev.preventDefault();};scope.altSelect=function(n,ev){emitEvent("treeNodeAltSelect",{element:element,tree:scope.tree,node:n,event:ev});};scope.animation=function(){if(scope.node.showHideAnimation){return scope.node.showHideAnimation;}
if(deleteAnimations&&scope.node.expanded){return{leave:'tree-node-delete-leave'};}
else{return{};}};scope.load=function(node){if(node.expanded){deleteAnimations=false;emitEvent("treeNodeCollapsing",{tree:scope.tree,node:node,element:element});node.expanded=false;}
else{scope.loadChildren(node,false);}};scope.loadChildren=function(node,forceReload){emitEvent("treeNodeExpanding",{tree:scope.tree,node:node});if(node.hasChildren&&(forceReload||!node.children||(angular.isArray(node.children)&&node.children.length===0))){treeService.loadNodeChildren({node:node,section:scope.section}).then(function(data){emitEvent("treeNodeExpanded",{tree:scope.tree,node:node,children:data});enableDeleteAnimations();});}
else{emitEvent("treeNodeExpanded",{tree:scope.tree,node:node,children:node.children});node.expanded=true;enableDeleteAnimations();}};setupNodeDom(scope.node,scope.tree);var template='<ul ng-class="{collapsed: !node.expanded}"><umb-tree-item  ng-repeat="child in node.children" eventhandler="eventhandler" tree="tree" current-node="currentNode" node="child" section="{{section}}" ng-animate="animation()"></umb-tree-item></ul>';var newElement=angular.element(template);$compile(newElement)(scope);element.append(newElement);}};});function treeSearchBox(localizationService,searchService,$q){return{scope:{searchFromId:"@",searchFromName:"@",showSearch:"@",section:"@",hideSearchCallback:"=",searchCallback:"="},restrict:"E",replace:true,templateUrl:'views/components/tree/umb-tree-search-box.html',link:function(scope,element,attrs,ctrl){scope.term="";scope.hideSearch=function(){scope.term="";scope.hideSearchCallback();};localizationService.localize("general_typeToSearch").then(function(value){scope.searchPlaceholderText=value;});if(!scope.showSearch){scope.showSearch="false";}
var canceler=null;function performSearch(){if(scope.term){scope.results=[];if(canceler){console.log("CANCELED!");canceler.resolve();canceler=$q.defer();}
else{canceler=$q.defer();}
var searchArgs={term:scope.term,canceler:canceler};if(scope.searchFromId){searchArgs["searchFrom"]=scope.searchFromId;}
searcher(searchArgs).then(function(data){scope.searchCallback(data);canceler=null;});}}
scope.$watch("term",_.debounce(function(newVal,oldVal){scope.$apply(function(){if(newVal!==null&&newVal!==undefined&&newVal!==oldVal){performSearch();}});},200));var searcher=searchService.searchContent;if(scope.section==="member"){searcher=searchService.searchMembers;}
else if(scope.section==="media"){searcher=searchService.searchMedia;}}};}
angular.module('umbraco.directives').directive("umbTreeSearchBox",treeSearchBox);function treeSearchResults(){return{scope:{results:"=",selectResultCallback:"="},restrict:"E",replace:true,templateUrl:'views/components/tree/umb-tree-search-results.html',link:function(scope,element,attrs,ctrl){}};}
angular.module('umbraco.directives').directive("umbTreeSearchResults",treeSearchResults);angular.module("umbraco.directives").directive('umbGenerateAlias',function($timeout,entityResource){return{restrict:'E',templateUrl:'views/components/umb-generate-alias.html',replace:true,scope:{alias:'=',aliasFrom:'=',enableLock:'=?',serverValidationField:'@'},link:function(scope,element,attrs,ctrl){var eventBindings=[];var bindWatcher=true;var generateAliasTimeout="";var updateAlias=false;scope.locked=true;scope.placeholderText="Enter alias...";function generateAlias(value){if(generateAliasTimeout){$timeout.cancel(generateAliasTimeout);}
if(value!==undefined&&value!==""&&value!==null){scope.alias="";scope.placeholderText="Generating Alias...";generateAliasTimeout=$timeout(function(){updateAlias=true;entityResource.getSafeAlias(value,true).then(function(safeAlias){if(updateAlias){scope.alias=safeAlias.alias;}});},500);}else{updateAlias=true;scope.alias="";scope.placeholderText="Enter alias...";}}
eventBindings.push(scope.$watch('locked',function(newValue,oldValue){if(newValue===false){bindWatcher=false;}}));eventBindings.push(scope.$watch('alias',function(newValue,oldValue){if(scope.alias===""&&bindWatcher===true||scope.alias===null&&bindWatcher===true){eventBindings.push(scope.$watch('aliasFrom',function(newValue,oldValue){if(bindWatcher){generateAlias(newValue);}}));}}));scope.$on('$destroy',function(){for(var e in eventBindings){eventBindings[e]();}});}};});(function(){'use strict';function ChildSelectorDirective(){function link(scope,el,attr,ctrl){var eventBindings=[];scope.dialogModel={};scope.showDialog=false;scope.removeChild=function(selectedChild,$index){if(scope.onRemove){scope.onRemove(selectedChild,$index);}};scope.addChild=function($event){if(scope.onAdd){scope.onAdd($event);}};function syncParentName(){angular.forEach(scope.availableChildren,function(availableChild){if(availableChild.id===scope.parentId){availableChild.name=scope.parentName;}});angular.forEach(scope.selectedChildren,function(selectedChild){if(selectedChild.id===scope.parentId){selectedChild.name=scope.parentName;}});}
function syncParentIcon(){angular.forEach(scope.availableChildren,function(availableChild){if(availableChild.id===scope.parentId){availableChild.icon=scope.parentIcon;}});angular.forEach(scope.selectedChildren,function(selectedChild){if(selectedChild.id===scope.parentId){selectedChild.icon=scope.parentIcon;}});}
eventBindings.push(scope.$watch('parentName',function(newValue,oldValue){if(newValue===oldValue){return;}
if(oldValue===undefined||newValue===undefined){return;}
syncParentName();}));eventBindings.push(scope.$watch('parentIcon',function(newValue,oldValue){if(newValue===oldValue){return;}
if(oldValue===undefined||newValue===undefined){return;}
syncParentIcon();}));scope.$on('$destroy',function(){for(var e in eventBindings){eventBindings[e]();}});}
var directive={restrict:'E',replace:true,templateUrl:'views/components/umb-child-selector.html',scope:{selectedChildren:'=',availableChildren:"=",parentName:"=",parentIcon:"=",parentId:"=",onRemove:"=",onAdd:"="},link:link};return directive;}
angular.module('umbraco.directives').directive('umbChildSelector',ChildSelectorDirective);})();function confirmDirective(){return{restrict:"E",replace:true,templateUrl:'views/components/umb-confirm.html',scope:{onConfirm:'=',onCancel:'=',caption:'@'},link:function(scope,element,attr,ctrl){}};}
angular.module('umbraco.directives').directive("umbConfirm",confirmDirective);(function(){'use strict';function ConfirmAction(){function link(scope,el,attr,ctrl){scope.clickConfirm=function(){if(scope.onConfirm){scope.onConfirm();}};scope.clickCancel=function(){if(scope.onCancel){scope.onCancel();}};}
var directive={restrict:'E',replace:true,templateUrl:'views/components/umb-confirm-action.html',scope:{direction:"@",onConfirm:"&",onCancel:"&"},link:link};return directive;}
angular.module('umbraco.directives').directive('umbConfirmAction',ConfirmAction);})();(function(){'use strict';function ContentGridDirective(){function link(scope,el,attr,ctrl){scope.clickItem=function(item,$event,$index){if(scope.onClick){scope.onClick(item,$event,$index);}};scope.clickItemName=function(item,$event,$index){if(scope.onClickName){scope.onClickName(item,$event,$index);}};}
var directive={restrict:'E',replace:true,templateUrl:'views/components/umb-content-grid.html',scope:{content:'=',contentProperties:"=",onClick:"=",onClickName:"="},link:link};return directive;}
angular.module('umbraco.directives').directive('umbContentGrid',ContentGridDirective);})();(function(){'use strict';function UmbDisableFormValidation(){var directive={restrict:'A',require:'?form',link:function(scope,elm,attrs,ctrl){ctrl.$setValidity=function(){};}};return directive;}
angular.module('umbraco.directives').directive('umbDisableFormValidation',UmbDisableFormValidation);})();(function(){'use strict';function EmptyStateDirective(){var directive={restrict:'E',replace:true,transclude:true,templateUrl:'views/components/umb-empty-state.html',scope:{size:'@',position:'@'}};return directive;}
angular.module('umbraco.directives').directive('umbEmptyState',EmptyStateDirective);})();(function(){'use strict';function FolderGridDirective(){function link(scope,el,attr,ctrl){scope.clickFolder=function(folder,$event,$index){if(scope.onClick){scope.onClick(folder,$event,$index);}};scope.clickFolderName=function(folder,$event,$index){if(scope.onClickName){scope.onClickName(folder,$event,$index);$event.stopPropagation();}};}
var directive={restrict:'E',replace:true,templateUrl:'views/components/umb-folder-grid.html',scope:{folders:'=',onClick:"=",onClickName:"="},link:link};return directive;}
angular.module('umbraco.directives').directive('umbFolderGrid',FolderGridDirective);})();(function(){'use strict';function GridSelector(){function link(scope,el,attr,ctrl){var eventBindings=[];scope.dialogModel={};scope.showDialog=false;scope.itemLabel="";if(!scope.itemName){scope.itemLabel="item";}else{scope.itemLabel=scope.itemName;}
scope.removeItem=function(selectedItem){var selectedItemIndex=scope.selectedItems.indexOf(selectedItem);scope.selectedItems.splice(selectedItemIndex,1);};scope.removeDefaultItem=function(){scope.selectedItems=[];scope.defaultItem=null;};scope.openItemPicker=function($event){scope.dialogModel={view:"itempicker",title:"Choose "+scope.itemLabel,availableItems:scope.availableItems,selectedItems:scope.selectedItems,event:$event,show:true,submit:function(model){scope.selectedItems.push(model.selectedItem);if(scope.defaultItem===null){scope.setAsDefaultItem(model.selectedItem);}
scope.dialogModel.show=false;scope.dialogModel=null;}};};scope.setAsDefaultItem=function(selectedItem){scope.defaultItem={};scope.defaultItem=selectedItem;};function updatePlaceholders(){if(scope.defaultItem!==null&&scope.defaultItem.placeholder){scope.defaultItem.name=scope.name;if(scope.alias!==null&&scope.alias!==undefined){scope.defaultItem.alias=scope.alias;}}
angular.forEach(scope.selectedItems,function(selectedItem){if(selectedItem.placeholder){selectedItem.name=scope.name;if(scope.alias!==null&&scope.alias!==undefined){selectedItem.alias=scope.alias;}}});angular.forEach(scope.availableItems,function(availableItem){if(availableItem.placeholder){availableItem.name=scope.name;if(scope.alias!==null&&scope.alias!==undefined){availableItem.alias=scope.alias;}}});}
function activate(){if(scope.updatePlaceholder){eventBindings.push(scope.$watch('name',function(newValue,oldValue){updatePlaceholders();}));eventBindings.push(scope.$watch('alias',function(newValue,oldValue){updatePlaceholders();}));}}
activate();scope.$on('$destroy',function(){for(var e in eventBindings){eventBindings[e]();}});}
var directive={restrict:'E',replace:true,templateUrl:'views/components/umb-grid-selector.html',scope:{name:"=",alias:"=",selectedItems:'=',availableItems:"=",defaultItem:"=",itemName:"@",updatePlaceholder:"="},link:link};return directive;}
angular.module('umbraco.directives').directive('umbGridSelector',GridSelector);})();(function(){'use strict';function GroupsBuilderDirective(contentTypeHelper,contentTypeResource,mediaTypeResource,dataTypeHelper,dataTypeResource,$filter,iconHelper,$q,$timeout,notificationsService,localizationService){function link(scope,el,attr,ctrl){var validationTranslated="";var tabNoSortOrderTranslated="";scope.sortingMode=false;scope.toolbar=[];scope.sortableOptionsGroup={};scope.sortableOptionsProperty={};scope.sortingButtonKey="general_reorder";function activate(){setSortingOptions();if(scope.model.groups.length!==0){angular.forEach(scope.model.groups,function(group){addInitProperty(group);});}
addInitGroup(scope.model.groups);activateFirstGroup(scope.model.groups);localizationService.localize("validation_validation").then(function(value){validationTranslated=value;});localizationService.localize("contentTypeEditor_tabHasNoSortOrder").then(function(value){tabNoSortOrderTranslated=value;});}
function setSortingOptions(){scope.sortableOptionsGroup={distance:10,tolerance:"pointer",opacity:0.7,scroll:true,cursor:"move",placeholder:"umb-group-builder__group-sortable-placeholder",zIndex:6000,handle:".umb-group-builder__group-handle",items:".umb-group-builder__group-sortable",start:function(e,ui){ui.placeholder.height(ui.item.height());},stop:function(e,ui){updateTabsSortOrder();},};scope.sortableOptionsProperty={distance:10,tolerance:"pointer",connectWith:".umb-group-builder__properties",opacity:0.7,scroll:true,cursor:"move",placeholder:"umb-group-builder__property_sortable-placeholder",zIndex:6000,handle:".umb-group-builder__property-handle",items:".umb-group-builder__property-sortable",start:function(e,ui){ui.placeholder.height(ui.item.height());},stop:function(e,ui){updatePropertiesSortOrder();}};}
function updateTabsSortOrder(){var first=true;var prevSortOrder=0;scope.model.groups.map(function(group){var index=scope.model.groups.indexOf(group);if(group.tabState!=="init"){if(!group.inherited&&first){if(prevSortOrder===0){group.sortOrder=0;}else{group.sortOrder=prevSortOrder+1;}
first=false;}else if(!group.inherited&&!first){var nextGroup=scope.model.groups[index+1];if(prevSortOrder===nextGroup.sortOrder){group.sortOrder=prevSortOrder;}else{group.sortOrder=prevSortOrder+1;}}
prevSortOrder=group.sortOrder;}});}
function filterAvailableCompositions(selectedContentType,selecting){var selectedContentTypeAliases=selecting?_.union(scope.compositionsDialogModel.compositeContentTypes,[selectedContentType.alias]):_.reject(scope.compositionsDialogModel.compositeContentTypes,function(i){return i===selectedContentType.alias;});var propAliasesExisting=_.filter(_.flatten(_.map(scope.model.groups,function(g){return _.map(g.properties,function(p){return p.alias;});})),function(f){return f!==null&&f!==undefined;});var resourceLookup=scope.contentType==="documentType"?contentTypeResource.getAvailableCompositeContentTypes:mediaTypeResource.getAvailableCompositeContentTypes;return resourceLookup(scope.model.id,selectedContentTypeAliases,propAliasesExisting).then(function(filteredAvailableCompositeTypes){_.each(scope.compositionsDialogModel.availableCompositeContentTypes,function(current){current.allowed=true;var found=_.find(filteredAvailableCompositeTypes,function(f){return current.contentType.alias===f.contentType.alias;});current.allowed=scope.model.lockedCompositeContentTypes.indexOf(current.contentType.alias)===-1&&(selectedContentTypeAliases.indexOf(current.contentType.alias)!==-1)||((found!==null&&found!==undefined)?found.allowed:false);});});}
function updatePropertiesSortOrder(){angular.forEach(scope.model.groups,function(group){if(group.tabState!=="init"){group.properties=contentTypeHelper.updatePropertiesSortOrder(group.properties);}});}
function setupAvailableContentTypesModel(result){scope.compositionsDialogModel.availableCompositeContentTypes=result;_.each(scope.compositionsDialogModel.availableCompositeContentTypes,function(c){if(scope.compositionsDialogModel.compositeContentTypes.indexOf(c.contentType.alias)!==-1){c.allowed=true;}
c.inherited=false;if(scope.model.lockedCompositeContentTypes.indexOf(c.contentType.alias)>-1){c.inherited=true;}
iconHelper.formatContentTypeIcons([c.contentType]);});}
scope.togglePrompt=function(object){object.deletePrompt=!object.deletePrompt;};scope.hidePrompt=function(object){object.deletePrompt=false;};scope.toggleSortingMode=function(tool){if(scope.sortingMode===true){var sortOrderMissing=false;for(var i=0;i<scope.model.groups.length;i++){var group=scope.model.groups[i];if(group.tabState!=="init"&&group.sortOrder===undefined){sortOrderMissing=true;group.showSortOrderMissing=true;notificationsService.error(validationTranslated+": "+group.name+" "+tabNoSortOrderTranslated);}}
if(!sortOrderMissing){scope.sortingMode=false;scope.sortingButtonKey="general_reorder";}}else{scope.sortingMode=true;scope.sortingButtonKey="general_reorderDone";}};scope.openCompositionsDialog=function(){scope.compositionsDialogModel={title:"Compositions",contentType:scope.model,compositeContentTypes:scope.model.compositeContentTypes,view:"views/common/overlays/contenttypeeditor/compositions/compositions.html",confirmSubmit:{title:"Warning",description:"Removing a composition will delete all the associated property data. Once you save the document type there's no way back, are you sure?",checkboxLabel:"I know what I'm doing",enable:true},submit:function(model,oldModel,confirmed){var compositionRemoved=false;for(var i=0;oldModel.compositeContentTypes.length>i;i++){var oldComposition=oldModel.compositeContentTypes[i];if(_.contains(model.compositeContentTypes,oldComposition)===false){compositionRemoved=true;}}
if(compositionRemoved&&confirmed===false){scope.compositionsDialogModel.confirmSubmit.show=true;}else{if(scope.model.groups.length!==0){angular.forEach(scope.model.groups,function(group){addInitProperty(group);});}
scope.compositionsDialogModel.show=false;scope.compositionsDialogModel=null;}},close:function(oldModel){scope.model.groups=oldModel.contentType.groups;scope.model.compositeContentTypes=oldModel.contentType.compositeContentTypes;scope.compositionsDialogModel.show=false;scope.compositionsDialogModel=null;},selectCompositeContentType:function(selectedContentType){var newSelection=scope.model.compositeContentTypes.indexOf(selectedContentType.alias)===-1;if(newSelection){var resourceLookup=scope.contentType==="documentType"?contentTypeResource.getById:mediaTypeResource.getById;resourceLookup(selectedContentType.id).then(function(composition){var overlappingAliases=contentTypeHelper.validateAddingComposition(scope.model,composition);if(overlappingAliases.length>0){scope.compositionsDialogModel.compositeContentTypes.splice(scope.compositionsDialogModel.compositeContentTypes.indexOf(composition.alias),1);selectedContentType.allowed=false;}
else{contentTypeHelper.mergeCompositeContentType(scope.model,composition);}
filterAvailableCompositions(selectedContentType,newSelection).then(function(){});});}
else{contentTypeHelper.splitCompositeContentType(scope.model,selectedContentType);filterAvailableCompositions(selectedContentType,newSelection).then(function(){});}}};var availableContentTypeResource=scope.contentType==="documentType"?contentTypeResource.getAvailableCompositeContentTypes:mediaTypeResource.getAvailableCompositeContentTypes;var countContentTypeResource=scope.contentType==="documentType"?contentTypeResource.getCount:mediaTypeResource.getCount;var propAliasesExisting=_.filter(_.flatten(_.map(scope.model.groups,function(g){return _.map(g.properties,function(p){return p.alias;});})),function(f){return f!==null&&f!==undefined;});$q.all([availableContentTypeResource(scope.model.id,[],propAliasesExisting).then(function(result){setupAvailableContentTypesModel(result);}),countContentTypeResource().then(function(result){scope.compositionsDialogModel.totalContentTypes=parseInt(result,10);})]).then(function(){scope.compositionsDialogModel.show=true;});};scope.addGroup=function(group){var index=scope.model.groups.indexOf(group);var prevGroup=scope.model.groups[index-1];if(index>0){group.sortOrder=prevGroup.sortOrder+1;}else{group.sortOrder=0;}
scope.activateGroup(group);};scope.activateGroup=function(selectedGroup){angular.forEach(scope.model.groups,function(group){if(group.tabState!=="init"){group.tabState="inActive";}});selectedGroup.tabState="active";};scope.removeGroup=function(groupIndex){scope.model.groups.splice(groupIndex,1);addInitGroup(scope.model.groups);};scope.updateGroupTitle=function(group){if(group.properties.length===0){addInitProperty(group);}};scope.changeSortOrderValue=function(group){if(group.sortOrder!==undefined){group.showSortOrderMissing=false;}
scope.model.groups=$filter('orderBy')(scope.model.groups,'sortOrder');};function addInitGroup(groups){var addGroup=true;angular.forEach(groups,function(group){if(group.tabState==="init"){addGroup=false;}});if(addGroup){groups.push({properties:[],parentTabContentTypes:[],parentTabContentTypeNames:[],name:"",tabState:"init"});}
return groups;}
function activateFirstGroup(groups){if(groups&&groups.length>0){var firstGroup=groups[0];if(!firstGroup.tabState||firstGroup.tabState==="inActive"){firstGroup.tabState="active";}}}
scope.addProperty=function(property,group){var index=group.properties.indexOf(property);var prevProperty=group.properties[index-1];if(index>0){property.sortOrder=prevProperty.sortOrder+1;}else{property.sortOrder=0;}
scope.editPropertyTypeSettings(property,group);};scope.editPropertyTypeSettings=function(property,group){if(!property.inherited&&!property.locked){scope.propertySettingsDialogModel={};scope.propertySettingsDialogModel.title="Property settings";scope.propertySettingsDialogModel.property=property;scope.propertySettingsDialogModel.contentType=scope.contentType;scope.propertySettingsDialogModel.contentTypeName=scope.model.name;scope.propertySettingsDialogModel.view="views/common/overlays/contenttypeeditor/propertysettings/propertysettings.html";scope.propertySettingsDialogModel.show=true;property.propertyState="active";property.dialogIsOpen=true;scope.propertySettingsDialogModel.submit=function(model){property.inherited=false;property.dialogIsOpen=false;if(model.updateSameDataTypes){updateSameDataTypes(property);}
scope.propertySettingsDialogModel.show=false;scope.propertySettingsDialogModel=null;addInitProperty(group);var numberOfProperties=group.properties.length;group.properties[numberOfProperties-1].focus=true;addInitGroup(scope.model.groups);};scope.propertySettingsDialogModel.close=function(oldModel){property.label=oldModel.property.label;property.alias=oldModel.property.alias;property.description=oldModel.property.description;property.config=oldModel.property.config;property.editor=oldModel.property.editor;property.view=oldModel.property.view;property.dataTypeId=oldModel.property.dataTypeId;property.dataTypeIcon=oldModel.property.dataTypeIcon;property.dataTypeName=oldModel.property.dataTypeName;property.validation.mandatory=oldModel.property.validation.mandatory;property.validation.pattern=oldModel.property.validation.pattern;property.showOnMemberProfile=oldModel.property.showOnMemberProfile;property.memberCanEdit=oldModel.property.memberCanEdit;if(oldModel.property.editor===undefined||oldModel.property.editor===null||oldModel.property.editor===""){property.propertyState="init";}else{property.propertyState=oldModel.property.propertyState;}
scope.propertySettingsDialogModel.show=false;scope.propertySettingsDialogModel=null;};}};scope.deleteProperty=function(tab,propertyIndex){tab.properties.splice(propertyIndex,1);if(tab.properties.length===1&&tab.properties[0].propertyState==="init"){angular.forEach(scope.model.groups,function(group,index,groups){if(group.tabState==='init'){groups.splice(index,1);}});}};function addInitProperty(group){var addInitPropertyBool=true;var initProperty={label:null,alias:null,propertyState:"init",validation:{mandatory:false,pattern:null}};angular.forEach(group.properties,function(property){if(property.propertyState==="init"){addInitPropertyBool=false;}});if(addInitPropertyBool){group.properties.push(initProperty);}
return group;}
function updateSameDataTypes(newProperty){angular.forEach(scope.model.groups,function(group){angular.forEach(group.properties,function(property){if(property.dataTypeId===newProperty.dataTypeId){property.config=newProperty.config;property.editor=newProperty.editor;property.view=newProperty.view;property.dataTypeId=newProperty.dataTypeId;property.dataTypeIcon=newProperty.dataTypeIcon;property.dataTypeName=newProperty.dataTypeName;}});});}
var unbindModelWatcher=scope.$watch('model',function(newValue,oldValue){if(newValue!==undefined&&newValue.groups!==undefined){activate();}});scope.$on('$destroy',function(){unbindModelWatcher();});}
var directive={restrict:"E",replace:true,templateUrl:"views/components/umb-groups-builder.html",scope:{model:"=",compositions:"=",sorting:"=",contentType:"@"},link:link};return directive;}
angular.module('umbraco.directives').directive('umbGroupsBuilder',GroupsBuilderDirective);})();(function(){'use strict';function KeyboardShortcutsOverviewDirective(){function link(scope,el,attr,ctrl){scope.shortcutOverlay=false;scope.toggleShortcutsOverlay=function(){scope.shortcutOverlay=!scope.shortcutOverlay;};}
var directive={restrict:'E',replace:true,templateUrl:'views/components/umb-keyboard-shortcuts-overview.html',link:link,scope:{model:"="}};return directive;}
angular.module('umbraco.directives').directive('umbKeyboardShortcutsOverview',KeyboardShortcutsOverviewDirective);})();angular.module("umbraco.directives").directive('umbLaunchMiniEditor',function(dialogService,editorState,fileManager,contentEditingHelper){return{restrict:'A',replace:false,scope:{node:'=umbLaunchMiniEditor',},link:function(scope,element,attrs){var launched=false;element.click(function(){if(launched===true){return;}
launched=true;var currFiles=_.groupBy(fileManager.getFiles(),"alias");fileManager.clearFiles();var currEditorState=editorState.getCurrent();dialogService.open({template:"views/common/dialogs/content/edit.html",id:scope.node.id,closeOnSave:true,tabFilter:["Generic properties"],callback:function(data){scope.node.name=data.name;fileManager.clearFiles();_.each(currFiles,function(val,key){fileManager.setFiles(key,_.map(currFiles['upload'],function(i){return i.file;}));});editorState.set(currEditorState);if(data.id===currEditorState.id){var changed=contentEditingHelper.reBindChangedProperties(currEditorState,data);}
launched=false;},closeCallback:function(){fileManager.clearFiles();_.each(currFiles,function(val,key){fileManager.setFiles(key,_.map(currFiles['upload'],function(i){return i.file;}));});editorState.set(currEditorState);launched=false;}});});}};});(function(){'use strict';function LayoutSelectorDirective(){function link(scope,el,attr,ctrl){scope.layoutDropDownIsOpen=false;scope.showLayoutSelector=true;function activate(){setVisibility();setActiveLayout(scope.layouts);}
function setVisibility(){var numberOfAllowedLayouts=getNumberOfAllowedLayouts(scope.layouts);if(numberOfAllowedLayouts===1){scope.showLayoutSelector=false;}}
function getNumberOfAllowedLayouts(layouts){var allowedLayouts=0;for(var i=0;layouts.length>i;i++){var layout=layouts[i];if(layout.selected===true){allowedLayouts++;}}
return allowedLayouts;}
function setActiveLayout(layouts){for(var i=0;layouts.length>i;i++){var layout=layouts[i];if(layout.path===scope.activeLayout.path){layout.active=true;}}}
scope.pickLayout=function(selectedLayout){if(scope.onLayoutSelect){scope.onLayoutSelect(selectedLayout);scope.layoutDropDownIsOpen=false;}};scope.toggleLayoutDropdown=function(){scope.layoutDropDownIsOpen=!scope.layoutDropDownIsOpen;};scope.closeLayoutDropdown=function(){scope.layoutDropDownIsOpen=false;};activate();}
var directive={restrict:'E',replace:true,templateUrl:'views/components/umb-layout-selector.html',scope:{layouts:'=',activeLayout:'=',onLayoutSelect:"="},link:link};return directive;}
angular.module('umbraco.directives').directive('umbLayoutSelector',LayoutSelectorDirective);})();(function(){'use strict';function ListViewLayoutDirective(){function link(scope,el,attr,ctrl){scope.getContent=function(contentId){if(scope.onGetContent){scope.onGetContent(contentId);}};}
var directive={restrict:'E',replace:true,templateUrl:'views/components/umb-list-view-layout.html',scope:{contentId:'=',folders:'=',items:'=',selection:'=',options:'=',entityType:'@',onGetContent:'='},link:link};return directive;}
angular.module('umbraco.directives').directive('umbListViewLayout',ListViewLayoutDirective);})();(function(){'use strict';function ListViewSettingsDirective(contentTypeResource,dataTypeResource,dataTypeHelper){function link(scope,el,attr,ctrl){scope.dataType={};scope.editDataTypeSettings=false;scope.customListViewCreated=false;function activate(){if(scope.enableListView){dataTypeResource.getByName(scope.listViewName).then(function(dataType){scope.dataType=dataType;scope.customListViewCreated=checkForCustomListView();});}else{scope.dataType={};}}
scope.toggleEditListViewDataTypeSettings=function(){scope.editDataTypeSettings=!scope.editDataTypeSettings;};scope.saveListViewDataType=function(){var preValues=dataTypeHelper.createPreValueProps(scope.dataType.preValues);dataTypeResource.save(scope.dataType,preValues,false).then(function(dataType){scope.dataType=dataType;scope.editDataTypeSettings=false;});};scope.createCustomListViewDataType=function(){dataTypeResource.createCustomListView(scope.modelAlias).then(function(dataType){scope.dataType=dataType;scope.listViewName=dataType.name;scope.customListViewCreated=true;scope.editDataTypeSettings=true;});};scope.removeCustomListDataType=function(){scope.editDataTypeSettings=false;dataTypeResource.deleteById(scope.dataType.id).then(function(dataType){if(scope.contentType==="documentType"){scope.listViewName="List View - Content";}else if(scope.contentType==="mediaType"){scope.listViewName="List View - Media";}
dataTypeResource.getByName(scope.listViewName).then(function(dataType){scope.dataType=dataType;scope.customListViewCreated=false;});});};var unbindEnableListViewWatcher=scope.$watch('enableListView',function(newValue,oldValue){if(newValue!==undefined){activate();}});scope.$on('$destroy',function(){unbindEnableListViewWatcher();});function checkForCustomListView(){return scope.dataType.name==="List View - "+scope.modelAlias;}}
var directive={restrict:'E',replace:true,templateUrl:'views/components/umb-list-view-settings.html',scope:{enableListView:"=",listViewName:"=",modelAlias:"=",contentType:"@"},link:link};return directive;}
angular.module('umbraco.directives').directive('umbListViewSettings',ListViewSettingsDirective);})();(function(){'use strict';function UmbLoadIndicatorDirective(){var directive={restrict:'E',replace:true,templateUrl:'views/components/umb-load-indicator.html'};return directive;}
angular.module('umbraco.directives').directive('umbLoadIndicator',UmbLoadIndicatorDirective);})();(function(){'use strict';function LockedFieldDirective($timeout,localizationService){function link(scope,el,attr,ngModelCtrl){function activate(){if(scope.locked===undefined||scope.locked===null){scope.locked=true;}
if(scope.regexValidation===undefined||scope.regexValidation===null){scope.regexValidation="^[a-zA-Z]\\w.*$";}
if(scope.serverValidationField===undefined||scope.serverValidationField===null){scope.serverValidationField="";}
if(scope.placeholderText===undefined||scope.placeholderText===null){scope.placeholderText="Enter value...";}}
scope.lock=function(){scope.locked=true;};scope.unlock=function(){scope.locked=false;};activate();}
var directive={require:"ngModel",restrict:'E',replace:true,templateUrl:'views/components/umb-locked-field.html',scope:{ngModel:"=",locked:"=?",placeholderText:"=?",regexValidation:"=?",serverValidationField:"@"},link:link};return directive;}
angular.module('umbraco.directives').directive('umbLockedField',LockedFieldDirective);})();(function(){'use strict';function MediaGridDirective($filter,mediaHelper){function link(scope,el,attr,ctrl){var itemDefaultHeight=200;var itemDefaultWidth=200;var itemMaxWidth=200;var itemMaxHeight=200;var itemMinWidth=125;var itemMinHeight=125;function activate(){if(scope.itemMaxWidth){itemMaxWidth=scope.itemMaxWidth;}
if(scope.itemMaxHeight){itemMaxHeight=scope.itemMaxHeight;}
if(scope.itemMinWidth){itemMinWidth=scope.itemMinWidth;}
if(scope.itemMinWidth){itemMinHeight=scope.itemMinHeight;}
for(var i=0;scope.items.length>i;i++){var item=scope.items[i];setItemData(item);setOriginalSize(item,itemMaxHeight);if(scope.onlyImages==="true"&&!item.isFolder&&!item.thumbnail){scope.items.splice(i,1);i--;}}
if(scope.items.length>0){setFlexValues(scope.items);}}
function setItemData(item){item.isFolder=!mediaHelper.hasFilePropertyType(item);if(!item.isFolder){item.thumbnail=mediaHelper.resolveFile(item,true);item.image=mediaHelper.resolveFile(item,false);}}
function setOriginalSize(item,maxHeight){item.width=itemDefaultWidth;item.height=itemDefaultHeight;item.aspectRatio=1;var widthProp=_.find(item.properties,function(v){return(v.alias==="umbracoWidth");});if(widthProp&&widthProp.value){item.width=parseInt(widthProp.value,10);if(isNaN(item.width)){item.width=itemDefaultWidth;}}
var heightProp=_.find(item.properties,function(v){return(v.alias==="umbracoHeight");});if(heightProp&&heightProp.value){item.height=parseInt(heightProp.value,10);if(isNaN(item.height)){item.height=itemDefaultWidth;}}
item.aspectRatio=item.width/item.height;if(item.aspectRatio>=1){if(item.width>itemMaxWidth){item.width=itemMaxWidth;item.height=itemMaxWidth/item.aspectRatio;}}else{if(item.height>itemMaxHeight){item.height=itemMaxHeight;item.width=itemMaxHeight*item.aspectRatio;}}}
function setFlexValues(mediaItems){var flexSortArray=mediaItems;var smallestImageWidth=null;var widestImageAspectRatio=null;flexSortArray=$filter('orderBy')(flexSortArray,'width',true);widestImageAspectRatio=flexSortArray[0].aspectRatio;smallestImageWidth=flexSortArray[flexSortArray.length-1].width;for(var i=0;flexSortArray.length>i;i++){var mediaItem=flexSortArray[i];var flex=1/(widestImageAspectRatio/mediaItem.aspectRatio);if(flex===0){flex=1;}
var imageMinFlexWidth=smallestImageWidth*flex;var flexStyle={"flex":flex+" 1 "+imageMinFlexWidth+"px","max-width":mediaItem.width+"px","min-width":itemMinWidth+"px","min-height":itemMinHeight+"px"};mediaItem.flexStyle=flexStyle;}}
scope.clickItem=function(item,$event,$index){if(scope.onClick){scope.onClick(item,$event,$index);}};scope.clickItemName=function(item,$event,$index){if(scope.onClickName){scope.onClickName(item,$event,$index);$event.stopPropagation();}};scope.hoverItemDetails=function(item,$event,hover){if(scope.onDetailsHover){scope.onDetailsHover(item,$event,hover);}};var unbindItemsWatcher=scope.$watch('items',function(newValue,oldValue){if(angular.isArray(newValue)){activate();}});scope.$on('$destroy',function(){unbindItemsWatcher();});}
var directive={restrict:'E',replace:true,templateUrl:'views/components/umb-media-grid.html',scope:{items:'=',onDetailsHover:"=",onClick:'=',onClickName:"=",filterBy:"=",itemMaxWidth:"@",itemMaxHeight:"@",itemMinWidth:"@",itemMinHeight:"@",onlyImages:"@"},link:link};return directive;}
angular.module('umbraco.directives').directive('umbMediaGrid',MediaGridDirective);})();(function(){'use strict';function PaginationDirective(){function link(scope,el,attr,ctrl){function activate(){scope.pagination=[];var i=0;if(scope.totalPages<=10){for(i=0;i<scope.totalPages;i++){scope.pagination.push({val:(i+1),isActive:scope.pageNumber===(i+1)});}}
else{var maxIndex=scope.totalPages-10;var start=Math.max(scope.pageNumber-5,0);start=Math.min(maxIndex,start);for(i=start;i<(10+start);i++){scope.pagination.push({val:(i+1),isActive:scope.pageNumber===(i+1)});}
if(start>0){scope.pagination.unshift({name:"First",val:1,isActive:false},{val:"...",isActive:false});}
if(start<maxIndex){scope.pagination.push({val:"...",isActive:false},{name:"Last",val:scope.totalPages,isActive:false});}}}
scope.next=function(){if(scope.onNext&&scope.pageNumber<scope.totalPages){scope.pageNumber++;scope.onNext(scope.pageNumber);}};scope.prev=function(pageNumber){if(scope.onPrev&&scope.pageNumber>1){scope.pageNumber--;scope.onPrev(scope.pageNumber);}};scope.goToPage=function(pageNumber){if(scope.onGoToPage){scope.pageNumber=pageNumber+1;scope.onGoToPage(scope.pageNumber);}};var unbindPageNumberWatcher=scope.$watch('pageNumber',function(newValue,oldValue){activate();});scope.$on('$destroy',function(){unbindPageNumberWatcher();});activate();}
var directive={restrict:'E',replace:true,templateUrl:'views/components/umb-pagination.html',scope:{pageNumber:"=",totalPages:"=",onNext:"=",onPrev:"=",onGoToPage:"="},link:link};return directive;}
angular.module('umbraco.directives').directive('umbPagination',PaginationDirective);})();(function(){'use strict';function StickyBarDirective($rootScope){function link(scope,el,attr,ctrl){var bar=$(el);var scrollableContainer=null;var clonedBar=null;var cloneIsMade=false;var barTop=bar.context.offsetTop;function activate(){if(attr.scrollableContainer){scrollableContainer=$(attr.scrollableContainer);}else{scrollableContainer=$(window);}
scrollableContainer.on('scroll.umbStickyBar',determineVisibility).trigger("scroll");$(window).on('resize.umbStickyBar',determineVisibility);scope.$on('$destroy',function(){scrollableContainer.off('.umbStickyBar');$(window).off('.umbStickyBar');});}
function determineVisibility(){var scrollTop=scrollableContainer.scrollTop();if(scrollTop>barTop){if(!cloneIsMade){createClone();clonedBar.css({'visibility':'visible'});}else{calculateSize();}}else{if(cloneIsMade){bar.remove();bar=clonedBar;clonedBar=null;bar.removeClass('-umb-sticky-bar');bar.css({position:'relative','width':'auto','height':'auto','z-index':'auto','visibility':'visible'});cloneIsMade=false;}}}
function calculateSize(){clonedBar.css({width:bar.outerWidth(),height:bar.height()});}
function createClone(){clonedBar=bar;bar=clonedBar.clone();clonedBar.after(bar);clonedBar.addClass('-umb-sticky-bar');clonedBar.css({'position':'fixed','z-index':500,'visibility':'hidden'});cloneIsMade=true;calculateSize();}
activate();}
var directive={restrict:'A',link:link};return directive;}
angular.module('umbraco.directives').directive('umbStickyBar',StickyBarDirective);})();(function(){'use strict';function TableDirective(){function link(scope,el,attr,ctrl){scope.clickItem=function(item,$event){if(scope.onClick){scope.onClick(item);$event.stopPropagation();}};scope.selectItem=function(item,$index,$event){if(scope.onSelect){scope.onSelect(item,$index,$event);$event.stopPropagation();}};scope.selectAll=function($event){if(scope.onSelectAll){scope.onSelectAll($event);}};scope.isSelectedAll=function(){if(scope.onSelectedAll&&scope.items&&scope.items.length>0){return scope.onSelectedAll();}};scope.isSortDirection=function(col,direction){if(scope.onSortingDirection){return scope.onSortingDirection(col,direction);}};scope.sort=function(field,allow){if(scope.onSort){scope.onSort(field,allow);}};}
var directive={restrict:'E',replace:true,templateUrl:'views/components/umb-table.html',scope:{items:'=',itemProperties:'=',allowSelectAll:'=',onSelect:'=',onClick:'=',onSelectAll:'=',onSelectedAll:'=',onSortingDirection:'=',onSort:'='},link:link};return directive;}
angular.module('umbraco.directives').directive('umbTable',TableDirective);})();(function(){'use strict';function TooltipDirective($timeout){function link(scope,el,attr,ctrl){scope.tooltipStyles={};scope.tooltipStyles.left=0;scope.tooltipStyles.top=0;function activate(){$timeout(function(){setTooltipPosition(scope.event);});}
function setTooltipPosition(event){var container=$("#contentwrapper");var containerLeft=container[0].offsetLeft;var containerRight=containerLeft+container[0].offsetWidth;var containerTop=container[0].offsetTop;var containerBottom=containerTop+container[0].offsetHeight;var elementHeight=null;var elementWidth=null;var position={right:"inherit",left:"inherit",top:"inherit",bottom:"inherit"};elementHeight=el.context.clientHeight;elementWidth=el.context.clientWidth;position.left=event.pageX-(elementWidth/2);position.top=event.pageY;if(position.left+elementWidth>containerRight){position.right=10;position.left="inherit";}
if(position.top+elementHeight>containerBottom){position.bottom=10;position.top="inherit";}
if(position.left<containerLeft){position.left=containerLeft+10;position.right="inherit";}
if(position.top<containerTop){position.top=10;position.bottom="inherit";}
scope.tooltipStyles=position;el.css(position);}
activate();}
var directive={restrict:'E',transclude:true,replace:true,templateUrl:'views/components/umb-tooltip.html',scope:{event:"="},link:link};return directive;}
angular.module('umbraco.directives').directive('umbTooltip',TooltipDirective);})();angular.module("umbraco.directives").directive('umbFileDropzone',function($timeout,Upload,localizationService,umbRequestHelper){return{restrict:'E',replace:true,templateUrl:'views/components/upload/umb-file-dropzone.html',scope:{parentId:'@',contentTypeAlias:'@',propertyAlias:'@',accept:'@',maxFileSize:'@',compact:'@',hideDropzone:'@',filesQueued:'=',handleFile:'=',filesUploaded:'='},link:function(scope,element,attrs){scope.queue=[];scope.done=[];scope.rejected=[];scope.currentFile=undefined;function _filterFile(file){var ignoreFileNames=['Thumbs.db'];var ignoreFileTypes=['directory'];if(ignoreFileNames.indexOf(file.name)===-1&&ignoreFileTypes.indexOf(file.type)===-1&&file.name.indexOf(".")!==0){return true;}else{return false;}}
function _filesQueued(files,event){angular.forEach(files,function(file){if(_filterFile(file)===true){if(file.$error){scope.rejected.push(file);}else{scope.queue.push(file);}}});if(!scope.working){_processQueueItem();}}
function _processQueueItem(){if(scope.queue.length>0){scope.currentFile=scope.queue.shift();_upload(scope.currentFile);}else if(scope.done.length>0){if(scope.filesUploaded){scope.filesUploaded(scope.done);}
var currentLength=scope.done.length;$timeout(function(){scope.done.splice(0,currentLength);},3000);}}
function _upload(file){scope.propertyAlias=scope.propertyAlias?scope.propertyAlias:"umbracoFile";scope.contentTypeAlias=scope.contentTypeAlias?scope.contentTypeAlias:"Image";Upload.upload({url:umbRequestHelper.getApiUrl("mediaApiBaseUrl","PostAddFile"),fields:{'currentFolder':scope.parentId,'contentTypeAlias':scope.contentTypeAlias,'propertyAlias':scope.propertyAlias,'path':file.path},file:file}).progress(function(evt){var progressPercentage=parseInt(100.0*evt.loaded/evt.total,10);file.uploadProgress=progressPercentage;file.uploadStatus="uploading";}).success(function(data,status,headers,config){if(data.notifications&&data.notifications.length>0){file.uploadStatus="error";file.serverErrorMessage=data.notifications[0].message;scope.rejected.push(file);}else{file.uploadStatus="done";file.doneDate=new Date();scope.done.push(file);}
scope.currentFile=undefined;_processQueueItem();}).error(function(evt,status,headers,config){file.uploadStatus="error";if(evt.InnerException){file.serverErrorMessage=evt.InnerException.ExceptionMessage;if(evt.InnerException.StackTrace&&evt.InnerException.StackTrace.indexOf("ValidateRequestEntityLength")>0){file.serverErrorMessage="File too large to upload";}}else if(evt.Message){file.serverErrorMessage=evt.Message;}
if(status===404){file.serverErrorMessage="File not found";}
scope.rejected.push(file);scope.currentFile=undefined;_processQueueItem();});}
scope.handleFiles=function(files,event){if(scope.filesQueued){scope.filesQueued(files,event);}
_filesQueued(files,event);};}};});function umbFileUpload(){return{restrict:"A",scope:true,link:function(scope,el,attrs){el.bind('change',function(event){var files=event.target.files;scope.$emit("filesSelected",{files:files});});}};}
angular.module('umbraco.directives').directive("umbFileUpload",umbFileUpload);function umbSingleFileUpload($compile){return{restrict:"E",scope:{rebuild:"="},replace:true,template:"<div><input type='file' umb-file-upload /></div>",link:function(scope,el,attrs){scope.$watch("rebuild",function(newVal,oldVal){if(newVal&&newVal!==oldVal){el.html("<input type='file' umb-file-upload />");$compile(el.contents())(scope);}});}};}
angular.module('umbraco.directives').directive("umbSingleFileUpload",umbSingleFileUpload);function noDirtyCheck(){return{restrict:'A',require:'ngModel',link:function(scope,elm,attrs,ctrl){elm.focus(function(){ctrl.$pristine=false;});}};}
angular.module('umbraco.directives.validation').directive("noDirtyCheck",noDirtyCheck);(function(){'use strict';function SetDirtyOnChange(){function link(scope,el,attr,ctrl){var initValue=attr.umbSetDirtyOnChange;attr.$observe("umbSetDirtyOnChange",function(newValue){if(newValue!==initValue){ctrl.$setDirty();}});}
var directive={require:"^form",restrict:'A',link:link};return directive;}
angular.module('umbraco.directives').directive('umbSetDirtyOnChange',SetDirtyOnChange);})();angular.module('umbraco.directives.validation').directive('valCustom',function(){return{restrict:'A',require:'ngModel',link:function(scope,elm,attrs,ctrl){var validateFn,watch,validators={},validateExpr=scope.$eval(attrs.valCustom);if(!validateExpr){return;}
if(angular.isString(validateExpr)){validateExpr={validator:validateExpr};}
angular.forEach(validateExpr,function(exprssn,key){validateFn=function(valueToValidate){var expression=scope.$eval(exprssn,{'$value':valueToValidate});if(angular.isObject(expression)&&angular.isFunction(expression.then)){expression.then(function(){ctrl.$setValidity(key,true);},function(){ctrl.$setValidity(key,false);});return valueToValidate;}else if(expression){ctrl.$setValidity(key,true);return valueToValidate;}else{ctrl.$setValidity(key,false);return undefined;}};validators[key]=validateFn;ctrl.$parsers.push(validateFn);});function apply_watch(watch)
{if(angular.isString(watch))
{scope.$watch(watch,function(){angular.forEach(validators,function(validatorFn){validatorFn(ctrl.$modelValue);});});return;}
if(angular.isArray(watch))
{angular.forEach(watch,function(expression){scope.$watch(expression,function()
{angular.forEach(validators,function(validatorFn){validatorFn(ctrl.$modelValue);});});});return;}
if(angular.isObject(watch))
{angular.forEach(watch,function(expression,validatorKey)
{if(angular.isString(expression))
{scope.$watch(expression,function(){validators[validatorKey](ctrl.$modelValue);});}
if(angular.isArray(expression))
{angular.forEach(expression,function(intExpression)
{scope.$watch(intExpression,function(){validators[validatorKey](ctrl.$modelValue);});});}});}}
if(attrs.valCustomWatch){apply_watch(scope.$eval(attrs.valCustomWatch));}}};});function valHighlight($timeout){return{restrict:"A",link:function(scope,element,attrs,ctrl){attrs.$observe("valHighlight",function(newVal){if(newVal==="true"){element.addClass("highlight-error");$timeout(function(){scope[attrs.valHighlight]=false;},1000);}
else{element.removeClass("highlight-error");}});}};}
angular.module('umbraco.directives.validation').directive("valHighlight",valHighlight);angular.module('umbraco.directives.validation').directive('valCompare',function(){return{require:"ngModel",link:function(scope,elem,attrs,ctrl){var otherInput=elem.inheritedData("$formController")[attrs.valCompare];ctrl.$parsers.push(function(value){if(value===otherInput.$viewValue){ctrl.$setValidity("valCompare",true);return value;}
ctrl.$setValidity("valCompare",false);});otherInput.$parsers.push(function(value){ctrl.$setValidity("valCompare",value===ctrl.$viewValue);return value;});}};});function valEmail(valEmailExpression){return{require:'ngModel',restrict:"A",link:function(scope,elm,attrs,ctrl){var patternValidator=function(viewValue){if(!viewValue||valEmailExpression.EMAIL_REGEXP.test(viewValue)){ctrl.$setValidity('valEmail',true);ctrl.errorMsg="";return viewValue;}
else{ctrl.$setValidity('valEmail',false);ctrl.errorMsg="Invalid email";return undefined;}};ctrl.$parsers.push(patternValidator);}};}
angular.module('umbraco.directives.validation').directive("valEmail",valEmail).factory('valEmailExpression',function(){return{EMAIL_REGEXP:/^[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$/i};});function valFormManager(serverValidationManager,$rootScope,$log,$timeout,notificationsService,eventsService,$routeParams){return{require:"form",restrict:"A",controller:function($scope){var unsubscribe=[];var self=this;this.onValidationStatusChanged=function(cb){unsubscribe.push($scope.$on("valStatusChanged",function(evt,args){cb.apply(self,[evt,args]);}));};$scope.$on('$destroy',function(){for(var u in unsubscribe){unsubscribe[u]();}});},link:function(scope,element,attr,formCtrl){scope.$watch(function(){return formCtrl.$error;},function(e){scope.$broadcast("valStatusChanged",{form:formCtrl});var inError=element.find(".control-group .ng-invalid").closest(".control-group");inError.addClass("error");var noInError=element.find(".control-group .ng-valid").closest(".control-group").not(inError);noInError.removeClass("error");},true);var className=attr.valShowValidation?attr.valShowValidation:"show-validation";var savingEventName=attr.savingEvent?attr.savingEvent:"formSubmitting";var savedEvent=attr.savedEvent?attr.savingEvent:"formSubmitted";var isSavingNewItem=false;if(serverValidationManager.items.length>0){element.addClass(className);}
var unsubscribe=[];unsubscribe.push(scope.$on(savingEventName,function(ev,args){element.addClass(className);isSavingNewItem=$routeParams.create;}));unsubscribe.push(scope.$on(savedEvent,function(ev,args){element.removeClass(className);formCtrl.$setPristine();}));var locationEvent=$rootScope.$on('$locationChangeStart',function(event,nextLocation,currentLocation){if(!formCtrl.$dirty||isSavingNewItem){return;}
var path=nextLocation.split("#")[1];if(path){if(path.indexOf("%253")||path.indexOf("%252")){path=decodeURIComponent(path);}
if(!notificationsService.hasView()){var msg={view:"confirmroutechange",args:{path:path,listener:locationEvent}};notificationsService.add(msg);}
event.preventDefault();eventsService.emit("valFormManager.pendingChanges",true);}});unsubscribe.push(locationEvent);scope.$on('$destroy',function(){for(var u in unsubscribe){unsubscribe[u]();}});$timeout(function(){formCtrl.$setPristine();},1000);}};}
angular.module('umbraco.directives.validation').directive("valFormManager",valFormManager);function valPropertyMsg(serverValidationManager){return{scope:{property:"="},require:"^form",replace:true,restrict:"E",template:"<div ng-show=\"errorMsg != ''\" class='alert alert-error property-error' >{{errorMsg}}</div>",link:function(scope,element,attrs,formCtrl){var watcher=null;function getErrorMsg(){if(scope.property){var err=serverValidationManager.getPropertyError(scope.property.alias,"");if(err&&err.errorMsg){return err.errorMsg;}
else{return scope.property.propertyErrorMessage?scope.property.propertyErrorMessage:"Property has errors";}}
return"Property has errors";}
function startWatch(){if(!watcher){watcher=scope.$watch("property.value",function(newValue,oldValue){if(!newValue||angular.equals(newValue,oldValue)){return;}
var errCount=0;for(var e in formCtrl.$error){if(angular.isArray(formCtrl.$error[e])){errCount++;}}
if((errCount===1&&angular.isArray(formCtrl.$error.valPropertyMsg))||(formCtrl.$invalid&&angular.isArray(formCtrl.$error.valServer))){scope.errorMsg="";formCtrl.$setValidity('valPropertyMsg',true);stopWatch();}},true);}}
function stopWatch(){if(watcher){watcher();watcher=null;}}
var showValidation=serverValidationManager.items.length>0;var hasError=false;scope.errorMsg="";var unsubscribe=[];unsubscribe.push(scope.$on("valStatusChanged",function(evt,args){if(args.form.$invalid){if(formCtrl.$error.valPropertyMsg&&formCtrl.$error.valPropertyMsg.length>0){return;}
else if(element.closest(".umb-control-group").find(".ng-invalid").length>0){hasError=true;if(showValidation&&scope.errorMsg===""){scope.errorMsg=getErrorMsg();}}
else{hasError=false;scope.errorMsg="";}}
else{hasError=false;scope.errorMsg="";}},true));unsubscribe.push(scope.$on("formSubmitting",function(ev,args){showValidation=true;if(hasError&&scope.errorMsg===""){scope.errorMsg=getErrorMsg();}
else if(!hasError){scope.errorMsg="";stopWatch();}}));unsubscribe.push(scope.$on("formSubmitted",function(ev,args){showValidation=false;scope.errorMsg="";formCtrl.$setValidity('valPropertyMsg',true);stopWatch();}));if(scope.property){serverValidationManager.subscribe(scope.property.alias,"",function(isValid,propertyErrors,allErrors){hasError=!isValid;if(hasError){scope.errorMsg=propertyErrors[0].errorMsg;formCtrl.$setValidity('valPropertyMsg',false);startWatch();}
else{scope.errorMsg="";formCtrl.$setValidity('valPropertyMsg',true);stopWatch();}});element.bind('$destroy',function(){stopWatch();serverValidationManager.unsubscribe(scope.property.alias,"");});}
scope.$on('$destroy',function(){for(var u in unsubscribe){unsubscribe[u]();}});}};}
angular.module('umbraco.directives.validation').directive("valPropertyMsg",valPropertyMsg);function valPropertyValidator(serverValidationManager){return{scope:{valPropertyValidator:"="},require:['ngModel','?^umbProperty'],restrict:"A",link:function(scope,element,attrs,ctrls){var modelCtrl=ctrls[0];var propCtrl=ctrls.length>1?ctrls[1]:null;if(!scope.valPropertyValidator||!angular.isFunction(scope.valPropertyValidator)){throw new Error('val-property-validator directive must specify a function to call');}
var initResult=scope.valPropertyValidator();var validate=function(viewValue){var result=scope.valPropertyValidator();if(!result.errorKey||result.isValid===undefined||!result.errorMsg){throw"The result object from valPropertyValidator does not contain required properties: isValid, errorKey, errorMsg";}
if(result.isValid===true){modelCtrl.$setValidity(result.errorKey,true);if(propCtrl){propCtrl.setPropertyError(null);}}
else{modelCtrl.$setValidity(result.errorKey,false);if(propCtrl){propCtrl.setPropertyError(result.errorMsg);}}};modelCtrl.$parsers.push(validate);}};}
angular.module('umbraco.directives.validation').directive("valPropertyValidator",valPropertyValidator);function valRegex(){return{require:'ngModel',restrict:"A",link:function(scope,elm,attrs,ctrl){var flags="";var regex;var eventBindings=[];attrs.$observe("valRegexFlags",function(newVal){if(newVal){flags=newVal;}});attrs.$observe("valRegex",function(newVal){if(newVal){try{var resolved=newVal;if(resolved){regex=new RegExp(resolved,flags);}
else{regex=new RegExp(attrs.valRegex,flags);}}
catch(e){regex=new RegExp(attrs.valRegex,flags);}}});eventBindings.push(scope.$watch('ngModel',function(newValue,oldValue){if(newValue&&newValue!==oldValue){patternValidator(newValue);}}));var patternValidator=function(viewValue){if(regex){if(!viewValue||regex.test(viewValue.toString())){ctrl.$setValidity('valRegex',true);ctrl.errorMsg="";return viewValue;}
else{ctrl.$setValidity('valRegex',false);ctrl.errorMsg="Value is invalid, it does not match the correct pattern";return undefined;}}};scope.$on('$destroy',function(){for(var e in eventBindings){eventBindings[e]();}});}};}
angular.module('umbraco.directives.validation').directive("valRegex",valRegex);function valServer(serverValidationManager){return{require:['ngModel','?^umbProperty'],restrict:"A",link:function(scope,element,attr,ctrls){var modelCtrl=ctrls[0];var umbPropCtrl=ctrls.length>1?ctrls[1]:null;if(!umbPropCtrl){return;}
var watcher=null;function startWatch(){if(!watcher){watcher=scope.$watch(function(){return modelCtrl.$modelValue;},function(newValue,oldValue){if(!newValue||angular.equals(newValue,oldValue)){return;}
if(modelCtrl.$invalid){modelCtrl.$setValidity('valServer',true);stopWatch();}},true);}}
function stopWatch(){if(watcher){watcher();watcher=null;}}
var currentProperty=umbPropCtrl.property;var fieldName="value";if(attr.valServer){fieldName=scope.$eval(attr.valServer);if(!fieldName){fieldName=attr.valServer;}}
serverValidationManager.subscribe(currentProperty.alias,fieldName,function(isValid,propertyErrors,allErrors){if(!isValid){modelCtrl.$setValidity('valServer',false);modelCtrl.errorMsg=propertyErrors[0].errorMsg;startWatch();}
else{modelCtrl.$setValidity('valServer',true);modelCtrl.errorMsg="";stopWatch();}});element.bind('$destroy',function(){stopWatch();serverValidationManager.unsubscribe(currentProperty.alias,fieldName);});}};}
angular.module('umbraco.directives.validation').directive("valServer",valServer);function valServerField(serverValidationManager){return{require:'ngModel',restrict:"A",link:function(scope,element,attr,ctrl){var fieldName=null;var eventBindings=[];attr.$observe("valServerField",function(newVal){if(newVal&&fieldName===null){fieldName=newVal;eventBindings.push(scope.$watch('ngModel',function(newValue){if(ctrl.$invalid){ctrl.$setValidity('valServerField',true);}}));serverValidationManager.subscribe(null,fieldName,function(isValid,fieldErrors,allErrors){if(!isValid){ctrl.$setValidity('valServerField',false);ctrl.errorMsg=fieldErrors[0].errorMsg;}
else{ctrl.$setValidity('valServerField',true);ctrl.errorMsg="";}});element.bind('$destroy',function(){serverValidationManager.unsubscribe(null,fieldName);});}});scope.$on('$destroy',function(){for(var e in eventBindings){eventBindings[e]();}});}};}
angular.module('umbraco.directives.validation').directive("valServerField",valServerField);function valTab(){return{require:['^form','^valFormManager'],restrict:"A",link:function(scope,element,attr,ctrs){var valFormManager=ctrs[1];var tabId="tab"+scope.tab.id;scope.tabHasError=false;valFormManager.onValidationStatusChanged(function(evt,args){if(!args.form.$valid){var tabContent=element.closest(".umb-panel").find("#"+tabId);if(tabContent.find(".ng-invalid").length>0){scope.tabHasError=true;}else{scope.tabHasError=false;}}
else{scope.tabHasError=false;}});}};}
angular.module('umbraco.directives.validation').directive("valTab",valTab);function valToggleMsg(serverValidationManager){return{require:"^form",restrict:"A",link:function(scope,element,attr,formCtrl){if(!attr.valToggleMsg){throw"valToggleMsg requires that a reference to a validator is specified";}
if(!attr.valMsgFor){throw"valToggleMsg requires that the attribute valMsgFor exists on the element";}
if(!formCtrl[attr.valMsgFor]){throw"valToggleMsg cannot find field "+attr.valMsgFor+" on form "+formCtrl.$name;}
var showValidation=serverValidationManager.items.length>0;var hasCustomMsg=element.contents().length>0;scope.$watch(function(){return(formCtrl&&formCtrl[attr.valMsgFor])?formCtrl[attr.valMsgFor].$error[attr.valToggleMsg]:null;},function(){if((formCtrl&&formCtrl[attr.valMsgFor])){if(formCtrl[attr.valMsgFor].$error[attr.valToggleMsg]&&showValidation){element.show();if(!hasCustomMsg){element.html(formCtrl[attr.valMsgFor].errorMsg);}}
else{element.hide();}}});var unsubscribe=[];unsubscribe.push(scope.$on("formSubmitting",function(ev,args){showValidation=true;if(formCtrl[attr.valMsgFor].$error[attr.valToggleMsg]){element.show();if(!hasCustomMsg){element.html(formCtrl[attr.valMsgFor].errorMsg);}}
else{element.hide();}}));unsubscribe.push(scope.$on("formSubmitted",function(ev,args){showValidation=false;element.hide();}));element.bind('$destroy',function(){for(var u in unsubscribe){unsubscribe[u]();}});}};}
angular.module('umbraco.directives.validation').directive("valToggleMsg",valToggleMsg);angular.module('umbraco.directives.validation').directive('valTriggerChange',function($sniffer){return{link:function(scope,elem,attrs){elem.bind('click',function(){$(attrs.valTriggerChange).trigger($sniffer.hasEvent('input')?'input':'change');});},priority:1};});angular.module('umbraco.directives').directive('konamiCode',['$document',function($document){var konamiKeysDefault=[38,38,40,40,37,39,37,39,66,65];return{restrict:'A',link:function(scope,element,attr){if(!attr.konamiCode){throw('Konami directive must receive an expression as value.');}
var konamiKeys=attr.konamiKeys||konamiKeysDefault;var keyIndex=0;function activated(){if('konamiOnce'in attr){stopListening();}
scope.$eval(attr.konamiCode);}
function keydown(e){if(e.keyCode===konamiKeys[keyIndex++]){if(keyIndex===konamiKeys.length){keyIndex=0;activated();}}else{keyIndex=0;}}
function stopListening(){$document.off('keydown',keydown);}
$document.on('keydown',keydown);scope.$on('$destroy',stopListening);}};}]);(function(){'use strict';function ValRequireComponentDirective(){function link(scope,el,attr,ngModel){var unbindModelWatcher=scope.$watch(function(){return ngModel.$modelValue;},function(newValue){if(newValue===undefined||newValue===null||newValue===""){ngModel.$setValidity("valRequiredComponent",false);}else{ngModel.$setValidity("valRequiredComponent",true);}});scope.$on('$destroy',function(){unbindModelWatcher();});}
var directive={require:'ngModel',restrict:"A",link:link};return directive;}
angular.module('umbraco.directives').directive('valRequireComponent',ValRequireComponentDirective);})();(function(){'use strict';function valSubViewDirective(){function link(scope,el,attr,ctrl){var valFormManager=ctrl[1];scope.subView.hasError=false;valFormManager.onValidationStatusChanged(function(evt,args){if(!args.form.$valid){var subViewContent=el.find(".ng-invalid");if(subViewContent.length>0){scope.subView.hasError=true;}else{scope.subView.hasError=false;}}
else{scope.subView.hasError=false;}});}
var directive={require:['^form','^valFormManager'],restrict:"A",link:link};return directive;}
angular.module('umbraco.directives').directive('valSubView',valSubViewDirective);})();})();
;;;
(function(){angular.module('umbraco.filters',[]);angular.module("umbraco.filters").filter('compareArrays',function(){return function inArray(array,compareArray,compareProperty){var result=[];angular.forEach(array,function(arrayItem){var exists=false;angular.forEach(compareArray,function(compareItem){if(arrayItem[compareProperty]===compareItem[compareProperty]){exists=true;}});if(!exists){result.push(arrayItem);}});return result;};});angular.module("umbraco.filters").filter('timespan',function(){return function(input){var sec_num=parseInt(input,10);var hours=Math.floor(sec_num/3600);var minutes=Math.floor((sec_num-(hours*3600))/60);var seconds=sec_num-(hours*3600)-(minutes*60);if(hours<10){hours="0"+hours;}
if(minutes<10){minutes="0"+minutes;}
if(seconds<10){seconds="0"+seconds;}
var time=hours+':'+minutes+':'+seconds;return time;};});})();
;;;
(function(){angular.module("umbraco.services",["umbraco.security","umbraco.resources"]);function angularHelper($log,$q){return{rejectedPromise:function(objReject){var deferred=$q.defer();deferred.reject(objReject);return deferred.promise;},safeApply:function(scope,fn){if(scope.$$phase||scope.$root.$$phase){if(angular.isFunction(fn)){fn();}}
else{if(angular.isFunction(fn)){scope.$apply(fn);}
else{scope.$apply();}}},getCurrentForm:function(scope){var form=null;var requiredFormProps=["$addControl","$removeControl","$setValidity","$setDirty","$setPristine"];function propertyExists(objectPropNames){return _.every(requiredFormProps,function(item){return _.contains(objectPropNames,item);});}
for(var p in scope){if(_.isObject(scope[p])&&p!=="this"&&p.substr(0,1)!=="$"){var props=_.keys(scope[p]);if(props.length<requiredFormProps.length){continue;}
var containProperty=propertyExists(props);if(containProperty){form=scope[p];break;}}}
return form;},getRequiredCurrentForm:function(scope){var currentForm=this.getCurrentForm(scope);if(!currentForm||!currentForm.$name){throw"The current scope requires a current form object (or ng-form) with a name assigned to it";}
return currentForm;},getNullForm:function(formName){return{$addControl:angular.noop,$removeControl:angular.noop,$setValidity:angular.noop,$setDirty:angular.noop,$setPristine:angular.noop,$name:formName};}};}
angular.module('umbraco.services').factory('angularHelper',angularHelper);function appState(eventsService){var globalState={showNavigation:null,touchDevice:null,showTray:null,stickyNavigation:null,navMode:null,isReady:null,isTablet:null};var sectionState={currentSection:null,showSearchResults:null};var treeState={selectedNode:null,currentRootNode:null};var menuState={menuActions:null,dialogTitle:null,currentNode:null,showMenuDialog:null,showMenu:null};function setState(stateObj,key,value,stateObjName){if(!_.has(stateObj,key)){throw"The variable "+key+" does not exist in "+stateObjName;}
var changed=stateObj[key]!==value;stateObj[key]=value;if(changed){eventsService.emit("appState."+stateObjName+".changed",{key:key,value:value});}}
function getState(stateObj,key,stateObjName){if(!_.has(stateObj,key)){throw"The variable "+key+" does not exist in "+stateObjName;}
return stateObj[key];}
return{getGlobalState:function(key){return getState(globalState,key,"globalState");},setGlobalState:function(key,value){setState(globalState,key,value,"globalState");},getSectionState:function(key){return getState(sectionState,key,"sectionState");},setSectionState:function(key,value){setState(sectionState,key,value,"sectionState");},getTreeState:function(key){return getState(treeState,key,"treeState");},setTreeState:function(key,value){setState(treeState,key,value,"treeState");},getMenuState:function(key){return getState(menuState,key,"menuState");},setMenuState:function(key,value){setState(menuState,key,value,"menuState");},};}
angular.module('umbraco.services').factory('appState',appState);angular.module('umbraco.services').factory("editorState",function(){var current=null;var state={set:function(entity){current=entity;},reset:function(){current=null;},getCurrent:function(){return current;}};Object.defineProperty(state,"current",{get:function(){return current;},set:function(value){throw"Use editorState.set to set the value of the current entity";},});return state;});angular.module('umbraco.services').factory('assetsService',function($q,$log,angularHelper,umbRequestHelper,$rootScope,$http){var initAssetsLoaded=false;var appendRnd=function(url){if(!Umbraco.Sys.ServerVariables.application){return url;}
var rnd=Umbraco.Sys.ServerVariables.application.version+"."+Umbraco.Sys.ServerVariables.application.cdf;var _op=(url.indexOf("?")>0)?"&":"?";url=url+_op+"umb__rnd="+rnd;return url;};function convertVirtualPath(path){if(path.startsWith("~/")){path=umbRequestHelper.convertVirtualToAbsolutePath(path);}
return path;}
var service={loadedAssets:{},_getAssetPromise:function(path){if(this.loadedAssets[path]){return this.loadedAssets[path];}else{var deferred=$q.defer();this.loadedAssets[path]={deferred:deferred,state:"new",path:path};return this.loadedAssets[path];}},_loadInitAssets:function(){var deferred=$q.defer();if(initAssetsLoaded===false){var self=this;self.loadJs(umbRequestHelper.getApiUrl("serverVarsJs","",""),$rootScope).then(function(){initAssetsLoaded=true;self.loadJs(umbRequestHelper.getApiUrl("legacyTreeJs","",""),$rootScope);deferred.resolve();});}
else{deferred.resolve();}
return deferred.promise;},loadCss:function(path,scope,attributes,timeout){path=convertVirtualPath(path);var asset=this._getAssetPromise(path);var t=timeout||5000;var a=attributes||undefined;if(asset.state==="new"){asset.state="loading";LazyLoad.css(appendRnd(path),function(){if(!scope){asset.state="loaded";asset.deferred.resolve(true);}else{asset.state="loaded";angularHelper.safeApply(scope,function(){asset.deferred.resolve(true);});}});}else if(asset.state==="loaded"){asset.deferred.resolve(true);}
return asset.deferred.promise;},loadJs:function(path,scope,attributes,timeout){path=convertVirtualPath(path);var asset=this._getAssetPromise(path);var t=timeout||5000;var a=attributes||undefined;if(asset.state==="new"){asset.state="loading";LazyLoad.js(appendRnd(path),function(){if(!scope){asset.state="loaded";asset.deferred.resolve(true);}else{asset.state="loaded";angularHelper.safeApply(scope,function(){asset.deferred.resolve(true);});}});}else if(asset.state==="loaded"){asset.deferred.resolve(true);}
return asset.deferred.promise;},load:function(pathArray,scope){var promise;if(!angular.isArray(pathArray)){throw"pathArray must be an array";}
var nonEmpty=_.reject(pathArray,function(item){return item===undefined||item==="";});if(nonEmpty.length>0){var promises=[];var assets=[];_.each(nonEmpty,function(path){path=convertVirtualPath(path);var asset=service._getAssetPromise(path);if(asset.state!=="loaded"){if(asset.state==="new"){asset.state="loading";assets.push(asset);}
promises.push(asset.deferred.promise);}});promise=$q.all(promises);_.each(assets,function(asset){LazyLoad.js(appendRnd(asset.path),function(){asset.state="loaded";if(!scope){asset.deferred.resolve(true);}
else{angularHelper.safeApply(scope,function(){asset.deferred.resolve(true);});}});});}
else{var deferred=$q.defer();promise=deferred.promise;deferred.resolve(true);}
return promise;}};return service;});function contentEditingHelper(fileManager,$q,$location,$routeParams,notificationsService,serverValidationManager,dialogService,formHelper,appState){function isValidIdentifier(id){if(angular.isNumber(id)&&id>0){return true;}
if(id==="00000000-0000-0000-0000-000000000000"){return false;}
if(id===""){return false;}
return true;}
return{contentEditorPerformSave:function(args){if(!angular.isObject(args)){throw"args must be an object";}
if(!args.scope){throw"args.scope is not defined";}
if(!args.content){throw"args.content is not defined";}
if(!args.statusMessage){throw"args.statusMessage is not defined";}
if(!args.saveMethod){throw"args.saveMethod is not defined";}
var redirectOnFailure=args.redirectOnFailure!==undefined?args.redirectOnFailure:true;var self=this;var rebindCallback=args.rebindCallback===undefined?self.reBindChangedProperties:args.rebindCallback;var deferred=$q.defer();if(!args.scope.busy&&formHelper.submitForm({scope:args.scope,statusMessage:args.statusMessage,action:args.action})){args.scope.busy=true;args.saveMethod(args.content,$routeParams.create,fileManager.getFiles()).then(function(data){formHelper.resetForm({scope:args.scope,notifications:data.notifications});self.handleSuccessfulSave({scope:args.scope,savedContent:data,rebindCallback:function(){rebindCallback.apply(self,[args.content,data]);}});args.scope.busy=false;deferred.resolve(data);},function(err){self.handleSaveError({redirectOnFailure:redirectOnFailure,err:err,rebindCallback:function(){rebindCallback.apply(self,[args.content,err.data]);}});if(angular.isArray(err.data.notifications)){for(var i=0;i<err.data.notifications.length;i++){notificationsService.showNotification(err.data.notifications[i]);}}
args.scope.busy=false;deferred.reject(err);});}
else{deferred.reject();}
return deferred.promise;},configureContentEditorButtons:function(args){if(!angular.isObject(args)){throw"args must be an object";}
if(!args.content){throw"args.content is not defined";}
if(!args.methods){throw"args.methods is not defined";}
if(!args.methods.saveAndPublish||!args.methods.sendToPublish||!args.methods.save||!args.methods.unPublish){throw"args.methods does not contain all required defined methods";}
var buttons={defaultButton:null,subButtons:[]};function createButtonDefinition(ch){switch(ch){case"U":return{letter:ch,labelKey:"buttons_saveAndPublish",handler:args.methods.saveAndPublish,hotKey:"ctrl+p",hotKeyWhenHidden:true};case"H":return{letter:ch,labelKey:"buttons_saveToPublish",handler:args.methods.sendToPublish,hotKey:"ctrl+p",hotKeyWhenHidden:true};case"A":return{letter:ch,labelKey:"buttons_save",handler:args.methods.save,hotKey:"ctrl+s",hotKeyWhenHidden:true};case"Z":return{letter:ch,labelKey:"content_unPublish",handler:args.methods.unPublish,hotKey:"ctrl+u",hotKeyWhenHidden:true};default:return null;}}
buttons.subButtons=[];var buttonOrder=["U","H","A"];if(!args.create||_.contains(args.content.allowedActions,"C")){for(var b in buttonOrder){if(_.contains(args.content.allowedActions,buttonOrder[b])){buttons.defaultButton=createButtonDefinition(buttonOrder[b]);break;}}}
if(buttons.defaultButton){var lastIndex=_.indexOf(buttonOrder,buttons.defaultButton.letter);for(var i=lastIndex+1;i<buttonOrder.length;i++){if(_.contains(args.content.allowedActions,buttonOrder[i])){buttons.subButtons.push(createButtonDefinition(buttonOrder[i]));}}
if(!args.create){if(args.content.publishDate&&_.contains(args.content.allowedActions,"U")){buttons.subButtons.push(createButtonDefinition("Z"));}}}
return buttons;},getAllProps:function(content){var allProps=[];for(var i=0;i<content.tabs.length;i++){for(var p=0;p<content.tabs[i].properties.length;p++){allProps.push(content.tabs[i].properties[p]);}}
return allProps;},getAllowedActions:function(content,creating){var actionOrder=["U","H","A"];var defaultActions;var actions=[];if(!creating||_.contains(content.allowedActions,"C")){for(var b in actionOrder){if(_.contains(content.allowedActions,actionOrder[b])){defaultAction=actionOrder[b];break;}}}
actions.push(defaultAction);if(defaultAction){var lastIndex=_.indexOf(actionOrder,defaultAction);for(var i=lastIndex+1;i<actionOrder.length;i++){if(_.contains(content.allowedActions,actionOrder[i])){actions.push(actionOrder[i]);}}
if(!creating){if(content.publishDate&&_.contains(content.allowedActions,"U")){actions.push("Z");}}}
return actions;},getButtonFromAction:function(ch){switch(ch){case"U":return{letter:ch,labelKey:"buttons_saveAndPublish",handler:"saveAndPublish",hotKey:"ctrl+p"};case"H":return{letter:ch,labelKey:"buttons_saveToPublish",handler:"sendToPublish",hotKey:"ctrl+p"};case"A":return{letter:ch,labelKey:"buttons_save",handler:"save",hotKey:"ctrl+s"};case"Z":return{letter:ch,labelKey:"content_unPublish",handler:"unPublish"};default:return null;}},reBindChangedProperties:function(origContent,savedContent){var changed=[];var allOrigProps=this.getAllProps(origContent);var allNewProps=this.getAllProps(savedContent);function getNewProp(alias){return _.find(allNewProps,function(item){return item.alias===alias;});}
var shouldIgnore=function(propName){return _.some(["tabs","notifications","ModelState","tabs","properties"],function(i){return i===propName;});};for(var o in origContent){if(shouldIgnore(o)){continue;}
if(!_.isEqual(origContent[o],savedContent[o])){origContent[o]=savedContent[o];}}
for(var p in allOrigProps){var newProp=getNewProp(allOrigProps[p].alias);if(newProp&&!_.isEqual(allOrigProps[p].value,newProp.value)){var origVal=allOrigProps[p].value;allOrigProps[p].value=newProp.value;if(angular.isFunction(allOrigProps[p].onValueChanged)){allOrigProps[p].onValueChanged(allOrigProps[p].value,origVal);}
changed.push(allOrigProps[p]);}}
return changed;},handleSaveError:function(args){if(!args.err){throw"args.err cannot be null";}
if(args.redirectOnFailure===undefined||args.redirectOnFailure===null){throw"args.redirectOnFailure must be set to true or false";}
if(args.err.status===400){if(args.err.data&&(args.err.data.ModelState)){formHelper.handleServerValidation(args.err.data.ModelState);if(!args.redirectOnFailure||!this.redirectToCreatedContent(args.err.data.id,args.err.data.ModelState)){if(args.rebindCallback&&angular.isFunction(args.rebindCallback)){args.rebindCallback();}
serverValidationManager.executeAndClearAllSubscriptions();}
return true;}
else{dialogService.ysodDialog(args.err);}}
else{dialogService.ysodDialog(args.err);}
return false;},handleSuccessfulSave:function(args){if(!args){throw"args cannot be null";}
if(!args.savedContent){throw"args.savedContent cannot be null";}
if(!this.redirectToCreatedContent(args.redirectId?args.redirectId:args.savedContent.id)){if(args.rebindCallback&&angular.isFunction(args.rebindCallback)){args.rebindCallback();}}},redirectToCreatedContent:function(id,modelState){if($routeParams.create&&(isValidIdentifier(id)&&(!modelState||!modelState["Name"]))){$location.search("");$location.path("/"+$routeParams.section+"/"+$routeParams.tree+"/"+$routeParams.method+"/"+id);$location.replace();return true;}
return false;}};}
angular.module('umbraco.services').factory('contentEditingHelper',contentEditingHelper);function contentTypeHelper(contentTypeResource,dataTypeResource,$filter,$injector,$q){var contentTypeHelperService={createIdArray:function(array){var newArray=[];angular.forEach(array,function(arrayItem){if(angular.isObject(arrayItem)){newArray.push(arrayItem.id);}else{newArray.push(arrayItem);}});return newArray;},generateModels:function(){var deferred=$q.defer();var modelsResource=$injector.has("modelsBuilderResource")?$injector.get("modelsBuilderResource"):null;var modelsBuilderEnabled=Umbraco.Sys.ServerVariables.umbracoPlugins.modelsBuilder.enabled;if(modelsBuilderEnabled&&modelsResource){modelsResource.buildModels().then(function(result){deferred.resolve(result);modelsResource.getModelsOutOfDateStatus();},function(e){deferred.reject(e);});}
else{deferred.resolve(false);}
return deferred.promise;},checkModelsBuilderStatus:function(){var deferred=$q.defer();var modelsResource=$injector.has("modelsBuilderResource")?$injector.get("modelsBuilderResource"):null;var modelsBuilderEnabled=(Umbraco&&Umbraco.Sys&&Umbraco.Sys.ServerVariables&&Umbraco.Sys.ServerVariables.umbracoPlugins&&Umbraco.Sys.ServerVariables.umbracoPlugins.modelsBuilder&&Umbraco.Sys.ServerVariables.umbracoPlugins.modelsBuilder.enabled===true);if(modelsBuilderEnabled&&modelsResource){modelsResource.getModelsOutOfDateStatus().then(function(result){deferred.resolve(result.status===0);});}
else{deferred.resolve(false);}
return deferred.promise;},makeObjectArrayFromId:function(idArray,objectArray){var newArray=[];for(var idIndex=0;idArray.length>idIndex;idIndex++){var id=idArray[idIndex];for(var objectIndex=0;objectArray.length>objectIndex;objectIndex++){var object=objectArray[objectIndex];if(id===object.id){newArray.push(object);}}}
return newArray;},validateAddingComposition:function(contentType,compositeContentType){var propertiesAdding=_.flatten(_.map(compositeContentType.groups,function(g){return _.map(g.properties,function(p){return p.alias;});}));var propAliasesExisting=_.filter(_.flatten(_.map(contentType.groups,function(g){return _.map(g.properties,function(p){return p.alias;});})),function(f){return f!==null&&f!==undefined;});var intersec=_.intersection(propertiesAdding,propAliasesExisting);if(intersec.length>0){return intersec;}
return[];},mergeCompositeContentType:function(contentType,compositeContentType){var overlappingAliases=this.validateAddingComposition(contentType,compositeContentType);if(overlappingAliases.length>0){throw new Error("Cannot add this composition, these properties already exist on the content type: "+overlappingAliases.join());}
angular.forEach(compositeContentType.groups,function(compositionGroup){compositionGroup.properties=$filter('orderBy')(compositionGroup.properties,'sortOrder');angular.forEach(compositionGroup.properties,function(property){dataTypeResource.getById(property.dataTypeId).then(function(dataType){property.dataTypeIcon=dataType.icon;property.dataTypeName=dataType.name;});});compositionGroup.inherited=true;angular.forEach(compositionGroup.properties,function(compositionProperty){compositionProperty.inherited=true;});compositionGroup.tabState="inActive";angular.forEach(contentType.groups,function(contentTypeGroup){if(contentTypeGroup.name===compositionGroup.name){compositionGroup.groupIsMerged=true;contentTypeGroup.inherited=true;contentTypeGroup.properties=compositionGroup.properties.concat(contentTypeGroup.properties);contentTypeGroup.properties=contentTypeHelperService.updatePropertiesSortOrder(contentTypeGroup.properties);if(contentTypeGroup.parentTabContentTypeNames===null||contentTypeGroup.parentTabContentTypeNames===undefined){contentTypeGroup.parentTabContentTypeNames=[];}
contentTypeGroup.parentTabContentTypeNames.push(compositeContentType.name);if(contentTypeGroup.parentTabContentTypes===null||contentTypeGroup.parentTabContentTypes===undefined){contentTypeGroup.parentTabContentTypes=[];}
contentTypeGroup.parentTabContentTypes.push(compositeContentType.id);contentTypeGroup.sortOrder=compositionGroup.sortOrder;var contentTypeGroupCopy=angular.copy(contentTypeGroup);var index=contentType.groups.indexOf(contentTypeGroup);contentType.groups.splice(index,1);contentType.groups.unshift(contentTypeGroupCopy);}});if(compositionGroup.groupIsMerged===false||compositionGroup.groupIsMerged===undefined){if(compositionGroup.parentTabContentTypeNames===null||compositionGroup.parentTabContentTypeNames===undefined){compositionGroup.parentTabContentTypeNames=[];}
compositionGroup.parentTabContentTypeNames.push(compositeContentType.name);if(compositionGroup.parentTabContentTypes===null||compositionGroup.parentTabContentTypes===undefined){compositionGroup.parentTabContentTypes=[];}
compositionGroup.parentTabContentTypes.push(compositeContentType.id);contentType.groups.unshift(compositionGroup);}});contentType.groups=$filter('orderBy')(contentType.groups,'sortOrder');return contentType;},splitCompositeContentType:function(contentType,compositeContentType){var groups=[];angular.forEach(contentType.groups,function(contentTypeGroup){if(contentTypeGroup.tabState!=="init"){var idIndex=contentTypeGroup.parentTabContentTypes.indexOf(compositeContentType.id);var nameIndex=contentTypeGroup.parentTabContentTypeNames.indexOf(compositeContentType.name);var groupIndex=contentType.groups.indexOf(contentTypeGroup);if(idIndex!==-1){var properties=[];angular.forEach(contentTypeGroup.properties,function(property){if(property.contentTypeId!==compositeContentType.id){properties.push(property);}});contentTypeGroup.properties=properties;contentTypeGroup.parentTabContentTypes.splice(idIndex,1);contentTypeGroup.parentTabContentTypeNames.splice(nameIndex,1);if(contentTypeGroup.parentTabContentTypes.length===0){contentTypeGroup.inherited=false;}
if(contentTypeGroup.properties.length>1){groups.push(contentTypeGroup);}}else{groups.push(contentTypeGroup);}}else{groups.push(contentTypeGroup);}
contentTypeGroup.properties=contentTypeHelperService.updatePropertiesSortOrder(contentTypeGroup.properties);});contentType.groups=groups;},updatePropertiesSortOrder:function(properties){var sortOrder=0;angular.forEach(properties,function(property){if(!property.inherited&&property.propertyState!=="init"){property.sortOrder=sortOrder;}
sortOrder++;});return properties;},getTemplatePlaceholder:function(){var templatePlaceholder={"name":"","icon":"icon-layout","alias":"templatePlaceholder","placeholder":true};return templatePlaceholder;},insertDefaultTemplatePlaceholder:function(defaultTemplate){var templatePlaceholder=contentTypeHelperService.getTemplatePlaceholder();defaultTemplate=templatePlaceholder;return defaultTemplate;},insertTemplatePlaceholder:function(array){var templatePlaceholder=contentTypeHelperService.getTemplatePlaceholder();array.push(templatePlaceholder);return array;},insertChildNodePlaceholder:function(array,name,icon,id){var placeholder={"name":name,"icon":icon,"id":id};array.push(placeholder);}};return contentTypeHelperService;}
angular.module('umbraco.services').factory('contentTypeHelper',contentTypeHelper);function cropperHelper(umbRequestHelper,$http){var service={configuration:function(mediaTypeAlias){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("imageCropperApiBaseUrl","GetConfiguration",[{mediaTypeAlias:mediaTypeAlias}])),'Failed to retrieve tinymce configuration');},calculateAspectRatioFit:function(srcWidth,srcHeight,maxWidth,maxHeight,maximize){var ratio=[maxWidth/srcWidth,maxHeight/srcHeight];if(maximize){ratio=Math.max(ratio[0],ratio[1]);}else{ratio=Math.min(ratio[0],ratio[1]);}
return{width:srcWidth*ratio,height:srcHeight*ratio,ratio:ratio};},calculateSizeToRatio:function(srcWidth,srcHeight,ratio){return{width:srcWidth*ratio,height:srcHeight*ratio,ratio:ratio};},scaleToMaxSize:function(srcWidth,srcHeight,maxSize){var retVal={height:srcHeight,width:srcWidth};if(srcWidth>maxSize||srcHeight>maxSize){var ratio=[maxSize/srcWidth,maxSize/srcHeight];ratio=Math.min(ratio[0],ratio[1]);retVal.height=srcHeight*ratio;retVal.width=srcWidth*ratio;}
return retVal;},convertToStyle:function(coordinates,originalSize,viewPort,offset){var coordinates_px=service.coordinatesToPixels(coordinates,originalSize,offset);var _offset=offset||0;var x=1-(coordinates.x1+Math.abs(coordinates.x2));var left_of_x=originalSize.width*x;var ratio=viewPort.width/left_of_x;var style={position:"absolute",top:-(coordinates_px.y1*ratio)+_offset,left:-(coordinates_px.x1*ratio)+_offset,width:Math.floor(originalSize.width*ratio),height:Math.floor(originalSize.height*ratio),originalWidth:originalSize.width,originalHeight:originalSize.height,ratio:ratio};return style;},coordinatesToPixels:function(coordinates,originalSize,offset){var coordinates_px={x1:Math.floor(coordinates.x1*originalSize.width),y1:Math.floor(coordinates.y1*originalSize.height),x2:Math.floor(coordinates.x2*originalSize.width),y2:Math.floor(coordinates.y2*originalSize.height)};return coordinates_px;},pixelsToCoordinates:function(image,width,height,offset){var x1_px=Math.abs(image.left-offset);var y1_px=Math.abs(image.top-offset);var x2_px=image.width-(x1_px+width);var y2_px=image.height-(y1_px+height);var crop={};crop.x1=x1_px/image.width;crop.y1=y1_px/image.height;crop.x2=x2_px/image.width;crop.y2=y2_px/image.height;for(var coord in crop){if(crop[coord]<0){crop[coord]=0;}}
return crop;},centerInsideViewPort:function(img,viewport){var left=viewport.width/2-img.width/2,top=viewport.height/2-img.height/2;return{left:left,top:top};},alignToCoordinates:function(image,center,viewport){var min_left=(image.width)-(viewport.width);var min_top=(image.height)-(viewport.height);var c_top=-(center.top*image.height)+(viewport.height/2);var c_left=-(center.left*image.width)+(viewport.width/2);if(c_top<-min_top){c_top=-min_top;}
if(c_top>0){c_top=0;}
if(c_left<-min_left){c_left=-min_left;}
if(c_left>0){c_left=0;}
return{left:c_left,top:c_top};},syncElements:function(source,target){target.height(source.height());target.width(source.width());target.css({"top":source[0].offsetTop,"left":source[0].offsetLeft});}};return service;}
angular.module('umbraco.services').factory('cropperHelper',cropperHelper);function dataTypeHelper(){var dataTypeHelperService={createPreValueProps:function(preVals){var preValues=[];for(var i=0;i<preVals.length;i++){preValues.push({hideLabel:preVals[i].hideLabel,alias:preVals[i].key,description:preVals[i].description,label:preVals[i].label,view:preVals[i].view,value:preVals[i].value});}
return preValues;},rebindChangedProperties:function(origContent,savedContent){var shouldIgnore=function(propName){return _.some(["notifications","ModelState"],function(i){return i===propName;});};for(var o in origContent){if(shouldIgnore(o)){continue;}
if(!_.isEqual(origContent[o],savedContent[o])){origContent[o]=savedContent[o];}}}};return dataTypeHelperService;}
angular.module('umbraco.services').factory('dataTypeHelper',dataTypeHelper);angular.module('umbraco.services').factory('dialogService',function($rootScope,$compile,$http,$timeout,$q,$templateCache,appState,eventsService){var dialogs=[];function removeAllDialogs(args){for(var i=0;i<dialogs.length;i++){var dialog=dialogs[i];if(!dialog.manualClose){dialog.close(args);}}}
function closeDialog(dialog){if(dialog.element){dialog.element.modal('hide');if(dialog.iframe){dialog.element.find("iframe").attr("src","about:blank");}
dialog.scope.$destroy();dialog.element.remove();dialogs=_.reject(dialogs,function(i){return i===dialog;});}}
function openDialog(options){var defaults={container:$("body"),animation:"fade",modalClass:"umb-modal",width:"100%",inline:false,iframe:false,show:true,template:"views/common/notfound.html",callback:undefined,closeCallback:undefined,element:undefined,dialogData:undefined};var dialog=angular.extend(defaults,options);var scope=options.scope||$rootScope.$new();dialog.element=$('<div ng-swipe-right="swipeHide($event)"  data-backdrop="false"></div>');var id="old-dialog-service";if(options.inline){dialog.animation="";}
else{dialog.element.addClass("modal");dialog.element.addClass("hide");}
dialog.element.attr('id',id).addClass(dialog.animation).addClass(dialog.modalClass);$timeout(function(){dialogs.push(dialog);},500);dialog.close=function(data){if(dialog.closeCallback){dialog.closeCallback(data);}
closeDialog(dialog);};if(dialog.iframe){var html=$("<iframe src='"+dialog.template+"' class='auto-expand' style='border: none; width: 100%; height: 100%;'></iframe>");dialog.element.html(html);dialog.container.append(dialog.element);$timeout(function(){$compile(dialog.element)(dialog.scope);});dialog.element.css("width",dialog.width);if(dialog.show){dialog.element.modal('show');}
dialog.scope=scope;return dialog;}
else{$q.when($templateCache.get(dialog.template)||$http.get(dialog.template,{cache:true}).then(function(res){return res.data;})).then(function onSuccess(template){dialog.element.html(template);dialog.container.append(dialog.element);$timeout(function(){$compile(dialog.element)(scope);});scope.dialogOptions=dialog;scope.dialogData=dialog.dialogData?dialog.dialogData:{};scope.dialogData.selection=[];scope.$modal=function(name){dialog.element.modal(name);};scope.swipeHide=function(e){if(appState.getGlobalState("touchDevice")){var selection=window.getSelection();if(selection.type!=="Range"){scope.hide();}}};scope.hide=function(){closeDialog(dialog);};scope.submit=function(data){if(dialog.callback){dialog.callback(data);}
closeDialog(dialog);};scope.close=function(data){dialog.close(data);};scope.show=function(){if(dialog.manualClose===true){dialog.element.modal({keyboard:false});}
else{dialog.element.modal('show');}};scope.select=function(item){var i=scope.dialogData.selection.indexOf(item);if(i<0){scope.dialogData.selection.push(item);}else{scope.dialogData.selection.splice(i,1);}};scope.dismiss=scope.hide;angular.forEach(['show','shown','hide','hidden'],function(name){dialog.element.on(name,function(ev){scope.$emit('modal-'+name,ev);});});dialog.element.on('shown',function(event){$('input[autofocus]',dialog.element).first().trigger('focus');});dialog.scope=scope;if(dialog.show){scope.show();}});return dialog;}}
eventsService.on("app.closeDialogs",function(evt,args){removeAllDialogs(args);});return{open:function(options){return openDialog(options);},close:function(dialog,args){if(dialog){dialog.close(args);}},closeAll:function(args){removeAllDialogs(args);},mediaPicker:function(options){options.template='views/common/dialogs/mediaPicker.html';options.show=true;return openDialog(options);},contentPicker:function(options){options.treeAlias="content";options.section="content";return this.treePicker(options);},linkPicker:function(options){options.template='views/common/dialogs/linkPicker.html';options.show=true;return openDialog(options);},macroPicker:function(options){options.template='views/common/dialogs/insertmacro.html';options.show=true;options.modalClass="span7 umb-modal";return openDialog(options);},memberPicker:function(options){options.treeAlias="member";options.section="member";return this.treePicker(options);},memberGroupPicker:function(options){options.template='views/common/dialogs/memberGroupPicker.html';options.show=true;return openDialog(options);},iconPicker:function(options){options.template='views/common/dialogs/iconPicker.html';options.show=true;return openDialog(options);},treePicker:function(options){options.template='views/common/dialogs/treePicker.html';options.show=true;return openDialog(options);},propertyDialog:function(options){options.template='views/common/dialogs/property.html';options.show=true;return openDialog(options);},embedDialog:function(options){options.template='views/common/dialogs/rteembed.html';options.show=true;return openDialog(options);},ysodDialog:function(ysodError){var newScope=$rootScope.$new();newScope.error=ysodError;return openDialog({modalClass:"umb-modal wide ysod",scope:newScope,template:'views/common/dialogs/ysod.html',show:true});},confirmDialog:function(ysodError){options.template='views/common/dialogs/confirm.html';options.show=true;return openDialog(options);}};});function eventsService($q,$rootScope){return{emit:function(name,args){if(!$rootScope.$$listeners[name]){return;}
$rootScope.$emit(name,args);},on:function(name,callback){return $rootScope.$on(name,callback);},unsubscribe:function(handle){if(angular.isFunction(handle)){handle();}}};}
angular.module('umbraco.services').factory('eventsService',eventsService);function fileManager(){var fileCollection=[];return{setFiles:function(propertyAlias,files){fileCollection=_.reject(fileCollection,function(item){return item.alias===propertyAlias;});for(var i=0;i<files.length;i++){fileCollection.push({alias:propertyAlias,file:files[i]});}},getFiles:function(){return fileCollection;},clearFiles:function(){fileCollection=[];}};}
angular.module('umbraco.services').factory('fileManager',fileManager);function formHelper(angularHelper,serverValidationManager,$timeout,notificationsService,dialogService,localizationService){return{submitForm:function(args){var currentForm;if(!args){throw"args cannot be null";}
if(!args.scope){throw"args.scope cannot be null";}
if(!args.formCtrl){currentForm=angularHelper.getRequiredCurrentForm(args.scope);}
else{currentForm=args.formCtrl;}
if(!args.statusPropertyName){args.statusPropertyName="formStatus";}
if(!args.statusTimeout){args.statusTimeout=2500;}
args.scope.$broadcast("formSubmitting",{scope:args.scope,action:args.action});if(!args.skipValidation){if(currentForm.$invalid){return false;}}
serverValidationManager.reset();if(args.statusMessage){args.scope[args.statusPropertyName]=args.statusMessage;$timeout(function(){args.scope[args.statusPropertyName]=undefined;},args.statusTimeout);}
return true;},resetForm:function(args){if(!args){throw"args cannot be null";}
if(!args.scope){throw"args.scope cannot be null";}
if(!args.statusPropertyName){args.statusPropertyName="formStatus";}
args.scope[args.statusPropertyName]=null;if(angular.isArray(args.notifications)){for(var i=0;i<args.notifications.length;i++){notificationsService.showNotification(args.notifications[i]);}}
args.scope.$broadcast("formSubmitted",{scope:args.scope});},handleError:function(err){if(err.status===400){if(err.data&&(err.data.ModelState)){this.handleServerValidation(err.data.ModelState);serverValidationManager.executeAndClearAllSubscriptions();}
else{dialogService.ysodDialog(err);}}
else{dialogService.ysodDialog(err);}},handleServerValidation:function(modelState){for(var e in modelState){var parts=e.split(".");if(parts.length>1&&parts[0]==="_Properties"){var propertyAlias=parts[1];if(parts.length>2){serverValidationManager.addPropertyError(propertyAlias,parts[2],modelState[e][0]);}
else{serverValidationManager.addPropertyError(propertyAlias,"",modelState[e][0]);}}
else{serverValidationManager.addFieldError(e,modelState[e][0]);}
notificationsService.error("Validation",modelState[e][0]);}}};}
angular.module('umbraco.services').factory('formHelper',formHelper);angular.module('umbraco.services').factory('gridService',function($http,$q){var configPath=Umbraco.Sys.ServerVariables.umbracoUrls.gridConfig;var service={getGridEditors:function(){return $http.get(configPath);}};return service;});angular.module('umbraco.services').factory('helpService',function($http,$q){var helpTopics={};var defaultUrl="http://our.umbraco.org/rss/help";var tvUrl="http://umbraco.tv/feeds/help";function getCachedHelp(url){if(helpTopics[url]){return helpTopics[cacheKey];}else{return null;}}
function setCachedHelp(url,data){helpTopics[url]=data;}
function fetchUrl(url){var deferred=$q.defer();var found=getCachedHelp(url);if(found){deferred.resolve(found);}else{var proxyUrl="dashboard/feedproxy.aspx?url="+url;$http.get(proxyUrl).then(function(data){var feed=$(data.data);var topics=[];$('item',feed).each(function(i,item){var topic={};topic.thumbnail=$(item).find('thumbnail').attr('url');topic.title=$("title",item).text();topic.link=$("guid",item).text();topic.description=$("description",item).text();topics.push(topic);});setCachedHelp(topics);deferred.resolve(topics);});}
return deferred.promise;}
var service={findHelp:function(args){var url=service.getUrl(defaultUrl,args);return fetchUrl(url);},findVideos:function(args){var url=service.getUrl(tvUrl,args);return fetchUrl(url);},getUrl:function(url,args){return url+"?"+$.param(args);}};return service;});angular.module('umbraco.services').factory('historyService',function($rootScope,$timeout,angularHelper,eventsService){var nArray=[];function add(item){if(!item){return null;}
var listWithoutThisItem=_.reject(nArray,function(i){return i.link===item.link;});listWithoutThisItem.splice(0,0,item);nArray=listWithoutThisItem;return nArray[0];}
return{add:function(item){var icon=item.icon||"icon-file";angularHelper.safeApply($rootScope,function(){var result=add({name:item.name,icon:icon,link:item.link,time:new Date()});eventsService.emit("historyService.add",{added:result,all:nArray});return result;});},remove:function(index){angularHelper.safeApply($rootScope,function(){var result=nArray.splice(index,1);eventsService.emit("historyService.remove",{removed:result,all:nArray});});},removeAll:function(){angularHelper.safeApply($rootScope,function(){nArray=[];eventsService.emit("historyService.removeAll");});},getCurrent:function(){return nArray;}};});function iconHelper($q,$timeout){var converter=[{oldIcon:".sprNew",newIcon:"add"},{oldIcon:".sprDelete",newIcon:"remove"},{oldIcon:".sprMove",newIcon:"enter"},{oldIcon:".sprCopy",newIcon:"documents"},{oldIcon:".sprSort",newIcon:"navigation-vertical"},{oldIcon:".sprPublish",newIcon:"globe"},{oldIcon:".sprRollback",newIcon:"undo"},{oldIcon:".sprProtect",newIcon:"lock"},{oldIcon:".sprAudit",newIcon:"time"},{oldIcon:".sprNotify",newIcon:"envelope"},{oldIcon:".sprDomain",newIcon:"home"},{oldIcon:".sprPermission",newIcon:"lock"},{oldIcon:".sprRefresh",newIcon:"refresh"},{oldIcon:".sprBinEmpty",newIcon:"trash"},{oldIcon:".sprExportDocumentType",newIcon:"download-alt"},{oldIcon:".sprImportDocumentType",newIcon:"page-up"},{oldIcon:".sprLiveEdit",newIcon:"edit"},{oldIcon:".sprCreateFolder",newIcon:"add"},{oldIcon:".sprPackage2",newIcon:"box"},{oldIcon:".sprLogout",newIcon:"logout"},{oldIcon:".sprSave",newIcon:"save"},{oldIcon:".sprSendToTranslate",newIcon:"envelope-alt"},{oldIcon:".sprToPublish",newIcon:"mail-forward"},{oldIcon:".sprTranslate",newIcon:"comments"},{oldIcon:".sprUpdate",newIcon:"save"},{oldIcon:".sprTreeSettingDomain",newIcon:"icon-home"},{oldIcon:".sprTreeDoc",newIcon:"icon-document"},{oldIcon:".sprTreeDoc2",newIcon:"icon-diploma-alt"},{oldIcon:".sprTreeDoc3",newIcon:"icon-notepad"},{oldIcon:".sprTreeDoc4",newIcon:"icon-newspaper-alt"},{oldIcon:".sprTreeDoc5",newIcon:"icon-notepad-alt"},{oldIcon:".sprTreeDocPic",newIcon:"icon-picture"},{oldIcon:".sprTreeFolder",newIcon:"icon-folder"},{oldIcon:".sprTreeFolder_o",newIcon:"icon-folder"},{oldIcon:".sprTreeMediaFile",newIcon:"icon-music"},{oldIcon:".sprTreeMediaMovie",newIcon:"icon-movie"},{oldIcon:".sprTreeMediaPhoto",newIcon:"icon-picture"},{oldIcon:".sprTreeMember",newIcon:"icon-user"},{oldIcon:".sprTreeMemberGroup",newIcon:"icon-users"},{oldIcon:".sprTreeMemberType",newIcon:"icon-users"},{oldIcon:".sprTreeNewsletter",newIcon:"icon-file-text-alt"},{oldIcon:".sprTreePackage",newIcon:"icon-box"},{oldIcon:".sprTreeRepository",newIcon:"icon-server-alt"},{oldIcon:".sprTreeSettingDataType",newIcon:"icon-autofill"},{oldIcon:"folder.png",newIcon:"icon-folder"},{oldIcon:"mediaphoto.gif",newIcon:"icon-picture"},{oldIcon:"mediafile.gif",newIcon:"icon-document"},{oldIcon:".sprTreeDeveloperCacheItem",newIcon:"icon-box"},{oldIcon:".sprTreeDeveloperCacheTypes",newIcon:"icon-box"},{oldIcon:".sprTreeDeveloperMacro",newIcon:"icon-cogs"},{oldIcon:".sprTreeDeveloperRegistry",newIcon:"icon-windows"},{oldIcon:".sprTreeDeveloperPython",newIcon:"icon-linux"}];var imageConverter=[{oldImage:"contour.png",newIcon:"icon-umb-contour"}];var collectedIcons;return{formatContentTypeThumbnails:function(contentTypes){for(var i=0;i<contentTypes.length;i++){if(contentTypes[i].thumbnailIsClass===undefined||contentTypes[i].thumbnailIsClass){contentTypes[i].cssClass=this.convertFromLegacyIcon(contentTypes[i].thumbnail);}else{contentTypes[i].style="background-image: url('"+contentTypes[i].thumbnailFilePath+"');height:36px; background-position:4px 0px; background-repeat: no-repeat;background-size: 35px 35px;";contentTypes[i].cssClass="custom-file";}}
return contentTypes;},formatContentTypeIcons:function(contentTypes){for(var i=0;i<contentTypes.length;i++){contentTypes[i].icon=this.convertFromLegacyIcon(contentTypes[i].icon);if(contentTypes[i].icon.indexOf(".")>0){contentTypes[i].icon="icon-document-dashed-line";}}
return contentTypes;},isFileBasedIcon:function(icon){if(icon.startsWith('..')||(!icon.startsWith('.')&&icon.indexOf('.')>1)){return true;}
return false;},isLegacyIcon:function(icon){if(icon.startsWith('..')){return false;}
if(icon.startsWith('.')){return true;}
return false;},isLegacyTreeNodeIcon:function(treeNode){if(treeNode.iconIsClass){return this.isLegacyIcon(treeNode.icon);}
return false;},getIcons:function(){var deferred=$q.defer();$timeout(function(){if(collectedIcons){deferred.resolve(collectedIcons);}else{collectedIcons=[];var c=".icon-";for(var i=document.styleSheets.length-1;i>=0;i--){var classes=document.styleSheets[i].rules||document.styleSheets[i].cssRules;if(classes!==null){for(var x=0;x<classes.length;x++){var cur=classes[x];if(cur.selectorText&&cur.selectorText.indexOf(c)===0){var s=cur.selectorText.substring(1);var hasSpace=s.indexOf(" ");if(hasSpace>0){s=s.substring(0,hasSpace);}
var hasPseudo=s.indexOf(":");if(hasPseudo>0){s=s.substring(0,hasPseudo);}
if(collectedIcons.indexOf(s)<0){collectedIcons.push(s);}}}}}
deferred.resolve(collectedIcons);}},100);return deferred.promise;},convertFromLegacyIcon:function(icon){if(this.isLegacyIcon(icon)){var found=_.find(converter,function(item){return item.oldIcon.toLowerCase()===icon.toLowerCase();});return(found?found.newIcon:icon);}
return icon;},convertFromLegacyImage:function(icon){var found=_.find(imageConverter,function(item){return item.oldImage.toLowerCase()===icon.toLowerCase();});return(found?found.newIcon:undefined);},convertFromLegacyTreeNodeIcon:function(treeNode){if(this.isLegacyTreeNodeIcon(treeNode)){return this.convertFromLegacyIcon(treeNode.icon);}
return treeNode.icon;}};}
angular.module('umbraco.services').factory('iconHelper',iconHelper);function imageHelper(umbRequestHelper,mediaHelper){return{getImagePropertyValue:function(options){return mediaHelper.getImagePropertyValue(options);},getThumbnail:function(options){return mediaHelper.getThumbnail(options);},scaleToMaxSize:function(maxSize,width,height){return mediaHelper.scaleToMaxSize(maxSize,width,height);},getThumbnailFromPath:function(imagePath){return mediaHelper.getThumbnailFromPath(imagePath);},detectIfImageByExtension:function(imagePath){return mediaHelper.detectIfImageByExtension(imagePath);}};}
angular.module('umbraco.services').factory('imageHelper',imageHelper);function keyboardService($window,$timeout){var keyboardManagerService={};var defaultOpt={'type':'keydown','propagate':false,'inputDisabled':false,'target':$window.document,'keyCode':false};var shift_nums={"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":":","'":"\"",",":"<",".":">","/":"?","\\":"|"};var special_keys={'esc':27,'escape':27,'tab':9,'space':32,'return':13,'enter':13,'backspace':8,'scrolllock':145,'scroll_lock':145,'scroll':145,'capslock':20,'caps_lock':20,'caps':20,'numlock':144,'num_lock':144,'num':144,'pause':19,'break':19,'insert':45,'home':36,'delete':46,'end':35,'pageup':33,'page_up':33,'pu':33,'pagedown':34,'page_down':34,'pd':34,'left':37,'up':38,'right':39,'down':40,'f1':112,'f2':113,'f3':114,'f4':115,'f5':116,'f6':117,'f7':118,'f8':119,'f9':120,'f10':121,'f11':122,'f12':123};var isMac=navigator.platform.toUpperCase().indexOf('MAC')>=0;function eventHandler(e){e=e||$window.event;var code,k;if(e.keyCode)
{code=e.keyCode;}
else if(e.which){code=e.which;}
var character=String.fromCharCode(code).toLowerCase();if(code===188){character=",";}
if(code===190){character=".";}
var propagate=true;_.find(_.keys(keyboardManagerService.keyboardEvent),function(key){var shortcutLabel=key;var shortcutVal=keyboardManagerService.keyboardEvent[key];var kp=0;var modifiers={shift:{wanted:false,pressed:e.shiftKey?true:false},ctrl:{wanted:false,pressed:e.ctrlKey?true:false},alt:{wanted:false,pressed:e.altKey?true:false},meta:{wanted:false,pressed:e.metaKey?true:false}};var keys=shortcutLabel.split("+");var opt=shortcutVal.opt;var callback=shortcutVal.callback;var l=keys.length;for(var i=0;i<l;i++){var k=keys[i];switch(k){case'ctrl':case'control':kp++;modifiers.ctrl.wanted=true;break;case'shift':case'alt':case'meta':kp++;modifiers[k].wanted=true;break;}
if(k.length>1){if(special_keys[k]===code){kp++;}}
else if(opt['keyCode']){if(opt['keyCode']===code){kp++;}}
else{if(character===k){kp++;}
else{if(shift_nums[character]&&e.shiftKey){character=shift_nums[character];if(character===k){kp++;}}}}}
if(kp===keys.length&&modifiers.ctrl.pressed===modifiers.ctrl.wanted&&modifiers.shift.pressed===modifiers.shift.wanted&&modifiers.alt.pressed===modifiers.alt.wanted&&modifiers.meta.pressed===modifiers.meta.wanted){if(opt['inputDisabled']){var elt;if(e.target){elt=e.target;}else if(e.srcElement){elt=e.srcElement;}
if(elt.nodeType===3){elt=elt.parentNode;}
if(elt.tagName==='INPUT'||elt.tagName==='TEXTAREA'){return true;}}
$timeout(function(){callback(e);},1);if(!opt['propagate']){propagate=false;}
return true;}
return false;});if(!propagate){e.cancelBubble=true;e.returnValue=false;if(e.stopPropagation){e.stopPropagation();e.preventDefault();}
return false;}}
keyboardManagerService.keyboardEvent={};keyboardManagerService.bind=function(label,callback,opt){if(isMac&&label!=="ctrl+space"){label=label.replace("ctrl","meta");}
var elt;opt=angular.extend({},defaultOpt,opt);label=label.toLowerCase();elt=opt.target;if(typeof opt.target==='string'){elt=document.getElementById(opt.target);}
var boundValues=_.values(keyboardManagerService.keyboardEvent);var found=_.find(boundValues,function(i){return i.target===elt&&i.event===opt['type'];});keyboardManagerService.keyboardEvent[label]={'callback':callback,'target':elt,'opt':opt};if(!found){if(elt.addEventListener){elt.addEventListener(opt['type'],eventHandler,false);}else if(elt.attachEvent){elt.attachEvent('on'+opt['type'],eventHandler);}else{elt['on'+opt['type']]=eventHandler;}}};keyboardManagerService.unbind=function(label){label=label.toLowerCase();var binding=keyboardManagerService.keyboardEvent[label];delete(keyboardManagerService.keyboardEvent[label]);if(!binding){return;}
var type=binding['event'],elt=binding['target'],callback=binding['callback'];if(elt.detachEvent){elt.detachEvent('on'+type,callback);}else if(elt.removeEventListener){elt.removeEventListener(type,callback,false);}else{elt['on'+type]=false;}};return keyboardManagerService;}
angular.module('umbraco.services').factory('keyboardService',['$window','$timeout',keyboardService]);(function(){'use strict';function listViewHelper(localStorageService){var firstSelectedIndex=0;var localStorageKey="umblistViewLayout";function getLayout(nodeId,availableLayouts){var storedLayouts=[];if(localStorageService.get(localStorageKey)){storedLayouts=localStorageService.get(localStorageKey);}
if(storedLayouts&&storedLayouts.length>0){for(var i=0;storedLayouts.length>i;i++){var layout=storedLayouts[i];if(layout.nodeId===nodeId){return setLayout(nodeId,layout,availableLayouts);}}}
return getFirstAllowedLayout(availableLayouts);}
function setLayout(nodeId,selectedLayout,availableLayouts){var activeLayout={};var layoutFound=false;for(var i=0;availableLayouts.length>i;i++){var layout=availableLayouts[i];if(layout.path===selectedLayout.path){activeLayout=layout;layout.active=true;layoutFound=true;}else{layout.active=false;}}
if(!layoutFound){activeLayout=getFirstAllowedLayout(availableLayouts);}
saveLayoutInLocalStorage(nodeId,activeLayout);return activeLayout;}
function saveLayoutInLocalStorage(nodeId,selectedLayout){var layoutFound=false;var storedLayouts=[];if(localStorageService.get(localStorageKey)){storedLayouts=localStorageService.get(localStorageKey);}
if(storedLayouts.length>0){for(var i=0;storedLayouts.length>i;i++){var layout=storedLayouts[i];if(layout.nodeId===nodeId){layout.path=selectedLayout.path;layoutFound=true;}}}
if(!layoutFound){var storageObject={"nodeId":nodeId,"path":selectedLayout.path};storedLayouts.push(storageObject);}
localStorageService.set(localStorageKey,storedLayouts);}
function getFirstAllowedLayout(layouts){var firstAllowedLayout={};for(var i=0;layouts.length>i;i++){var layout=layouts[i];if(layout.selected===true){firstAllowedLayout=layout;break;}}
return firstAllowedLayout;}
function selectHandler(selectedItem,selectedIndex,items,selection,$event){var start=0;var end=0;var item=null;if($event.shiftKey===true){if(selectedIndex>firstSelectedIndex){start=firstSelectedIndex;end=selectedIndex;for(;end>=start;start++){item=items[start];selectItem(item,selection);}}else{start=firstSelectedIndex;end=selectedIndex;for(;end<=start;start--){item=items[start];selectItem(item,selection);}}}else{if(selectedItem.selected){deselectItem(selectedItem,selection);}else{selectItem(selectedItem,selection);}
firstSelectedIndex=selectedIndex;}}
function selectItem(item,selection){var isSelected=false;for(var i=0;selection.length>i;i++){var selectedItem=selection[i];if(item.id===selectedItem.id){isSelected=true;}}
if(!isSelected){selection.push({id:item.id});item.selected=true;}}
function deselectItem(item,selection){for(var i=0;selection.length>i;i++){var selectedItem=selection[i];if(item.id===selectedItem.id){selection.splice(i,1);item.selected=false;}}}
function clearSelection(items,folders,selection){var i=0;selection.length=0;if(angular.isArray(items)){for(i=0;items.length>i;i++){var item=items[i];item.selected=false;}}
if(angular.isArray(folders)){for(i=0;folders.length>i;i++){var folder=folders[i];folder.selected=false;}}}
function selectAllItems(items,selection,$event){var checkbox=$event.target;var clearSelection=false;if(!angular.isArray(items)){return;}
selection.length=0;for(var i=0;i<items.length;i++){var item=items[i];if(checkbox.checked){selection.push({id:item.id});}else{clearSelection=true;}
item.selected=checkbox.checked;}
if(clearSelection){selection.length=0;}}
function isSelectedAll(items,selection){var numberOfSelectedItem=0;for(var itemIndex=0;items.length>itemIndex;itemIndex++){var item=items[itemIndex];for(var selectedIndex=0;selection.length>selectedIndex;selectedIndex++){var selectedItem=selection[selectedIndex];if(item.id===selectedItem.id){numberOfSelectedItem++;}}}
if(numberOfSelectedItem===items.length){return true;}}
function setSortingDirection(col,direction,options){return options.orderBy.toUpperCase()===col.toUpperCase()&&options.orderDirection===direction;}
function setSorting(field,allow,options){if(allow){options.orderBy=field;if(options.orderDirection==="desc"){options.orderDirection="asc";}else{options.orderDirection="desc";}}}
function getButtonPermissions(unmergedPermissions,currentIdsWithPermissions){if(currentIdsWithPermissions==null){currentIdsWithPermissions={};}
_.each(unmergedPermissions,function(value,key,list){currentIdsWithPermissions[key]=value;});var arr=[];_.each(currentIdsWithPermissions,function(value,key,list){arr.push(value);});var intersectPermissions=_.intersection.apply(_,arr);return{canCopy:_.contains(intersectPermissions,'O'),canCreate:_.contains(intersectPermissions,'C'),canDelete:_.contains(intersectPermissions,'D'),canMove:_.contains(intersectPermissions,'M'),canPublish:_.contains(intersectPermissions,'U'),canUnpublish:_.contains(intersectPermissions,'U'),};}
var service={getLayout:getLayout,getFirstAllowedLayout:getFirstAllowedLayout,setLayout:setLayout,saveLayoutInLocalStorage:saveLayoutInLocalStorage,selectHandler:selectHandler,selectItem:selectItem,deselectItem:deselectItem,clearSelection:clearSelection,selectAllItems:selectAllItems,isSelectedAll:isSelectedAll,setSortingDirection:setSortingDirection,setSorting:setSorting,getButtonPermissions:getButtonPermissions};return service;}
angular.module('umbraco.services').factory('listViewHelper',listViewHelper);})();angular.module('umbraco.services').factory('localizationService',function($http,$q,eventsService,$window,$filter,userService){var url="LocalizedText";var resourceFileLoadStatus="none";var resourceLoadingPromise=[];function _lookup(value,tokens,dictionary){if(value&&value[0]==="@"){value=value.substring(1);}
if(value&&value.indexOf("_")<0){value="general_"+value;}
var entry=dictionary[value];if(entry){if(tokens){for(var i=0;i<tokens.length;i++){entry=entry.replace("%"+i+"%",tokens[i]);}}
return entry;}
return"["+value+"]";}
var service={dictionary:[],initLocalizedResources:function(){var deferred=$q.defer();if(resourceFileLoadStatus==="loaded"){deferred.resolve(service.dictionary);return deferred.promise;}
if(resourceFileLoadStatus==="loading"){resourceLoadingPromise.push(deferred);return deferred.promise;}
resourceFileLoadStatus="loading";$http({method:"GET",url:url,cache:false}).then(function(response){resourceFileLoadStatus="loaded";service.dictionary=response.data;eventsService.emit("localizationService.updated",response.data);deferred.resolve(response.data);for(var p in resourceLoadingPromise){resourceLoadingPromise[p].resolve(response.data);}},function(err){deferred.reject("Something broke");for(var p in resourceLoadingPromise){resourceLoadingPromise[p].reject("Something broke");}});return deferred.promise;},tokenize:function(value,scope){if(value){var localizer=value.split(':');var retval={tokens:undefined,key:localizer[0].substring(0)};if(localizer.length>1){retval.tokens=localizer[1].split(',');for(var x=0;x<retval.tokens.length;x++){retval.tokens[x]=scope.$eval(retval.tokens[x]);}}
return retval;}
return value;},localize:function(value,tokens){return service.initLocalizedResources().then(function(dic){var val=_lookup(value,tokens,dic);return val;});},};eventsService.on("app.authenticated",function(){resourceFileLoadStatus="none";resourceLoadingPromise=[];});return service;});function macroService(){return{parseMacroSyntax:function(syntax){var expression=/(<\?UMBRACO_MACRO (?:.+?)?macroAlias=["']([^\"\'\n\r]+?)["'][\s\S]+?)(\/>|>.*?<\/\?UMBRACO_MACRO>)/i;var match=expression.exec(syntax);if(!match||match.length<3){return null;}
var alias=match[2];var paramsChunk=match[1].trim().replace(new RegExp("UMBRACO_MACRO macroAlias=[\"']"+alias+"[\"']"),"").trim();var paramExpression=/(\w+?)=['\"]([\s\S]*?)['\"]/g;var paramMatch;var returnVal={macroAlias:alias,macroParamsDictionary:{}};while(paramMatch=paramExpression.exec(paramsChunk)){returnVal.macroParamsDictionary[paramMatch[1]]=paramMatch[2];}
return returnVal;},generateMacroSyntax:function(args){var macroString='<?UMBRACO_MACRO macroAlias=\"'+args.macroAlias+"\" ";if(args.macroParamsDictionary){_.each(args.macroParamsDictionary,function(val,key){val=val?val:"";var keyVal;if(angular.isString(val)){keyVal=key+"=\""+(val?val:"")+"\" ";}
else{var json=angular.toJson(val);var encoded=encodeURIComponent(json);keyVal=key+"=\""+encoded+"\" ";}
macroString+=keyVal;});}
macroString+="/>";return macroString;},generateWebFormsSyntax:function(args){var macroString='<umbraco:Macro ';if(args.macroParamsDictionary){_.each(args.macroParamsDictionary,function(val,key){var keyVal=key+"=\""+(val?val:"")+"\" ";macroString+=keyVal;});}
macroString+="Alias=\""+args.macroAlias+"\" runat=\"server\"></umbraco:Macro>";return macroString;},generateMvcSyntax:function(args){var macroString="@Umbraco.RenderMacro(\""+args.macroAlias+"\"";var hasParams=false;var paramString;if(args.macroParamsDictionary){paramString=", new {";_.each(args.macroParamsDictionary,function(val,key){hasParams=true;var keyVal=key+"=\""+(val?val:"")+"\", ";paramString+=keyVal;});paramString=paramString.trimEnd(", ");paramString+="}";}
if(hasParams){macroString+=paramString;}
macroString+=")";return macroString;},collectValueData:function(macro,macroParams,renderingEngine){var paramDictionary={};var macroAlias=macro.alias;var syntax;_.each(macroParams,function(item){var val=item.value;if(item.value!==null&&item.value!==undefined&&!_.isString(item.value)){try{val=angular.toJson(val);}
catch(e){}}
paramDictionary[item.alias]=_.escape(val);});if(renderingEngine&&renderingEngine==="WebForms"){syntax=this.generateWebFormsSyntax({macroAlias:macroAlias,macroParamsDictionary:paramDictionary});}
else if(renderingEngine&&renderingEngine==="Mvc"){syntax=this.generateMvcSyntax({macroAlias:macroAlias,macroParamsDictionary:paramDictionary});}
else{syntax=this.generateMacroSyntax({macroAlias:macroAlias,macroParamsDictionary:paramDictionary});}
var macroObject={"macroParamsDictionary":paramDictionary,"macroAlias":macroAlias,"syntax":syntax};return macroObject;}};}
angular.module('umbraco.services').factory('macroService',macroService);function mediaHelper(umbRequestHelper){var _mediaFileResolvers={};return{getMediaPropertyValue:function(options){if(!options||!options.mediaModel){throw"The options objet does not contain the required parameters: mediaModel";}
var props=[];if(options.mediaModel.properties){props=options.mediaModel.properties;}else{$(options.mediaModel.tabs).each(function(i,tab){props=props.concat(tab.properties);});}
var mediaRoot=Umbraco.Sys.ServerVariables.umbracoSettings.mediaPath;var imageProp=_.find(props,function(item){if(item.alias==="umbracoFile"){return true;}
if(angular.isString(item.value)&&item.value.indexOf(mediaRoot)===0){return true;}
return false;});if(!imageProp){return"";}
var mediaVal;var split=imageProp.value.split(',');var self=this;mediaVal=_.map(split,function(item){return{file:item,isImage:self.detectIfImageByExtension(item)};});if(mediaVal.length&&mediaVal.length>0){if(!options.imageOnly||(options.imageOnly===true&&mediaVal[0].isImage)){return mediaVal[0].file;}}
return"";},getImagePropertyValue:function(options){if(!options||(!options.imageModel&&!options.mediaModel)){throw"The options objet does not contain the required parameters: imageModel";}
options.mediaModel=options.imageModel?options.imageModel:options.mediaModel;options.imageOnly=true;return this.getMediaPropertyValue(options);},getThumbnail:function(options){if(!options||!options.imageModel){throw"The options objet does not contain the required parameters: imageModel";}
var imagePropVal=this.getImagePropertyValue(options);if(imagePropVal!==""){return this.getThumbnailFromPath(imagePropVal);}
return"";},registerFileResolver:function(propertyEditorAlias,func){_mediaFileResolvers[propertyEditorAlias]=func;},resolveFileFromEntity:function(mediaEntity,thumbnail){if(!angular.isObject(mediaEntity.metaData)){throw"Cannot resolve the file url from the mediaEntity, it does not contain the required metaData";}
var values=_.values(mediaEntity.metaData);for(var i=0;i<values.length;i++){var val=values[i];if(angular.isObject(val)&&val.PropertyEditorAlias){for(var resolver in _mediaFileResolvers){if(val.PropertyEditorAlias===resolver){var property={value:val.Value};return _mediaFileResolvers[resolver](property,mediaEntity,thumbnail);}}}}
return"";},resolveFile:function(mediaItem,thumbnail){function iterateProps(props){var res=null;for(var resolver in _mediaFileResolvers){var property=_.find(props,function(prop){return prop.editor===resolver;});if(property){res=_mediaFileResolvers[resolver](property,mediaItem,thumbnail);break;}}
return res;}
var result="";if(mediaItem.properties){result=iterateProps(mediaItem.properties);}else if(mediaItem.tabs){for(var tab in mediaItem.tabs){if(mediaItem.tabs[tab].properties){result=iterateProps(mediaItem.tabs[tab].properties);if(result){break;}}}}
return result;},hasFilePropertyType:function(mediaItem){function iterateProps(props){var res=false;for(var resolver in _mediaFileResolvers){var property=_.find(props,function(prop){return prop.editor===resolver;});if(property){res=true;break;}}
return res;}
var result=false;if(mediaItem.properties){result=iterateProps(mediaItem.properties);}else if(mediaItem.tabs){for(var tab in mediaItem.tabs){if(mediaItem.tabs[tab].properties){result=iterateProps(mediaItem.tabs[tab].properties);if(result){break;}}}}
return result;},scaleToMaxSize:function(maxSize,width,height){var retval={width:width,height:height};var maxWidth=maxSize;var maxHeight=maxSize;var ratio=0;if(width>maxWidth){ratio=maxWidth/width;retval.width=maxWidth;retval.height=height*ratio;height=height*ratio;width=width*ratio;}
if(height>maxHeight){ratio=maxHeight/height;retval.height=maxHeight;retval.width=width*ratio;width=width*ratio;}
return retval;},getThumbnailFromPath:function(imagePath){if(!this.detectIfImageByExtension(imagePath)){return null;}
var thumbnailUrl=umbRequestHelper.getApiUrl("imagesApiBaseUrl","GetBigThumbnail",[{originalImagePath:imagePath}]);return thumbnailUrl;},detectIfImageByExtension:function(imagePath){if(!imagePath){return false;}
var lowered=imagePath.toLowerCase();var ext=lowered.substr(lowered.lastIndexOf(".")+1);return(","+Umbraco.Sys.ServerVariables.umbracoSettings.imageFileTypes+",").indexOf(","+ext+",")!==-1;},formatFileTypes:function(fileTypes){var fileTypesArray=fileTypes.split(',');var newFileTypesArray=[];for(var i=0;i<fileTypesArray.length;i++){var fileType=fileTypesArray[i];if(fileType.indexOf(".")!==0){fileType=".".concat(fileType);}
newFileTypesArray.push(fileType);}
return newFileTypesArray.join(",");}};}angular.module('umbraco.services').factory('mediaHelper',mediaHelper);function umbracoMenuActions($q,treeService,$location,navigationService,appState){return{"RefreshNode":function(args){var treeRoot=appState.getTreeState("currentRootNode");if(treeRoot&&treeRoot.root){var treeNode=treeService.getDescendantNode(treeRoot.root,args.entity.id,args.treeAlias);if(treeNode){treeService.loadNodeChildren({node:treeNode,section:args.section});}}},"CreateChildEntity":function(args){navigationService.hideNavigation();var route="/"+args.section+"/"+args.treeAlias+"/edit/"+args.entity.id;$location.path(route).search({create:true});}};}
angular.module('umbraco.services').factory('umbracoMenuActions',umbracoMenuActions);function navigationService($rootScope,$routeParams,$log,$location,$q,$timeout,$injector,dialogService,umbModelMapper,treeService,notificationsService,historyService,appState,angularHelper){var currentDialog=null;var mainTreeEventHandler=null;var userDialog=null;function setMode(mode){switch(mode){case'tree':appState.setGlobalState("navMode","tree");appState.setGlobalState("showNavigation",true);appState.setMenuState("showMenu",false);appState.setMenuState("showMenuDialog",false);appState.setGlobalState("stickyNavigation",false);appState.setGlobalState("showTray",false);break;case'menu':appState.setGlobalState("navMode","menu");appState.setGlobalState("showNavigation",true);appState.setMenuState("showMenu",true);appState.setMenuState("showMenuDialog",false);appState.setGlobalState("stickyNavigation",true);break;case'dialog':appState.setGlobalState("navMode","dialog");appState.setGlobalState("stickyNavigation",true);appState.setGlobalState("showNavigation",true);appState.setMenuState("showMenu",false);appState.setMenuState("showMenuDialog",true);break;case'search':appState.setGlobalState("navMode","search");appState.setGlobalState("stickyNavigation",false);appState.setGlobalState("showNavigation",true);appState.setMenuState("showMenu",false);appState.setSectionState("showSearchResults",true);appState.setMenuState("showMenuDialog",false);$timeout(function(){$("#search-field").focus();});break;default:appState.setGlobalState("navMode","default");appState.setMenuState("showMenu",false);appState.setMenuState("showMenuDialog",false);appState.setSectionState("showSearchResults",false);appState.setGlobalState("stickyNavigation",false);appState.setGlobalState("showTray",false);if(appState.getGlobalState("isTablet")===true){appState.setGlobalState("showNavigation",false);}
break;}}
var service={init:function(){$rootScope.$watch(function(){return $routeParams.section;},function(newVal,oldVal){appState.setSectionState("currentSection",newVal);});},loadLegacyIFrame:function(source){$location.path("/"+appState.getSectionState("currentSection")+"/framed/"+encodeURIComponent(source));},changeSection:function(sectionAlias,force){setMode("default-opensection");if(force&&appState.getSectionState("currentSection")===sectionAlias){appState.setSectionState("currentSection","");}
appState.setSectionState("currentSection",sectionAlias);this.showTree(sectionAlias);$location.path(sectionAlias);},showTree:function(sectionAlias,syncArgs){if(sectionAlias!==appState.getSectionState("currentSection")){appState.setSectionState("currentSection",sectionAlias);if(syncArgs){this.syncTree(syncArgs);}}
setMode("tree");},showTray:function(){appState.setGlobalState("showTray",true);},hideTray:function(){appState.setGlobalState("showTray",false);},setupTreeEvents:function(treeEventHandler){mainTreeEventHandler=treeEventHandler;mainTreeEventHandler.bind("treeLoaded",function(ev,args){appState.setTreeState("currentRootNode",args.tree);});mainTreeEventHandler.bind("treeSynced",function(ev,args){if(args.activate===undefined||args.activate===true){appState.setTreeState("selectedNode",args.node);appState.setMenuState("currentNode",args.node);}});mainTreeEventHandler.bind("treeOptionsClick",function(ev,args){ev.stopPropagation();ev.preventDefault();appState.setMenuState("currentNode",args.node);if(args.event&&args.event.altKey){args.skipDefault=true;}
service.showMenu(ev,args);});mainTreeEventHandler.bind("treeNodeAltSelect",function(ev,args){ev.stopPropagation();ev.preventDefault();args.skipDefault=true;service.showMenu(ev,args);});mainTreeEventHandler.bind("treeNodeSelect",function(ev,args){var n=args.node;ev.stopPropagation();ev.preventDefault();if(n.metaData&&n.metaData["jsClickCallback"]&&angular.isString(n.metaData["jsClickCallback"])&&n.metaData["jsClickCallback"]!==""){var jsPrefix="javascript:";var js;if(n.metaData["jsClickCallback"].startsWith(jsPrefix)){js=n.metaData["jsClickCallback"].substr(jsPrefix.length);}
else{js=n.metaData["jsClickCallback"];}
try{var func=eval(js);if(func!=null&&(typeof func==="function")){func.call();}}
catch(ex){$log.error("Error evaluating js callback from legacy tree node: "+ex);}}
else if(n.routePath){historyService.add({name:n.name,link:n.routePath,icon:n.icon});appState.setTreeState("selectedNode",args.node);appState.setMenuState("currentNode",args.node);$location.path(n.routePath).search("");}
else if(args.element.section){$location.path(args.element.section).search("");}
service.hideNavigation();});},syncTree:function(args){if(!args){throw"args cannot be null";}
if(!args.path){throw"args.path cannot be null";}
if(!args.tree){throw"args.tree cannot be null";}
if(mainTreeEventHandler){return mainTreeEventHandler.syncTree(args);}
return angularHelper.rejectedPromise();},_syncPath:function(path,forceReload){if(mainTreeEventHandler){mainTreeEventHandler.syncTree({path:path,forceReload:forceReload});}},reloadNode:function(node){if(mainTreeEventHandler){mainTreeEventHandler.reloadNode(node);}},reloadSection:function(sectionAlias){if(mainTreeEventHandler){mainTreeEventHandler.clearCache({section:sectionAlias});mainTreeEventHandler.load(sectionAlias);}},_setActiveTreeType:function(treeAlias,loadChildren){if(mainTreeEventHandler){mainTreeEventHandler._setActiveTreeType(treeAlias,loadChildren);}},hideTree:function(){if(appState.getGlobalState("isTablet")===true&&!appState.getGlobalState("stickyNavigation")){appState.setSectionState("currentSection",$routeParams.section);setMode("default-hidesectiontree");}},showMenu:function(event,args){var deferred=$q.defer();var self=this;treeService.getMenu({treeNode:args.node}).then(function(data){if(data.defaultAlias&&!args.skipDefault){var found=_.find(data.menuItems,function(item){return item.alias=data.defaultAlias;});if(found){appState.setMenuState("currentNode",args.node);if(currentDialog){dialogService.close(currentDialog);}
var dialog=self.showDialog({node:args.node,action:found,section:appState.getSectionState("currentSection")});deferred.resolve(dialog);return;}}
setMode("menu");appState.setMenuState("currentNode",args.node);appState.setMenuState("menuActions",data.menuItems);appState.setMenuState("dialogTitle",args.node.name);deferred.resolve(null);});return deferred.promise;},hideMenu:function(){appState.setMenuState("currentNode",null);appState.setMenuState("menuActions",[]);setMode("tree");},executeMenuAction:function(action,node,section){if(!action){throw"action cannot be null";}
if(!node){throw"node cannot be null";}
if(!section){throw"section cannot be null";}
if(action.metaData&&action.metaData["actionRoute"]&&angular.isString(action.metaData["actionRoute"])){var parts=action.metaData["actionRoute"].split("?");$location.path(parts[0]).search(parts.length>1?parts[1]:"");this.hideNavigation();return;}
else if(action.metaData&&action.metaData["jsAction"]&&angular.isString(action.metaData["jsAction"])){var menuAction=action.metaData["jsAction"].split('.');if(menuAction.length!==2){var js=action.metaData["jsAction"].replace("javascript:","");eval(js);}
else{var menuActionService=$injector.get(menuAction[0]);if(!menuActionService){throw"The angular service "+menuAction[0]+" could not be found";}
var method=menuActionService[menuAction[1]];if(!method){throw"The method "+menuAction[1]+" on the angular service "+menuAction[0]+" could not be found";}
method.apply(this,[{entity:umbModelMapper.convertToEntityBasic(node),action:action,section:section,treeAlias:treeService.getTreeAlias(node)}]);}}
else{service.showDialog({node:node,action:action,section:section});}},showUserDialog:function(){if(service.helpDialog){service.helpDialog.close();}
service.hideTray();if(service.userDialog){service.userDialog.close();service.userDialog=undefined;}
service.userDialog=dialogService.open({template:"views/common/dialogs/user.html",modalClass:"umb-modal-left",show:true});return service.userDialog;},showHelpDialog:function(){service.hideTray();if(service.userDialog){service.userDialog.close();}
if(service.helpDialog){service.helpDialog.close();service.helpDialog=undefined;}
service.helpDialog=dialogService.open({template:"views/common/dialogs/help.html",modalClass:"umb-modal-left",show:true});return service.helpDialog;},showDialog:function(args){if(!args){throw"showDialog is missing the args parameter";}
if(!args.action){throw"The args parameter must have an 'action' property as the clicked menu action object";}
if(!args.node){throw"The args parameter must have a 'node' as the active tree node";}
if(currentDialog){dialogService.close(currentDialog);currentDialog=null;}
setMode("dialog");var dialogScope=args.scope?args.scope.$new():$rootScope.$new();dialogScope.currentNode=args.node;dialogScope.currentAction=args.action;if(args.action.metaData["dialogTitle"]){appState.setMenuState("dialogTitle",args.action.metaData["dialogTitle"]);}
else{appState.setMenuState("dialogTitle",args.action.name);}
var templateUrl;var iframe;if(args.action.metaData["actionUrl"]){templateUrl=args.action.metaData["actionUrl"];iframe=true;}
else if(args.action.metaData["actionView"]){templateUrl=args.action.metaData["actionView"];iframe=false;}
else{var treeAlias=treeService.getTreeAlias(args.node);var packageTreeFolder=treeService.getTreePackageFolder(treeAlias);if(!treeAlias){throw"Could not get tree alias for node "+args.node.id;}
if(packageTreeFolder){templateUrl=Umbraco.Sys.ServerVariables.umbracoSettings.appPluginsPath+"/"+packageTreeFolder+"/backoffice/"+treeAlias+"/"+args.action.alias+".html";}
else{templateUrl="views/"+treeAlias+"/"+args.action.alias+".html";}
iframe=false;}
var dialog=dialogService.open({container:$("#dialog div.umb-modalcolumn-body"),scope:dialogScope,inline:true,show:true,iframe:iframe,modalClass:"umb-dialog",template:templateUrl,currentNode:args.node,currentAction:args.action,});currentDialog=dialog;return dialog;},hideDialog:function(showMenu){setMode("default");if(showMenu){this.showMenu(undefined,{skipDefault:true,node:appState.getMenuState("currentNode")});}},showSearch:function(){setMode("search");},hideSearch:function(){setMode("default-hidesearch");},hideNavigation:function(){appState.setMenuState("menuActions",[]);setMode("default");}};return service;}
angular.module('umbraco.services').factory('navigationService',navigationService);angular.module('umbraco.services').factory('notificationsService',function($rootScope,$timeout,angularHelper){var nArray=[];function setViewPath(view){if(view.indexOf('/')<0)
{view="views/common/notifications/"+view;}
if(view.indexOf('.html')<0)
{view=view+".html";}
return view;}
var service={add:function(item){angularHelper.safeApply($rootScope,function(){if(item.view){item.view=setViewPath(item.view);item.sticky=true;item.type="form";item.headline=null;}
if(item.message){item.headline+=": ";if(item.message.length>200){item.sticky=true;}}
item.id=String.CreateGuid();nArray.push(item);if(!item.sticky){$timeout(function(){var found=_.find(nArray,function(i){return i.id===item.id;});if(found){var index=nArray.indexOf(found);nArray.splice(index,1);}},7000);}
return item;});},hasView:function(view){if(!view){return _.find(nArray,function(notification){return notification.view;});}else{view=setViewPath(view).toLowerCase();return _.find(nArray,function(notification){return notification.view.toLowerCase()===view;});}},addView:function(view,args){var item={args:args,view:view};service.add(item);},showNotification:function(args){if(!args){throw"args cannot be null";}
if(args.type===undefined||args.type===null){throw"args.type cannot be null";}
if(!args.header){throw"args.header cannot be null";}
switch(args.type){case 0:this.success(args.header,args.message);break;case 1:this.success(args.header,args.message);break;case 2:this.error(args.header,args.message);break;case 3:this.success(args.header,args.message);break;case 4:this.warning(args.header,args.message);break;}},success:function(headline,message){return service.add({headline:headline,message:message,type:'success',time:new Date()});},error:function(headline,message){return service.add({headline:headline,message:message,type:'error',time:new Date()});},warning:function(headline,message){return service.add({headline:headline,message:message,type:'warning',time:new Date()});},info:function(headline,message){return service.add({headline:headline,message:message,type:'info',time:new Date()});},remove:function(index){if(angular.isObject(index)){var i=nArray.indexOf(index);angularHelper.safeApply($rootScope,function(){nArray.splice(i,1);});}else{angularHelper.safeApply($rootScope,function(){nArray.splice(index,1);});}},removeAll:function(){angularHelper.safeApply($rootScope,function(){nArray=[];});},current:nArray,getCurrent:function(){return nArray;}};return service;});(function(){'use strict';function overlayHelper(){var numberOfOverlays=0;function registerOverlay(){numberOfOverlays++;return numberOfOverlays;}
function unregisterOverlay(){numberOfOverlays--;return numberOfOverlays;}
function getNumberOfOverlays(){return numberOfOverlays;}
var service={numberOfOverlays:numberOfOverlays,registerOverlay:registerOverlay,unregisterOverlay:unregisterOverlay,getNumberOfOverlays:getNumberOfOverlays};return service;}
angular.module('umbraco.services').factory('overlayHelper',overlayHelper);})();angular.module('umbraco.services').factory('searchService',function($q,$log,entityResource,contentResource,umbRequestHelper){function configureMemberResult(member){member.menuUrl=umbRequestHelper.getApiUrl("memberTreeBaseUrl","GetMenu",[{id:member.id},{application:'member'}]);member.editorPath="member/member/edit/"+(member.key?member.key:member.id);angular.extend(member.metaData,{treeAlias:"member"});member.subTitle=member.metaData.Email;}
function configureMediaResult(media)
{media.menuUrl=umbRequestHelper.getApiUrl("mediaTreeBaseUrl","GetMenu",[{id:media.id},{application:'media'}]);media.editorPath="media/media/edit/"+media.id;angular.extend(media.metaData,{treeAlias:"media"});}
function configureContentResult(content){content.menuUrl=umbRequestHelper.getApiUrl("contentTreeBaseUrl","GetMenu",[{id:content.id},{application:'content'}]);content.editorPath="content/content/edit/"+content.id;angular.extend(content.metaData,{treeAlias:"content"});content.subTitle=content.metaData.Url;}
return{searchMembers:function(args){if(!args.term){throw"args.term is required";}
return entityResource.search(args.term,"Member",args.searchFrom).then(function(data){_.each(data,function(item){configureMemberResult(item);});return data;});},searchContent:function(args){if(!args.term){throw"args.term is required";}
return entityResource.search(args.term,"Document",args.searchFrom,args.canceler).then(function(data){_.each(data,function(item){configureContentResult(item);});return data;});},searchMedia:function(args){if(!args.term){throw"args.term is required";}
return entityResource.search(args.term,"Media",args.searchFrom).then(function(data){_.each(data,function(item){configureMediaResult(item);});return data;});},searchAll:function(args){if(!args.term){throw"args.term is required";}
return entityResource.searchAll(args.term,args.canceler).then(function(data){_.each(data,function(resultByType){switch(resultByType.type){case"Document":_.each(resultByType.results,function(item){configureContentResult(item);});break;case"Media":_.each(resultByType.results,function(item){configureMediaResult(item);});break;case"Member":_.each(resultByType.results,function(item){configureMemberResult(item);});break;}});return data;});},setCurrent:function(sectionAlias){var currentSection=sectionAlias;}};});function serverValidationManager($timeout){var callbacks=[];function executeCallback(self,errorsForCallback,callback){callback.apply(self,[false,errorsForCallback,self.items]);}
function getFieldErrors(self,fieldName){if(!angular.isString(fieldName)){throw"fieldName must be a string";}
return _.filter(self.items,function(item){return(item.propertyAlias===null&&item.fieldName===fieldName);});}
function getPropertyErrors(self,propertyAlias,fieldName){if(!angular.isString(propertyAlias)){throw"propertyAlias must be a string";}
if(fieldName&&!angular.isString(fieldName)){throw"fieldName must be a string";}
return _.filter(self.items,function(item){return(item.propertyAlias===propertyAlias&&(item.fieldName===fieldName||(fieldName===undefined||fieldName==="")));});}
return{executeAndClearAllSubscriptions:function(){var self=this;$timeout(function(){for(var cb in callbacks){if(callbacks[cb].propertyAlias===null){var fieldErrors=getFieldErrors(self,callbacks[cb].fieldName);if(fieldErrors.length>0){executeCallback(self,fieldErrors,callbacks[cb].callback);}}
else{var propErrors=getPropertyErrors(self,callbacks[cb].propertyAlias,callbacks[cb].fieldName);if(propErrors.length>0){executeCallback(self,propErrors,callbacks[cb].callback);}}}
self.clear();});},subscribe:function(propertyAlias,fieldName,callback){if(!callback){return;}
if(propertyAlias===null){var exists1=_.find(callbacks,function(item){return item.propertyAlias===null&&item.fieldName===fieldName;});if(!exists1){callbacks.push({propertyAlias:null,fieldName:fieldName,callback:callback});}}
else if(propertyAlias!==undefined){var exists2=_.find(callbacks,function(item){return item.propertyAlias===propertyAlias&&item.fieldName===fieldName;});if(!exists2){callbacks.push({propertyAlias:propertyAlias,fieldName:fieldName,callback:callback});}}},unsubscribe:function(propertyAlias,fieldName){if(propertyAlias===null){callbacks=_.reject(callbacks,function(item){return item.propertyAlias===null&&item.fieldName===fieldName;});}
else if(propertyAlias!==undefined){callbacks=_.reject(callbacks,function(item){return item.propertyAlias===propertyAlias&&(item.fieldName===fieldName||((item.fieldName===undefined||item.fieldName==="")&&(fieldName===undefined||fieldName==="")));});}},getPropertyCallbacks:function(propertyAlias,fieldName){var found=_.filter(callbacks,function(item){return(item.propertyAlias===propertyAlias&&(item.fieldName===fieldName||(item.fieldName===undefined||item.fieldName==="")));});return found;},getFieldCallbacks:function(fieldName){var found=_.filter(callbacks,function(item){return(item.propertyAlias===null&&item.fieldName===fieldName);});return found;},addFieldError:function(fieldName,errorMsg){if(!fieldName){return;}
if(!this.hasFieldError(fieldName)){this.items.push({propertyAlias:null,fieldName:fieldName,errorMsg:errorMsg});}
var errorsForCallback=getFieldErrors(this,fieldName);var cbs=this.getFieldCallbacks(fieldName);for(var cb in cbs){executeCallback(this,errorsForCallback,cbs[cb].callback);}},addPropertyError:function(propertyAlias,fieldName,errorMsg){if(!propertyAlias){return;}
if(!this.hasPropertyError(propertyAlias,fieldName)){this.items.push({propertyAlias:propertyAlias,fieldName:fieldName,errorMsg:errorMsg});}
var errorsForCallback=getPropertyErrors(this,propertyAlias,fieldName);var cbs=this.getPropertyCallbacks(propertyAlias,fieldName);for(var cb in cbs){executeCallback(this,errorsForCallback,cbs[cb].callback);}},removePropertyError:function(propertyAlias,fieldName){if(!propertyAlias){return;}
this.items=_.reject(this.items,function(item){return(item.propertyAlias===propertyAlias&&(item.fieldName===fieldName||(fieldName===undefined||fieldName==="")));});},reset:function(){this.clear();for(var cb in callbacks){callbacks[cb].callback.apply(this,[true,[],[]]);}},clear:function(){this.items=[];},getPropertyError:function(propertyAlias,fieldName){var err=_.find(this.items,function(item){return(item.propertyAlias===propertyAlias&&(item.fieldName===fieldName||(fieldName===undefined||fieldName==="")));});return err;},getFieldError:function(fieldName){var err=_.find(this.items,function(item){return(item.propertyAlias===null&&item.fieldName===fieldName);});return err;},hasPropertyError:function(propertyAlias,fieldName){var err=_.find(this.items,function(item){return(item.propertyAlias===propertyAlias&&(item.fieldName===fieldName||(fieldName===undefined||fieldName==="")));});return err?true:false;},hasFieldError:function(fieldName){var err=_.find(this.items,function(item){return(item.propertyAlias===null&&item.fieldName===fieldName);});return err?true:false;},items:[]};}
angular.module('umbraco.services').factory('serverValidationManager',serverValidationManager);function tinyMceService(dialogService,$log,imageHelper,$http,$timeout,macroResource,macroService,$routeParams,umbRequestHelper,angularHelper,userService){return{configuration:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("rteApiBaseUrl","GetConfiguration"),{cache:true}),'Failed to retrieve tinymce configuration');},defaultPrevalues:function(){var cfg={};cfg.toolbar=["code","bold","italic","styleselect","alignleft","aligncenter","alignright","bullist","numlist","outdent","indent","link","image","umbmediapicker","umbembeddialog","umbmacro"];cfg.stylesheets=[];cfg.dimensions={height:500};cfg.maxImageSize=500;return cfg;},createInsertEmbeddedMedia:function(editor,scope,callback){editor.addButton('umbembeddialog',{icon:'custom icon-tv',tooltip:'Embed',onclick:function(){if(callback){callback();}}});},insertEmbeddedMediaInEditor:function(editor,preview){editor.insertContent(preview);},createMediaPicker:function(editor,scope,callback){editor.addButton('umbmediapicker',{icon:'custom icon-picture',tooltip:'Media Picker',onclick:function(){var selectedElm=editor.selection.getNode(),currentTarget;if(selectedElm.nodeName==='IMG'){var img=$(selectedElm);currentTarget={altText:img.attr("alt"),url:img.attr("src"),id:img.attr("rel")};}
userService.getCurrentUser().then(function(userData){if(callback){callback(currentTarget,userData);}});}});},insertMediaInEditor:function(editor,img){if(img){var data={alt:img.altText||"",src:(img.url)?img.url:"nothing.jpg",rel:img.id,'data-id':img.id,id:'__mcenew'};editor.insertContent(editor.dom.createHTML('img',data));$timeout(function(){var imgElm=editor.dom.get('__mcenew');var size=editor.dom.getSize(imgElm);if(editor.settings.maxImageSize&&editor.settings.maxImageSize!==0){var newSize=imageHelper.scaleToMaxSize(editor.settings.maxImageSize,size.w,size.h);var s="width: "+newSize.width+"px; height:"+newSize.height+"px;";editor.dom.setAttrib(imgElm,'style',s);editor.dom.setAttrib(imgElm,'id',null);if(img.url){var src=img.url+"?width="+newSize.width+"&height="+newSize.height;editor.dom.setAttrib(imgElm,'data-mce-src',src);}}},500);}},createInsertMacro:function(editor,$scope,callback){var createInsertMacroScope=this;editor.on('preInit',function(args){editor.serializer.addRules('div');editor.serializer.addNodeFilter('div',function(nodes,name){for(var i=0;i<nodes.length;i++){if(nodes[i].attr("class")==="umb-macro-holder"&&nodes[i].parent&&nodes[i].parent.name.toUpperCase()==="P"){nodes[i].parent.unwrap();}}});});function getRealMacroElem(element){var e=$(element).closest(".umb-macro-holder");if(e.length>0){if(e.get(0).parentNode.nodeName==="P"){if(element.parentNode.childNodes.length===1){return e.get(0).parentNode;}}
return e.get(0);}
return null;}
editor.addButton('umbmacro',{icon:'custom icon-settings-alt',tooltip:'Insert macro',onPostRender:function(){var ctrl=this;var isOnMacroElement=false;function handleSelectionChange(){if(!editor.selection.isCollapsed()){var endSelection=tinymce.activeEditor.selection.getEnd();var startSelection=tinymce.activeEditor.selection.getStart();if(endSelection!==startSelection){var $testForMacro=$(endSelection).closest(".umb-macro-holder");if($testForMacro.length>0){var next=$testForMacro.next();if(next.length>0){editor.selection.setCursorLocation($testForMacro.next().get(0));}
else{selectMacroElement($testForMacro.get(0));}}}}}
function selectMacroElement(macroElement){editor.selection.select(macroElement);var currentSelection=editor.selection.getStart();if(tinymce.isIE){if(!editor.dom.hasClass(currentSelection,'umb-macro-holder')){while(!editor.dom.hasClass(currentSelection,'umb-macro-holder')&&currentSelection.parentNode){currentSelection=currentSelection.parentNode;}
editor.selection.select(currentSelection);}}}
function onNodeChanged(evt){var $macroElement=$(evt.element).closest(".umb-macro-holder");handleSelectionChange();ctrl.active($macroElement.length!==0);if($macroElement.length>0){var macroElement=$macroElement.get(0);editor.off('NodeChange',onNodeChanged);selectMacroElement(macroElement);isOnMacroElement=true;editor.on('NodeChange',onNodeChanged);}
else{isOnMacroElement=false;}}
editor.on("LoadContent",function(o){$(editor.dom.select(".umb-macro-holder.mceNonEditable")).each(function(){createInsertMacroScope.loadMacroContent($(this),null,$scope);});});editor.on('BeforeExecCommand',function(o){if(isOnMacroElement){if(o.preventDefault){o.preventDefault();}
if(o.stopImmediatePropagation){o.stopImmediatePropagation();}
return;}});editor.on("Paste",function(o){if(isOnMacroElement){if(o.preventDefault){o.preventDefault();}
if(o.stopImmediatePropagation){o.stopImmediatePropagation();}
return;}});editor.on('NodeChange',onNodeChanged);editor.on('KeyDown',function(e){if(isOnMacroElement){var macroElement=editor.selection.getNode();macroElement=getRealMacroElem(macroElement);e.preventDefault();e.stopPropagation();var moveSibling=function(element,isNext){var $e=$(element);var $sibling=isNext?$e.next():$e.prev();if($sibling.length>0){editor.selection.select($sibling.get(0));editor.selection.collapse(true);}
else{if(!isNext){moveSibling(element,true);return;}
editor.setContent(editor.getContent()+"<p>&nbsp;</p>");editor.selection.select($(editor.dom.getRoot()).children().last().get(0));editor.selection.collapse(true);}};if($.inArray(e.keyCode,[13,40,39])!==-1){moveSibling(macroElement,true);}
else if($.inArray(e.keyCode,[27,38,37])!==-1){moveSibling(macroElement,false);}
else if($.inArray(e.keyCode,[8,46])!==-1){moveSibling(macroElement,false);editor.dom.remove(macroElement);}
return;}});},onclick:function(){var dialogData={richTextEditor:true};var macroElement=editor.selection.getNode();macroElement=getRealMacroElem(macroElement);if(macroElement){var contents=$(macroElement).contents();var comment=_.find(contents,function(item){return item.nodeType===8;});if(!comment){throw"Cannot parse the current macro, the syntax in the editor is invalid";}
var syntax=comment.textContent.trim();var parsed=macroService.parseMacroSyntax(syntax);dialogData={macroData:parsed};}
if(callback){callback(dialogData);}}});},insertMacroInEditor:function(editor,macroObject,$scope){var macroSyntaxComment="<!-- "+macroObject.syntax+" -->";var uniqueId="umb-macro-"+editor.dom.uniqueId();var macroDiv=editor.dom.create('div',{'class':'umb-macro-holder '+macroObject.macroAlias+' mceNonEditable '+uniqueId},macroSyntaxComment+'<ins>Macro alias: <strong>'+macroObject.macroAlias+'</strong></ins>');editor.selection.setNode(macroDiv);var $macroDiv=$(editor.dom.select("div.umb-macro-holder."+uniqueId));this.loadMacroContent($macroDiv,macroObject,$scope);},loadMacroContent:function($macroDiv,macroData,$scope){if(!macroData){var contents=$macroDiv.contents();var comment=_.find(contents,function(item){return item.nodeType===8;});if(!comment){throw"Cannot parse the current macro, the syntax in the editor is invalid";}
var syntax=comment.textContent.trim();var parsed=macroService.parseMacroSyntax(syntax);macroData=parsed;}
var $ins=$macroDiv.find("ins");$macroDiv.addClass("loading");var contentId=$routeParams.id;angularHelper.safeApply($scope,function(){macroResource.getMacroResultAsHtmlForEditor(macroData.macroAlias,contentId,macroData.macroParamsDictionary).then(function(htmlResult){$macroDiv.removeClass("loading");htmlResult=htmlResult.trim();if(htmlResult!==""){$ins.html(htmlResult);}});});},createLinkPicker:function(editor,$scope,onClick){function createLinkList(callback){return function(){var linkList=editor.settings.link_list;if(typeof(linkList)==="string"){tinymce.util.XHR.send({url:linkList,success:function(text){callback(tinymce.util.JSON.parse(text));}});}else{callback(linkList);}};}
function showDialog(linkList){var data={},selection=editor.selection,dom=editor.dom,selectedElm,anchorElm,initialText;var win,linkListCtrl,relListCtrl,targetListCtrl;function linkListChangeHandler(e){var textCtrl=win.find('#text');if(!textCtrl.value()||(e.lastControl&&textCtrl.value()===e.lastControl.text())){textCtrl.value(e.control.text());}
win.find('#href').value(e.control.value());}
function buildLinkList(){var linkListItems=[{text:'None',value:''}];tinymce.each(linkList,function(link){linkListItems.push({text:link.text||link.title,value:link.value||link.url,menu:link.menu});});return linkListItems;}
function buildRelList(relValue){var relListItems=[{text:'None',value:''}];tinymce.each(editor.settings.rel_list,function(rel){relListItems.push({text:rel.text||rel.title,value:rel.value,selected:relValue===rel.value});});return relListItems;}
function buildTargetList(targetValue){var targetListItems=[{text:'None',value:''}];if(!editor.settings.target_list){targetListItems.push({text:'New window',value:'_blank'});}
tinymce.each(editor.settings.target_list,function(target){targetListItems.push({text:target.text||target.title,value:target.value,selected:targetValue===target.value});});return targetListItems;}
function buildAnchorListControl(url){var anchorList=[];tinymce.each(editor.dom.select('a:not([href])'),function(anchor){var id=anchor.name||anchor.id;if(id){anchorList.push({text:id,value:'#'+id,selected:url.indexOf('#'+id)!==-1});}});if(anchorList.length){anchorList.unshift({text:'None',value:''});return{name:'anchor',type:'listbox',label:'Anchors',values:anchorList,onselect:linkListChangeHandler};}}
function updateText(){if(!initialText&&data.text.length===0){this.parent().parent().find('#text')[0].value(this.value());}}
selectedElm=selection.getNode();anchorElm=dom.getParent(selectedElm,'a[href]');data.text=initialText=anchorElm?(anchorElm.innerText||anchorElm.textContent):selection.getContent({format:'text'});data.href=anchorElm?dom.getAttrib(anchorElm,'href'):'';data.target=anchorElm?dom.getAttrib(anchorElm,'target'):'';data.rel=anchorElm?dom.getAttrib(anchorElm,'rel'):'';if(selectedElm.nodeName==="IMG"){data.text=initialText=" ";}
if(linkList){linkListCtrl={type:'listbox',label:'Link list',values:buildLinkList(),onselect:linkListChangeHandler};}
if(editor.settings.target_list!==false){targetListCtrl={name:'target',type:'listbox',label:'Target',values:buildTargetList(data.target)};}
if(editor.settings.rel_list){relListCtrl={name:'rel',type:'listbox',label:'Rel',values:buildRelList(data.rel)};}
var injector=angular.element(document.getElementById("umbracoMainPageBody")).injector();var dialogService=injector.get("dialogService");var currentTarget=null;if(anchorElm){var anchor=$(anchorElm);currentTarget={name:anchor.attr("title"),url:anchor.attr("href"),target:anchor.attr("target")};if(currentTarget.url.indexOf("localLink:")>0){currentTarget.id=currentTarget.url.substring(currentTarget.url.indexOf(":")+1,currentTarget.url.length-1);}}
if(onClick){onClick(currentTarget,anchorElm);}}
editor.addButton('link',{icon:'link',tooltip:'Insert/edit link',shortcut:'Ctrl+K',onclick:createLinkList(showDialog),stateSelector:'a[href]'});editor.addButton('unlink',{icon:'unlink',tooltip:'Remove link',cmd:'unlink',stateSelector:'a[href]'});editor.addShortcut('Ctrl+K','',createLinkList(showDialog));this.showDialog=showDialog;editor.addMenuItem('link',{icon:'link',text:'Insert link',shortcut:'Ctrl+K',onclick:createLinkList(showDialog),stateSelector:'a[href]',context:'insert',prependToContext:true});},insertLinkInEditor:function(editor,target,anchorElm){var href=target.url;function insertLink(){if(anchorElm){editor.dom.setAttribs(anchorElm,{href:href,title:target.name,target:target.target?target.target:null,rel:target.rel?target.rel:null,'data-id':target.id?target.id:null});editor.selection.select(anchorElm);editor.execCommand('mceEndTyping');}else{editor.execCommand('mceInsertLink',false,{href:href,title:target.name,target:target.target?target.target:null,rel:target.rel?target.rel:null,'data-id':target.id?target.id:null});}}
if(!href){editor.execCommand('unlink');return;}
if(target.id&&(angular.isUndefined(target.isMedia)||!target.isMedia)){href="/{localLink:"+target.id+"}";insertLink();return;}
if(href.indexOf('@')>0&&href.indexOf('//')===-1&&href.indexOf('mailto:')===-1){href='mailto:'+href;insertLink();return;}
if(/^\s*www\./i.test(href)){href='http://'+href;insertLink();return;}
insertLink();}};}
angular.module('umbraco.services').factory('tinyMceService',tinyMceService);function treeService($q,treeResource,iconHelper,notificationsService,eventsService){var treeCache={};var standardCssClass='icon umb-tree-icon sprTree';function getCacheKey(args){if(!args||!args.cacheKey){return null;}
var cacheKey=args.cacheKey;cacheKey+="_"+args.section;return cacheKey;}
return{_getTreeCache:function(){return treeCache;},_formatNodeDataForUseInUI:function(parentNode,treeNodes,section,level){var childLevel=(level?level:1);if(!parentNode.section){parentNode.section=section;}
var funcParent=function(){return parentNode;};for(var i=0;i<treeNodes.length;i++){treeNodes[i].level=childLevel;treeNodes[i].parent=funcParent;treeNodes[i].section=section;if(!treeNodes[i].routePath){if(treeNodes[i].metaData&&treeNodes[i].metaData["treeAlias"]){treeNodes[i].routePath=section;}
else{var treeAlias=this.getTreeAlias(treeNodes[i]);treeNodes[i].routePath=section+"/"+treeAlias+"/edit/"+treeNodes[i].id;}}
if(treeNodes[i].iconIsClass===undefined||treeNodes[i].iconIsClass){var converted=iconHelper.convertFromLegacyTreeNodeIcon(treeNodes[i]);treeNodes[i].cssClass=standardCssClass+" "+converted;if(converted.startsWith('.')){treeNodes[i].style="height:16px;width:16px;";}
else{treeNodes[i].style="";}}
else{treeNodes[i].style="background-image: url('"+treeNodes[i].iconFilePath+"');";treeNodes[i].cssClass=standardCssClass+" legacy-custom-file";}}},getTreePackageFolder:function(treeAlias){if(Umbraco.Sys.ServerVariables.umbracoPlugins&&Umbraco.Sys.ServerVariables.umbracoPlugins.trees&&angular.isArray(Umbraco.Sys.ServerVariables.umbracoPlugins.trees)){var found=_.find(Umbraco.Sys.ServerVariables.umbracoPlugins.trees,function(item){return item.alias===treeAlias;});return found?found.packageFolder:undefined;}
return undefined;},clearCache:function(args){if(!args){treeCache={};}
else{if(args.section&&args.cacheKey){var cacheKey=getCacheKey(args);if(cacheKey&&treeCache&&treeCache[cacheKey]!=null){treeCache=_.omit(treeCache,cacheKey);}}
else if(args.childrenOf){if(!args.cacheKey){throw"args.cacheKey is required if args.childrenOf is supplied";}
var self=this;this.clearCache({cacheKey:args.cacheKey,filter:function(cc){var parent=self.getDescendantNode(cc.root,args.childrenOf);if(parent){parent.children=null;parent.expanded=false;}
return cc;}});}
else if(args.filter&&angular.isFunction(args.filter)){if(!args.cacheKey){throw"args.cacheKey is required if args.filter is supplied";}
var byKey=treeCache[args.cacheKey];if(byKey){var result=args.filter(byKey);if(result){treeCache[args.cacheKey]=result;}
else{treeCache=_.omit(treeCache,args.cacheKey);}}}
else if(args.cacheKey){var allKeys1=_.keys(treeCache);var toRemove1=_.filter(allKeys1,function(k){return k.startsWith(args.cacheKey+"_");});treeCache=_.omit(treeCache,toRemove1);}
else if(args.section){var allKeys2=_.keys(treeCache);var toRemove2=_.filter(allKeys2,function(k){return k.endsWith("_"+args.section);});treeCache=_.omit(treeCache,toRemove2);}}},loadNodeChildren:function(args){if(!args){throw"No args object defined for loadNodeChildren";}
if(!args.node){throw"No node defined on args object for loadNodeChildren";}
this.removeChildNodes(args.node);args.node.loading=true;return this.getChildren(args).then(function(data){args.node.loading=false;args.node.children=data;if(args.node.children&&args.node.children.length>0){args.node.expanded=true;args.node.hasChildren=true;}
return data;},function(reason){eventsService.emit("treeService.treeNodeLoadError",{error:reason});args.node.loading=false;notificationsService.error(reason);return reason;});},removeNode:function(treeNode){if(!angular.isFunction(treeNode.parent)){return;}
if(treeNode.parent()==null){throw"Cannot remove a node that doesn't have a parent";}
treeNode.parent().children.splice(treeNode.parent().children.indexOf(treeNode),1);},removeChildNodes:function(treeNode){treeNode.expanded=false;treeNode.children=[];treeNode.hasChildren=false;},getChildNode:function(treeNode,id){if(!treeNode.children){return null;}
var found=_.find(treeNode.children,function(child){return String(child.id).toLowerCase()===String(id).toLowerCase();});return found===undefined?null:found;},getDescendantNode:function(treeNode,id,treeAlias){if(treeNode.isContainer===true&&!treeAlias){throw"Cannot get a descendant node from a section container node without a treeAlias specified";}
if(treeNode.isContainer){var foundRoot=null;for(var c=0;c<treeNode.children.length;c++){if(this.getTreeAlias(treeNode.children[c])===treeAlias){foundRoot=treeNode.children[c];break;}}
if(!foundRoot){throw"Could not find a tree in the current section with alias "+treeAlias;}
treeNode=foundRoot;}
if(treeNode.id===id){return treeNode;}
var found=this.getChildNode(treeNode,id);if(found){return found;}
if(!treeNode.children){return null;}
for(var i=0;i<treeNode.children.length;i++){if(treeNode.children[i].children&&angular.isArray(treeNode.children[i].children)&&treeNode.children[i].children.length>0){found=this.getDescendantNode(treeNode.children[i],id);if(found){return found;}}}
return found===undefined?null:found;},getTreeRoot:function(treeNode){if(!treeNode){throw"treeNode cannot be null";}
var root=null;var current=treeNode;while(root===null&&current){if(current.metaData&&current.metaData["treeAlias"]){root=current;}
else if(angular.isFunction(current.parent)){current=current.parent();}
else{current=null;}}
return root;},getTreeAlias:function(treeNode){var root=this.getTreeRoot(treeNode);if(root){return root.metaData["treeAlias"];}
return"";},getTree:function(args){var deferred=$q.defer();if(!args){args={section:'content',cacheKey:null};}
else if(!args.section){args.section='content';}
var cacheKey=getCacheKey(args);if(cacheKey&&treeCache[cacheKey]!==undefined){deferred.resolve(treeCache[cacheKey]);return deferred.promise;}
var self=this;treeResource.loadApplication(args).then(function(data){var result={name:data.name,alias:args.section,root:data};self._formatNodeDataForUseInUI(result.root,result.root.children,args.section);if(cacheKey){treeCache[cacheKey]=result;deferred.resolve(treeCache[cacheKey]);}
deferred.resolve(result);});return deferred.promise;},getMenu:function(args){if(!args){throw"args cannot be null";}
if(!args.treeNode){throw"args.treeNode cannot be null";}
return treeResource.loadMenu(args.treeNode).then(function(data){for(var i=0;i<data.length;i++){data[i].cssclass=iconHelper.convertFromLegacyIcon(data[i].cssclass);}
return data;});},getChildren:function(args){if(!args){throw"No args object defined for getChildren";}
if(!args.node){throw"No node defined on args object for getChildren";}
var section=args.section||'content';var treeItem=args.node;var self=this;return treeResource.loadNodes({node:treeItem}).then(function(data){self._formatNodeDataForUseInUI(treeItem,data,section,treeItem.level+1);return data;});},reloadNode:function(node){if(!node){throw"node cannot be null";}
if(!node.parent()){throw"cannot reload a single node without a parent";}
if(!node.section){throw"cannot reload a single node without an assigned node.section";}
var deferred=$q.defer();node.loading=true;this.getChildren({node:node.parent(),section:node.section}).then(function(data){var found=_.find(data,function(item){return item.id===node.id;});if(found){var index=_.indexOf(node.parent().children,node);if(angular.isFunction(node.parent().children[index].updateNodeData)){node.parent().children[index].updateNodeData(found);}
else{_.extend(node.parent().children[index],found);}
node.parent().children[index].loading=false;deferred.resolve(node.parent().children[index]);}
else{deferred.reject();}},function(){deferred.reject();});return deferred.promise;},getPath:function(node){if(!node){throw"node cannot be null";}
if(!angular.isFunction(node.parent)){throw"node.parent is not a function, the path cannot be resolved";}
var reversePath=[];var current=node;while(current!=null){reversePath.push(current.id);if(current.metaData&&current.metaData["treeAlias"]){current=null;}
else{current=current.parent();}}
return reversePath.reverse();},syncTree:function(args){if(!args){throw"No args object defined for syncTree";}
if(!args.node){throw"No node defined on args object for syncTree";}
if(!args.path){throw"No path defined on args object for syncTree";}
if(!angular.isArray(args.path)){throw"Path must be an array";}
if(args.path.length<1){args.path.push("-1");}
var deferred=$q.defer();var root=this.getTreeRoot(args.node);if(!root){throw"Could not get the root tree node based on the node passed in";}
var currPathIndex=0;if(String(args.path[currPathIndex]).toLowerCase()===String(args.node.id).toLowerCase()){if(args.path.length===1){deferred.resolve(root);return deferred.promise;}
else{currPathIndex=1;}}
var self=this;var node=args.node;var doSync=function(){var child=self.getChildNode(node,args.path[currPathIndex]);if(child){if(args.path.length===(currPathIndex+1)){if(!args.forceReload){deferred.resolve(child);}
else{self.reloadNode(child).then(function(reloaded){deferred.resolve(reloaded);},function(){deferred.reject();});}}
else{currPathIndex++;node=child;doSync();}}
else{self.loadNodeChildren({node:node,section:node.section}).then(function(){var found=self.getChildNode(node,args.path[currPathIndex]);if(found){if(args.path.length===(currPathIndex+1)){deferred.resolve(found);}
else{currPathIndex++;node=found;doSync();}}
else{deferred.reject();}},function(){deferred.reject();});}};doSync();return deferred.promise;}};}
angular.module('umbraco.services').factory('treeService',treeService);function umbRequestHelper($http,$q,umbDataFormatter,angularHelper,dialogService,notificationsService,eventsService){return{convertVirtualToAbsolutePath:function(virtualPath){if(virtualPath.startsWith("/")){return virtualPath;}
if(!virtualPath.startsWith("~/")){throw"The path "+virtualPath+" is not a virtual path";}
if(!Umbraco.Sys.ServerVariables.application.applicationPath){throw"No applicationPath defined in Umbraco.ServerVariables.application.applicationPath";}
return Umbraco.Sys.ServerVariables.application.applicationPath+virtualPath.trimStart("~/");},dictionaryToQueryString:function(queryStrings){if(angular.isArray(queryStrings)){return _.map(queryStrings,function(item){var key=null;var val=null;for(var k in item){key=k;val=item[k];break;}
if(key===null||val===null){throw"The object in the array was not formatted as a key/value pair";}
return encodeURIComponent(key)+"="+encodeURIComponent(val);}).join("&");}
else if(angular.isObject(queryStrings)){return decodeURIComponent($.param(queryStrings));}
throw"The queryString parameter is not an array or object of key value pairs";},getApiUrl:function(apiName,actionName,queryStrings){if(!Umbraco||!Umbraco.Sys||!Umbraco.Sys.ServerVariables||!Umbraco.Sys.ServerVariables["umbracoUrls"]){throw"No server variables defined!";}
if(!Umbraco.Sys.ServerVariables["umbracoUrls"][apiName]){throw"No url found for api name "+apiName;}
return Umbraco.Sys.ServerVariables["umbracoUrls"][apiName]+actionName+
(!queryStrings?"":"?"+(angular.isString(queryStrings)?queryStrings:this.dictionaryToQueryString(queryStrings)));},resourcePromise:function(httpPromise,opts){var deferred=$q.defer();function defaultSuccess(data,status,headers,config){return data;}
function defaultError(data,status,headers,config){return{errorMsg:(angular.isString(opts)?opts:'An error occurred!'),data:data,status:status};}
var callbacks={success:((!opts||!opts.success)?defaultSuccess:opts.success),error:((!opts||!opts.error)?defaultError:opts.error)};httpPromise.success(function(data,status,headers,config){var result=callbacks.success.apply(this,[data,status,headers,config]);deferred.resolve(result);}).error(function(data,status,headers,config){var result=callbacks.error.apply(this,[data,status,headers,config]);if(status>=500&&status<600){if(Umbraco.Sys.ServerVariables["isDebuggingEnabled"]===true){eventsService.emit('app.ysod',{errorMsg:'An error occured',data:data});}
else{notificationsService.error("Server error","Contact administrator, see log for full details.<br/><i>"+result.errorMsg+"</i>");}}
else{deferred.reject({errorMsg:result.errorMsg,data:result.data,status:result.status});}});return deferred.promise;},postSaveContent:function(args){if(!args.restApiUrl){throw"args.restApiUrl is a required argument";}
if(!args.content){throw"args.content is a required argument";}
if(!args.action){throw"args.action is a required argument";}
if(!args.files){throw"args.files is a required argument";}
if(!args.dataFormatter){throw"args.dataFormatter is a required argument";}
var deferred=$q.defer();var activeTab=_.find(args.content.tabs,function(item){return item.active;});var activeTabIndex=(activeTab===undefined?0:_.indexOf(args.content.tabs,activeTab));this.postMultiPartRequest(args.restApiUrl,{key:"contentItem",value:args.dataFormatter(args.content,args.action)},function(data,formData){for(var f in args.files){formData.append("file_"+args.files[f].alias,args.files[f].file);}},function(data,status,headers,config){_.each(data.tabs,function(item){item.active=false;});data.tabs[activeTabIndex].active=true;deferred.resolve(data);},function(data,status,headers,config){if(status>=500&&status<600){if(typeof data!=="undefined"&&typeof data.indexOf==="function"&&data.indexOf("Maximum request length exceeded")>=0){notificationsService.error("Server error","The uploaded file was too large, check with your site administrator to adjust the maximum size allowed");}
else if(Umbraco.Sys.ServerVariables["isDebuggingEnabled"]===true){eventsService.emit('app.ysod',{errorMsg:'An error occured',data:data});}
else{notificationsService.error("Server error","Contact administrator, see log for full details.<br/><i>"+data.ExceptionMessage+"</i>");}}
else{deferred.reject({errorMsg:'An error occurred',data:data,status:status});}});return deferred.promise;},postMultiPartRequest:function(url,jsonData,transformCallback,successCallback,failureCallback){if(!jsonData){throw"jsonData cannot be null";}
if(angular.isArray(jsonData)){_.each(jsonData,function(item){if(!item.key||!item.value){throw"jsonData array item must have both a key and a value property";}});}
else if(!jsonData.key||!jsonData.value){throw"jsonData object must have both a key and a value property";}
$http({method:'POST',url:url,headers:{'Content-Type':false},transformRequest:function(data){var formData=new FormData();if(angular.isArray(data)){_.each(data,function(item){formData.append(item.key,!angular.isString(item.value)?angular.toJson(item.value):item.value);});}
else{formData.append(data.key,!angular.isString(data.value)?angular.toJson(data.value):data.value);}
if(transformCallback){transformCallback.apply(this,[data,formData]);}
return formData;},data:jsonData}).success(function(data,status,headers,config){if(successCallback){successCallback.apply(this,[data,status,headers,config]);}}).error(function(data,status,headers,config){if(failureCallback){failureCallback.apply(this,[data,status,headers,config]);}});}};}
angular.module('umbraco.services').factory('umbRequestHelper',umbRequestHelper);angular.module('umbraco.services').factory('userService',function($rootScope,eventsService,$q,$location,$log,securityRetryQueue,authResource,dialogService,$timeout,angularHelper,$http){var currentUser=null;var lastUserId=null;var loginDialog=null;var lastServerTimeoutSet=null;function openLoginDialog(isTimedOut){if(!loginDialog){loginDialog=dialogService.open({manualClose:true,template:'views/common/dialogs/login.html',modalClass:"login-overlay",animation:"slide",show:true,callback:onLoginDialogClose,dialogData:{isTimedOut:isTimedOut}});}}
function onLoginDialogClose(success){loginDialog=null;if(success){securityRetryQueue.retryAll();}
else{securityRetryQueue.cancelAll();$location.path('/');}}
function setCurrentUser(usr){if(!usr.remainingAuthSeconds){throw"The user object is invalid, the remainingAuthSeconds is required.";}
currentUser=usr;lastServerTimeoutSet=new Date();countdownUserTimeout();}
function countdownUserTimeout(){$timeout(function(){if(currentUser){currentUser.remainingAuthSeconds-=5;if(currentUser.remainingAuthSeconds>30){if(lastServerTimeoutSet!=null){var now=new Date();var seconds=(now.getTime()-lastServerTimeoutSet.getTime())/1000;if(seconds>30){lastServerTimeoutSet=null;angularHelper.safeApply($rootScope,function(){authResource.getRemainingTimeoutSeconds().then(function(result){setUserTimeoutInternal(result);});});}}
countdownUserTimeout();}
else{if(Umbraco.Sys.ServerVariables.umbracoSettings.keepUserLoggedIn!==true){angularHelper.safeApply($rootScope,function(){try{authResource.getRemainingTimeoutSeconds();}
finally{userAuthExpired();}});}
else{if(lastServerTimeoutSet!=null){lastServerTimeoutSet=null;angularHelper.safeApply($rootScope,function(){authResource.getRemainingTimeoutSeconds().then(function(result){setUserTimeoutInternal(result);});});}
countdownUserTimeout();}}}},5000,false);}
function setUserTimeoutInternal(newTimeout){var asNumber=parseFloat(newTimeout);if(!isNaN(asNumber)&&currentUser&&angular.isNumber(asNumber)){currentUser.remainingAuthSeconds=newTimeout;lastServerTimeoutSet=new Date();}}
function userAuthExpired(isLogout){if(currentUser&&currentUser.id!==undefined){lastUserId=currentUser.id;}
if(currentUser){currentUser.remainingAuthSeconds=0;}
lastServerTimeoutSet=null;currentUser=null;eventsService.emit("app.notAuthenticated");openLoginDialog(isLogout===undefined?true:!isLogout);}
securityRetryQueue.onItemAddedCallbacks.push(function(retryItem){if(securityRetryQueue.hasMore()){userAuthExpired();}});return{_showLoginDialog:function(){openLoginDialog();},isAuthenticated:function(){if(currentUser){var deferred=$q.defer();deferred.resolve(true);return deferred.promise;}
return authResource.isAuthenticated();},authenticate:function(login,password){return authResource.performLogin(login,password).then(function(data){setCurrentUser(data);var result={user:data,authenticated:true,lastUserId:lastUserId};eventsService.emit("app.authenticated",result);return result;});},logout:function(){return authResource.performLogout().then(function(data){userAuthExpired();return null;});},getCurrentUser:function(args){var deferred=$q.defer();if(!currentUser){authResource.getCurrentUser().then(function(data){var result={user:data,authenticated:true,lastUserId:lastUserId};if(Umbraco&&Umbraco.Sys&&Umbraco.Sys.ServerVariables){Umbraco.Sys.ServerVariables["security"]={startContentId:data.startContentId,startMediaId:data.startMediaId};}
if(args&&args.broadcastEvent){eventsService.emit("app.authenticated",result);}
setCurrentUser(data);deferred.resolve(currentUser);});}
else{deferred.resolve(currentUser);}
return deferred.promise;},setUserTimeout:function(newTimeout){setUserTimeoutInternal(newTimeout);}};});function packageHelper(assetsService,treeService,eventsService,$templateCache){return{packageInstalled:function(){treeService.clearCache();$templateCache.removeAll();eventsService.emit("app.reInitialize");}};}
angular.module('umbraco.services').factory('packageHelper',packageHelper);function umbPhotoFolderHelper($compile,$log,$timeout,$filter,imageHelper,mediaHelper,umbRequestHelper){return{setImageData:function(img){img.isFolder=!mediaHelper.hasFilePropertyType(img);if(!img.isFolder){img.thumbnail=mediaHelper.resolveFile(img,true);img.image=mediaHelper.resolveFile(img,false);}},setOriginalSize:function(img,maxHeight){img.originalWidth=maxHeight;img.originalHeight=maxHeight;var widthProp=_.find(img.properties,function(v){return(v.alias==="umbracoWidth");});if(widthProp&&widthProp.value){img.originalWidth=parseInt(widthProp.value,10);if(isNaN(img.originalWidth)){img.originalWidth=maxHeight;}}
var heightProp=_.find(img.properties,function(v){return(v.alias==="umbracoHeight");});if(heightProp&&heightProp.value){img.originalHeight=parseInt(heightProp.value,10);if(isNaN(img.originalHeight)){img.originalHeight=maxHeight;}}},setImageStyle:function(img,width,height,rightMargin,bottomMargin){img.style={width:width+"px",height:height+"px","margin-right":rightMargin+"px","margin-bottom":bottomMargin+"px"};img.thumbStyle={"background-image":"url('"+img.thumbnail+"')","background-repeat":"no-repeat","background-position":"center","background-size":Math.min(width,img.originalWidth)+"px "+Math.min(height,img.originalHeight)+"px"};},getScaledWidth:function(img,maxHeight){var scaled=img.originalWidth*maxHeight/img.originalHeight;return scaled;},getTargetWidth:function(imgsPerRow,maxRowWidth,margin){return(maxRowWidth-((imgsPerRow-1)*margin));},getRowHeightForImages:function(imgs,maxRowHeight,minDisplayHeight,maxRowWidth,idealImgPerRow,margin,targetHeight){var idealImages=imgs.slice(0,idealImgPerRow);var targetRowWidth=this.getTargetWidth(idealImages.length,maxRowWidth,margin);var maxScaleableHeight=this.getMaxScaleableHeight(idealImages,maxRowHeight);targetHeight=targetHeight!==undefined?targetHeight:Math.max(maxScaleableHeight,minDisplayHeight);var attemptedRowHeight=this.performGetRowHeight(idealImages,targetRowWidth,minDisplayHeight,targetHeight);if(attemptedRowHeight!=null){if(attemptedRowHeight<minDisplayHeight){if(idealImages.length>1){targetHeight+=Math.floor((maxRowHeight-targetHeight)/2);return this.getRowHeightForImages(imgs,maxRowHeight,minDisplayHeight,maxRowWidth,idealImgPerRow-1,margin,targetHeight);}
else{return{height:minDisplayHeight,imgCount:1};}}
else{return{height:attemptedRowHeight,imgCount:idealImages.length};}}
if(idealImages.length===imgs.length){return{height:targetHeight,imgCount:idealImages.length};}
else if(idealImages.length===1){return{height:minDisplayHeight,imgCount:1};}
else if(idealImages.length===idealImgPerRow&&targetHeight<maxRowHeight){while(targetHeight<maxRowHeight&&(maxRowHeight-targetHeight)>5){targetHeight+=Math.floor((maxRowHeight-targetHeight)/2);attemptedRowHeight=this.performGetRowHeight(idealImages,targetRowWidth,minDisplayHeight,targetHeight);if(attemptedRowHeight!=null){return{height:attemptedRowHeight,imgCount:idealImages.length};}}
return this.getRowHeightForImages(imgs,maxRowHeight,minDisplayHeight,maxRowWidth,idealImgPerRow-1,margin);}
else if(targetHeight===maxRowHeight){return{height:targetHeight,imgCount:idealImages.length};}
else{return this.getRowHeightForImages(imgs,maxRowHeight,minDisplayHeight,maxRowWidth,idealImgPerRow+1,margin);}},performGetRowHeight:function(idealImages,targetRowWidth,minDisplayHeight,targetHeight){var currRowWidth=0;for(var i=0;i<idealImages.length;i++){var scaledW=this.getScaledWidth(idealImages[i],targetHeight);currRowWidth+=scaledW;}
if(currRowWidth>targetRowWidth){var newHeight=targetRowWidth*targetHeight/currRowWidth;return newHeight;}
else if(idealImages.length===1&&(currRowWidth<=targetRowWidth)&&!idealImages[0].isFolder){return targetHeight;}
else if(currRowWidth/targetRowWidth>0.90){return targetHeight;}
else{return null;}},buildRow:function(imgs,maxRowHeight,minDisplayHeight,maxRowWidth,idealImgPerRow,margin,totalRemaining){var currRowWidth=0;var row={images:[]};var imageRowHeight=this.getRowHeightForImages(imgs,maxRowHeight,minDisplayHeight,maxRowWidth,idealImgPerRow,margin);var targetWidth=this.getTargetWidth(imageRowHeight.imgCount,maxRowWidth,margin);var sizes=[];for(var i=0;i<imageRowHeight.imgCount;i++){var scaledWidth=Math.floor(this.getScaledWidth(imgs[i],imageRowHeight.height));if(currRowWidth+scaledWidth<=targetWidth){currRowWidth+=scaledWidth;sizes.push({width:scaledWidth,height:Math.round(imageRowHeight.height)});row.images.push(imgs[i]);}
else if(imageRowHeight.imgCount===1&&row.images.length===0){sizes.push({width:maxRowWidth,height:Math.round(imageRowHeight.height)});row.images.push(imgs[i]);}
else{break;}}
for(var j=0;j<row.images.length;j++){var bottomMargin=margin;if(j===(row.images.length-1)){margin=0;}
this.setImageStyle(row.images[j],sizes[j].width,sizes[j].height,margin,bottomMargin);}
if(row.images.length===1&&totalRemaining>1){row.images[0].style.width=maxRowWidth+"px";}
return row;},getMaxScaleableHeight:function(imgs,maxRowHeight){var smallestHeight=_.min(imgs,function(item){return item.originalHeight;}).originalHeight;if(smallestHeight>maxRowHeight){smallestHeight=maxRowHeight;}
return smallestHeight;},buildGrid:function(images,maxRowWidth,maxRowHeight,startingIndex,minDisplayHeight,idealImgPerRow,margin,imagesOnly){var rows=[];var imagesProcessed=0;for(var i=startingIndex;i<images.length;i++){var item=images[i];this.setImageData(item);this.setOriginalSize(item,maxRowHeight);if(imagesOnly&&!item.isFolder&&!item.thumbnail){images.splice(i,1);i--;}}
while((imagesProcessed+startingIndex)<images.length){var currImgs=images.slice(imagesProcessed);var remaining=images.length-imagesProcessed;var row=this.buildRow(currImgs,maxRowHeight,minDisplayHeight,maxRowWidth,idealImgPerRow,margin,remaining);if(row.images.length>0){rows.push(row);imagesProcessed+=row.images.length;}
else{if(currImgs.length>0){throw"Could not fill grid with all images, images remaining: "+currImgs.length;}
break;}}
return rows;}};}
angular.module("umbraco.services").factory("umbPhotoFolderHelper",umbPhotoFolderHelper);function umbModelMapper(){return{convertToEntityBasic:function(source){var required=["id","name","icon","parentId","path"];_.each(required,function(k){if(!_.has(source,k)){throw"The source object does not contain the property "+k;}});var optional=["metaData","key","alias"];var result=_.pick(source,required.concat(optional));return result;}};}
angular.module('umbraco.services').factory('umbModelMapper',umbModelMapper);function umbSessionStorage($window){var storage=$window['sessionStorage']?$window['sessionStorage']:{};return{get:function(key){return angular.fromJson(storage["umb_"+key]);},set:function(key,value){storage["umb_"+key]=angular.toJson(value);}};}
angular.module('umbraco.services').factory('umbSessionStorage',umbSessionStorage);function updateChecker($http,umbRequestHelper){return{check:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("updateCheckApiBaseUrl","GetCheck")),'Failed to retrieve update status');}};}
angular.module('umbraco.services').factory('updateChecker',updateChecker);function umbPropEditorHelper(){return{getViewPath:function(input,isPreValue){var path=String(input);if(path.startsWith('/')){return path;}else{if(path.indexOf("/")>=0){return path;}else{if(!isPreValue){return"views/propertyeditors/"+path+"/"+path+".html";}else{return"views/prevalueeditors/"+path+".html";}}}}};}
angular.module('umbraco.services').factory('umbPropEditorHelper',umbPropEditorHelper);function umbDataFormatter(){return{formatContentTypePostData:function(displayModel,action){var saveModel=_.pick(displayModel,'compositeContentTypes','isContainer','allowAsRoot','allowedTemplates','allowedContentTypes','alias','description','thumbnail','name','id','icon','trashed','key','parentId','alias','path');saveModel.allowedTemplates=_.map(displayModel.allowedTemplates,function(t){return t.alias;});saveModel.defaultTemplate=displayModel.defaultTemplate?displayModel.defaultTemplate.alias:null;var realGroups=_.reject(displayModel.groups,function(g){return g.tabState==="init";});saveModel.groups=_.map(realGroups,function(g){var saveGroup=_.pick(g,'inherited','id','sortOrder','name');var realProperties=_.reject(g.properties,function(p){return p.propertyState==="init"||p.inherited===true;});var saveProperties=_.map(realProperties,function(p){var saveProperty=_.pick(p,'id','alias','description','validation','label','sortOrder','dataTypeId','groupId','memberCanEdit','showOnMemberProfile');return saveProperty;});saveGroup.properties=saveProperties;if(saveGroup.inherited===true&&saveProperties.length===0){return null;}
return saveGroup;});saveModel.groups=_.reject(saveModel.groups,function(g){return!g;});return saveModel;},formatDataTypePostData:function(displayModel,preValues,action){var saveModel={parentId:displayModel.parentId,id:displayModel.id,name:displayModel.name,selectedEditor:displayModel.selectedEditor,action:action,preValues:[]};for(var i=0;i<preValues.length;i++){saveModel.preValues.push({key:preValues[i].alias,value:preValues[i].value});}
return saveModel;},formatMemberPostData:function(displayModel,action){var saveModel=this.formatMediaPostData(displayModel,action);saveModel.key=displayModel.key;var genericTab=_.find(displayModel.tabs,function(item){return item.id===0;});var propLogin=_.find(genericTab.properties,function(item){return item.alias==="_umb_login";});var propEmail=_.find(genericTab.properties,function(item){return item.alias==="_umb_email";});var propPass=_.find(genericTab.properties,function(item){return item.alias==="_umb_password";});var propGroups=_.find(genericTab.properties,function(item){return item.alias==="_umb_membergroup";});saveModel.email=propEmail.value;saveModel.username=propLogin.value;saveModel.password=propPass.value;var selectedGroups=[];for(var n in propGroups.value){if(propGroups.value[n]===true){selectedGroups.push(n);}}
saveModel.memberGroups=selectedGroups;var memberProviderPropAliases=_.pairs(displayModel.fieldConfig);_.each(displayModel.tabs,function(tab){_.each(tab.properties,function(prop){var foundAlias=_.find(memberProviderPropAliases,function(item){return prop.alias===item[1];});if(foundAlias){switch(foundAlias[0]){case"umbracoMemberLockedOut":saveModel.isLockedOut=prop.value.toString()==="1"?true:false;break;case"umbracoMemberApproved":saveModel.isApproved=prop.value.toString()==="1"?true:false;break;case"umbracoMemberComments":saveModel.comments=prop.value;break;}}});});return saveModel;},formatMediaPostData:function(displayModel,action){var saveModel={id:displayModel.id,properties:[],name:displayModel.name,contentTypeAlias:displayModel.contentTypeAlias,parentId:displayModel.parentId,action:action};_.each(displayModel.tabs,function(tab){_.each(tab.properties,function(prop){if(!prop.alias.startsWith("_umb_")){saveModel.properties.push({id:prop.id,alias:prop.alias,value:prop.value});}});});return saveModel;},formatContentPostData:function(displayModel,action){var saveModel=this.formatMediaPostData(displayModel,action);var genericTab=_.find(displayModel.tabs,function(item){return item.id===0;});var propExpireDate=_.find(genericTab.properties,function(item){return item.alias==="_umb_expiredate";});var propReleaseDate=_.find(genericTab.properties,function(item){return item.alias==="_umb_releasedate";});var propTemplate=_.find(genericTab.properties,function(item){return item.alias==="_umb_template";});saveModel.expireDate=propExpireDate.value;saveModel.releaseDate=propReleaseDate.value;saveModel.templateAlias=propTemplate.value;return saveModel;}};}
angular.module('umbraco.services').factory('umbDataFormatter',umbDataFormatter);function windowResizeListener($rootScope){var WinReszier=(function(){var registered=[];var inited=false;var resize=_.debounce(function(ev){notify();},100);var notify=function(){var h=$(window).height();var w=$(window).width();$rootScope.$apply(function(){for(var i=0,cnt=registered.length;i<cnt;i++){registered[i].apply($(window),[{width:w,height:h}]);}});};return{register:function(fn){registered.push(fn);if(inited===false){$(window).bind('resize',resize);inited=true;}},unregister:function(fn){var index=registered.indexOf(fn);if(index>-1){registered.splice(index,1);}}};}());return{register:function(cb){WinReszier.register(cb);},unregister:function(cb){WinReszier.unregister(cb);}};}
angular.module('umbraco.services').factory('windowResizeListener',windowResizeListener);function xmlhelper($http){function X2JS(){var VERSION="1.0.11";var escapeMode=false;var DOMNodeTypes={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,DOCUMENT_NODE:9};function getNodeLocalName(node){var nodeLocalName=node.localName;if(nodeLocalName==null){nodeLocalName=node.baseName;}
if(nodeLocalName===null||nodeLocalName===""){nodeLocalName=node.nodeName;}
return nodeLocalName;}
function getNodePrefix(node){return node.prefix;}
function escapeXmlChars(str){if(typeof(str)==="string"){return str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#x27;').replace(/\//g,'&#x2F;');}else{return str;}}
function unescapeXmlChars(str){return str.replace(/&amp;/g,'&').replace(/&lt;/g,'<').replace(/&gt;/g,'>').replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&#x2F;/g,'\/');}
function parseDOMChildren(node){var result,child,childName;if(node.nodeType===DOMNodeTypes.DOCUMENT_NODE){result={};child=node.firstChild;childName=getNodeLocalName(child);result[childName]=parseDOMChildren(child);return result;}
else{if(node.nodeType===DOMNodeTypes.ELEMENT_NODE){result={};result.__cnt=0;var nodeChildren=node.childNodes;for(var cidx=0;cidx<nodeChildren.length;cidx++){child=nodeChildren.item(cidx);childName=getNodeLocalName(child);result.__cnt++;if(result[childName]===null){result[childName]=parseDOMChildren(child);result[childName+"_asArray"]=new Array(1);result[childName+"_asArray"][0]=result[childName];}
else{if(result[childName]!==null){if(!(result[childName]instanceof Array)){var tmpObj=result[childName];result[childName]=[];result[childName][0]=tmpObj;result[childName+"_asArray"]=result[childName];}}
var aridx=0;while(result[childName][aridx]!==null){aridx++;}
(result[childName])[aridx]=parseDOMChildren(child);}}
for(var aidx=0;aidx<node.attributes.length;aidx++){var attr=node.attributes.item(aidx);result.__cnt++;result["_"+attr.name]=attr.value;}
var nodePrefix=getNodePrefix(node);if(nodePrefix!==null&&nodePrefix!==""){result.__cnt++;result.__prefix=nodePrefix;}
if(result.__cnt===1&&result["#text"]!==null){result=result["#text"];}
if(result["#text"]!==null){result.__text=result["#text"];if(escapeMode){result.__text=unescapeXmlChars(result.__text);}
delete result["#text"];delete result["#text_asArray"];}
if(result["#cdata-section"]!=null){result.__cdata=result["#cdata-section"];delete result["#cdata-section"];delete result["#cdata-section_asArray"];}
if(result.__text!=null||result.__cdata!=null){result.toString=function(){return(this.__text!=null?this.__text:'')+(this.__cdata!=null?this.__cdata:'');};}
return result;}
else{if(node.nodeType===DOMNodeTypes.TEXT_NODE||node.nodeType===DOMNodeTypes.CDATA_SECTION_NODE){return node.nodeValue;}}}}
function startTag(jsonObj,element,attrList,closed){var resultStr="<"+((jsonObj!=null&&jsonObj.__prefix!=null)?(jsonObj.__prefix+":"):"")+element;if(attrList!=null){for(var aidx=0;aidx<attrList.length;aidx++){var attrName=attrList[aidx];var attrVal=jsonObj[attrName];resultStr+=" "+attrName.substr(1)+"='"+attrVal+"'";}}
if(!closed){resultStr+=">";}else{resultStr+="/>";}
return resultStr;}
function endTag(jsonObj,elementName){return"</"+(jsonObj.__prefix!==null?(jsonObj.__prefix+":"):"")+elementName+">";}
function endsWith(str,suffix){return str.indexOf(suffix,str.length-suffix.length)!==-1;}
function jsonXmlSpecialElem(jsonObj,jsonObjField){if(endsWith(jsonObjField.toString(),("_asArray"))||jsonObjField.toString().indexOf("_")===0||(jsonObj[jsonObjField]instanceof Function)){return true;}else{return false;}}
function jsonXmlElemCount(jsonObj){var elementsCnt=0;if(jsonObj instanceof Object){for(var it in jsonObj){if(jsonXmlSpecialElem(jsonObj,it)){continue;}
elementsCnt++;}}
return elementsCnt;}
function parseJSONAttributes(jsonObj){var attrList=[];if(jsonObj instanceof Object){for(var ait in jsonObj){if(ait.toString().indexOf("__")===-1&&ait.toString().indexOf("_")===0){attrList.push(ait);}}}
return attrList;}
function parseJSONTextAttrs(jsonTxtObj){var result="";if(jsonTxtObj.__cdata!=null){result+="<![CDATA["+jsonTxtObj.__cdata+"]]>";}
if(jsonTxtObj.__text!=null){if(escapeMode){result+=escapeXmlChars(jsonTxtObj.__text);}else{result+=jsonTxtObj.__text;}}
return result;}
function parseJSONTextObject(jsonTxtObj){var result="";if(jsonTxtObj instanceof Object){result+=parseJSONTextAttrs(jsonTxtObj);}
else{if(jsonTxtObj!=null){if(escapeMode){result+=escapeXmlChars(jsonTxtObj);}else{result+=jsonTxtObj;}}}
return result;}
function parseJSONArray(jsonArrRoot,jsonArrObj,attrList){var result="";if(jsonArrRoot.length===0){result+=startTag(jsonArrRoot,jsonArrObj,attrList,true);}
else{for(var arIdx=0;arIdx<jsonArrRoot.length;arIdx++){result+=startTag(jsonArrRoot[arIdx],jsonArrObj,parseJSONAttributes(jsonArrRoot[arIdx]),false);result+=parseJSONObject(jsonArrRoot[arIdx]);result+=endTag(jsonArrRoot[arIdx],jsonArrObj);}}
return result;}
function parseJSONObject(jsonObj){var result="";var elementsCnt=jsonXmlElemCount(jsonObj);if(elementsCnt>0){for(var it in jsonObj){if(jsonXmlSpecialElem(jsonObj,it)){continue;}
var subObj=jsonObj[it];var attrList=parseJSONAttributes(subObj);if(subObj===null||subObj===undefined){result+=startTag(subObj,it,attrList,true);}else{if(subObj instanceof Object){if(subObj instanceof Array){result+=parseJSONArray(subObj,it,attrList);}else{var subObjElementsCnt=jsonXmlElemCount(subObj);if(subObjElementsCnt>0||subObj.__text!==null||subObj.__cdata!==null){result+=startTag(subObj,it,attrList,false);result+=parseJSONObject(subObj);result+=endTag(subObj,it);}else{result+=startTag(subObj,it,attrList,true);}}}else{result+=startTag(subObj,it,attrList,false);result+=parseJSONTextObject(subObj);result+=endTag(subObj,it);}}}}
result+=parseJSONTextObject(jsonObj);return result;}
this.parseXmlString=function(xmlDocStr){var xmlDoc;if(window.DOMParser){var parser=new window.DOMParser();xmlDoc=parser.parseFromString(xmlDocStr,"text/xml");}
else{if(xmlDocStr.indexOf("<?")===0){xmlDocStr=xmlDocStr.substr(xmlDocStr.indexOf("?>")+2);}
xmlDoc=new ActiveXObject("Microsoft.XMLDOM");xmlDoc.async="false";xmlDoc.loadXML(xmlDocStr);}
return xmlDoc;};this.xml2json=function(xmlDoc){return parseDOMChildren(xmlDoc);};this.xml_str2json=function(xmlDocStr){var xmlDoc=this.parseXmlString(xmlDocStr);return this.xml2json(xmlDoc);};this.json2xml_str=function(jsonObj){return parseJSONObject(jsonObj);};this.json2xml=function(jsonObj){var xmlDocStr=this.json2xml_str(jsonObj);return this.parseXmlString(xmlDocStr);};this.getVersion=function(){return VERSION;};this.escapeMode=function(enabled){escapeMode=enabled;};}
var x2js=new X2JS();return{toJson:function(xml){var json=x2js.xml_str2json(xml);return json;},fromJson:function(json){var xml=x2js.json2xml_str(json);return xml;}};}
angular.module('umbraco.services').factory('xmlhelper',xmlhelper);})();
;;;
(function(){angular.module('umbraco.security',['umbraco.security.retryQueue','umbraco.security.interceptor']);angular.module('umbraco.security.interceptor',['umbraco.security.retryQueue']).factory('securityInterceptor',['$injector','securityRetryQueue','notificationsService','requestInterceptorFilter',function($injector,queue,notifications,requestInterceptorFilter){return function(promise){return promise.then(function(originalResponse){var headers=originalResponse.headers();if(headers["x-umb-user-seconds"]){var userService=$injector.get('userService');userService.setUserTimeout(headers["x-umb-user-seconds"]);}
return promise;},function(originalResponse){var headers=originalResponse.config?originalResponse.config.headers:{};if(headers["x-umb-ignore-error"]==="ignore"){return promise;}
var filtered=_.find(requestInterceptorFilter(),function(val){return originalResponse.config.url.indexOf(val)>0;});if(filtered){return promise;}
if(originalResponse.status===401){promise=queue.pushRetryFn('unauthorized-server',function retryRequest(){return $injector.get('$http')(originalResponse.config);});}
else if(originalResponse.status===404){var errMsg="The URL returned a 404 (not found): <br/><i>"+originalResponse.config.url.split('?')[0]+"</i>";if(originalResponse.data&&originalResponse.data.ExceptionMessage){errMsg+="<br/> with error: <br/><i>"+originalResponse.data.ExceptionMessage+"</i>";}
if(originalResponse.config.data){errMsg+="<br/> with data: <br/><i>"+angular.toJson(originalResponse.config.data)+"</i><br/>Contact your administrator for information.";}
notifications.error("Request error",errMsg);}
else if(originalResponse.status===403){var msg="Unauthorized access to URL: <br/><i>"+originalResponse.config.url.split('?')[0]+"</i>";if(originalResponse.config.data){msg+="<br/> with data: <br/><i>"+angular.toJson(originalResponse.config.data)+"</i><br/>Contact your administrator for information.";}
notifications.error("Authorization error",msg);}
return promise;});};}]).value('requestInterceptorFilter',function(){return["www.gravatar.com"];}).config(['$httpProvider',function($httpProvider){$httpProvider.responseInterceptors.push('securityInterceptor');}]);angular.module('umbraco.security.retryQueue',[]).factory('securityRetryQueue',['$q','$log',function($q,$log){var retryQueue=[];var service={onItemAddedCallbacks:[],hasMore:function(){return retryQueue.length>0;},push:function(retryItem){retryQueue.push(retryItem);angular.forEach(service.onItemAddedCallbacks,function(cb){try{cb(retryItem);}catch(e){$log.error('securityRetryQueue.push(retryItem): callback threw an error'+e);}});},pushRetryFn:function(reason,retryFn){if(arguments.length===1){retryFn=reason;reason=undefined;}
var deferred=$q.defer();var retryItem={reason:reason,retry:function(){$q.when(retryFn()).then(function(value){deferred.resolve(value);},function(value){deferred.reject(value);});},cancel:function(){deferred.reject();}};service.push(retryItem);return deferred.promise;},retryReason:function(){return service.hasMore()&&retryQueue[0].reason;},cancelAll:function(){while(service.hasMore()){retryQueue.shift().cancel();}},retryAll:function(){while(service.hasMore()){retryQueue.shift().retry();}}};return service;}]);})();
;;;
(function(){function MainController($scope,$rootScope,$location,$routeParams,$timeout,$http,$log,appState,treeService,notificationsService,userService,navigationService,historyService,updateChecker,assetsService,eventsService,umbRequestHelper,tmhDynamicLocale){$scope.authenticated=null;$scope.avatar=[{value:"assets/img/application/logo.png"},{value:"assets/img/application/logo@2x.png"},{value:"assets/img/application/logo@3x.png"}];$scope.touchDevice=appState.getGlobalState("touchDevice");$scope.removeNotification=function(index){notificationsService.remove(index);};$scope.closeDialogs=function(event){var el=event.target.nodeName;var els=["INPUT","A","BUTTON"];if(els.indexOf(el)>=0){return;}
var parents=$(event.target).parents("a,button");if(parents.length>0){return;}
var nav=$(event.target).parents("#dialog");if(nav.length===1){return;}
eventsService.emit("app.closeDialogs",event);};var evts=[];evts.push(eventsService.on("app.notAuthenticated",function(){$scope.authenticated=null;$scope.user=null;}));evts.push(eventsService.on("app.ready",function(evt,data){$scope.authenticated=data.authenticated;$scope.user=data.user;updateChecker.check().then(function(update){if(update&&update!=="null"){if(update.type!=="None"){var notification={headline:"Update available",message:"Click to download",sticky:true,type:"info",url:update.url};notificationsService.add(notification);}}})
if(data.lastUserId!==undefined&&data.lastUserId!==null&&data.lastUserId!==data.user.id){$location.path("/").search("");historyService.removeAll();treeService.clearCache();}
if($scope.user.locale){tmhDynamicLocale.set($scope.user.locale);}
if($scope.user.emailHash){$http.get("https://www.gravatar.com/avatar/"+$scope.user.emailHash+".jpg?s=64&d=404").then(function successCallback(response){$("#avatar-img").fadeTo(1000,0,function(){$scope.$apply(function(){if($scope.user&&$scope.user.emailHash){var avatarBaseUrl="https://www.gravatar.com/avatar/",hash=$scope.user.emailHash;$scope.avatar=[{value:avatarBaseUrl+hash+".jpg?s=30&d=mm"},{value:avatarBaseUrl+hash+".jpg?s=60&d=mm"},{value:avatarBaseUrl+hash+".jpg?s=90&d=mm"}];}});$("#avatar-img").fadeTo(1000,1);});},function errorCallback(response){});}}));evts.push(eventsService.on("app.ysod",function(name,error){$scope.ysodOverlay={view:"ysod",error:error,show:true};}));$scope.$on('$destroy',function(){for(var e in evts){eventsService.unsubscribe(evts[e]);}});}
angular.module('umbraco').controller("Umbraco.MainController",MainController).config(function(tmhDynamicLocaleProvider){tmhDynamicLocaleProvider.localeLocationPattern('lib/angular/1.1.5/i18n/angular-locale_{{locale}}.js');});function NavigationController($scope,$rootScope,$location,$log,$routeParams,$timeout,appState,navigationService,keyboardService,dialogService,historyService,eventsService,sectionResource,angularHelper){$scope.treeEventHandler=$({});navigationService.setupTreeEvents($scope.treeEventHandler);$scope.nav=navigationService;$rootScope.nav=navigationService;$scope.showContextMenuDialog=false;$scope.showContextMenu=false;$scope.showSearchResults=false;$scope.menuDialogTitle=null;$scope.menuActions=[];$scope.menuNode=null;$scope.currentSection=appState.getSectionState("currentSection");$scope.showNavigation=appState.getGlobalState("showNavigation");keyboardService.bind("ctrl+shift+s",function(){navigationService.showSearch();});keyboardService.bind("esc",function(){eventsService.emit("app.closeDialogs");});$scope.selectedId=navigationService.currentId;var evts=[];evts.push(eventsService.on("appState.globalState.changed",function(e,args){if(args.key==="showNavigation"){$scope.showNavigation=args.value;}}));evts.push(eventsService.on("appState.menuState.changed",function(e,args){if(args.key==="showMenuDialog"){$scope.showContextMenuDialog=args.value;}
if(args.key==="showMenu"){$scope.showContextMenu=args.value;}
if(args.key==="dialogTitle"){$scope.menuDialogTitle=args.value;}
if(args.key==="menuActions"){$scope.menuActions=args.value;}
if(args.key==="currentNode"){$scope.menuNode=args.value;}}));evts.push(eventsService.on("appState.treeState.changed",function(e,args){var f=args;if(args.value.root&&args.value.root.metaData.containsTrees===false){$rootScope.emptySection=true;}
else{$rootScope.emptySection=false;}}));evts.push(eventsService.on("appState.sectionState.changed",function(e,args){if(args.key==="currentSection"){$scope.currentSection=args.value;}
if(args.key==="showSearchResults"){$scope.showSearchResults=args.value;}}));evts.push(eventsService.on("app.closeDialogs",function(event){if(appState.getGlobalState("stickyNavigation")){navigationService.hideNavigation();angularHelper.safeApply($scope);}}));evts.push(eventsService.on("app.notAuthenticated",function(){$scope.authenticated=false;}));evts.push(eventsService.on("app.ready",function(evt,data){$scope.authenticated=true;}));$scope.searchShowMenu=function(ev,args){args.skipDefault=true;navigationService.showMenu(ev,args);};$scope.searchHide=function(){navigationService.hideSearch();};var treeActive=false;$scope.enterTree=function(event){treeActive=true;};$scope.leaveTree=function(event){if(!event){return;}
if(!appState.getGlobalState("touchDevice")){treeActive=false;$timeout(function(){if(!treeActive){navigationService.hideTree();}},300);}};$scope.$on('$destroy',function(){for(var e in evts){eventsService.unsubscribe(evts[e]);}});}
angular.module('umbraco').controller("Umbraco.NavigationController",NavigationController);function SearchController($scope,searchService,$log,$location,navigationService,$q){$scope.searchTerm=null;$scope.searchResults=[];$scope.isSearching=false;$scope.selectedResult=-1;$scope.navigateResults=function(ev){switch(ev.keyCode){case 38:iterateResults(true);break;case 40:iterateResults(false);break;case 13:if($scope.selectedItem){$location.path($scope.selectedItem.editorPath);navigationService.hideSearch();}
break;}};var group=undefined;var groupIndex=-1;var itemIndex=-1;$scope.selectedItem=undefined;function iterateResults(up){if(!group){group=$scope.groups[0];groupIndex=0;}
if(up){if(itemIndex===0){if(groupIndex===0){gotoGroup($scope.groups.length-1,true);}else{gotoGroup(groupIndex-1,true);}}else{gotoItem(itemIndex-1);}}else{if(itemIndex<group.results.length-1){gotoItem(itemIndex+1);}else{if(groupIndex===$scope.groups.length-1){gotoGroup(0);}else{gotoGroup(groupIndex+1);}}}}
function gotoGroup(index,up){groupIndex=index;group=$scope.groups[groupIndex];if(up){gotoItem(group.results.length-1);}else{gotoItem(0);}}
function gotoItem(index){itemIndex=index;$scope.selectedItem=group.results[itemIndex];}
var canceler=null;$scope.$watch("searchTerm",_.debounce(function(newVal,oldVal){$scope.$apply(function(){if($scope.searchTerm){if(newVal!==null&&newVal!==undefined&&newVal!==oldVal){$scope.isSearching=true;navigationService.showSearch();$scope.selectedItem=undefined;if(canceler){console.log("CANCELED!");canceler.resolve();canceler=$q.defer();}
else{canceler=$q.defer();}
searchService.searchAll({term:$scope.searchTerm,canceler:canceler}).then(function(result){$scope.groups=_.filter(result,function(group){return group.results.length>0;});canceler=null;});}}
else{$scope.isSearching=false;navigationService.hideSearch();$scope.selectedItem=undefined;}});},200));}
angular.module('umbraco').controller("Umbraco.SearchController",SearchController);function AuthorizeUpgradeController($scope,$window){$scope.submit=function(event){var qry=$window.location.search.trimStart("?").split("&");var redir=_.find(qry,function(item){return item.startsWith("redir=");});if(redir){$window.location=decodeURIComponent(redir.split("=")[1]);}
else{$window.location="/";}};}
angular.module('umbraco').controller("Umbraco.AuthorizeUpgradeController",AuthorizeUpgradeController);function DashboardController($scope,$routeParams,dashboardResource,localizationService){$scope.page={};$scope.page.nameLocked=true;$scope.page.loading=true;$scope.dashboard={};localizationService.localize("sections_"+$routeParams.section).then(function(name){$scope.dashboard.name=name;});dashboardResource.getDashboard($routeParams.section).then(function(tabs){$scope.dashboard.tabs=tabs;$scope.page.loading=false;});}
angular.module('umbraco').controller("Umbraco.DashboardController",DashboardController);angular.module("umbraco").controller("Umbraco.Dialogs.ApprovedColorPickerController",function($scope,$http,umbPropEditorHelper,assetsService){assetsService.loadJs("lib/cssparser/cssparser.js").then(function(){var cssPath=$scope.dialogData.cssPath;$scope.cssClass=$scope.dialogData.cssClass;$scope.classes=[];$scope.change=function(newClass){$scope.model.value=newClass;}
$http.get(cssPath).success(function(data){var parser=new CSSParser();$scope.classes=parser.parse(data,false,false).cssRules;$scope.classes.splice(0,0,"noclass");})
assetsService.loadCss("/App_Plugins/Lecoati.uSky.Grid/lib/uSky.Grid.ApprovedColorPicker.css");assetsService.loadCss(cssPath);});});function ContentEditDialogController($scope,editorState,$routeParams,$q,$timeout,$window,appState,contentResource,entityResource,navigationService,notificationsService,angularHelper,serverValidationManager,contentEditingHelper,treeService,fileManager,formHelper,umbRequestHelper,umbModelMapper,$http){$scope.defaultButton=null;$scope.subButtons=[];var dialogOptions=$scope.$parent.dialogOptions;function performSave(args){contentEditingHelper.contentEditorPerformSave({statusMessage:args.statusMessage,saveMethod:args.saveMethod,scope:$scope,content:$scope.content}).then(function(content){if(dialogOptions.closeOnSave){$scope.submit(content);}},function(err){});}
function filterTabs(entity,blackList){if(blackList){_.each(entity.tabs,function(tab){tab.hide=_.contains(blackList,tab.alias);});}
return entity;};function init(content){var buttons=contentEditingHelper.configureContentEditorButtons({create:$routeParams.create,content:content,methods:{saveAndPublish:$scope.saveAndPublish,sendToPublish:$scope.sendToPublish,save:$scope.save,unPublish:angular.noop}});$scope.defaultButton=buttons.defaultButton;$scope.subButtons=buttons.subButtons;$scope.content.isDialogEditor=true;editorState.set($scope.content);}
if(angular.isObject(dialogOptions.entity)){$scope.loaded=true;$scope.content=filterTabs(dialogOptions.entity,dialogOptions.tabFilter);init($scope.content);}
else{contentResource.getById(dialogOptions.id).then(function(data){$scope.loaded=true;$scope.content=filterTabs(data,dialogOptions.tabFilter);init($scope.content);serverValidationManager.executeAndClearAllSubscriptions();});}
$scope.sendToPublish=function(){performSave({saveMethod:contentResource.sendToPublish,statusMessage:"Sending..."});};$scope.saveAndPublish=function(){performSave({saveMethod:contentResource.publish,statusMessage:"Publishing..."});};$scope.save=function(){performSave({saveMethod:contentResource.save,statusMessage:"Saving..."});};$scope.performAction=function(btn){if(!btn||!angular.isFunction(btn.handler)){throw"btn.handler must be a function reference";}
if(!$scope.busy){btn.handler.apply(this);}};}
angular.module("umbraco").controller("Umbraco.Dialogs.Content.EditController",ContentEditDialogController);angular.module("umbraco").controller("Umbraco.Dialogs.HelpController",function($scope,$location,$routeParams,helpService,userService,localizationService){$scope.section=$routeParams.section;$scope.version=Umbraco.Sys.ServerVariables.application.version+" assembly: "+Umbraco.Sys.ServerVariables.application.assemblyVersion;if(!$scope.section){$scope.section="content";}
$scope.sectionName=$scope.section;var rq={};rq.section=$scope.section;localizationService.localize("sections_"+rq.section).then(function(value){$scope.sectionName=value;});userService.getCurrentUser().then(function(user){rq.usertype=user.userType;rq.lang=user.locale;if($routeParams.url){rq.path=decodeURIComponent($routeParams.url);if(rq.path.indexOf(Umbraco.Sys.ServerVariables.umbracoSettings.umbracoPath)===0){rq.path=rq.path.substring(Umbraco.Sys.ServerVariables.umbracoSettings.umbracoPath.length);}
if(rq.path.indexOf(".aspx")>0){rq.path=rq.path.substring(0,rq.path.indexOf(".aspx"));}}else{rq.path=rq.section+"/"+$routeParams.tree+"/"+$routeParams.method;}
helpService.findHelp(rq).then(function(topics){$scope.topics=topics;});helpService.findVideos(rq).then(function(videos){$scope.videos=videos;});});});angular.module("umbraco").controller("Umbraco.Dialogs.IconPickerController",function($scope,iconHelper){iconHelper.getIcons().then(function(icons){$scope.icons=icons;});$scope.submitClass=function(icon){if($scope.color)
{$scope.submit(icon+" "+$scope.color);}else{$scope.submit(icon);}};});function InsertMacroController($scope,entityResource,macroResource,umbPropEditorHelper,macroService,formHelper){function editParams(){macroResource.getMacroParameters($scope.selectedMacro.id).then(function(data){if(!angular.isArray(data)||data.length===0){submitForm();}else{$scope.wizardStep="paramSelect";$scope.macroParams=data;if($scope.dialogData&&$scope.dialogData.macroData&&$scope.dialogData.macroData.macroParamsDictionary){_.each($scope.dialogData.macroData.macroParamsDictionary,function(val,key){var prop=_.find($scope.macroParams,function(item){return item.alias==key;});if(prop){if(_.isString(val)){val=_.unescape(val);if(val.detectIsJson()){try{prop.value=angular.fromJson(val);}
catch(e){prop.value=val;}}
else{prop.value=val;}}
else{prop.value=val;}}});}}});}
function submitForm(){var paramDictionary={};_.each($scope.macroParams,function(item){var val=item.value;if(item.value!=null&&item.value!=undefined&&!_.isString(item.value)){try{val=angular.toJson(val);}
catch(e){}}
paramDictionary[item.alias]=_.escape(val);});var macroAlias=$scope.selectedMacro.alias;var syntax;if($scope.dialogData.renderingEngine&&$scope.dialogData.renderingEngine==="WebForms"){syntax=macroService.generateWebFormsSyntax({macroAlias:macroAlias,macroParamsDictionary:paramDictionary});}
else if($scope.dialogData.renderingEngine&&$scope.dialogData.renderingEngine==="Mvc"){syntax=macroService.generateMvcSyntax({macroAlias:macroAlias,macroParamsDictionary:paramDictionary});}
else{syntax=macroService.generateMacroSyntax({macroAlias:macroAlias,macroParamsDictionary:paramDictionary});}
$scope.submit({syntax:syntax,macroAlias:macroAlias,macroParamsDictionary:paramDictionary});}
$scope.macros=[];$scope.selectedMacro=null;$scope.wizardStep="macroSelect";$scope.macroParams=[];$scope.submitForm=function(){if(formHelper.submitForm({scope:$scope})){formHelper.resetForm({scope:$scope});if($scope.wizardStep==="macroSelect"){editParams();}
else{submitForm();}}};if($scope.dialogData&&$scope.dialogData.macroData){$scope.wizardStep="paramSelect";}
entityResource.getAll("Macro",($scope.dialogData&&$scope.dialogData.richTextEditor&&$scope.dialogData.richTextEditor===true)?"UseInEditor=true":null).then(function(data){if(angular.isArray($scope.dialogData.allowedMacros)&&$scope.dialogData.allowedMacros.length>0){$scope.macros=_.filter(data,function(d){return _.contains($scope.dialogData.allowedMacros,d.alias);});}
else{$scope.macros=data;}
if($scope.dialogData&&$scope.dialogData.macroData&&$scope.dialogData.macroData.macroAlias){var found=_.find(data,function(item){return item.alias===$scope.dialogData.macroData.macroAlias;});if(found){$scope.selectedMacro=found;editParams();return;}}
$scope.wizardStep="macroSelect";});}
angular.module("umbraco").controller("Umbraco.Dialogs.InsertMacroController",InsertMacroController);function LegacyDeleteController($scope,legacyResource,treeService,navigationService){$scope.performDelete=function(){$scope.currentNode.loading=true;legacyResource.deleteItem({nodeId:$scope.currentNode.id,nodeType:$scope.currentNode.nodeType,alias:$scope.currentNode.name,}).then(function(){$scope.currentNode.loading=false;treeService.removeNode($scope.currentNode);navigationService.hideMenu();});};$scope.cancel=function(){navigationService.hideDialog();};}
angular.module("umbraco").controller("Umbraco.Dialogs.LegacyDeleteController",LegacyDeleteController);angular.module("umbraco").controller("Umbraco.Dialogs.LinkPickerController",function($scope,eventsService,dialogService,entityResource,contentResource,mediaHelper,userService,localizationService){var dialogOptions=$scope.dialogOptions;var searchText="Search...";localizationService.localize("general_search").then(function(value){searchText=value+"...";});$scope.dialogTreeEventHandler=$({});$scope.target={};$scope.searchInfo={searchFromId:null,searchFromName:null,showSearch:false,results:[],selectedSearchResults:[]}
if(dialogOptions.currentTarget){$scope.target=dialogOptions.currentTarget;if($scope.target.id){if(!$scope.target.path){entityResource.getPath($scope.target.id,"Document").then(function(path){$scope.target.path=path;$scope.dialogTreeEventHandler.syncTree({path:$scope.target.path,tree:"content"});});}
contentResource.getNiceUrl($scope.target.id).then(function(url){$scope.target.url=url;});}}
function nodeSelectHandler(ev,args){args.event.preventDefault();args.event.stopPropagation();if(args.node.metaData.listViewNode){$scope.searchInfo.showSearch=true;$scope.searchInfo.searchFromId=args.node.metaData.listViewNode.id;$scope.searchInfo.searchFromName=args.node.metaData.listViewNode.name;}
else{eventsService.emit("dialogs.linkPicker.select",args);if($scope.currentNode){$scope.currentNode.selected=false;}
$scope.currentNode=args.node;$scope.currentNode.selected=true;$scope.target.id=args.node.id;$scope.target.name=args.node.name;if(args.node.id<0){$scope.target.url="/";}
else{contentResource.getNiceUrl(args.node.id).then(function(url){$scope.target.url=url;});}
if(!angular.isUndefined($scope.target.isMedia)){delete $scope.target.isMedia;}}}
function nodeExpandedHandler(ev,args){if(angular.isArray(args.children)){_.each(args.children,function(child){if(child.metaData.isContainer){child.hasChildren=true;child.children=[{level:child.level+1,hasChildren:false,name:searchText,metaData:{listViewNode:child,},cssClass:"icon umb-tree-icon sprTree icon-search",cssClasses:["not-published"]}];}});}}
$scope.switchToMediaPicker=function(){userService.getCurrentUser().then(function(userData){dialogService.mediaPicker({startNodeId:userData.startMediaId,callback:function(media){$scope.target.id=media.id;$scope.target.isMedia=true;$scope.target.name=media.name;$scope.target.url=mediaHelper.resolveFile(media);}});});};$scope.hideSearch=function(){$scope.searchInfo.showSearch=false;$scope.searchInfo.searchFromId=null;$scope.searchInfo.searchFromName=null;$scope.searchInfo.results=[];}
$scope.selectResult=function(evt,result){result.selected=result.selected===true?false:true;nodeSelectHandler(evt,{event:evt,node:result});};$scope.onSearchResults=function(results){$scope.searchInfo.results=results;$scope.searchInfo.showSearch=true;};$scope.dialogTreeEventHandler.bind("treeNodeSelect",nodeSelectHandler);$scope.dialogTreeEventHandler.bind("treeNodeExpanded",nodeExpandedHandler);$scope.$on('$destroy',function(){$scope.dialogTreeEventHandler.unbind("treeNodeSelect",nodeSelectHandler);$scope.dialogTreeEventHandler.unbind("treeNodeExpanded",nodeExpandedHandler);});});angular.module("umbraco").controller("Umbraco.Dialogs.LoginController",function($scope,$cookies,localizationService,userService,externalLoginInfo){var d=new Date();var konamiGreetings=new Array("Suze Sunday","Malibu Monday","Tequila Tuesday","Whiskey Wednesday","Negroni Day","Fernet Friday","Sancerre Saturday");var konamiMode=$cookies.konamiLogin;if(konamiMode=="1"){$scope.greeting="Happy "+konamiGreetings[d.getDay()];}else{localizationService.localize("login_greeting"+d.getDay()).then(function(label){$scope.greeting=label;});}
$scope.errorMsg="";$scope.externalLoginFormAction=Umbraco.Sys.ServerVariables.umbracoUrls.externalLoginsUrl;$scope.externalLoginProviders=externalLoginInfo.providers;$scope.externalLoginInfo=externalLoginInfo;$scope.activateKonamiMode=function(){if($cookies.konamiLogin=="1"){document.cookie="konamiLogin=; expires=Thu, 01 Jan 1970 00:00:01 GMT;";document.location.reload();}else{document.cookie="konamiLogin=1; expires=Tue, 01 Jan 2030 00:00:01 GMT;";$scope.$apply(function(){$scope.greeting="Happy "+konamiGreetings[d.getDay()];});}}
$scope.loginSubmit=function(login,password){if(login&&password&&login.length>0&&password.length>0){$scope.loginForm.username.$setValidity('auth',true);$scope.loginForm.password.$setValidity('auth',true);}
if($scope.loginForm.$invalid){return;}
userService.authenticate(login,password).then(function(data){$scope.submit(true);},function(reason){$scope.errorMsg=reason.errorMsg;$scope.loginForm.username.$setValidity("auth",false);$scope.loginForm.password.$setValidity("auth",false);});$scope.loginForm.username.$viewChangeListeners.push(function(){if($scope.loginForm.username.$invalid){$scope.loginForm.username.$setValidity('auth',true);}});$scope.loginForm.password.$viewChangeListeners.push(function(){if($scope.loginForm.password.$invalid){$scope.loginForm.password.$setValidity('auth',true);}});};});angular.module("umbraco").controller("Umbraco.Dialogs.MacroPickerController",function($scope,macroFactory,umbPropEditorHelper){$scope.macros=macroFactory.all(true);$scope.dialogMode="list";$scope.configureMacro=function(macro){$scope.dialogMode="configure";$scope.dialogData.macro=macroFactory.getMacro(macro.alias);for(var i=0;i<dialogData.macro.properties.length;i++){dialogData.macro.properties[i].editorView=umbPropEditorHelper.getViewPath(dialogData.macro.properties[i].view);}};});angular.module("umbraco").controller("Umbraco.Dialogs.MediaPickerController",function($scope,mediaResource,umbRequestHelper,entityResource,$log,mediaHelper,eventsService,treeService,$cookies,$element,$timeout){var dialogOptions=$scope.dialogOptions;$scope.onlyImages=dialogOptions.onlyImages;$scope.showDetails=dialogOptions.showDetails;$scope.multiPicker=(dialogOptions.multiPicker&&dialogOptions.multiPicker!=="0")?true:false;$scope.startNodeId=dialogOptions.startNodeId?dialogOptions.startNodeId:-1;$scope.cropSize=dialogOptions.cropSize;$scope.target=undefined;if(dialogOptions.currentTarget){$scope.target=dialogOptions.currentTarget;}
$scope.upload=function(v){angular.element(".umb-file-dropzone-directive .file-select").click();};$scope.dragLeave=function(el,event){$scope.activeDrag=false;};$scope.dragEnter=function(el,event){$scope.activeDrag=true;};$scope.submitFolder=function(e){if(e.keyCode===13){e.preventDefault();mediaResource.addFolder($scope.newFolderName,$scope.currentFolder.id).then(function(data){$scope.showFolderInput=false;$scope.newFolderName="";treeService.clearCache({cacheKey:"__media",childrenOf:data.parentId});$scope.gotoFolder(data);});}};$scope.gotoFolder=function(folder){if(!folder){folder={id:-1,name:"Media",icon:"icon-folder"};}
if(folder.id>0){entityResource.getAncestors(folder.id,"media").then(function(anc){$scope.path=_.filter(anc,function(f){return f.path.indexOf($scope.startNodeId)!==-1;});});}
else{$scope.path=[];}
mediaResource.getChildren(folder.id).then(function(data){$scope.searchTerm="";$scope.images=data.items?data.items:[];});$scope.currentFolder=folder;};$scope.clickHandler=function(image,ev,select){ev.preventDefault();if(image.isFolder&&!select){$scope.gotoFolder(image);}else{eventsService.emit("dialogs.mediaPicker.select",image);if($scope.multiPicker){$scope.select(image);image.cssclass=($scope.dialogData.selection.indexOf(image)>-1)?"selected":"";}else if($scope.showDetails){$scope.target=image;$scope.target.url=mediaHelper.resolveFile(image);}else{$scope.submit(image);}}};$scope.exitDetails=function(){if(!$scope.currentFolder){$scope.gotoFolder();}
$scope.target=undefined;};$scope.onUploadComplete=function(){$scope.gotoFolder($scope.currentFolder);};$scope.onFilesQueue=function(){$scope.activeDrag=false;};if(!$scope.target){$scope.gotoFolder({id:$scope.startNodeId,name:"Media",icon:"icon-folder"});}});angular.module("umbraco").controller("Umbraco.Dialogs.MemberGroupPickerController",function($scope,eventsService,entityResource,searchService,$log){var dialogOptions=$scope.dialogOptions;$scope.dialogTreeEventHandler=$({});$scope.multiPicker=dialogOptions.multiPicker;function select(text,id){if(dialogOptions.multiPicker){$scope.select(id);}
else{$scope.submit(id);}}
function nodeSelectHandler(ev,args){args.event.preventDefault();args.event.stopPropagation();eventsService.emit("dialogs.memberGroupPicker.select",args);select(args.node.name,args.node.id);args.node.selected=args.node.selected===true?false:true;}
$scope.dialogTreeEventHandler.bind("treeNodeSelect",nodeSelectHandler);$scope.$on('$destroy',function(){$scope.dialogTreeEventHandler.unbind("treeNodeSelect",nodeSelectHandler);});});angular.module("umbraco").controller("Umbraco.Dialogs.RteEmbedController",function($scope,$http,umbRequestHelper){$scope.form={};$scope.form.url="";$scope.form.width=360;$scope.form.height=240;$scope.form.constrain=true;$scope.form.preview="";$scope.form.success=false;$scope.form.info="";$scope.form.supportsDimensions=false;var origWidth=500;var origHeight=300;$scope.showPreview=function(){if($scope.form.url){$scope.form.show=true;$scope.form.preview="<div class=\"umb-loader\" style=\"height: 10px; margin: 10px 0px;\"></div>";$scope.form.info="";$scope.form.success=false;$http({method:'GET',url:umbRequestHelper.getApiUrl("embedApiBaseUrl","GetEmbed"),params:{url:$scope.form.url,width:$scope.form.width,height:$scope.form.height}}).success(function(data){$scope.form.preview="";switch(data.Status){case 0:$scope.form.info="Not supported";break;case 1:$scope.form.info="Computer says no";break;case 2:$scope.form.preview=data.Markup;$scope.form.supportsDimensions=data.SupportsDimensions;$scope.form.success=true;break;}}).error(function(){$scope.form.supportsDimensions=false;$scope.form.preview="";$scope.form.info="Computer says no";});}else{$scope.form.supportsDimensions=false;$scope.form.preview="";$scope.form.info="Please enter a URL";}};$scope.changeSize=function(type){var width,height;if($scope.form.constrain){width=parseInt($scope.form.width,10);height=parseInt($scope.form.height,10);if(type=='width'){origHeight=Math.round((width/origWidth)*height);$scope.form.height=origHeight;}else{origWidth=Math.round((height/origHeight)*width);$scope.form.width=origWidth;}}
if($scope.form.url!=""){$scope.showPreview();}};$scope.insert=function(){$scope.submit($scope.form.preview);};});angular.module("umbraco").controller('Umbraco.Dialogs.Template.QueryBuilderController',function($scope,$http,dialogService){$http.get("backoffice/UmbracoApi/TemplateQuery/GetAllowedProperties").then(function(response){$scope.properties=response.data;});$http.get("backoffice/UmbracoApi/TemplateQuery/GetContentTypes").then(function(response){$scope.contentTypes=response.data;});$http.get("backoffice/UmbracoApi/TemplateQuery/GetFilterConditions").then(function(response){$scope.conditions=response.data;});$scope.query={contentType:{name:"Everything"},source:{name:"My website"},filters:[{property:undefined,operator:undefined}],sort:{property:{alias:"",name:"",},direction:"ascending"}};$scope.chooseSource=function(query){dialogService.contentPicker({callback:function(data){if(data.id>0){query.source={id:data.id,name:data.name};}else{query.source.name="My website";delete query.source.id;}}});};var throttledFunc=_.throttle(function(){$http.post("backoffice/UmbracoApi/TemplateQuery/PostTemplateQuery",$scope.query).then(function(response){$scope.result=response.data;});},200);$scope.$watch("query",function(value){throttledFunc();},true);$scope.getPropertyOperators=function(property){var conditions=_.filter($scope.conditions,function(condition){var index=condition.appliesTo.indexOf(property.type);return index>=0;});return conditions;};$scope.addFilter=function(query){query.filters.push({});};$scope.trashFilter=function(query){query.filters.splice(query,1);};$scope.changeSortOrder=function(query){if(query.sort.direction==="ascending"){query.sort.direction="descending";}else{query.sort.direction="ascending";}};$scope.setSortProperty=function(query,property){query.sort.property=property;if(property.type==="datetime"){query.sort.direction="descending";}else{query.sort.direction="ascending";}};});angular.module("umbraco").controller('Umbraco.Dialogs.Template.SnippetController',function($scope){$scope.type=$scope.dialogOptions.type;$scope.section={name:"",required:false};});angular.module("umbraco").controller("Umbraco.Dialogs.TreePickerController",function($scope,entityResource,eventsService,$log,searchService,angularHelper,$timeout,localizationService,treeService){var tree=null;var dialogOptions=$scope.dialogOptions;$scope.dialogTreeEventHandler=$({});$scope.section=dialogOptions.section;$scope.treeAlias=dialogOptions.treeAlias;$scope.multiPicker=dialogOptions.multiPicker;$scope.hideHeader=true;$scope.searchInfo={searchFromId:dialogOptions.startNodeId,searchFromName:null,showSearch:false,results:[],selectedSearchResults:[]}
$scope.customTreeParams=dialogOptions.startNodeId?"startNodeId="+dialogOptions.startNodeId:"";$scope.customTreeParams+=dialogOptions.customTreeParams?"&"+dialogOptions.customTreeParams:"";var searchText="Search...";localizationService.localize("general_search").then(function(value){searchText=value+"...";});var entityType=dialogOptions.entityType?dialogOptions.entityType:"Document";if(dialogOptions.minNumber){dialogOptions.minNumber=parseInt(dialogOptions.minNumber,10);}
if(dialogOptions.maxNumber){dialogOptions.maxNumber=parseInt(dialogOptions.maxNumber,10);}
if(dialogOptions.section==="member"){entityType="Member";}
else if(dialogOptions.section==="media"){entityType="Media";}
if(dialogOptions.filter){dialogOptions.filterExclude=false;dialogOptions.filterAdvanced=false;if(angular.isFunction(dialogOptions.filter)){dialogOptions.filterAdvanced=true;}
else if(angular.isObject(dialogOptions.filter)){dialogOptions.filterAdvanced=true;}
else{if(dialogOptions.filter.startsWith("!")){dialogOptions.filterExclude=true;dialogOptions.filter=dialogOptions.filter.substring(1);}
if(dialogOptions.filter.startsWith("{")){dialogOptions.filterAdvanced=true;dialogOptions.filter=angular.fromJson(dialogOptions.filter);}}}
function nodeExpandedHandler(ev,args){if(angular.isArray(args.children)){_.each(args.children,function(child){if(child.metaData.isContainer){child.hasChildren=true;child.children=[{level:child.level+1,hasChildren:false,parent:function(){return child;},name:searchText,metaData:{listViewNode:child,},cssClass:"icon-search",cssClasses:["not-published"]}];child.cssClasses.push("tree-node-slide-up");var listViewResults=_.filter($scope.searchInfo.selectedSearchResults,function(i){return i.parentId==child.id;});_.each(listViewResults,function(item){child.children.unshift({id:item.id,name:item.name,cssClass:"icon umb-tree-icon sprTree "+item.icon,level:child.level+1,metaData:{isSearchResult:true},hasChildren:false,parent:function(){return child;}});});}
var exists=_.find($scope.searchInfo.selectedSearchResults,function(selected){return child.id==selected.id;});if(exists){child.selected=true;}});performFiltering(args.children);}}
function treeLoadedHandler(ev,args){tree=args.tree;}
function nodeSelectHandler(ev,args){args.event.preventDefault();args.event.stopPropagation();if(args.node.metaData.listViewNode){$scope.searchInfo.showSearch=true;$scope.searchInfo.searchFromId=args.node.metaData.listViewNode.id;$scope.searchInfo.searchFromName=args.node.metaData.listViewNode.name;var listViewNode=args.node.parent();listViewNode.cssClasses.push('tree-node-slide-up-hide-active');}
else if(args.node.metaData.isSearchResult){select(args.node.name,args.node.id);var listView=args.node.parent();listView.children=_.reject(listView.children,function(child){return child.id==args.node.id;});$scope.searchInfo.selectedSearchResults=_.reject($scope.searchInfo.selectedSearchResults,function(i){return i.id==args.node.id;});}
else{eventsService.emit("dialogs.treePickerController.select",args);if(args.node.filtered){return;}
select(args.node.name,args.node.id);args.node.selected=args.node.selected===true?false:true;}}
function select(text,id,entity){if(id<0){if($scope.multiPicker){$scope.select(id);}
else{var node={alias:null,icon:"icon-folder",id:id,name:text};$scope.submit(node);}}
else{if($scope.multiPicker){$scope.select(Number(id));}
else{$scope.hideSearch();if(entity){$scope.submit(entity);}else{entityResource.getById(id,entityType).then(function(ent){$scope.submit(ent);});}}}}
function performFiltering(nodes){if(!dialogOptions.filter){return;}
nodes=_.filter(nodes,function(n){return!angular.isObject(n.metaData.listViewNode);});if(dialogOptions.filterAdvanced){var filtered=angular.isFunction(dialogOptions.filter)?_.filter(nodes,dialogOptions.filter):_.where(nodes,dialogOptions.filter);angular.forEach(filtered,function(value,key){value.filtered=true;if(dialogOptions.filterCssClass){if(!value.cssClasses){value.cssClasses=[];}
value.cssClasses.push(dialogOptions.filterCssClass);}});}else{var a=dialogOptions.filter.toLowerCase().split(',');angular.forEach(nodes,function(value,key){var found=a.indexOf(value.metaData.contentType.toLowerCase())>=0;if(!dialogOptions.filterExclude&&!found||dialogOptions.filterExclude&&found){value.filtered=true;if(dialogOptions.filterCssClass){if(!value.cssClasses){value.cssClasses=[];}
value.cssClasses.push(dialogOptions.filterCssClass);}}});}}
$scope.multiSubmit=function(result){entityResource.getByIds(result,entityType).then(function(ents){$scope.submit(ents);});};$scope.selectResult=function(evt,result){if(result.filtered){return;}
result.selected=result.selected===true?false:true;select(result.name,result.id,result);if(result.selected){$scope.searchInfo.selectedSearchResults.push(result);}
else{$scope.searchInfo.selectedSearchResults=_.reject($scope.searchInfo.selectedSearchResults,function(i){return i.id==result.id;});}
if(tree){var found=treeService.getDescendantNode(tree.root,result.id);if(found){found.selected=result.selected;}}};$scope.hideSearch=function(){if(tree){function checkChildren(children){_.each(children,function(child){var exists=_.find($scope.searchInfo.selectedSearchResults,function(selected){return child.id==selected.id;});if(exists){child.selected=true;}
else if(child.metaData.isSearchResult){var listView=child.parent();listView.children=_.reject(listView.children,function(c){return c.id==child.id;});}
if(child.metaData.isContainer){child.cssClasses=_.reject(child.cssClasses,function(c){return c==='tree-node-slide-up-hide-active';});var listViewResults=_.filter($scope.searchInfo.selectedSearchResults,function(i){return i.parentId==child.id;});_.each(listViewResults,function(item){var childExists=_.find(child.children,function(c){return c.id==item.id;});if(!childExists){var parent=child;child.children.unshift({id:item.id,name:item.name,cssClass:"icon umb-tree-icon sprTree "+item.icon,level:child.level+1,metaData:{isSearchResult:true},hasChildren:false,parent:function(){return parent;}});}});}
if(child.children&&child.children.length>0){checkChildren(child.children);}});}
checkChildren(tree.root.children);}
$scope.searchInfo.showSearch=false;$scope.searchInfo.searchFromId=dialogOptions.startNodeId;$scope.searchInfo.searchFromName=null;$scope.searchInfo.results=[];}
$scope.onSearchResults=function(results){performFiltering(results);results=_.filter(results,function(item){return!item.filtered;});$scope.searchInfo.results=results;_.each($scope.searchInfo.results,function(result){var exists=_.find($scope.dialogData.selection,function(selectedId){return result.id==selectedId;});if(exists){result.selected=true;}});$scope.searchInfo.showSearch=true;};$scope.dialogTreeEventHandler.bind("treeLoaded",treeLoadedHandler);$scope.dialogTreeEventHandler.bind("treeNodeExpanded",nodeExpandedHandler);$scope.dialogTreeEventHandler.bind("treeNodeSelect",nodeSelectHandler);$scope.$on('$destroy',function(){$scope.dialogTreeEventHandler.unbind("treeLoaded",treeLoadedHandler);$scope.dialogTreeEventHandler.unbind("treeNodeExpanded",nodeExpandedHandler);$scope.dialogTreeEventHandler.unbind("treeNodeSelect",nodeSelectHandler);});});angular.module("umbraco").controller("Umbraco.Dialogs.UserController",function($scope,$location,$timeout,userService,historyService,eventsService,externalLoginInfo,authResource,currentUserResource,formHelper){$scope.history=historyService.getCurrent();$scope.version=Umbraco.Sys.ServerVariables.application.version+" assembly: "+Umbraco.Sys.ServerVariables.application.assemblyVersion;$scope.showPasswordFields=false;$scope.changePasswordButtonState="init";$scope.externalLoginProviders=externalLoginInfo.providers;$scope.externalLinkLoginFormAction=Umbraco.Sys.ServerVariables.umbracoUrls.externalLinkLoginsUrl;var evts=[];evts.push(eventsService.on("historyService.add",function(e,args){$scope.history=args.all;}));evts.push(eventsService.on("historyService.remove",function(e,args){$scope.history=args.all;}));evts.push(eventsService.on("historyService.removeAll",function(e,args){$scope.history=[];}));$scope.logout=function(){var pendingChangeEvent=eventsService.on("valFormManager.pendingChanges",function(e,args){pendingChangeEvent();$scope.close();});$scope.close();$location.path("/logout");};$scope.gotoHistory=function(link){$location.path(link);$scope.close();};function updateTimeout(){$timeout(function(){if($scope.remainingAuthSeconds>0){$scope.remainingAuthSeconds--;$scope.$digest();updateTimeout();}},1000,false);}
function updateUserInfo(){userService.getCurrentUser().then(function(user){$scope.user=user;if($scope.user){$scope.remainingAuthSeconds=$scope.user.remainingAuthSeconds;$scope.canEditProfile=_.indexOf($scope.user.allowedSections,"users")>-1;updateTimeout();authResource.getCurrentUserLinkedLogins().then(function(logins){for(var provider in $scope.externalLoginProviders){$scope.externalLoginProviders[provider].linkedProviderKey=undefined;}
for(var login in logins){var found=_.find($scope.externalLoginProviders,function(i){return i.authType==login;});if(found){found.linkedProviderKey=logins[login];}}});}});}
$scope.unlink=function(e,loginProvider,providerKey){var result=confirm("Are you sure you want to unlink this account?");if(!result){e.preventDefault();return;}
authResource.unlinkLogin(loginProvider,providerKey).then(function(a,b,c){updateUserInfo();});}
updateUserInfo();$scope.$on('$destroy',function(){for(var e=0;e<evts.length;e++){evts[e]();}});$scope.changePasswordModel={alias:"_umb_password",view:"changepassword",config:{},value:{}};currentUserResource.getMembershipProviderConfig().then(function(data){$scope.changePasswordModel.config=data;$scope.changePasswordModel.config.hasPassword=true;$scope.changePasswordModel.config.disableToggle=true;$scope.changePasswordModel.config.enableReset=false;});$scope.changePassword=function(){if(formHelper.submitForm({scope:$scope})){$scope.changePasswordButtonState="busy";currentUserResource.changePassword($scope.changePasswordModel.value).then(function(data){if(data.value){$scope.changePasswordModel.value.generatedPassword=data.value;}
formHelper.resetForm({scope:$scope,notifications:data.notifications});$scope.changePasswordButtonState="success";},function(err){formHelper.handleError(err);$scope.changePasswordButtonState="error";});}};$scope.togglePasswordFields=function(){clearPasswordFields();$scope.showPasswordFields=!$scope.showPasswordFields;}
function clearPasswordFields(){$scope.changePasswordModel.value.newPassword="";$scope.changePasswordModel.confirm="";}});function YsodController($scope,legacyResource,treeService,navigationService){if($scope.error&&$scope.error.data&&$scope.error.data.StackTrace){$scope.error.data.StackTrace=$scope.error.data.StackTrace.trim();}
$scope.closeDialog=function(){$scope.dismiss();};}
angular.module("umbraco").controller("Umbraco.Dialogs.YsodController",YsodController);function LegacyController($scope,$routeParams,$element){var url=decodeURIComponent($routeParams.url.replace(/javascript\:/gi,""));var urlParts=url.split("?");var extIndex=urlParts[0].lastIndexOf(".");var ext=extIndex===-1?"":urlParts[0].substr(extIndex);if(ext!==".js"||ext===""){var toClean="*(){}[];:<>\\|'\"";for(var i=0;i<toClean.length;i++){var reg=new RegExp("\\"+toClean[i],"g");urlParts[0]=urlParts[0].replace(reg,"");}
url=urlParts[0]+(urlParts.length===1?"":("?"+urlParts[1]));$scope.legacyPath=url;}
else{throw"Invalid url";}}
angular.module("umbraco").controller('Umbraco.LegacyController',LegacyController);angular.module('umbraco').controller("Umbraco.LoginController",function(eventsService,$scope,userService,$location,$rootScope){userService._showLoginDialog();var evtOn=eventsService.on("app.ready",function(evt,data){$scope.avatar="assets/img/application/logo.png";var path="/";var locationObj=$location.search();if(locationObj.returnPath){path=decodeURIComponent(locationObj.returnPath);}
$location.url(path);});$scope.$on('$destroy',function(){eventsService.unsubscribe(evtOn);});});angular.module("umbraco").controller("Umbraco.Notifications.ConfirmRouteChangeController",function($scope,$location,$log,notificationsService){$scope.discard=function(not){not.args.listener();$location.search("");var parts=not.args.path.split("?");var query={};if(parts.length>1){_.each(parts[1].split("&"),function(q){var keyVal=q.split("=");query[keyVal[0]]=keyVal[1];});}
$location.path(parts[0]).search(query);notificationsService.remove(not);};$scope.stay=function(not){notificationsService.remove(not);};});(function(){"use strict";function CompositionsOverlay($scope){var vm=this;vm.isSelected=isSelected;function isSelected(alias){if($scope.model.contentType.compositeContentTypes.indexOf(alias)!==-1){return true;}}}
angular.module("umbraco").controller("Umbraco.Overlays.CompositionsOverlay",CompositionsOverlay);})();(function(){"use strict";function EditorPickerOverlay($scope,dataTypeResource,dataTypeHelper,contentTypeResource,localizationService){var vm=this;if(!$scope.model.title){$scope.model.title=localizationService.localize("defaultdialogs_selectEditor");}
vm.searchTerm="";vm.showTabs=false;vm.tabsLoaded=0;vm.typesAndEditors=[];vm.userConfigured=[];vm.loading=false;vm.tabs=[{active:true,id:1,label:localizationService.localize("contentTypeEditor_availableEditors"),alias:"Default",typesAndEditors:[]},{active:false,id:2,label:localizationService.localize("contentTypeEditor_reuse"),alias:"Reuse",userConfigured:[]}];vm.filterItems=filterItems;vm.showDetailsOverlay=showDetailsOverlay;vm.hideDetailsOverlay=hideDetailsOverlay;vm.pickEditor=pickEditor;vm.pickDataType=pickDataType;function activate(){getGroupedDataTypes();getGroupedPropertyEditors();}
function getGroupedPropertyEditors(){vm.loading=true;dataTypeResource.getGroupedPropertyEditors().then(function(data){vm.tabs[0].typesAndEditors=data;vm.typesAndEditors=data;vm.tabsLoaded=vm.tabsLoaded+1;checkIfTabContentIsLoaded();});}
function getGroupedDataTypes(){vm.loading=true;dataTypeResource.getGroupedDataTypes().then(function(data){vm.tabs[1].userConfigured=data;vm.userConfigured=data;vm.tabsLoaded=vm.tabsLoaded+1;checkIfTabContentIsLoaded();});}
function checkIfTabContentIsLoaded(){if(vm.tabsLoaded===2){vm.loading=false;vm.showTabs=true;}}
function filterItems(){$scope.model.itemDetails=null;if(vm.searchTerm){vm.showFilterResult=true;vm.showTabs=false;}else{vm.showFilterResult=false;vm.showTabs=true;}}
function showDetailsOverlay(property){var propertyDetails={};propertyDetails.icon=property.icon;propertyDetails.title=property.name;$scope.model.itemDetails=propertyDetails;}
function hideDetailsOverlay(){$scope.model.itemDetails=null;}
function pickEditor(editor){var parentId=-1;dataTypeResource.getScaffold(parentId).then(function(dataType){dataType.selectedEditor=editor.alias;var nameArray=[];if($scope.model.contentTypeName){nameArray.push($scope.model.contentTypeName);}
if($scope.model.property.label){nameArray.push($scope.model.property.label);}
if(editor.name){nameArray.push(editor.name);}
dataType.name=nameArray.join(" - ");dataTypeResource.getPreValues(dataType.selectedEditor).then(function(preValues){dataType.preValues=preValues;openEditorSettingsOverlay(dataType,true);});});}
function pickDataType(selectedDataType){dataTypeResource.getById(selectedDataType.id).then(function(dataType){contentTypeResource.getPropertyTypeScaffold(dataType.id).then(function(propertyType){submitOverlay(dataType,propertyType,false);});});}
function openEditorSettingsOverlay(dataType,isNew){vm.editorSettingsOverlay={title:localizationService.localize("contentTypeEditor_editorSettings"),dataType:dataType,view:"views/common/overlays/contenttypeeditor/editorsettings/editorsettings.html",show:true,submit:function(model){var preValues=dataTypeHelper.createPreValueProps(model.dataType.preValues);dataTypeResource.save(model.dataType,preValues,isNew).then(function(newDataType){contentTypeResource.getPropertyTypeScaffold(newDataType.id).then(function(propertyType){submitOverlay(newDataType,propertyType,true);vm.editorSettingsOverlay.show=false;vm.editorSettingsOverlay=null;});});}};}
function submitOverlay(dataType,propertyType,isNew){$scope.model.property.config=propertyType.config;$scope.model.property.editor=propertyType.editor;$scope.model.property.view=propertyType.view;$scope.model.property.dataTypeId=dataType.id;$scope.model.property.dataTypeIcon=dataType.icon;$scope.model.property.dataTypeName=dataType.name;$scope.model.updateSameDataTypes=isNew;$scope.model.submit($scope.model);}
activate();}
angular.module("umbraco").controller("Umbraco.Overlays.EditorPickerOverlay",EditorPickerOverlay);})();(function(){"use strict";function PropertySettingsOverlay($scope,contentTypeResource,dataTypeResource,dataTypeHelper,localizationService){var vm=this;vm.showValidationPattern=false;vm.focusOnPatternField=false;vm.focusOnMandatoryField=false;vm.selectedValidationType={};vm.validationTypes=[{"name":localizationService.localize("validation_validateAsEmail"),"key":"email","pattern":"[a-zA-Z0-9_\.\+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-\.]+","enableEditing":true},{"name":localizationService.localize("validation_validateAsNumber"),"key":"number","pattern":"^[0-9]*$","enableEditing":true},{"name":localizationService.localize("validation_validateAsUrl"),"key":"url","pattern":"https?\:\/\/[a-zA-Z0-9\-\.]+\.[a-zA-Z]{2,}","enableEditing":true},{"name":localizationService.localize("validation_enterCustomValidation"),"key":"custom","pattern":"","enableEditing":true}];vm.changeValidationType=changeValidationType;vm.changeValidationPattern=changeValidationPattern;vm.openEditorPickerOverlay=openEditorPickerOverlay;vm.openEditorSettingsOverlay=openEditorSettingsOverlay;function activate(){matchValidationType();}
function changeValidationPattern(){matchValidationType();}
function openEditorPickerOverlay(property){vm.focusOnMandatoryField=false;vm.editorPickerOverlay={};vm.editorPickerOverlay.property=$scope.model.property;vm.editorPickerOverlay.contentTypeName=$scope.model.contentTypeName;vm.editorPickerOverlay.view="views/common/overlays/contenttypeeditor/editorpicker/editorpicker.html";vm.editorPickerOverlay.show=true;vm.editorPickerOverlay.submit=function(model){$scope.model.updateSameDataTypes=model.updateSameDataTypes;vm.focusOnMandatoryField=true;property.config=model.property.config;property.editor=model.property.editor;property.view=model.property.view;property.dataTypeId=model.property.dataTypeId;property.dataTypeIcon=model.property.dataTypeIcon;property.dataTypeName=model.property.dataTypeName;vm.editorPickerOverlay.show=false;vm.editorPickerOverlay=null;};vm.editorPickerOverlay.close=function(model){vm.editorPickerOverlay.show=false;vm.editorPickerOverlay=null;};}
function openEditorSettingsOverlay(property){vm.focusOnMandatoryField=false;dataTypeResource.getById(property.dataTypeId).then(function(dataType){vm.editorSettingsOverlay={};vm.editorSettingsOverlay.title="Editor settings";vm.editorSettingsOverlay.view="views/common/overlays/contenttypeeditor/editorsettings/editorsettings.html";vm.editorSettingsOverlay.dataType=dataType;vm.editorSettingsOverlay.show=true;vm.editorSettingsOverlay.submit=function(model){var preValues=dataTypeHelper.createPreValueProps(model.dataType.preValues);dataTypeResource.save(model.dataType,preValues,false).then(function(newDataType){contentTypeResource.getPropertyTypeScaffold(newDataType.id).then(function(propertyType){property.config=propertyType.config;property.editor=propertyType.editor;property.view=propertyType.view;property.dataTypeId=newDataType.id;property.dataTypeIcon=newDataType.icon;property.dataTypeName=newDataType.name;$scope.model.updateSameDataTypes=true;vm.focusOnMandatoryField=true;vm.editorSettingsOverlay.show=false;vm.editorSettingsOverlay=null;});});};vm.editorSettingsOverlay.close=function(oldModel){vm.editorSettingsOverlay.show=false;vm.editorSettingsOverlay=null;};});}
function matchValidationType(){if($scope.model.property.validation.pattern!==null&&$scope.model.property.validation.pattern!==""&&$scope.model.property.validation.pattern!==undefined){var match=false;angular.forEach(vm.validationTypes,function(validationType,index){if($scope.model.property.validation.pattern===validationType.pattern){vm.selectedValidationType=vm.validationTypes[index];vm.showValidationPattern=true;match=true;}});if(!match){angular.forEach(vm.validationTypes,function(validationType){if(validationType.key==="custom"){vm.selectedValidationType=validationType;vm.showValidationPattern=true;}});}}}
function changeValidationType(selectedValidationType){if(selectedValidationType){$scope.model.property.validation.pattern=selectedValidationType.pattern;vm.showValidationPattern=true;if(selectedValidationType.key==="custom"){vm.focusOnPatternField=true;}}else{$scope.model.property.validation.pattern="";vm.showValidationPattern=false;}}
activate();}
angular.module("umbraco").controller("Umbraco.Overlay.PropertySettingsOverlay",PropertySettingsOverlay);})();(function(){"use strict";function CopyOverlay($scope,localizationService,eventsService){var vm=this;if(!$scope.model.title){$scope.model.title=localizationService.localize("general_copy");}
vm.hideSearch=hideSearch;vm.selectResult=selectResult;vm.onSearchResults=onSearchResults;var dialogOptions=$scope.model;var searchText="Search...";var node=dialogOptions.currentNode;localizationService.localize("general_search").then(function(value){searchText=value+"...";});$scope.model.relateToOriginal=true;$scope.dialogTreeEventHandler=$({});vm.searchInfo={searchFromId:null,searchFromName:null,showSearch:false,results:[],selectedSearchResults:[]};function nodeSelectHandler(ev,args){args.event.preventDefault();args.event.stopPropagation();if(args.node.metaData.listViewNode){vm.searchInfo.showSearch=true;vm.searchInfo.searchFromId=args.node.metaData.listViewNode.id;vm.searchInfo.searchFromName=args.node.metaData.listViewNode.name;}
else{if($scope.model.target){$scope.model.target.selected=false;}
$scope.model.target=args.node;$scope.model.target.selected=true;}}
function nodeExpandedHandler(ev,args){if(angular.isArray(args.children)){_.each(args.children,function(child){if(child.metaData.isContainer){child.hasChildren=true;child.children=[{level:child.level+1,hasChildren:false,name:searchText,metaData:{listViewNode:child,},cssClass:"icon umb-tree-icon sprTree icon-search",cssClasses:["not-published"]}];}});}}
function hideSearch(){vm.searchInfo.showSearch=false;vm.searchInfo.searchFromId=null;vm.searchInfo.searchFromName=null;vm.searchInfo.results=[];}
function selectResult(evt,result){result.selected=result.selected===true?false:true;nodeSelectHandler(evt,{event:evt,node:result});}
function onSearchResults(results){vm.searchInfo.results=results;vm.searchInfo.showSearch=true;}
$scope.dialogTreeEventHandler.bind("treeNodeSelect",nodeSelectHandler);$scope.dialogTreeEventHandler.bind("treeNodeExpanded",nodeExpandedHandler);$scope.$on('$destroy',function(){$scope.dialogTreeEventHandler.unbind("treeNodeSelect",nodeSelectHandler);$scope.dialogTreeEventHandler.unbind("treeNodeExpanded",nodeExpandedHandler);});}
angular.module("umbraco").controller("Umbraco.Overlays.CopyOverlay",CopyOverlay);})();(function(){"use strict";function EmbedOverlay($scope,$http,umbRequestHelper,localizationService){var vm=this;var origWidth=500;var origHeight=300;if(!$scope.model.title){$scope.model.title=localizationService.localize("general_embed");}
$scope.model.embed={url:"",width:360,height:240,constrain:true,preview:"",success:false,info:"",supportsDimensions:""};vm.showPreview=showPreview;vm.changeSize=changeSize;function showPreview(){if($scope.model.embed.url){$scope.model.embed.show=true;$scope.model.embed.preview="<div class=\"umb-loader\" style=\"height: 10px; margin: 10px 0px;\"></div>";$scope.model.embed.info="";$scope.model.embed.success=false;$http({method:'GET',url:umbRequestHelper.getApiUrl("embedApiBaseUrl","GetEmbed"),params:{url:$scope.model.embed.url,width:$scope.model.embed.width,height:$scope.model.embed.height}}).success(function(data){$scope.model.embed.preview="";switch(data.Status){case 0:$scope.model.embed.info="Not supported";break;case 1:$scope.model.embed.info="Computer says no";break;case 2:$scope.model.embed.preview=data.Markup;$scope.model.embed.supportsDimensions=data.SupportsDimensions;$scope.model.embed.success=true;break;}}).error(function(){$scope.model.embed.supportsDimensions=false;$scope.model.embed.preview="";$scope.model.embed.info="Computer says no";});}else{$scope.model.embed.supportsDimensions=false;$scope.model.embed.preview="";$scope.model.embed.info="Please enter a URL";}}
function changeSize(type){var width,height;if($scope.model.embed.constrain){width=parseInt($scope.model.embed.width,10);height=parseInt($scope.model.embed.height,10);if(type=='width'){origHeight=Math.round((width/origWidth)*height);$scope.model.embed.height=origHeight;}else{origWidth=Math.round((height/origHeight)*width);$scope.model.embed.width=origWidth;}}
if($scope.model.embed.url!==""){showPreview();}}}
angular.module("umbraco").controller("Umbraco.Overlays.EmbedOverlay",EmbedOverlay);})();angular.module("umbraco").controller("Umbraco.Overlays.HelpController",function($scope,$location,$routeParams,helpService,userService,localizationService){$scope.section=$routeParams.section;$scope.version=Umbraco.Sys.ServerVariables.application.version+" assembly: "+Umbraco.Sys.ServerVariables.application.assemblyVersion;$scope.model.subtitle="Umbraco version"+" "+$scope.version;if(!$scope.model.title){$scope.model.title=localizationService.localize("general_help");}
if(!$scope.section){$scope.section="content";}
$scope.sectionName=$scope.section;var rq={};rq.section=$scope.section;localizationService.localize("sections_"+rq.section).then(function(value){$scope.sectionName=value;});userService.getCurrentUser().then(function(user){rq.usertype=user.userType;rq.lang=user.locale;if($routeParams.url){rq.path=decodeURIComponent($routeParams.url);if(rq.path.indexOf(Umbraco.Sys.ServerVariables.umbracoSettings.umbracoPath)===0){rq.path=rq.path.substring(Umbraco.Sys.ServerVariables.umbracoSettings.umbracoPath.length);}
if(rq.path.indexOf(".aspx")>0){rq.path=rq.path.substring(0,rq.path.indexOf(".aspx"));}}else{rq.path=rq.section+"/"+$routeParams.tree+"/"+$routeParams.method;}
helpService.findHelp(rq).then(function(topics){$scope.topics=topics;});helpService.findVideos(rq).then(function(videos){$scope.videos=videos;});});});function IconPickerOverlay($scope,iconHelper,localizationService){$scope.loading=true;$scope.model.hideSubmitButton=true;if(!$scope.model.title){$scope.model.title=localizationService.localize("defaultdialogs_selectIcon");}
iconHelper.getIcons().then(function(icons){$scope.icons=icons;$scope.loading=false;});$scope.selectIcon=function(icon,color){$scope.model.icon=icon;$scope.model.color=color;$scope.submitForm($scope.model);};}
angular.module("umbraco").controller("Umbraco.Overlays.IconPickerOverlay",IconPickerOverlay);function ItemPickerOverlay($scope,localizationService){if(!$scope.model.title){$scope.model.title=localizationService.localize("defaultdialogs_selectItem");}
$scope.model.hideSubmitButton=true;$scope.selectItem=function(item){$scope.model.selectedItem=item;$scope.submitForm($scope.model);};}
angular.module("umbraco").controller("Umbraco.Overlays.ItemPickerOverlay",ItemPickerOverlay);angular.module("umbraco").controller("Umbraco.Overlays.LinkPickerController",function($scope,eventsService,dialogService,entityResource,contentResource,mediaHelper,userService,localizationService){var dialogOptions=$scope.model;var searchText="Search...";localizationService.localize("general_search").then(function(value){searchText=value+"...";});if(!$scope.model.title){$scope.model.title=localizationService.localize("defaultdialogs_selectLink");}
$scope.dialogTreeEventHandler=$({});$scope.model.target={};$scope.searchInfo={searchFromId:null,searchFromName:null,showSearch:false,results:[],selectedSearchResults:[]};if(dialogOptions.currentTarget){$scope.model.target=dialogOptions.currentTarget;if($scope.model.target.id){if(!$scope.model.target.path){entityResource.getPath($scope.model.target.id,"Document").then(function(path){$scope.model.target.path=path;$scope.dialogTreeEventHandler.syncTree({path:$scope.model.target.path,tree:"content"});});}
contentResource.getNiceUrl($scope.model.target.id).then(function(url){$scope.model.target.url=url;});}}
function nodeSelectHandler(ev,args){args.event.preventDefault();args.event.stopPropagation();if(args.node.metaData.listViewNode){$scope.searchInfo.showSearch=true;$scope.searchInfo.searchFromId=args.node.metaData.listViewNode.id;$scope.searchInfo.searchFromName=args.node.metaData.listViewNode.name;}
else{eventsService.emit("dialogs.linkPicker.select",args);if($scope.currentNode){$scope.currentNode.selected=false;}
$scope.currentNode=args.node;$scope.currentNode.selected=true;$scope.model.target.id=args.node.id;$scope.model.target.name=args.node.name;if(args.node.id<0){$scope.model.target.url="/";}
else{contentResource.getNiceUrl(args.node.id).then(function(url){$scope.model.target.url=url;});}
if(!angular.isUndefined($scope.model.target.isMedia)){delete $scope.model.target.isMedia;}}}
function nodeExpandedHandler(ev,args){if(angular.isArray(args.children)){_.each(args.children,function(child){if(child.metaData.isContainer){child.hasChildren=true;child.children=[{level:child.level+1,hasChildren:false,name:searchText,metaData:{listViewNode:child,},cssClass:"icon umb-tree-icon sprTree icon-search",cssClasses:["not-published"]}];}});}}
$scope.switchToMediaPicker=function(){userService.getCurrentUser().then(function(userData){$scope.mediaPickerOverlay={view:"mediapicker",startNodeId:userData.startMediaId,show:true,submit:function(model){var media=model.selectedImages[0];$scope.model.target.id=media.id;$scope.model.target.isMedia=true;$scope.model.target.name=media.name;$scope.model.target.url=mediaHelper.resolveFile(media);$scope.mediaPickerOverlay.show=false;$scope.mediaPickerOverlay=null;}};});};$scope.hideSearch=function(){$scope.searchInfo.showSearch=false;$scope.searchInfo.searchFromId=null;$scope.searchInfo.searchFromName=null;$scope.searchInfo.results=[];}
$scope.selectResult=function(evt,result){result.selected=result.selected===true?false:true;nodeSelectHandler(evt,{event:evt,node:result});};$scope.onSearchResults=function(results){$scope.searchInfo.results=results;$scope.searchInfo.showSearch=true;};$scope.dialogTreeEventHandler.bind("treeNodeSelect",nodeSelectHandler);$scope.dialogTreeEventHandler.bind("treeNodeExpanded",nodeExpandedHandler);$scope.$on('$destroy',function(){$scope.dialogTreeEventHandler.unbind("treeNodeSelect",nodeSelectHandler);$scope.dialogTreeEventHandler.unbind("treeNodeExpanded",nodeExpandedHandler);});});function MacroPickerController($scope,entityResource,macroResource,umbPropEditorHelper,macroService,formHelper,localizationService){if(!$scope.model.title){$scope.model.title=localizationService.localize("defaultdialogs_selectMacro");}
$scope.macros=[];$scope.model.selectedMacro=null;$scope.wizardStep="macroSelect";$scope.model.macroParams=[];$scope.noMacroParams=false;$scope.changeMacro=function(){if($scope.wizardStep==="macroSelect"){editParams();}else{submitForm();}};function editParams(){macroResource.getMacroParameters($scope.model.selectedMacro.id).then(function(data){if(!angular.isArray(data)||data.length===0){$scope.noMacroParams=true;}else{$scope.wizardStep="paramSelect";$scope.model.macroParams=data;if($scope.model.dialogData&&$scope.model.dialogData.macroData&&$scope.model.dialogData.macroData.macroParamsDictionary){_.each($scope.model.dialogData.macroData.macroParamsDictionary,function(val,key){var prop=_.find($scope.model.macroParams,function(item){return item.alias==key;});if(prop){if(_.isString(val)){val=_.unescape(val);if(val.detectIsJson()){try{prop.value=angular.fromJson(val);}
catch(e){prop.value=val;}}
else{prop.value=val;}}
else{prop.value=val;}}});}}});}
if($scope.model.dialogData&&$scope.model.dialogData.macroData){$scope.wizardStep="paramSelect";}
entityResource.getAll("Macro",($scope.model.dialogData&&$scope.model.dialogData.richTextEditor&&$scope.model.dialogData.richTextEditor===true)?"UseInEditor=true":null).then(function(data){if(angular.isArray($scope.model.dialogData.allowedMacros)&&$scope.model.dialogData.allowedMacros.length>0){$scope.macros=_.filter(data,function(d){return _.contains($scope.model.dialogData.allowedMacros,d.alias);});}
else{$scope.macros=data;}
if($scope.model.dialogData&&$scope.model.dialogData.macroData&&$scope.model.dialogData.macroData.macroAlias){var found=_.find(data,function(item){return item.alias===$scope.model.dialogData.macroData.macroAlias;});if(found){$scope.model.selectedMacro=found;editParams();return;}}
$scope.wizardStep="macroSelect";});}
angular.module("umbraco").controller("Umbraco.Overlays.MacroPickerController",MacroPickerController);angular.module("umbraco").controller("Umbraco.Overlays.MediaPickerController",function($scope,mediaResource,umbRequestHelper,entityResource,$log,mediaHelper,eventsService,treeService,$element,$timeout,$cookies,$cookieStore,localizationService){if(!$scope.model.title){$scope.model.title=localizationService.localize("defaultdialogs_selectMedia");}
var dialogOptions=$scope.model;$scope.disableFolderSelect=dialogOptions.disableFolderSelect;$scope.onlyImages=dialogOptions.onlyImages;$scope.showDetails=dialogOptions.showDetails;$scope.multiPicker=(dialogOptions.multiPicker&&dialogOptions.multiPicker!=="0")?true:false;$scope.startNodeId=dialogOptions.startNodeId?dialogOptions.startNodeId:-1;$scope.cropSize=dialogOptions.cropSize;$scope.lastOpenedNode=$cookieStore.get("umbLastOpenedMediaNodeId");if($scope.onlyImages){$scope.acceptedFileTypes=mediaHelper.formatFileTypes(Umbraco.Sys.ServerVariables.umbracoSettings.imageFileTypes);}
else{$scope.acceptedFileTypes=!mediaHelper.formatFileTypes(Umbraco.Sys.ServerVariables.umbracoSettings.disallowedUploadFiles);}
$scope.maxFileSize=Umbraco.Sys.ServerVariables.umbracoSettings.maxFileSize+"KB";$scope.model.selectedImages=[];$scope.target=undefined;if(dialogOptions.currentTarget){$scope.target=dialogOptions.currentTarget;}
$scope.upload=function(v){angular.element(".umb-file-dropzone-directive .file-select").click();};$scope.dragLeave=function(el,event){$scope.activeDrag=false;};$scope.dragEnter=function(el,event){$scope.activeDrag=true;};$scope.submitFolder=function(){if($scope.newFolderName){mediaResource.addFolder($scope.newFolderName,$scope.currentFolder.id).then(function(data){treeService.clearCache({cacheKey:"__media",childrenOf:data.parentId});$scope.gotoFolder(data);$scope.showFolderInput=false;$scope.newFolderName="";});}else{$scope.showFolderInput=false;}};$scope.enterSubmitFolder=function(event){if(event.keyCode===13){$scope.submitFolder();event.stopPropagation();}};$scope.gotoFolder=function(folder){if(!$scope.multiPicker){deselectAllImages($scope.model.selectedImages);}
if(!folder){folder={id:-1,name:"Media",icon:"icon-folder"};}
if(folder.id>0){entityResource.getAncestors(folder.id,"media").then(function(anc){$scope.path=_.filter(anc,function(f){return f.path.indexOf($scope.startNodeId)!==-1;});});}
else{$scope.path=[];}
mediaResource.getChildren(folder.id).then(function(data){$scope.searchTerm="";$scope.images=data.items?data.items:[];for(var folderImageIndex=0;folderImageIndex<$scope.images.length;folderImageIndex++){var folderImage=$scope.images[folderImageIndex];var imageIsSelected=false;for(var selectedImageIndex=0;selectedImageIndex<$scope.model.selectedImages.length;selectedImageIndex++){var selectedImage=$scope.model.selectedImages[selectedImageIndex];if(folderImage.key===selectedImage.key){imageIsSelected=true;}}
if(imageIsSelected){folderImage.selected=true;}}});$scope.currentFolder=folder;document.cookie="umbLastOpenedMediaNodeId="+folder.id;};$scope.clickHandler=function(image,event,index){if(image.isFolder){if($scope.disableFolderSelect){$scope.gotoFolder(image);}else{eventsService.emit("dialogs.mediaPicker.select",image);selectImage(image);}}else{eventsService.emit("dialogs.mediaPicker.select",image);if($scope.showDetails){$scope.target=image;$scope.target.url=mediaHelper.resolveFile(image);$scope.openDetailsDialog();}else{selectImage(image);}}};$scope.clickItemName=function(item){if(item.isFolder){$scope.gotoFolder(item);}};function selectImage(image){if(image.selected){for(var i=0;$scope.model.selectedImages.length>i;i++){var imageInSelection=$scope.model.selectedImages[i];if(image.key===imageInSelection.key){image.selected=false;$scope.model.selectedImages.splice(i,1);}}}else{if(!$scope.multiPicker){deselectAllImages($scope.model.selectedImages);}
image.selected=true;$scope.model.selectedImages.push(image);}}
function deselectAllImages(images){for(var i=0;i<images.length;i++){var image=images[i];image.selected=false;}
images.length=0;}
$scope.onUploadComplete=function(){$scope.gotoFolder($scope.currentFolder);};$scope.onFilesQueue=function(){$scope.activeDrag=false;};if(!$scope.target){if($scope.lastOpenedNode&&$scope.lastOpenedNode!==-1){entityResource.getById($scope.lastOpenedNode,"media").then(function(node){var nodePath=node.path.split(",");if(nodePath.indexOf($scope.startNodeId.toString())!==-1){$scope.gotoFolder({id:$scope.lastOpenedNode,name:"Media",icon:"icon-folder"});}else{$scope.gotoFolder({id:$scope.startNodeId,name:"Media",icon:"icon-folder"});}},function(err){$scope.gotoFolder({id:$scope.startNodeId,name:"Media",icon:"icon-folder"});});}else{$scope.gotoFolder({id:$scope.startNodeId,name:"Media",icon:"icon-folder"});}}
$scope.openDetailsDialog=function(){$scope.mediaPickerDetailsOverlay={};$scope.mediaPickerDetailsOverlay.show=true;$scope.mediaPickerDetailsOverlay.submit=function(model){$scope.model.selectedImages.push($scope.target);$scope.model.submit($scope.model);$scope.mediaPickerDetailsOverlay.show=false;$scope.mediaPickerDetailsOverlay=null;};$scope.mediaPickerDetailsOverlay.close=function(oldModel){$scope.mediaPickerDetailsOverlay.show=false;$scope.mediaPickerDetailsOverlay=null;};};});angular.module("umbraco").controller("Umbraco.Overlays.MemberGroupPickerController",function($scope,eventsService,entityResource,searchService,$log,localizationService){if(!$scope.model.title){$scope.model.title=localizationService.localize("defaultdialogs_selectMemberGroup");}
$scope.dialogTreeEventHandler=$({});$scope.multiPicker=$scope.model.multiPicker;function activate(){if($scope.multiPicker){$scope.model.selectedMemberGroups=[];}else{$scope.model.selectedMemberGroup="";}}
function selectMemberGroup(id){$scope.model.selectedMemberGroup=id;}
function selectMemberGroups(id){$scope.model.selectedMemberGroups.push(id);}
function select(text,id){if($scope.model.multiPicker){selectMemberGroups(id);}
else{selectMemberGroup(id);$scope.model.submit($scope.model);}}
function nodeSelectHandler(ev,args){args.event.preventDefault();args.event.stopPropagation();eventsService.emit("dialogs.memberGroupPicker.select",args);select(args.node.name,args.node.id);args.node.selected=args.node.selected===true?false:true;}
$scope.dialogTreeEventHandler.bind("treeNodeSelect",nodeSelectHandler);$scope.$on('$destroy',function(){$scope.dialogTreeEventHandler.unbind("treeNodeSelect",nodeSelectHandler);});activate();});(function(){"use strict";function MoveOverlay($scope,localizationService,eventsService){var vm=this;vm.hideSearch=hideSearch;vm.selectResult=selectResult;vm.onSearchResults=onSearchResults;var dialogOptions=$scope.model;var searchText="Search...";var node=dialogOptions.currentNode;localizationService.localize("general_search").then(function(value){searchText=value+"...";});if(!$scope.model.title){$scope.model.title=localizationService.localize("actions_move");}
$scope.model.relateToOriginal=true;$scope.dialogTreeEventHandler=$({});vm.searchInfo={searchFromId:null,searchFromName:null,showSearch:false,results:[],selectedSearchResults:[]};function nodeSelectHandler(ev,args){args.event.preventDefault();args.event.stopPropagation();if(args.node.metaData.listViewNode){vm.searchInfo.showSearch=true;vm.searchInfo.searchFromId=args.node.metaData.listViewNode.id;vm.searchInfo.searchFromName=args.node.metaData.listViewNode.name;}
else{if($scope.model.target){$scope.model.target.selected=false;}
$scope.model.target=args.node;$scope.model.target.selected=true;}}
function nodeExpandedHandler(ev,args){if(angular.isArray(args.children)){_.each(args.children,function(child){if(child.metaData.isContainer){child.hasChildren=true;child.children=[{level:child.level+1,hasChildren:false,name:searchText,metaData:{listViewNode:child,},cssClass:"icon umb-tree-icon sprTree icon-search",cssClasses:["not-published"]}];}});}}
function hideSearch(){vm.searchInfo.showSearch=false;vm.searchInfo.searchFromId=null;vm.searchInfo.searchFromName=null;vm.searchInfo.results=[];}
function selectResult(evt,result){result.selected=result.selected===true?false:true;nodeSelectHandler(evt,{event:evt,node:result});}
function onSearchResults(results){vm.searchInfo.results=results;vm.searchInfo.showSearch=true;}
$scope.dialogTreeEventHandler.bind("treeNodeSelect",nodeSelectHandler);$scope.dialogTreeEventHandler.bind("treeNodeExpanded",nodeExpandedHandler);$scope.$on('$destroy',function(){$scope.dialogTreeEventHandler.unbind("treeNodeSelect",nodeSelectHandler);$scope.dialogTreeEventHandler.unbind("treeNodeExpanded",nodeExpandedHandler);});}
angular.module("umbraco").controller("Umbraco.Overlays.MoveOverlay",MoveOverlay);})();angular.module("umbraco").controller("Umbraco.Overlays.TreePickerController",function($scope,entityResource,eventsService,$log,searchService,angularHelper,$timeout,localizationService,treeService){var tree=null;var dialogOptions=$scope.model;$scope.dialogTreeEventHandler=$({});$scope.section=dialogOptions.section;$scope.treeAlias=dialogOptions.treeAlias;$scope.multiPicker=dialogOptions.multiPicker;$scope.hideHeader=true;$scope.searchInfo={searchFromId:dialogOptions.startNodeId,searchFromName:null,showSearch:false,results:[],selectedSearchResults:[]}
$scope.model.selection=[];$scope.init=function(contentType){if(contentType==="content"){entityType="Document";if(!$scope.model.title){$scope.model.title=localizationService.localize("defaultdialogs_selectContent");}}else if(contentType==="member"){entityType="Member";if(!$scope.model.title){$scope.model.title=localizationService.localize("defaultdialogs_selectMember");}}else if(contentType==="media"){entityType="Media";if(!$scope.model.title){$scope.model.title=localizationService.localize("defaultdialogs_selectMedia");}}}
$scope.customTreeParams=dialogOptions.startNodeId?"startNodeId="+dialogOptions.startNodeId:"";$scope.customTreeParams+=dialogOptions.customTreeParams?"&"+dialogOptions.customTreeParams:"";var searchText="Search...";localizationService.localize("general_search").then(function(value){searchText=value+"...";});var entityType=dialogOptions.entityType?dialogOptions.entityType:"Document";if(dialogOptions.minNumber){dialogOptions.minNumber=parseInt(dialogOptions.minNumber,10);}
if(dialogOptions.maxNumber){dialogOptions.maxNumber=parseInt(dialogOptions.maxNumber,10);}
if(dialogOptions.section==="member"){entityType="Member";}
else if(dialogOptions.section==="media"){entityType="Media";}
if(dialogOptions.filter){dialogOptions.filterExclude=false;dialogOptions.filterAdvanced=false;if(angular.isFunction(dialogOptions.filter)){dialogOptions.filterAdvanced=true;}
else if(angular.isObject(dialogOptions.filter)){dialogOptions.filterAdvanced=true;}
else{if(dialogOptions.filter.startsWith("!")){dialogOptions.filterExclude=true;dialogOptions.filter=dialogOptions.filter.substring(1);}
if(dialogOptions.filter.startsWith("{")){dialogOptions.filterAdvanced=true;dialogOptions.filter=angular.fromJson(dialogOptions.filter);}}}
function nodeExpandedHandler(ev,args){if(angular.isArray(args.children)){_.each(args.children,function(child){if(child.metaData.isContainer){child.hasChildren=true;child.children=[{level:child.level+1,hasChildren:false,parent:function(){return child;},name:searchText,metaData:{listViewNode:child,},cssClass:"icon-search",cssClasses:["not-published"]}];child.cssClasses.push("tree-node-slide-up");var listViewResults=_.filter($scope.searchInfo.selectedSearchResults,function(i){return i.parentId==child.id;});_.each(listViewResults,function(item){child.children.unshift({id:item.id,name:item.name,cssClass:"icon umb-tree-icon sprTree "+item.icon,level:child.level+1,metaData:{isSearchResult:true},hasChildren:false,parent:function(){return child;}});});}
var exists=_.find($scope.searchInfo.selectedSearchResults,function(selected){return child.id==selected.id;});if(exists){child.selected=true;}});performFiltering(args.children);}}
function treeLoadedHandler(ev,args){tree=args.tree;}
function nodeSelectHandler(ev,args){args.event.preventDefault();args.event.stopPropagation();if(args.node.metaData.listViewNode){$scope.searchInfo.showSearch=true;$scope.searchInfo.searchFromId=args.node.metaData.listViewNode.id;$scope.searchInfo.searchFromName=args.node.metaData.listViewNode.name;var listViewNode=args.node.parent();listViewNode.cssClasses.push('tree-node-slide-up-hide-active');}
else if(args.node.metaData.isSearchResult){select(args.node.name,args.node.id);var listView=args.node.parent();listView.children=_.reject(listView.children,function(child){return child.id==args.node.id;});$scope.searchInfo.selectedSearchResults=_.reject($scope.searchInfo.selectedSearchResults,function(i){return i.id==args.node.id;});}
else{eventsService.emit("dialogs.treePickerController.select",args);if(args.node.filtered){return;}
select(args.node.name,args.node.id);args.node.selected=args.node.selected===true?false:true;}}
function select(text,id,entity){if(id<0){if($scope.multiPicker){if(entity){multiSelectItem(entity);}else{entityResource.getById(id,entityType).then(function(ent){multiSelectItem(ent);});}}
else{var node={alias:null,icon:"icon-folder",id:id,name:text};$scope.model.selection.push(node);$scope.model.submit($scope.model);}}
else{if($scope.multiPicker){if(entity){multiSelectItem(entity);}else{entityResource.getById(id,entityType).then(function(ent){multiSelectItem(ent);});}}
else{$scope.hideSearch();if(entity){$scope.model.selection.push(entity);$scope.model.submit($scope.model);}else{entityResource.getById(id,entityType).then(function(ent){$scope.model.selection.push(ent);$scope.model.submit($scope.model);});}}}}
function multiSelectItem(item){var found=false;var foundIndex=0;if($scope.model.selection.length>0){for(i=0;$scope.model.selection.length>i;i++){var selectedItem=$scope.model.selection[i];if(selectedItem.id===item.id){found=true;foundIndex=i;}}}
if(found){$scope.model.selection.splice(foundIndex,1);}else{$scope.model.selection.push(item);}}
function performFiltering(nodes){if(!dialogOptions.filter){return;}
nodes=_.filter(nodes,function(n){return!angular.isObject(n.metaData.listViewNode);});if(dialogOptions.filterAdvanced){var filtered=angular.isFunction(dialogOptions.filter)?_.filter(nodes,dialogOptions.filter):_.where(nodes,dialogOptions.filter);angular.forEach(filtered,function(value,key){value.filtered=true;if(dialogOptions.filterCssClass){if(!value.cssClasses){value.cssClasses=[];}
value.cssClasses.push(dialogOptions.filterCssClass);}});}else{var a=dialogOptions.filter.toLowerCase().split(',');angular.forEach(nodes,function(value,key){var found=a.indexOf(value.metaData.contentType.toLowerCase())>=0;if(!dialogOptions.filterExclude&&!found||dialogOptions.filterExclude&&found){value.filtered=true;if(dialogOptions.filterCssClass){if(!value.cssClasses){value.cssClasses=[];}
value.cssClasses.push(dialogOptions.filterCssClass);}}});}}
$scope.multiSubmit=function(result){entityResource.getByIds(result,entityType).then(function(ents){$scope.submit(ents);});};$scope.selectResult=function(evt,result){if(result.filtered){return;}
result.selected=result.selected===true?false:true;select(result.name,result.id,result);if(result.selected){$scope.searchInfo.selectedSearchResults.push(result);}
else{$scope.searchInfo.selectedSearchResults=_.reject($scope.searchInfo.selectedSearchResults,function(i){return i.id==result.id;});}
if(tree){var found=treeService.getDescendantNode(tree.root,result.id);if(found){found.selected=result.selected;}}};$scope.hideSearch=function(){if(tree){function checkChildren(children){_.each(children,function(child){var exists=_.find($scope.searchInfo.selectedSearchResults,function(selected){return child.id==selected.id;});if(exists){child.selected=true;}
else if(child.metaData.isSearchResult){var listView=child.parent();listView.children=_.reject(listView.children,function(c){return c.id==child.id;});}
if(child.metaData.isContainer){child.cssClasses=_.reject(child.cssClasses,function(c){return c==='tree-node-slide-up-hide-active';});var listViewResults=_.filter($scope.searchInfo.selectedSearchResults,function(i){return i.parentId==child.id;});_.each(listViewResults,function(item){var childExists=_.find(child.children,function(c){return c.id==item.id;});if(!childExists){var parent=child;child.children.unshift({id:item.id,name:item.name,cssClass:"icon umb-tree-icon sprTree "+item.icon,level:child.level+1,metaData:{isSearchResult:true},hasChildren:false,parent:function(){return parent;}});}});}
if(child.children&&child.children.length>0){checkChildren(child.children);}});}
checkChildren(tree.root.children);}
$scope.searchInfo.showSearch=false;$scope.searchInfo.searchFromId=dialogOptions.startNodeId;$scope.searchInfo.searchFromName=null;$scope.searchInfo.results=[];}
$scope.onSearchResults=function(results){performFiltering(results);results=_.filter(results,function(item){return!item.filtered;});$scope.searchInfo.results=results;_.each($scope.searchInfo.results,function(result){var exists=_.find($scope.model.selection,function(selectedId){return result.id==selectedId;});if(exists){result.selected=true;}});$scope.searchInfo.showSearch=true;};$scope.dialogTreeEventHandler.bind("treeLoaded",treeLoadedHandler);$scope.dialogTreeEventHandler.bind("treeNodeExpanded",nodeExpandedHandler);$scope.dialogTreeEventHandler.bind("treeNodeSelect",nodeSelectHandler);$scope.$on('$destroy',function(){$scope.dialogTreeEventHandler.unbind("treeLoaded",treeLoadedHandler);$scope.dialogTreeEventHandler.unbind("treeNodeExpanded",nodeExpandedHandler);$scope.dialogTreeEventHandler.unbind("treeNodeSelect",nodeSelectHandler);});});angular.module("umbraco").controller("Umbraco.Overlays.UserController",function($scope,$location,$timeout,userService,historyService,eventsService,externalLoginInfo,authResource,currentUserResource,formHelper,localizationService){$scope.history=historyService.getCurrent();$scope.version=Umbraco.Sys.ServerVariables.application.version+" assembly: "+Umbraco.Sys.ServerVariables.application.assemblyVersion;$scope.showPasswordFields=false;$scope.changePasswordButtonState="init";$scope.model.subtitle="Umbraco version"+" "+$scope.version;if(!$scope.model.title){$scope.model.title=localizationService.localize("general_user");}
$scope.externalLoginProviders=externalLoginInfo.providers;$scope.externalLinkLoginFormAction=Umbraco.Sys.ServerVariables.umbracoUrls.externalLinkLoginsUrl;var evts=[];evts.push(eventsService.on("historyService.add",function(e,args){$scope.history=args.all;}));evts.push(eventsService.on("historyService.remove",function(e,args){$scope.history=args.all;}));evts.push(eventsService.on("historyService.removeAll",function(e,args){$scope.history=[];}));$scope.logout=function(){var pendingChangeEvent=eventsService.on("valFormManager.pendingChanges",function(e,args){pendingChangeEvent();$scope.model.close();});$scope.model.close();$location.path("/logout");};$scope.gotoHistory=function(link){$location.path(link);$scope.model.close();};function updateTimeout(){$timeout(function(){if($scope.remainingAuthSeconds>0){$scope.remainingAuthSeconds--;$scope.$digest();updateTimeout();}},1000,false);}
function updateUserInfo(){userService.getCurrentUser().then(function(user){$scope.user=user;if($scope.user){$scope.model.title=user.name;$scope.remainingAuthSeconds=$scope.user.remainingAuthSeconds;$scope.canEditProfile=_.indexOf($scope.user.allowedSections,"users")>-1;updateTimeout();authResource.getCurrentUserLinkedLogins().then(function(logins){for(var provider in $scope.externalLoginProviders){$scope.externalLoginProviders[provider].linkedProviderKey=undefined;}
for(var login in logins){var found=_.find($scope.externalLoginProviders,function(i){return i.authType==login;});if(found){found.linkedProviderKey=logins[login];}}});}});}
$scope.unlink=function(e,loginProvider,providerKey){var result=confirm("Are you sure you want to unlink this account?");if(!result){e.preventDefault();return;}
authResource.unlinkLogin(loginProvider,providerKey).then(function(a,b,c){updateUserInfo();});}
updateUserInfo();$scope.$on('$destroy',function(){for(var e=0;e<evts.length;e++){evts[e]();}});$scope.changePasswordModel={alias:"_umb_password",view:"changepassword",config:{},value:{}};currentUserResource.getMembershipProviderConfig().then(function(data){$scope.changePasswordModel.config=data;$scope.changePasswordModel.config.hasPassword=true;$scope.changePasswordModel.config.disableToggle=true;$scope.changePasswordModel.config.enableReset=false;});$scope.changePassword=function(){if(formHelper.submitForm({scope:$scope})){$scope.changePasswordButtonState="busy";currentUserResource.changePassword($scope.changePasswordModel.value).then(function(data){if(data.value){$scope.changePasswordModel.value.generatedPassword=data.value;}
formHelper.resetForm({scope:$scope,notifications:data.notifications});$scope.changePasswordButtonState="success";$timeout(function(){$scope.togglePasswordFields();},2000);},function(err){formHelper.handleError(err);$scope.changePasswordButtonState="error";});}};$scope.togglePasswordFields=function(){clearPasswordFields();$scope.showPasswordFields=!$scope.showPasswordFields;}
function clearPasswordFields(){$scope.changePasswordModel.value.newPassword="";$scope.changePasswordModel.confirm="";}});angular.module("umbraco").controller("Umbraco.Overlays.YsodController",function($scope,legacyResource,treeService,navigationService,localizationService){if(!$scope.model.title){$scope.model.title=localizationService.localize("errors_receivedErrorFromServer");}
if($scope.model.error&&$scope.model.error.data&&$scope.model.error.data.StackTrace){$scope.model.error.data.StackTrace=$scope.model.error.data.StackTrace.trim();}
if($scope.model.error&&$scope.model.error.data){$scope.model.error.data.InnerExceptions=[];var ex=$scope.model.error.data.InnerException;while(ex){if(ex.StackTrace){ex.StackTrace=ex.StackTrace.trim();}
$scope.model.error.data.InnerExceptions.push(ex);ex=ex.InnerException;}}});angular.module("umbraco").controller("Umbraco.Editors.Content.CopyController",function($scope,eventsService,contentResource,navigationService,appState,treeService,localizationService,notificationsService){var dialogOptions=$scope.dialogOptions;var searchText="Search...";localizationService.localize("general_search").then(function(value){searchText=value+"...";});$scope.relateToOriginal=true;$scope.recursive=true;$scope.dialogTreeEventHandler=$({});$scope.busy=false;$scope.searchInfo={searchFromId:null,searchFromName:null,showSearch:false,results:[],selectedSearchResults:[]}
var node=dialogOptions.currentNode;function nodeSelectHandler(ev,args){args.event.preventDefault();args.event.stopPropagation();if(args.node.metaData.listViewNode){$scope.searchInfo.showSearch=true;$scope.searchInfo.searchFromId=args.node.metaData.listViewNode.id;$scope.searchInfo.searchFromName=args.node.metaData.listViewNode.name;}
else{eventsService.emit("editors.content.copyController.select",args);if($scope.target){$scope.target.selected=false;}
$scope.target=args.node;$scope.target.selected=true;}}
function nodeExpandedHandler(ev,args){if(angular.isArray(args.children)){_.each(args.children,function(child){if(child.metaData.isContainer){child.hasChildren=true;child.children=[{level:child.level+1,hasChildren:false,name:searchText,metaData:{listViewNode:child,},cssClass:"icon umb-tree-icon sprTree icon-search",cssClasses:["not-published"]}];}});}}
$scope.hideSearch=function(){$scope.searchInfo.showSearch=false;$scope.searchInfo.searchFromId=null;$scope.searchInfo.searchFromName=null;$scope.searchInfo.results=[];}
$scope.selectResult=function(evt,result){result.selected=result.selected===true?false:true;nodeSelectHandler(evt,{event:evt,node:result});};$scope.onSearchResults=function(results){$scope.searchInfo.results=results;$scope.searchInfo.showSearch=true;};$scope.copy=function(){$scope.busy=true;$scope.error=false;contentResource.copy({parentId:$scope.target.id,id:node.id,relateToOriginal:$scope.relateToOriginal,recursive:$scope.recursive}).then(function(path){$scope.error=false;$scope.success=true;$scope.busy=false;var activeNode=appState.getTreeState("selectedNode");navigationService.syncTree({tree:"content",path:path,forceReload:true,activate:false}).then(function(args){if(activeNode){var activeNodePath=treeService.getPath(activeNode).join();navigationService.syncTree({tree:"content",path:activeNodePath,forceReload:false,activate:true});}});},function(err){$scope.success=false;$scope.error=err;$scope.busy=false;if(angular.isArray(err.data.notifications)){for(var i=0;i<err.data.notifications.length;i++){notificationsService.showNotification(err.data.notifications[i]);}}});};$scope.dialogTreeEventHandler.bind("treeNodeSelect",nodeSelectHandler);$scope.dialogTreeEventHandler.bind("treeNodeExpanded",nodeExpandedHandler);$scope.$on('$destroy',function(){$scope.dialogTreeEventHandler.unbind("treeNodeSelect",nodeSelectHandler);$scope.dialogTreeEventHandler.unbind("treeNodeExpanded",nodeExpandedHandler);});});function contentCreateController($scope,$routeParams,contentTypeResource,iconHelper){contentTypeResource.getAllowedTypes($scope.currentNode.id).then(function(data){$scope.allowedTypes=iconHelper.formatContentTypeIcons(data);});}
angular.module('umbraco').controller("Umbraco.Editors.Content.CreateController",contentCreateController);function ContentDeleteController($scope,contentResource,treeService,navigationService,editorState,$location,dialogService,notificationsService){$scope.performDelete=function(){$scope.currentNode.loading=true;contentResource.deleteById($scope.currentNode.id).then(function(){$scope.currentNode.loading=false;var rootNode=treeService.getTreeRoot($scope.currentNode);treeService.removeNode($scope.currentNode);if(rootNode){var recycleBin=treeService.getDescendantNode(rootNode,-20);if(recycleBin){recycleBin.hasChildren=true;}}
if(editorState.current&&editorState.current.id==$scope.currentNode.id){var location="/content";if($scope.currentNode.parentId.toString()!=="-1")
location="/content/content/edit/"+$scope.currentNode.parentId;$location.path(location);}
navigationService.hideMenu();},function(err){$scope.currentNode.loading=false;if(err.status&&err.status>=500){dialogService.ysodDialog(err);}
if(err.data&&angular.isArray(err.data.notifications)){for(var i=0;i<err.data.notifications.length;i++){notificationsService.showNotification(err.data.notifications[i]);}}});};$scope.cancel=function(){navigationService.hideDialog();};}
angular.module("umbraco").controller("Umbraco.Editors.Content.DeleteController",ContentDeleteController);function ContentEditController($scope,$rootScope,$routeParams,$q,$timeout,$window,appState,contentResource,entityResource,navigationService,notificationsService,angularHelper,serverValidationManager,contentEditingHelper,treeService,fileManager,formHelper,umbRequestHelper,keyboardService,umbModelMapper,editorState,$http){$scope.defaultButton=null;$scope.subButtons=[];$scope.page={};$scope.page.loading=false;$scope.page.menu={};$scope.page.menu.currentNode=null;$scope.page.menu.currentSection=appState.getSectionState("currentSection");$scope.page.listViewPath=null;$scope.page.isNew=$routeParams.create;$scope.page.buttonGroupState="init";function init(content){var buttons=contentEditingHelper.configureContentEditorButtons({create:$routeParams.create,content:content,methods:{saveAndPublish:$scope.saveAndPublish,sendToPublish:$scope.sendToPublish,save:$scope.save,unPublish:$scope.unPublish}});$scope.defaultButton=buttons.defaultButton;$scope.subButtons=buttons.subButtons;editorState.set($scope.content);if(!$routeParams.create){if(content.parentId&&content.parentId!=-1){entityResource.getAncestors(content.id,"document").then(function(anc){$scope.ancestors=anc;});}}}
function syncTreeNode(content,path,initialLoad){if(!$scope.content.isChildOfListView){navigationService.syncTree({tree:"content",path:path.split(","),forceReload:initialLoad!==true}).then(function(syncArgs){$scope.page.menu.currentNode=syncArgs.node;});}
else if(initialLoad===true){navigationService.syncTree({tree:"content",path:path.substring(0,path.lastIndexOf(",")).split(","),forceReload:initialLoad!==true});umbRequestHelper.resourcePromise($http.get(content.treeNodeUrl),'Failed to retrieve data for child node '+content.id).then(function(node){$scope.page.menu.currentNode=node;});}}
function performSave(args){var deferred=$q.defer();$scope.page.buttonGroupState="busy";contentEditingHelper.contentEditorPerformSave({statusMessage:args.statusMessage,saveMethod:args.saveMethod,scope:$scope,content:$scope.content,action:args.action}).then(function(data){init($scope.content);syncTreeNode($scope.content,data.path);$scope.page.buttonGroupState="success";deferred.resolve(data);},function(err){if(err){editorState.set($scope.content);}
$scope.page.buttonGroupState="error";deferred.reject(err);});return deferred.promise;}
function resetLastListPageNumber(content){if(!content.isChildOfListView&&!content.isContainer){$rootScope.lastListViewPageViewed=null;}}
if($routeParams.create){$scope.page.loading=true;contentResource.getScaffold($routeParams.id,$routeParams.doctype).then(function(data){$scope.content=data;init($scope.content);resetLastListPageNumber($scope.content);$scope.page.loading=false;});}
else{$scope.page.loading=true;contentResource.getById($routeParams.id).then(function(data){$scope.content=data;if(data.isChildOfListView&&data.trashed===false){$scope.page.listViewPath=($routeParams.page)?"/content/content/edit/"+data.parentId+"?page="+$routeParams.page:"/content/content/edit/"+data.parentId;}
init($scope.content);serverValidationManager.executeAndClearAllSubscriptions();syncTreeNode($scope.content,data.path,true);resetLastListPageNumber($scope.content);$scope.page.loading=false;});}
$scope.unPublish=function(){if(formHelper.submitForm({scope:$scope,statusMessage:"Unpublishing...",skipValidation:true})){$scope.page.buttonGroupState="busy";contentResource.unPublish($scope.content.id).then(function(data){formHelper.resetForm({scope:$scope,notifications:data.notifications});contentEditingHelper.handleSuccessfulSave({scope:$scope,savedContent:data,rebindCallback:contentEditingHelper.reBindChangedProperties($scope.content,data)});init($scope.content);syncTreeNode($scope.content,data.path);$scope.page.buttonGroupState="success";});}};$scope.sendToPublish=function(){return performSave({saveMethod:contentResource.sendToPublish,statusMessage:"Sending...",action:"sendToPublish"});};$scope.saveAndPublish=function(){return performSave({saveMethod:contentResource.publish,statusMessage:"Publishing...",action:"publish"});};$scope.save=function(){return performSave({saveMethod:contentResource.save,statusMessage:"Saving...",action:"save"});};$scope.preview=function(content){if(!$scope.busy){var previewWindow=$window.open('preview/?id='+content.id,'umbpreview');$scope.save().then(function(data){var redirect=Umbraco.Sys.ServerVariables.umbracoSettings.umbracoPath+'/preview/?id='+data.id;previewWindow.location.href=redirect;});}};}
angular.module("umbraco").controller("Umbraco.Editors.Content.EditController",ContentEditController);function ContentEmptyRecycleBinController($scope,contentResource,treeService,navigationService){$scope.performDelete=function(){$scope.currentNode.loading=true;contentResource.emptyRecycleBin($scope.currentNode.id).then(function(){$scope.currentNode.loading=false;treeService.removeChildNodes($scope.currentNode);navigationService.hideMenu();});};$scope.cancel=function(){navigationService.hideDialog();};}
angular.module("umbraco").controller("Umbraco.Editors.Content.EmptyRecycleBinController",ContentEmptyRecycleBinController);angular.module("umbraco").controller("Umbraco.Editors.Content.MoveController",function($scope,eventsService,contentResource,navigationService,appState,treeService,localizationService,notificationsService){var dialogOptions=$scope.dialogOptions;var searchText="Search...";localizationService.localize("general_search").then(function(value){searchText=value+"...";});$scope.dialogTreeEventHandler=$({});$scope.busy=false;$scope.searchInfo={searchFromId:null,searchFromName:null,showSearch:false,results:[],selectedSearchResults:[]}
var node=dialogOptions.currentNode;function nodeSelectHandler(ev,args){args.event.preventDefault();args.event.stopPropagation();if(args.node.metaData.listViewNode){$scope.searchInfo.showSearch=true;$scope.searchInfo.searchFromId=args.node.metaData.listViewNode.id;$scope.searchInfo.searchFromName=args.node.metaData.listViewNode.name;}
else{eventsService.emit("editors.content.moveController.select",args);if($scope.target){$scope.target.selected=false;}
$scope.target=args.node;$scope.target.selected=true;}}
function nodeExpandedHandler(ev,args){if(angular.isArray(args.children)){_.each(args.children,function(child){if(child.metaData.isContainer){child.hasChildren=true;child.children=[{level:child.level+1,hasChildren:false,name:searchText,metaData:{listViewNode:child,},cssClass:"icon umb-tree-icon sprTree icon-search",cssClasses:["not-published"]}];}});}}
$scope.hideSearch=function(){$scope.searchInfo.showSearch=false;$scope.searchInfo.searchFromId=null;$scope.searchInfo.searchFromName=null;$scope.searchInfo.results=[];}
$scope.selectResult=function(evt,result){result.selected=result.selected===true?false:true;nodeSelectHandler(evt,{event:evt,node:result});};$scope.onSearchResults=function(results){$scope.searchInfo.results=results;$scope.searchInfo.showSearch=true;};$scope.move=function(){$scope.busy=true;$scope.error=false;contentResource.move({parentId:$scope.target.id,id:node.id}).then(function(path){$scope.error=false;$scope.success=true;$scope.busy=false;treeService.removeNode($scope.currentNode);var activeNode=appState.getTreeState("selectedNode");navigationService.syncTree({tree:"content",path:path,forceReload:true,activate:false}).then(function(args){if(activeNode){var activeNodePath=treeService.getPath(activeNode).join();navigationService.syncTree({tree:"content",path:activeNodePath,forceReload:false,activate:true});}});},function(err){$scope.success=false;$scope.error=err;$scope.busy=false;if(angular.isArray(err.data.notifications)){for(var i=0;i<err.data.notifications.length;i++){notificationsService.showNotification(err.data.notifications[i]);}}});};$scope.dialogTreeEventHandler.bind("treeNodeSelect",nodeSelectHandler);$scope.dialogTreeEventHandler.bind("treeNodeExpanded",nodeExpandedHandler);$scope.$on('$destroy',function(){$scope.dialogTreeEventHandler.unbind("treeNodeSelect",nodeSelectHandler);$scope.dialogTreeEventHandler.unbind("treeNodeExpanded",nodeExpandedHandler);});});function ContentRecycleBinController($scope,$routeParams,contentResource,navigationService,localizationService){$scope.page={};$scope.page.name="Recycle Bin";$scope.page.nameLocked=true;$scope.listViewPath=null;$routeParams.id="-20";contentResource.getRecycleBin().then(function(result){var listproperty=result.tabs[0].properties[0];_.each(listproperty.config,function(val,key){$scope.model.config[key]=val;});$scope.listViewPath='views/propertyeditors/listview/listview.html';});$scope.model={config:{entityType:$routeParams.section,layouts:[]}};navigationService.syncTree({tree:"content",path:["-1",$routeParams.id],forceReload:false});localizePageName();function localizePageName(){var pageName="general_recycleBin";localizationService.localize(pageName).then(function(value){$scope.page.name=value;});}}
angular.module('umbraco').controller("Umbraco.Editors.Content.RecycleBinController",ContentRecycleBinController);angular.module("umbraco").controller("Umbraco.Editors.Content.RestoreController",function($scope,relationResource,contentResource,navigationService,appState,treeService){var dialogOptions=$scope.dialogOptions;var node=dialogOptions.currentNode;$scope.error=null;$scope.success=false;relationResource.getByChildId(node.id,"relateParentDocumentOnDelete").then(function(data){if(data.length==0){$scope.success=false;$scope.error={errorMsg:"Cannot automatically restore this item",data:{Message:"There is no 'restore' relation found for this node. Use the Move menu item to move it manually."}}
return;}
$scope.relation=data[0];if($scope.relation.parentId==-1){$scope.target={id:-1,name:"Root"};}else{contentResource.getById($scope.relation.parentId).then(function(data){$scope.target=data;},function(err){$scope.success=false;$scope.error=err;});}},function(err){$scope.success=false;$scope.error=err;});$scope.restore=function(){contentResource.move({parentId:$scope.target.id,id:node.id}).then(function(path){$scope.success=true;treeService.removeNode($scope.currentNode);var activeNode=appState.getTreeState("selectedNode");navigationService.syncTree({tree:"content",path:path,forceReload:true,activate:false}).then(function(args){if(activeNode){var activeNodePath=treeService.getPath(activeNode).join();navigationService.syncTree({tree:"content",path:activeNodePath,forceReload:false,activate:true});}});},function(err){$scope.success=false;$scope.error=err;});};});function startUpVideosDashboardController($scope,xmlhelper,$log,$http){$scope.videos=[];$scope.init=function(url){var proxyUrl="dashboard/feedproxy.aspx?url="+url;$http.get(proxyUrl).then(function(data){var feed=$(data.data);$('item',feed).each(function(i,item){var video={};video.thumbnail=$(item).find('thumbnail').attr('url');video.title=$("title",item).text();video.link=$("guid",item).text();$scope.videos.push(video);});});};}
angular.module("umbraco").controller("Umbraco.Dashboard.StartupVideosController",startUpVideosDashboardController);function FormsController($scope,$route,$cookieStore,packageResource){$scope.installForms=function(){$scope.state="Installng package";packageResource.fetch("CD44CF39-3D71-4C19-B6EE-948E1FAF0525").then(function(pack){$scope.state="importing";return packageResource.import(pack);},$scope.error).then(function(pack){$scope.state="Installing";return packageResource.installFiles(pack);},$scope.error).then(function(pack){$scope.state="Restarting, please hold...";return packageResource.installData(pack);},$scope.error).then(function(pack){$scope.state="All done, your browser will now refresh";return packageResource.cleanUp(pack);},$scope.error).then($scope.complete,$scope.error);};$scope.complete=function(result){var url=window.location.href+"?init=true";$cookieStore.put("umbPackageInstallId",result.packageGuid);window.location.reload(true);};$scope.error=function(err){$scope.state=undefined;$scope.error=err;};function Video_player(videoId){this.container=document.getElementById(videoId);this.video=this.container.getElementsByTagName('video')[0];this.controls=document.createElement('div');this.controls.className="video-controls";this.seek_bar=document.createElement('input');this.seek_bar.className="seek-bar";this.seek_bar.type="range";this.seek_bar.setAttribute('value','0');this.loader=document.createElement('div');this.loader.className="loader";this.progress_bar=document.createElement('span');this.progress_bar.className="progress-bar";this.controls.appendChild(this.seek_bar);this.container.appendChild(this.controls);this.controls.appendChild(this.loader);this.loader.appendChild(this.progress_bar);}
Video_player.prototype.seeking=function(){var time=this.video.duration*(this.seek_bar.value/100);this.video.currentTime=time;};Video_player.prototype.start_seek=function(){this.video.pause();};Video_player.prototype.stop_seek=function(){this.video.play();};Video_player.prototype.update_progress_bar=function(){var value=(100/this.video.duration)*this.video.currentTime;this.progress_bar.style.width=value+'%';};Video_player.prototype.handle_mouse_move=function(event){var pos=this.progress_bar.getBoundingClientRect().left;event=event||window.event;this.progress_bar.style.width=(event.clientX-pos)+"px";};Video_player.prototype.video_event_handler=function(videoPlayer,interval){var animate_progress_bar=setInterval(function(){videoPlayer.update_progress_bar();},interval);videoPlayer.seek_bar.addEventListener("change",function(){videoPlayer.seeking();});videoPlayer.seek_bar.addEventListener("mousedown",function(clickEvent){videoPlayer.start_seek();clearInterval(animate_progress_bar);videoPlayer.handle_mouse_move(clickEvent);window.onmousemove=function(moveEvent){videoPlayer.handle_mouse_move(moveEvent);};});videoPlayer.seek_bar.addEventListener("mouseup",function(){window.onmousemove=null;videoPlayer.stop_seek();animate_progress_bar=setInterval(function(){videoPlayer.update_progress_bar();},interval);});};var videoPlayer=new Video_player('video_1');videoPlayer.video_event_handler(videoPlayer,17);}
angular.module("umbraco").controller("Umbraco.Dashboard.FormsDashboardController",FormsController);function startupLatestEditsController($scope){}
angular.module("umbraco").controller("Umbraco.Dashboard.StartupLatestEditsController",startupLatestEditsController);function MediaFolderBrowserDashboardController($rootScope,$scope,contentTypeResource){contentTypeResource.getPropertyTypeScaffold(-96).then(function(dt){$scope.fakeProperty={alias:"contents",config:dt.config,description:"",editor:dt.editor,hideLabel:true,id:1,label:"Contents:",validation:{mandatory:false,pattern:null},value:"",view:dt.view};});}
angular.module("umbraco").controller("Umbraco.Dashboard.MediaFolderBrowserDashboardController",MediaFolderBrowserDashboardController);function examineMgmtController($scope,umbRequestHelper,$log,$http,$q,$timeout){$scope.indexerDetails=[];$scope.searcherDetails=[];$scope.loading=true;function checkProcessing(indexer,checkActionName){umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("examineMgmtBaseUrl",checkActionName,{indexerName:indexer.name})),'Failed to check index processing').then(function(data){if(data!==null&&data!=="null"){for(var k in data){indexer[k]=data[k];}
indexer.isProcessing=false;}
else{$timeout(function(){if(indexer.processingAttempts<100){checkProcessing(indexer,checkActionName);indexer.processingAttempts++;}
else{indexer.isProcessing=false;}},1000);}});}
$scope.search=function(searcher,e){if(e&&e.keyCode!==13){return;}
umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("examineMgmtBaseUrl","GetSearchResults",{searcherName:searcher.name,query:encodeURIComponent(searcher.searchText),queryType:searcher.searchType})),'Failed to search').then(function(searchResults){searcher.isSearching=true;searcher.searchResults=searchResults;});}
$scope.toggle=function(provider,propName){if(provider[propName]!==undefined){provider[propName]=!provider[propName];}
else{provider[propName]=true;}}
$scope.rebuildIndex=function(indexer){if(confirm("This will cause the index to be rebuilt. "+"Depending on how much content there is in your site this could take a while. "+"It is not recommended to rebuild an index during times of high website traffic "+"or when editors are editing content.")){indexer.isProcessing=true;indexer.processingAttempts=0;umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("examineMgmtBaseUrl","PostRebuildIndex",{indexerName:indexer.name})),'Failed to rebuild index').then(function(){$timeout(function(){checkProcessing(indexer,"PostCheckRebuildIndex");},1000);});}}
$scope.optimizeIndex=function(indexer){if(confirm("This will cause the index to be optimized which will improve its performance. "+"It is not recommended to optimize an index during times of high website traffic "+"or when editors are editing content.")){indexer.isProcessing=true;umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("examineMgmtBaseUrl","PostOptimizeIndex",{indexerName:indexer.name})),'Failed to optimize index').then(function(){$timeout(function(){checkProcessing(indexer,"PostCheckOptimizeIndex");},1000);});}}
$scope.closeSearch=function(searcher){searcher.isSearching=true;}
$q.all([umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("examineMgmtBaseUrl","GetIndexerDetails")),'Failed to retrieve indexer details').then(function(data){$scope.indexerDetails=data;}),umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("examineMgmtBaseUrl","GetSearcherDetails")),'Failed to retrieve searcher details').then(function(data){$scope.searcherDetails=data;for(var s in $scope.searcherDetails){$scope.searcherDetails[s].searchType="text";}})]).then(function(){$scope.loading=false;});}
angular.module("umbraco").controller("Umbraco.Dashboard.ExamineMgmtController",examineMgmtController);function xmlDataIntegrityReportController($scope,umbRequestHelper,$log,$http,$q,$timeout){function check(item){var action=item.check;umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("xmlDataIntegrityBaseUrl",action)),'Failed to retrieve data integrity status').then(function(result){item.checking=false;item.invalid=result==="false";});}
$scope.fix=function(item){var action=item.fix;if(item.fix){if(confirm("This will cause all xml structures for this type to be rebuilt. "+"Depending on how much content there is in your site this could take a while. "+"It is not recommended to rebuild xml structures if they are not out of sync, during times of high website traffic "+"or when editors are editing content.")){item.fixing=true;umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("xmlDataIntegrityBaseUrl",action)),'Failed to retrieve data integrity status').then(function(result){item.fixing=false;item.invalid=result==="false";});}}}
$scope.items={"contentXml":{label:"Content in the cmsContentXml table",checking:true,fixing:false,fix:"FixContentXmlTable",check:"CheckContentXmlTable"},"mediaXml":{label:"Media in the cmsContentXml table",checking:true,fixing:false,fix:"FixMediaXmlTable",check:"CheckMediaXmlTable"},"memberXml":{label:"Members in the cmsContentXml table",checking:true,fixing:false,fix:"FixMembersXmlTable",check:"CheckMembersXmlTable"}};for(var i in $scope.items){check($scope.items[i]);}}
angular.module("umbraco").controller("Umbraco.Dashboard.XmlDataIntegrityReportController",xmlDataIntegrityReportController);function DataTypeCreateController($scope,$location,navigationService,dataTypeResource,formHelper,appState){$scope.model={folderName:"",creatingFolder:false};var node=$scope.dialogOptions.currentNode;$scope.showCreateFolder=function(){$scope.model.creatingFolder=true;}
$scope.createContainer=function(){if(formHelper.submitForm({scope:$scope,formCtrl:this.createFolderForm,statusMessage:"Creating folder..."})){dataTypeResource.createContainer(node.id,$scope.model.folderName).then(function(folderId){navigationService.hideMenu();var currPath=node.path?node.path:"-1";navigationService.syncTree({tree:"datatypes",path:currPath+","+folderId,forceReload:true,activate:true});formHelper.resetForm({scope:$scope});var section=appState.getSectionState("currentSection");},function(err){});};}
$scope.createDataType=function(){$location.search('create',null);$location.path("/developer/datatypes/edit/"+node.id).search("create","true");navigationService.hideMenu();}}
angular.module('umbraco').controller("Umbraco.Editors.DataType.CreateController",DataTypeCreateController);function DataTypeDeleteController($scope,dataTypeResource,treeService,navigationService){$scope.performDelete=function(){$scope.currentNode.loading=true;dataTypeResource.deleteById($scope.currentNode.id).then(function(){$scope.currentNode.loading=false;var rootNode=treeService.getTreeRoot($scope.currentNode);treeService.removeNode($scope.currentNode);navigationService.hideMenu();});};$scope.performContainerDelete=function(){$scope.currentNode.loading=true;dataTypeResource.deleteContainerById($scope.currentNode.id).then(function(){$scope.currentNode.loading=false;var rootNode=treeService.getTreeRoot($scope.currentNode);treeService.removeNode($scope.currentNode);navigationService.hideMenu();});};$scope.cancel=function(){navigationService.hideDialog();};}
angular.module("umbraco").controller("Umbraco.Editors.DataType.DeleteController",DataTypeDeleteController);function DataTypeEditController($scope,$routeParams,$location,appState,navigationService,treeService,dataTypeResource,notificationsService,angularHelper,serverValidationManager,contentEditingHelper,formHelper,editorState,dataTypeHelper,eventsService){$scope.page={};$scope.page.loading=false;$scope.page.nameLocked=false;$scope.page.menu={};$scope.page.menu.currentSection=appState.getSectionState("currentSection");$scope.page.menu.currentNode=null;var evts=[];function createPreValueProps(preVals){$scope.preValues=[];for(var i=0;i<preVals.length;i++){$scope.preValues.push({hideLabel:preVals[i].hideLabel,alias:preVals[i].key,description:preVals[i].description,label:preVals[i].label,view:preVals[i].view,value:preVals[i].value});}}
$scope.properties={selectedEditor:{alias:"selectedEditor",description:"Select a property editor",label:"Property editor"},selectedEditorId:{alias:"selectedEditorId",label:"Property editor alias"}};$scope.preValues=[];if($routeParams.create){$scope.page.loading=true;dataTypeResource.getScaffold($routeParams.id).then(function(data){$scope.preValuesLoaded=true;$scope.content=data;setHeaderNameState($scope.content);editorState.set($scope.content);$scope.page.loading=false;});}
else{loadDataType();}
function loadDataType(){$scope.page.loading=true;dataTypeResource.getById($routeParams.id).then(function(data){$scope.preValuesLoaded=true;$scope.content=data;createPreValueProps($scope.content.preValues);setHeaderNameState($scope.content);editorState.set($scope.content);serverValidationManager.executeAndClearAllSubscriptions();navigationService.syncTree({tree:"datatypes",path:data.path}).then(function(syncArgs){$scope.page.menu.currentNode=syncArgs.node;});$scope.page.loading=false;});}
$scope.$watch("content.selectedEditor",function(newVal,oldVal){if(newVal&&(newVal!=oldVal&&(oldVal||$routeParams.create))){var currDataTypeId=$routeParams.create?undefined:$routeParams.id;dataTypeResource.getPreValues(newVal,currDataTypeId).then(function(data){$scope.preValuesLoaded=true;$scope.content.preValues=data;createPreValueProps($scope.content.preValues);setHeaderNameState($scope.content);editorState.set($scope.content);});}});function setHeaderNameState(content){if(content.isSystem==1){$scope.page.nameLocked=true;}}
$scope.save=function(){if(formHelper.submitForm({scope:$scope,statusMessage:"Saving..."})){$scope.page.saveButtonState="busy";dataTypeResource.save($scope.content,$scope.preValues,$routeParams.create).then(function(data){formHelper.resetForm({scope:$scope,notifications:data.notifications});contentEditingHelper.handleSuccessfulSave({scope:$scope,savedContent:data,rebindCallback:function(){createPreValueProps(data.preValues);}});setHeaderNameState($scope.content);editorState.set($scope.content);navigationService.syncTree({tree:"datatypes",path:data.path,forceReload:true}).then(function(syncArgs){$scope.page.menu.currentNode=syncArgs.node;});$scope.page.saveButtonState="success";dataTypeHelper.rebindChangedProperties($scope.content,data);},function(err){contentEditingHelper.handleSaveError({redirectOnFailure:false,err:err});$scope.page.saveButtonState="error";editorState.set($scope.content);dataTypeHelper.rebindChangedProperties($scope.content,data);});}};evts.push(eventsService.on("app.refreshEditor",function(name,error){loadDataType();}));$scope.$on('$destroy',function(){for(var e in evts){eventsService.unsubscribe(evts[e]);}});}
angular.module("umbraco").controller("Umbraco.Editors.DataType.EditController",DataTypeEditController);angular.module("umbraco").controller("Umbraco.Editors.DataType.MoveController",function($scope,dataTypeResource,treeService,navigationService,notificationsService,appState,eventsService){var dialogOptions=$scope.dialogOptions;$scope.dialogTreeEventHandler=$({});function nodeSelectHandler(ev,args){args.event.preventDefault();args.event.stopPropagation();if($scope.target){$scope.target.selected=false;}
$scope.target=args.node;$scope.target.selected=true;}
$scope.move=function(){$scope.busy=true;$scope.error=false;dataTypeResource.move({parentId:$scope.target.id,id:dialogOptions.currentNode.id}).then(function(path){$scope.error=false;$scope.success=true;$scope.busy=false;treeService.removeNode($scope.currentNode);var activeNode=appState.getTreeState("selectedNode");navigationService.syncTree({tree:"dataTypes",path:path,forceReload:true,activate:false}).then(function(args){if(activeNode){var activeNodePath=treeService.getPath(activeNode).join();navigationService.syncTree({tree:"dataTypes",path:activeNodePath,forceReload:false,activate:true});}});eventsService.emit('app.refreshEditor');},function(err){$scope.success=false;$scope.error=err;$scope.busy=false;if(angular.isArray(err.data.notifications)){for(var i=0;i<err.data.notifications.length;i++){notificationsService.showNotification(err.data.notifications[i]);}}});};$scope.dialogTreeEventHandler.bind("treeNodeSelect",nodeSelectHandler);$scope.$on('$destroy',function(){$scope.dialogTreeEventHandler.unbind("treeNodeSelect",nodeSelectHandler);});});angular.module("umbraco").controller("Umbraco.Editors.DocumentTypes.CopyController",function($scope,contentTypeResource,treeService,navigationService,notificationsService,appState,eventsService){var dialogOptions=$scope.dialogOptions;$scope.dialogTreeEventHandler=$({});function nodeSelectHandler(ev,args){args.event.preventDefault();args.event.stopPropagation();if($scope.target){$scope.target.selected=false;}
$scope.target=args.node;$scope.target.selected=true;}
$scope.copy=function(){$scope.busy=true;$scope.error=false;contentTypeResource.copy({parentId:$scope.target.id,id:dialogOptions.currentNode.id}).then(function(path){$scope.error=false;$scope.success=true;$scope.busy=false;var activeNode=appState.getTreeState("selectedNode");navigationService.syncTree({tree:"documentTypes",path:path,forceReload:true,activate:false}).then(function(args){if(activeNode){var activeNodePath=treeService.getPath(activeNode).join();navigationService.syncTree({tree:"documentTypes",path:activeNodePath,forceReload:false,activate:true});}});},function(err){$scope.success=false;$scope.error=err;$scope.busy=false;if(angular.isArray(err.data.notifications)){for(var i=0;i<err.data.notifications.length;i++){notificationsService.showNotification(err.data.notifications[i]);}}});};$scope.dialogTreeEventHandler.bind("treeNodeSelect",nodeSelectHandler);$scope.$on('$destroy',function(){$scope.dialogTreeEventHandler.unbind("treeNodeSelect",nodeSelectHandler);});});function DocumentTypesCreateController($scope,$location,navigationService,contentTypeResource,formHelper,appState,notificationsService,localizationService){$scope.model={allowCreateFolder:$scope.dialogOptions.currentNode.parentId===null||$scope.dialogOptions.currentNode.nodeType==="container",folderName:"",creatingFolder:false,};var node=$scope.dialogOptions.currentNode,localizeCreateFolder=localizationService.localize("defaultdialog_createFolder");$scope.showCreateFolder=function(){$scope.model.creatingFolder=true;};$scope.createContainer=function(){if(formHelper.submitForm({scope:$scope,formCtrl:this.createFolderForm,statusMessage:localizeCreateFolder})){contentTypeResource.createContainer(node.id,$scope.model.folderName).then(function(folderId){navigationService.hideMenu();var currPath=node.path?node.path:"-1";navigationService.syncTree({tree:"documenttypes",path:currPath+","+folderId,forceReload:true,activate:true});formHelper.resetForm({scope:$scope});var section=appState.getSectionState("currentSection");},function(err){$scope.error=err;if(angular.isArray(err.data.notifications)){for(var i=0;i<err.data.notifications.length;i++){notificationsService.showNotification(err.data.notifications[i]);}}});}};$scope.createDocType=function(){$location.search('create',null);$location.search('notemplate',null);$location.path("/settings/documenttypes/edit/"+node.id).search("create","true");navigationService.hideMenu();};$scope.createComponent=function(){$location.search('create',null);$location.search('notemplate',null);$location.path("/settings/documenttypes/edit/"+node.id).search("create","true").search("notemplate","true");navigationService.hideMenu();};}
angular.module('umbraco').controller("Umbraco.Editors.DocumentTypes.CreateController",DocumentTypesCreateController);function DocumentTypesDeleteController($scope,dataTypeResource,contentTypeResource,treeService,navigationService){$scope.performDelete=function(){$scope.currentNode.loading=true;contentTypeResource.deleteById($scope.currentNode.id).then(function(){$scope.currentNode.loading=false;var rootNode=treeService.getTreeRoot($scope.currentNode);treeService.removeNode($scope.currentNode);navigationService.hideMenu();});};$scope.performContainerDelete=function(){$scope.currentNode.loading=true;contentTypeResource.deleteContainerById($scope.currentNode.id).then(function(){$scope.currentNode.loading=false;var rootNode=treeService.getTreeRoot($scope.currentNode);treeService.removeNode($scope.currentNode);navigationService.hideMenu();});};$scope.cancel=function(){navigationService.hideDialog();};}
angular.module("umbraco").controller("Umbraco.Editors.DocumentTypes.DeleteController",DocumentTypesDeleteController);(function(){"use strict";function DocumentTypesEditController($scope,$routeParams,$injector,contentTypeResource,dataTypeResource,editorState,contentEditingHelper,formHelper,navigationService,iconHelper,contentTypeHelper,notificationsService,$filter,$q,localizationService,overlayHelper,eventsService){var vm=this;var localizeSaving=localizationService.localize("general_saving");var evts=[];vm.save=save;vm.currentNode=null;vm.contentType={};vm.page={};vm.page.loading=false;vm.page.saveButtonState="init";vm.page.navigation=[{"name":localizationService.localize("general_design"),"icon":"icon-document-dashed-line","view":"views/documenttypes/views/design/design.html","active":true},{"name":localizationService.localize("general_listView"),"icon":"icon-list","view":"views/documenttypes/views/listview/listview.html"},{"name":localizationService.localize("general_rights"),"icon":"icon-keychain","view":"views/documenttypes/views/permissions/permissions.html"},{"name":localizationService.localize("treeHeaders_templates"),"icon":"icon-layout","view":"views/documenttypes/views/templates/templates.html"}];vm.page.keyboardShortcutsOverview=[{"name":localizationService.localize("main_sections"),"shortcuts":[{"description":localizationService.localize("shortcuts_navigateSections"),"keys":[{"key":"1"},{"key":"4"}],"keyRange":true}]},{"name":localizationService.localize("general_design"),"shortcuts":[{"description":localizationService.localize("shortcuts_addTab"),"keys":[{"key":"alt"},{"key":"shift"},{"key":"t"}]},{"description":localizationService.localize("shortcuts_addProperty"),"keys":[{"key":"alt"},{"key":"shift"},{"key":"p"}]},{"description":localizationService.localize("shortcuts_addEditor"),"keys":[{"key":"alt"},{"key":"shift"},{"key":"e"}]},{"description":localizationService.localize("shortcuts_editDataType"),"keys":[{"key":"alt"},{"key":"shift"},{"key":"d"}]}]},{"name":localizationService.localize("general_listView"),"shortcuts":[{"description":localizationService.localize("shortcuts_toggleListView"),"keys":[{"key":"alt"},{"key":"shift"},{"key":"l"}]}]},{"name":localizationService.localize("general_rights"),"shortcuts":[{"description":localizationService.localize("shortcuts_toggleAllowAsRoot"),"keys":[{"key":"alt"},{"key":"shift"},{"key":"r"}]},{"description":localizationService.localize("shortcuts_addChildNode"),"keys":[{"key":"alt"},{"key":"shift"},{"key":"c"}]}]},{"name":localizationService.localize("treeHeaders_templates"),"shortcuts":[{"description":localizationService.localize("shortcuts_addTemplate"),"keys":[{"key":"alt"},{"key":"shift"},{"key":"t"}]}]}];contentTypeHelper.checkModelsBuilderStatus().then(function(result){vm.page.modelsBuilder=result;if(result){vm.page.defaultButton={hotKey:"ctrl+s",hotKeyWhenHidden:true,labelKey:"buttons_save",letter:"S",type:"submit",handler:function(){vm.save();}};vm.page.subButtons=[{hotKey:"ctrl+g",hotKeyWhenHidden:true,labelKey:"buttons_saveAndGenerateModels",letter:"G",handler:function(){vm.page.saveButtonState="busy";vm.save().then(function(result){vm.page.saveButtonState="busy";localizationService.localize("modelsBuilder_buildingModels").then(function(headerValue){localizationService.localize("modelsBuilder_waitingMessage").then(function(msgValue){notificationsService.info(headerValue,msgValue);});});contentTypeHelper.generateModels().then(function(result){if(!result.lastError){contentTypeHelper.checkModelsBuilderStatus().then(function(statusResult){vm.page.modelsBuilder=statusResult;});vm.page.saveButtonState="init";localizationService.localize("modelsBuilder_modelsGenerated").then(function(value){notificationsService.success(value);});}else{vm.page.saveButtonState="error";localizationService.localize("modelsBuilder_modelsExceptionInUlog").then(function(value){notificationsService.error(value);});}},function(){vm.page.saveButtonState="error";localizationService.localize("modelsBuilder_modelsGeneratedError").then(function(value){notificationsService.error(value);});});});}}];}});if($routeParams.create){vm.page.loading=true;contentTypeResource.getScaffold($routeParams.id).then(function(dt){init(dt);vm.page.loading=false;});}
else{loadDocumentType();}
function loadDocumentType(){vm.page.loading=true;contentTypeResource.getById($routeParams.id).then(function(dt){init(dt);syncTreeNode(vm.contentType,dt.path,true);vm.page.loading=false;});}
function save(){if(overlayHelper.getNumberOfOverlays()===0){var deferred=$q.defer();vm.page.saveButtonState="busy";vm.contentType.allowedContentTypes=contentTypeHelper.createIdArray(vm.contentType.allowedContentTypes);contentEditingHelper.contentEditorPerformSave({statusMessage:localizeSaving,saveMethod:contentTypeResource.save,scope:$scope,content:vm.contentType,redirectOnFailure:false,rebindCallback:function(origContentType,savedContentType){vm.contentType.id=savedContentType.id;vm.contentType.groups.forEach(function(group){if(!group.name)return;var k=0;while(k<savedContentType.groups.length&&savedContentType.groups[k].name!=group.name)
k++;if(k==savedContentType.groups.length){group.id=0;return;}
var savedGroup=savedContentType.groups[k];if(!group.id)group.id=savedGroup.id;group.properties.forEach(function(property){if(property.id||!property.alias)return;k=0;while(k<savedGroup.properties.length&&savedGroup.properties[k].alias!=property.alias)
k++;if(k==savedGroup.properties.length){property.id=0;return;}
var savedProperty=savedGroup.properties[k];property.id=savedProperty.id;});});}}).then(function(data){syncTreeNode(vm.contentType,data.path);vm.page.saveButtonState="success";deferred.resolve(data);},function(err){if(err){editorState.set($scope.content);}
else{localizationService.localize("speechBubbles_validationFailedHeader").then(function(headerValue){localizationService.localize("speechBubbles_validationFailedMessage").then(function(msgValue){notificationsService.error(headerValue,msgValue);});});}
vm.page.saveButtonState="error";deferred.reject(err);});return deferred.promise;}}
function init(contentType){if(contentType.groups.length!==0){angular.forEach(contentType.groups,function(group){angular.forEach(group.properties,function(property){getDataTypeDetails(property);});});}
if(!$routeParams.notemplate&&contentType.id===0){contentType.defaultTemplate=contentTypeHelper.insertDefaultTemplatePlaceholder(contentType.defaultTemplate);contentType.allowedTemplates=contentTypeHelper.insertTemplatePlaceholder(contentType.allowedTemplates);}
convertLegacyIcons(contentType);editorState.set(contentType);vm.contentType=contentType;}
function convertLegacyIcons(contentType){var contentTypeArray=[];contentTypeArray.push({"icon":contentType.icon});iconHelper.formatContentTypeIcons(contentTypeArray);contentType.icon=contentTypeArray[0].icon;}
function getDataTypeDetails(property){if(property.propertyState!=="init"){dataTypeResource.getById(property.dataTypeId).then(function(dataType){property.dataTypeIcon=dataType.icon;property.dataTypeName=dataType.name;});}}
function syncTreeNode(dt,path,initialLoad){navigationService.syncTree({tree:"documenttypes",path:path.split(","),forceReload:initialLoad!==true}).then(function(syncArgs){vm.currentNode=syncArgs.node;});}
evts.push(eventsService.on("app.refreshEditor",function(name,error){loadDocumentType();}));$scope.$on('$destroy',function(){for(var e in evts){eventsService.unsubscribe(evts[e]);}});}
angular.module("umbraco").controller("Umbraco.Editors.DocumentTypes.EditController",DocumentTypesEditController);})();angular.module("umbraco").controller("Umbraco.Editors.DocumentTypes.MoveController",function($scope,contentTypeResource,treeService,navigationService,notificationsService,appState,eventsService){var dialogOptions=$scope.dialogOptions;$scope.dialogTreeEventHandler=$({});function nodeSelectHandler(ev,args){args.event.preventDefault();args.event.stopPropagation();if($scope.target){$scope.target.selected=false;}
$scope.target=args.node;$scope.target.selected=true;}
$scope.move=function(){$scope.busy=true;$scope.error=false;contentTypeResource.move({parentId:$scope.target.id,id:dialogOptions.currentNode.id}).then(function(path){$scope.error=false;$scope.success=true;$scope.busy=false;treeService.removeNode($scope.currentNode);var activeNode=appState.getTreeState("selectedNode");navigationService.syncTree({tree:"documentTypes",path:path,forceReload:true,activate:false}).then(function(args){if(activeNode){var activeNodePath=treeService.getPath(activeNode).join();navigationService.syncTree({tree:"documentTypes",path:activeNodePath,forceReload:false,activate:true});}});eventsService.emit('app.refreshEditor');},function(err){$scope.success=false;$scope.error=err;$scope.busy=false;if(angular.isArray(err.data.notifications)){for(var i=0;i<err.data.notifications.length;i++){notificationsService.showNotification(err.data.notifications[i]);}}});};$scope.dialogTreeEventHandler.bind("treeNodeSelect",nodeSelectHandler);$scope.$on('$destroy',function(){$scope.dialogTreeEventHandler.unbind("treeNodeSelect",nodeSelectHandler);});});(function(){'use strict';function PermissionsController($scope,contentTypeResource,iconHelper,contentTypeHelper,localizationService){var vm=this;var childNodeSelectorOverlayTitle="";vm.contentTypes=[];vm.selectedChildren=[];vm.overlayTitle="";vm.addChild=addChild;vm.removeChild=removeChild;init();function init(){childNodeSelectorOverlayTitle=localizationService.localize("contentTypeEditor_chooseChildNode");contentTypeResource.getAll().then(function(contentTypes){vm.contentTypes=contentTypes;iconHelper.formatContentTypeIcons(vm.contentTypes);vm.selectedChildren=contentTypeHelper.makeObjectArrayFromId($scope.model.allowedContentTypes,vm.contentTypes);if($scope.model.id===0){contentTypeHelper.insertChildNodePlaceholder(vm.contentTypes,$scope.model.name,$scope.model.icon,$scope.model.id);}});}
function addChild($event){vm.childNodeSelectorOverlay={view:"itempicker",title:childNodeSelectorOverlayTitle,availableItems:vm.contentTypes,selectedItems:vm.selectedChildren,event:$event,show:true,submit:function(model){vm.selectedChildren.push(model.selectedItem);$scope.model.allowedContentTypes.push(model.selectedItem.id);vm.childNodeSelectorOverlay.show=false;vm.childNodeSelectorOverlay=null;}};}
function removeChild(selectedChild,index){vm.selectedChildren.splice(index,1);var selectedChildIndex=$scope.model.allowedContentTypes.indexOf(selectedChild.id);$scope.model.allowedContentTypes.splice(selectedChildIndex,1);}}
angular.module("umbraco").controller("Umbraco.Editors.DocumentType.PermissionsController",PermissionsController);})();(function(){'use strict';function TemplatesController($scope,entityResource,contentTypeHelper,$routeParams){var vm=this;vm.availableTemplates=[];vm.updateTemplatePlaceholder=false;init();function init(){entityResource.getAll("Template").then(function(templates){vm.availableTemplates=templates;if(!$routeParams.notemplate&&$scope.model.id===0){vm.updateTemplatePlaceholder=true;vm.availableTemplates=contentTypeHelper.insertTemplatePlaceholder(vm.availableTemplates);}});}}
angular.module("umbraco").controller("Umbraco.Editors.DocumentType.TemplatesController",TemplatesController);})();function mediaCreateController($scope,$routeParams,mediaTypeResource,iconHelper){mediaTypeResource.getAllowedTypes($scope.currentNode.id).then(function(data){$scope.allowedTypes=iconHelper.formatContentTypeIcons(data);});}
angular.module('umbraco').controller("Umbraco.Editors.Media.CreateController",mediaCreateController);function MediaDeleteController($scope,mediaResource,treeService,navigationService,editorState,$location,dialogService,notificationsService){$scope.performDelete=function(){$scope.currentNode.loading=true;mediaResource.deleteById($scope.currentNode.id).then(function(){$scope.currentNode.loading=false;var rootNode=treeService.getTreeRoot($scope.currentNode);treeService.removeNode($scope.currentNode);if(rootNode){var recycleBin=treeService.getDescendantNode(rootNode,-21);if(recycleBin){recycleBin.hasChildren=true;}}
if(editorState.current&&editorState.current.id==$scope.currentNode.id){var location="/media";if($scope.currentNode.parentId.toString()!=="-1")
location="/media/media/edit/"+$scope.currentNode.parentId;$location.path(location);}
navigationService.hideMenu();},function(err){$scope.currentNode.loading=false;if(err.status&&err.status>=500){dialogService.ysodDialog(err);}
if(err.data&&angular.isArray(err.data.notifications)){for(var i=0;i<err.data.notifications.length;i++){notificationsService.showNotification(err.data.notifications[i]);}}});};$scope.cancel=function(){navigationService.hideDialog();};}
angular.module("umbraco").controller("Umbraco.Editors.Media.DeleteController",MediaDeleteController);function mediaEditController($scope,$routeParams,appState,mediaResource,entityResource,navigationService,notificationsService,angularHelper,serverValidationManager,contentEditingHelper,fileManager,treeService,formHelper,umbModelMapper,editorState,umbRequestHelper,$http){$scope.currentSection=appState.getSectionState("currentSection");$scope.currentNode=null;$scope.page={};$scope.page.loading=false;$scope.page.menu={};$scope.page.menu.currentSection=appState.getSectionState("currentSection");$scope.page.menu.currentNode=null;$scope.page.listViewPath=null;$scope.page.saveButtonState="init";function syncTreeNode(content,path,initialLoad){if(!$scope.content.isChildOfListView){navigationService.syncTree({tree:"media",path:path.split(","),forceReload:initialLoad!==true}).then(function(syncArgs){$scope.page.menu.currentNode=syncArgs.node;});}
else if(initialLoad===true){navigationService.syncTree({tree:"media",path:path.substring(0,path.lastIndexOf(",")).split(","),forceReload:initialLoad!==true});umbRequestHelper.resourcePromise($http.get(content.treeNodeUrl),'Failed to retrieve data for child node '+content.id).then(function(node){$scope.page.menu.currentNode=node;});}}
if($routeParams.create){$scope.page.loading=true;mediaResource.getScaffold($routeParams.id,$routeParams.doctype).then(function(data){$scope.content=data;editorState.set($scope.content);$scope.page.loading=false;});}
else{$scope.page.loading=true;mediaResource.getById($routeParams.id).then(function(data){$scope.content=data;if(data.isChildOfListView&&data.trashed===false){$scope.page.listViewPath=($routeParams.page)?"/media/media/edit/"+data.parentId+"?page="+$routeParams.page:"/media/media/edit/"+data.parentId;}
editorState.set($scope.content);serverValidationManager.executeAndClearAllSubscriptions();syncTreeNode($scope.content,data.path,true);if($scope.content.parentId&&$scope.content.parentId!=-1){entityResource.getAncestors($routeParams.id,"media").then(function(anc){$scope.ancestors=anc;});}
$scope.page.loading=false;});}
$scope.save=function(){if(!$scope.busy&&formHelper.submitForm({scope:$scope,statusMessage:"Saving..."})){$scope.busy=true;$scope.page.saveButtonState="busy";mediaResource.save($scope.content,$routeParams.create,fileManager.getFiles()).then(function(data){formHelper.resetForm({scope:$scope,notifications:data.notifications});contentEditingHelper.handleSuccessfulSave({scope:$scope,savedContent:data,rebindCallback:contentEditingHelper.reBindChangedProperties($scope.content,data)});editorState.set($scope.content);$scope.busy=false;syncTreeNode($scope.content,data.path);$scope.page.saveButtonState="success";},function(err){contentEditingHelper.handleSaveError({err:err,redirectOnFailure:true,rebindCallback:contentEditingHelper.reBindChangedProperties($scope.content,err.data)});if(angular.isArray(err.data.notifications)){for(var i=0;i<err.data.notifications.length;i++){notificationsService.showNotification(err.data.notifications[i]);}}
editorState.set($scope.content);$scope.busy=false;$scope.page.saveButtonState="error";});}else{$scope.busy=false;}};}
angular.module("umbraco").controller("Umbraco.Editors.Media.EditController",mediaEditController);function MediaEmptyRecycleBinController($scope,mediaResource,treeService,navigationService){$scope.performDelete=function(){$scope.currentNode.loading=true;mediaResource.emptyRecycleBin($scope.currentNode.id).then(function(){$scope.currentNode.loading=false;treeService.removeChildNodes($scope.currentNode);navigationService.hideMenu();});};$scope.cancel=function(){navigationService.hideDialog();};}
angular.module("umbraco").controller("Umbraco.Editors.Media.EmptyRecycleBinController",MediaEmptyRecycleBinController);angular.module("umbraco").controller("Umbraco.Editors.Media.MoveController",function($scope,eventsService,mediaResource,appState,treeService,navigationService){var dialogOptions=$scope.dialogOptions;$scope.dialogTreeEventHandler=$({});var node=dialogOptions.currentNode;function nodeSelectHandler(ev,args){args.event.preventDefault();args.event.stopPropagation();eventsService.emit("editors.media.moveController.select",args);if($scope.target){$scope.target.selected=false;}
$scope.target=args.node;$scope.target.selected=true;}
$scope.dialogTreeEventHandler.bind("treeNodeSelect",nodeSelectHandler);$scope.move=function(){mediaResource.move({parentId:$scope.target.id,id:node.id}).then(function(path){$scope.error=false;$scope.success=true;treeService.removeNode($scope.currentNode);var activeNode=appState.getTreeState("selectedNode");navigationService.syncTree({tree:"media",path:path,forceReload:true,activate:false}).then(function(args){if(activeNode){var activeNodePath=treeService.getPath(activeNode).join();navigationService.syncTree({tree:"media",path:activeNodePath,forceReload:false,activate:true});}});},function(err){$scope.success=false;$scope.error=err;});};$scope.$on('$destroy',function(){$scope.dialogTreeEventHandler.unbind("treeNodeSelect",nodeSelectHandler);});});function MediaRecycleBinController($scope,$routeParams,mediaResource,navigationService,localizationService){$scope.page={};$scope.page.name="Recycle Bin";$scope.page.nameLocked=true;$scope.listViewPath=null;$routeParams.id="-21";mediaResource.getRecycleBin().then(function(result){var listproperty=result.tabs[0].properties[0];_.each(listproperty.config,function(val,key){$scope.model.config[key]=val;});$scope.listViewPath='views/propertyeditors/listview/listview.html';});$scope.model={config:{entityType:$routeParams.section,layouts:[]}};navigationService.syncTree({tree:"media",path:["-1",$routeParams.id],forceReload:false});localizePageName();function localizePageName(){var pageName="general_recycleBin";localizationService.localize(pageName).then(function(value){$scope.page.name=value;});}}
angular.module('umbraco').controller("Umbraco.Editors.Media.RecycleBinController",MediaRecycleBinController);angular.module("umbraco").controller("Umbraco.Editors.MediaTypes.CopyController",function($scope,mediaTypeResource,treeService,navigationService,notificationsService,appState,eventsService){var dialogOptions=$scope.dialogOptions;$scope.dialogTreeEventHandler=$({});function nodeSelectHandler(ev,args){args.event.preventDefault();args.event.stopPropagation();if($scope.target){$scope.target.selected=false;}
$scope.target=args.node;$scope.target.selected=true;}
$scope.copy=function(){$scope.busy=true;$scope.error=false;mediaTypeResource.copy({parentId:$scope.target.id,id:dialogOptions.currentNode.id}).then(function(path){$scope.error=false;$scope.success=true;$scope.busy=false;var activeNode=appState.getTreeState("selectedNode");navigationService.syncTree({tree:"mediaTypes",path:path,forceReload:true,activate:false}).then(function(args){if(activeNode){var activeNodePath=treeService.getPath(activeNode).join();navigationService.syncTree({tree:"mediaTypes",path:activeNodePath,forceReload:false,activate:true});}});},function(err){$scope.success=false;$scope.error=err;$scope.busy=false;if(angular.isArray(err.data.notifications)){for(var i=0;i<err.data.notifications.length;i++){notificationsService.showNotification(err.data.notifications[i]);}}});};$scope.dialogTreeEventHandler.bind("treeNodeSelect",nodeSelectHandler);$scope.$on('$destroy',function(){$scope.dialogTreeEventHandler.unbind("treeNodeSelect",nodeSelectHandler);});});function MediaTypesCreateController($scope,$location,navigationService,mediaTypeResource,formHelper,appState,localizationService){$scope.model={folderName:"",creatingFolder:false};var node=$scope.dialogOptions.currentNode,localizeCreateFolder=localizationService.localize("defaultdialog_createFolder");$scope.showCreateFolder=function(){$scope.model.creatingFolder=true;}
$scope.createContainer=function(){if(formHelper.submitForm({scope:$scope,formCtrl:this.createFolderForm,statusMessage:localizeCreateFolder})){mediaTypeResource.createContainer(node.id,$scope.model.folderName).then(function(folderId){navigationService.hideMenu();var currPath=node.path?node.path:"-1";navigationService.syncTree({tree:"mediatypes",path:currPath+","+folderId,forceReload:true,activate:true});formHelper.resetForm({scope:$scope});var section=appState.getSectionState("currentSection");},function(err){});};}
$scope.createMediaType=function(){$location.search('create',null);$location.path("/settings/mediatypes/edit/"+node.id).search("create","true");navigationService.hideMenu();}}
angular.module('umbraco').controller("Umbraco.Editors.MediaTypes.CreateController",MediaTypesCreateController);function MediaTypesDeleteController($scope,dataTypeResource,mediaTypeResource,treeService,navigationService){$scope.performDelete=function(){$scope.currentNode.loading=true;mediaTypeResource.deleteById($scope.currentNode.id).then(function(){$scope.currentNode.loading=false;var rootNode=treeService.getTreeRoot($scope.currentNode);treeService.removeNode($scope.currentNode);navigationService.hideMenu();});};$scope.performContainerDelete=function(){$scope.currentNode.loading=true;mediaTypeResource.deleteContainerById($scope.currentNode.id).then(function(){$scope.currentNode.loading=false;var rootNode=treeService.getTreeRoot($scope.currentNode);treeService.removeNode($scope.currentNode);navigationService.hideMenu();});};$scope.cancel=function(){navigationService.hideDialog();};}
angular.module("umbraco").controller("Umbraco.Editors.MediaTypes.DeleteController",MediaTypesDeleteController);(function(){"use strict";function MediaTypesEditController($scope,$routeParams,mediaTypeResource,dataTypeResource,editorState,contentEditingHelper,formHelper,navigationService,iconHelper,contentTypeHelper,notificationsService,$filter,$q,localizationService,overlayHelper,eventsService){var vm=this;var localizeSaving=localizationService.localize("general_saving");var evts=[];vm.save=save;vm.currentNode=null;vm.contentType={};vm.page={};vm.page.loading=false;vm.page.saveButtonState="init";vm.page.navigation=[{"name":localizationService.localize("general_design"),"icon":"icon-document-dashed-line","view":"views/mediatypes/views/design/design.html","active":true},{"name":localizationService.localize("general_listView"),"icon":"icon-list","view":"views/mediatypes/views/listview/listview.html"},{"name":localizationService.localize("general_rights"),"icon":"icon-keychain","view":"views/mediatypes/views/permissions/permissions.html"}];vm.page.keyboardShortcutsOverview=[{"name":localizationService.localize("main_sections"),"shortcuts":[{"description":localizationService.localize("shortcuts_navigateSections"),"keys":[{"key":"1"},{"key":"3"}],"keyRange":true}]},{"name":localizationService.localize("general_design"),"shortcuts":[{"description":localizationService.localize("shortcuts_addTab"),"keys":[{"key":"alt"},{"key":"shift"},{"key":"t"}]},{"description":localizationService.localize("shortcuts_addProperty"),"keys":[{"key":"alt"},{"key":"shift"},{"key":"p"}]},{"description":localizationService.localize("shortcuts_addEditor"),"keys":[{"key":"alt"},{"key":"shift"},{"key":"e"}]},{"description":localizationService.localize("shortcuts_editDataType"),"keys":[{"key":"alt"},{"key":"shift"},{"key":"d"}]}]},{"name":localizationService.localize("general_listView"),"shortcuts":[{"description":localizationService.localize("shortcuts_toggleListView"),"keys":[{"key":"alt"},{"key":"shift"},{"key":"l"}]}]},{"name":localizationService.localize("general_rights"),"shortcuts":[{"description":localizationService.localize("shortcuts_toggleAllowAsRoot"),"keys":[{"key":"alt"},{"key":"shift"},{"key":"r"}]},{"description":localizationService.localize("shortcuts_addChildNode"),"keys":[{"key":"alt"},{"key":"shift"},{"key":"c"}]}]}];contentTypeHelper.checkModelsBuilderStatus().then(function(result){vm.page.modelsBuilder=result;if(result){vm.page.defaultButton={hotKey:"ctrl+s",hotKeyWhenHidden:true,labelKey:"buttons_save",letter:"S",type:"submit",handler:function(){vm.save();}};vm.page.subButtons=[{hotKey:"ctrl+g",hotKeyWhenHidden:true,labelKey:"buttons_saveAndGenerateModels",letter:"G",handler:function(){vm.page.saveButtonState="busy";vm.save().then(function(result){vm.page.saveButtonState="busy";localizationService.localize("modelsBuilder_buildingModels").then(function(headerValue){localizationService.localize("modelsBuilder_waitingMessage").then(function(msgValue){notificationsService.info(headerValue,msgValue);});});contentTypeHelper.generateModels().then(function(result){if(result.success){contentTypeHelper.checkModelsBuilderStatus().then(function(statusResult){vm.page.modelsBuilder=statusResult;});vm.page.saveButtonState="init";localizationService.localize("modelsBuilder_modelsGenerated").then(function(value){notificationsService.success(value);});}else{vm.page.saveButtonState="error";localizationService.localize("modelsBuilder_modelsExceptionInUlog").then(function(value){notificationsService.error(value);});}},function(){vm.page.saveButtonState="error";localizationService.localize("modelsBuilder_modelsGeneratedError").then(function(value){notificationsService.error(value);});});});}}];}});if($routeParams.create){vm.page.loading=true;mediaTypeResource.getScaffold($routeParams.id).then(function(dt){init(dt);vm.page.loading=false;});}
else{loadMediaType();}
function loadMediaType(){vm.page.loading=true;mediaTypeResource.getById($routeParams.id).then(function(dt){init(dt);syncTreeNode(vm.contentType,dt.path,true);vm.page.loading=false;});}
function save(){if(overlayHelper.getNumberOfOverlays()===0){var deferred=$q.defer();vm.page.saveButtonState="busy";vm.contentType.allowedContentTypes=contentTypeHelper.createIdArray(vm.contentType.allowedContentTypes);contentEditingHelper.contentEditorPerformSave({statusMessage:localizeSaving,saveMethod:mediaTypeResource.save,scope:$scope,content:vm.contentType,redirectOnFailure:false,rebindCallback:function(origContentType,savedContentType){vm.contentType.id=savedContentType.id;vm.contentType.groups.forEach(function(group){if(!group.name)return;var k=0;while(k<savedContentType.groups.length&&savedContentType.groups[k].name!=group.name)
k++;if(k==savedContentType.groups.length){group.id=0;return;}
var savedGroup=savedContentType.groups[k];if(!group.id)group.id=savedGroup.id;group.properties.forEach(function(property){if(property.id||!property.alias)return;k=0;while(k<savedGroup.properties.length&&savedGroup.properties[k].alias!=property.alias)
k++;if(k==savedGroup.properties.length){property.id=0;return;}
var savedProperty=savedGroup.properties[k];property.id=savedProperty.id;});});}}).then(function(data){syncTreeNode(vm.contentType,data.path);vm.page.saveButtonState="success";deferred.resolve(data);},function(err){if(err){editorState.set($scope.content);}
else{localizationService.localize("speechBubbles_validationFailedHeader").then(function(headerValue){localizationService.localize("speechBubbles_validationFailedMessage").then(function(msgValue){notificationsService.error(headerValue,msgValue);});});}
vm.page.saveButtonState="error";deferred.reject(err);});return deferred.promise;}}
function init(contentType){if(contentType.groups.length!==0){angular.forEach(contentType.groups,function(group){angular.forEach(group.properties,function(property){getDataTypeDetails(property);});});}
convertLegacyIcons(contentType);editorState.set(contentType);vm.contentType=contentType;}
function convertLegacyIcons(contentType){var contentTypeArray=[];contentTypeArray.push({"icon":contentType.icon});iconHelper.formatContentTypeIcons(contentTypeArray);contentType.icon=contentTypeArray[0].icon;}
function getDataTypeDetails(property){if(property.propertyState!=="init"){dataTypeResource.getById(property.dataTypeId).then(function(dataType){property.dataTypeIcon=dataType.icon;property.dataTypeName=dataType.name;});}}
function syncTreeNode(dt,path,initialLoad){navigationService.syncTree({tree:"mediatypes",path:path.split(","),forceReload:initialLoad!==true}).then(function(syncArgs){vm.currentNode=syncArgs.node;});}
evts.push(eventsService.on("app.refreshEditor",function(name,error){loadMediaType();}));$scope.$on('$destroy',function(){for(var e in evts){eventsService.unsubscribe(evts[e]);}});}
angular.module("umbraco").controller("Umbraco.Editors.MediaTypes.EditController",MediaTypesEditController);})();angular.module("umbraco").controller("Umbraco.Editors.MediaTypes.MoveController",function($scope,mediaTypeResource,treeService,navigationService,notificationsService,appState,eventsService){var dialogOptions=$scope.dialogOptions;$scope.dialogTreeEventHandler=$({});function nodeSelectHandler(ev,args){args.event.preventDefault();args.event.stopPropagation();if($scope.target){$scope.target.selected=false;}
$scope.target=args.node;$scope.target.selected=true;}
$scope.move=function(){$scope.busy=true;$scope.error=false;mediaTypeResource.move({parentId:$scope.target.id,id:dialogOptions.currentNode.id}).then(function(path){$scope.error=false;$scope.success=true;$scope.busy=false;treeService.removeNode($scope.currentNode);var activeNode=appState.getTreeState("selectedNode");navigationService.syncTree({tree:"mediaTypes",path:path,forceReload:true,activate:false}).then(function(args){if(activeNode){var activeNodePath=treeService.getPath(activeNode).join();navigationService.syncTree({tree:"mediaTypes",path:activeNodePath,forceReload:false,activate:true});}});eventsService.emit('app.refreshEditor');},function(err){$scope.success=false;$scope.error=err;$scope.busy=false;if(angular.isArray(err.data.notifications)){for(var i=0;i<err.data.notifications.length;i++){notificationsService.showNotification(err.data.notifications[i]);}}});};$scope.dialogTreeEventHandler.bind("treeNodeSelect",nodeSelectHandler);$scope.$on('$destroy',function(){$scope.dialogTreeEventHandler.unbind("treeNodeSelect",nodeSelectHandler);});});(function(){'use strict';function PermissionsController($scope,mediaTypeResource,iconHelper,contentTypeHelper,localizationService){var vm=this;var childNodeSelectorOverlayTitle="";vm.mediaTypes=[];vm.selectedChildren=[];vm.addChild=addChild;vm.removeChild=removeChild;init();function init(){childNodeSelectorOverlayTitle=localizationService.localize("contentTypeEditor_chooseChildNode");mediaTypeResource.getAll().then(function(mediaTypes){vm.mediaTypes=mediaTypes;iconHelper.formatContentTypeIcons(vm.mediaTypes);vm.selectedChildren=contentTypeHelper.makeObjectArrayFromId($scope.model.allowedContentTypes,vm.mediaTypes);if($scope.model.id===0){contentTypeHelper.insertChildNodePlaceholder(vm.mediaTypes,$scope.model.name,$scope.model.icon,$scope.model.id);}});}
function addChild($event){vm.childNodeSelectorOverlay={view:"itempicker",title:childNodeSelectorOverlayTitle,availableItems:vm.mediaTypes,selectedItems:vm.selectedChildren,event:$event,show:true,submit:function(model){vm.selectedChildren.push(model.selectedItem);$scope.model.allowedContentTypes.push(model.selectedItem.id);vm.childNodeSelectorOverlay.show=false;vm.childNodeSelectorOverlay=null;}};}
function removeChild(selectedChild,index){vm.selectedChildren.splice(index,1);var selectedChildIndex=$scope.model.allowedContentTypes.indexOf(selectedChild.id);$scope.model.allowedContentTypes.splice(selectedChildIndex,1);}}
angular.module("umbraco").controller("Umbraco.Editors.MediaType.PermissionsController",PermissionsController);})();function memberCreateController($scope,$routeParams,memberTypeResource,iconHelper){memberTypeResource.getTypes($scope.currentNode.id).then(function(data){$scope.allowedTypes=iconHelper.formatContentTypeIcons(data);});}
angular.module('umbraco').controller("Umbraco.Editors.Member.CreateController",memberCreateController);function MemberDeleteController($scope,memberResource,treeService,navigationService,editorState,$location,$routeParams){$scope.performDelete=function(){$scope.currentNode.loading=true;memberResource.deleteByKey($scope.currentNode.id).then(function(){$scope.currentNode.loading=false;treeService.removeNode($scope.currentNode);if(editorState.current&&editorState.current.key==$scope.currentNode.id){$location.path("/member/member/list/"+($routeParams.listName?$routeParams.listName:'all-members'));}
navigationService.hideMenu();});};$scope.cancel=function(){navigationService.hideDialog();};}
angular.module("umbraco").controller("Umbraco.Editors.Member.DeleteController",MemberDeleteController);function MemberEditController($scope,$routeParams,$location,$q,$window,appState,memberResource,entityResource,navigationService,notificationsService,angularHelper,serverValidationManager,contentEditingHelper,fileManager,formHelper,umbModelMapper,editorState,umbRequestHelper,$http){$scope.page={};$scope.page.loading=true;$scope.page.menu={};$scope.page.menu.currentSection=appState.getSectionState("currentSection");$scope.page.menu.currentNode=null;$scope.page.nameLocked=false;$scope.page.listViewPath=null;$scope.page.saveButtonState="init";$scope.busy=false;$scope.page.listViewPath=($routeParams.page&&$routeParams.listName)?"/member/member/list/"+$routeParams.listName+"?page="+$routeParams.page:null;function buildTreePath(data){return $routeParams.listName?"-1,"+$routeParams.listName:"-1";}
if($routeParams.create){if($routeParams.doctype){memberResource.getScaffold($routeParams.doctype).then(function(data){$scope.content=data;setHeaderNameState($scope.content);editorState.set($scope.content);$scope.page.loading=false;});}
else{memberResource.getScaffold().then(function(data){$scope.content=data;setHeaderNameState($scope.content);editorState.set($scope.content);$scope.page.loading=false;});}}
else{if($routeParams.id&&$routeParams.id.length<9){entityResource.getById($routeParams.id,"Member").then(function(entity){$location.path("/member/member/edit/"+entity.key);});}
else{memberResource.getByKey($routeParams.id).then(function(data){$scope.content=data;setHeaderNameState($scope.content);editorState.set($scope.content);var path=buildTreePath(data);navigationService.syncTree({tree:"member",path:path.split(",")});umbRequestHelper.resourcePromise($http.get(data.treeNodeUrl),'Failed to retrieve data for child node '+data.key).then(function(node){$scope.page.menu.currentNode=node;});serverValidationManager.executeAndClearAllSubscriptions();$scope.page.loading=false;});}}
function setHeaderNameState(content){if(content.membershipScenario===0){$scope.page.nameLocked=true;}}
$scope.save=function(){if(!$scope.busy&&formHelper.submitForm({scope:$scope,statusMessage:"Saving..."})){$scope.busy=true;$scope.page.saveButtonState="busy";memberResource.save($scope.content,$routeParams.create,fileManager.getFiles()).then(function(data){formHelper.resetForm({scope:$scope,notifications:data.notifications});contentEditingHelper.handleSuccessfulSave({scope:$scope,savedContent:data,redirectId:data.key,rebindCallback:contentEditingHelper.reBindChangedProperties($scope.content,data)});editorState.set($scope.content);$scope.busy=false;$scope.page.saveButtonState="success";var path=buildTreePath(data);navigationService.syncTree({tree:"member",path:path.split(","),forceReload:true});},function(err){contentEditingHelper.handleSaveError({redirectOnFailure:false,err:err,rebindCallback:contentEditingHelper.reBindChangedProperties($scope.content,err.data)});editorState.set($scope.content);$scope.busy=false;$scope.page.saveButtonState="error";});}else{$scope.busy=false;}};}
angular.module("umbraco").controller("Umbraco.Editors.Member.EditController",MemberEditController);function MemberListController($scope,$routeParams,$location,$q,$window,appState,memberResource,entityResource,navigationService,notificationsService,angularHelper,serverValidationManager,contentEditingHelper,fileManager,formHelper,umbModelMapper,editorState,localizationService){$scope.currentSection=appState.getSectionState("currentSection");$scope.currentNode=null;$scope.page={};$scope.page.lockedName=true;$scope.page.loading=true;memberResource.getListNode($routeParams.id).then(function(data){$scope.content=data;if($scope.content!=null&&$scope.content.name!=null&&$scope.content.name.replace(" ","").toLowerCase()=="allmembers"){localizationService.localize("member_allMembers").then(function(value){$scope.content.name=value;});}
editorState.set($scope.content);navigationService.syncTree({tree:"member",path:data.path.split(",")}).then(function(syncArgs){$scope.currentNode=syncArgs.node;});serverValidationManager.executeAndClearAllSubscriptions();$scope.page.loading=false;});}
angular.module("umbraco").controller("Umbraco.Editors.Member.ListController",MemberListController);function MemberTypesCreateController($scope,$location,navigationService,memberTypeResource,formHelper,appState,localizationService){$scope.model={folderName:"",creatingFolder:false};var node=$scope.dialogOptions.currentNode,localizeCreateFolder=localizationService.localize("defaultdialog_createFolder");$scope.showCreateFolder=function(){$scope.model.creatingFolder=true;}
$scope.createContainer=function(){if(formHelper.submitForm({scope:$scope,formCtrl:this.createFolderForm,statusMessage:localizeCreateFolder})){memberTypeResource.createContainer(node.id,$scope.model.folderName).then(function(folderId){navigationService.hideMenu();var currPath=node.path?node.path:"-1";navigationService.syncTree({tree:"membertypes",path:currPath+","+folderId,forceReload:true,activate:true});formHelper.resetForm({scope:$scope});var section=appState.getSectionState("currentSection");},function(err){});};}
$scope.createMemberType=function(){$location.search('create',null);$location.path("/settings/membertypes/edit/"+node.id).search("create","true");navigationService.hideMenu();}}
angular.module('umbraco').controller("Umbraco.Editors.MemberTypes.CreateController",MemberTypesCreateController);function MemberTypesDeleteController($scope,memberTypeResource,treeService,navigationService){$scope.performDelete=function(){$scope.currentNode.loading=true;memberTypeResource.deleteById($scope.currentNode.id).then(function(){$scope.currentNode.loading=false;var rootNode=treeService.getTreeRoot($scope.currentNode);treeService.removeNode($scope.currentNode);navigationService.hideMenu();});};$scope.cancel=function(){navigationService.hideDialog();};}
angular.module("umbraco").controller("Umbraco.Editors.MemberTypes.DeleteController",MemberTypesDeleteController);(function(){"use strict";function MemberTypesEditController($scope,$rootScope,$routeParams,$log,$filter,memberTypeResource,dataTypeResource,editorState,iconHelper,formHelper,navigationService,contentEditingHelper,notificationsService,$q,localizationService,overlayHelper,contentTypeHelper){var vm=this;var localizeSaving=localizationService.localize("general_saving");vm.save=save;vm.currentNode=null;vm.contentType={};vm.page={};vm.page.loading=false;vm.page.saveButtonState="init";vm.page.navigation=[{"name":localizationService.localize("general_design"),"icon":"icon-document-dashed-line","view":"views/membertypes/views/design/design.html","active":true}];vm.page.keyboardShortcutsOverview=[{"name":localizationService.localize("shortcuts_shortcut"),"shortcuts":[{"description":localizationService.localize("shortcuts_addTab"),"keys":[{"key":"alt"},{"key":"shift"},{"key":"t"}]},{"description":localizationService.localize("shortcuts_addProperty"),"keys":[{"key":"alt"},{"key":"shift"},{"key":"p"}]},{"description":localizationService.localize("shortcuts_addEditor"),"keys":[{"key":"alt"},{"key":"shift"},{"key":"e"}]},{"description":localizationService.localize("shortcuts_editDataType"),"keys":[{"key":"alt"},{"key":"shift"},{"key":"d"}]}]}];contentTypeHelper.checkModelsBuilderStatus().then(function(result){vm.page.modelsBuilder=result;if(result){vm.page.defaultButton={hotKey:"ctrl+s",hotKeyWhenHidden:true,labelKey:"buttons_save",letter:"S",type:"submit",handler:function(){vm.save();}};vm.page.subButtons=[{hotKey:"ctrl+g",hotKeyWhenHidden:true,labelKey:"buttons_saveAndGenerateModels",letter:"G",handler:function(){vm.page.saveButtonState="busy";vm.save().then(function(result){vm.page.saveButtonState="busy";localizationService.localize("modelsBuilder_buildingModels").then(function(headerValue){localizationService.localize("modelsBuilder_waitingMessage").then(function(msgValue){notificationsService.info(headerValue,msgValue);});});contentTypeHelper.generateModels().then(function(result){if(result.success){contentTypeHelper.checkModelsBuilderStatus().then(function(statusResult){vm.page.modelsBuilder=statusResult;});vm.page.saveButtonState="init";localizationService.localize("modelsBuilder_modelsGenerated").then(function(value){notificationsService.success(value);});}else{vm.page.saveButtonState="error";localizationService.localize("modelsBuilder_modelsExceptionInUlog").then(function(value){notificationsService.error(value);});}},function(){vm.page.saveButtonState="error";localizationService.localize("modelsBuilder_modelsGeneratedError").then(function(value){notificationsService.error(value);});});});}}];}});if($routeParams.create){vm.page.loading=true;memberTypeResource.getScaffold($routeParams.id).then(function(dt){init(dt);vm.page.loading=false;});}
else{vm.page.loading=true;memberTypeResource.getById($routeParams.id).then(function(dt){init(dt);syncTreeNode(vm.contentType,dt.path,true);vm.page.loading=false;});}
function save(){if(overlayHelper.getNumberOfOverlays()===0){var deferred=$q.defer();vm.page.saveButtonState="busy";contentEditingHelper.contentEditorPerformSave({statusMessage:localizeSaving,saveMethod:memberTypeResource.save,scope:$scope,content:vm.contentType,redirectOnFailure:false,rebindCallback:function(origContentType,savedContentType){vm.contentType.id=savedContentType.id;vm.contentType.groups.forEach(function(group){if(!group.name)return;var k=0;while(k<savedContentType.groups.length&&savedContentType.groups[k].name!=group.name)
k++;if(k==savedContentType.groups.length){group.id=0;return;}
var savedGroup=savedContentType.groups[k];if(!group.id)group.id=savedGroup.id;group.properties.forEach(function(property){if(property.id||!property.alias)return;k=0;while(k<savedGroup.properties.length&&savedGroup.properties[k].alias!=property.alias)
k++;if(k==savedGroup.properties.length){property.id=0;return;}
var savedProperty=savedGroup.properties[k];property.id=savedProperty.id;});});}}).then(function(data){syncTreeNode(vm.contentType,data.path);vm.page.saveButtonState="success";deferred.resolve(data);},function(err){if(err){editorState.set($scope.content);}
else{localizationService.localize("speechBubbles_validationFailedHeader").then(function(headerValue){localizationService.localize("speechBubbles_validationFailedMessage").then(function(msgValue){notificationsService.error(headerValue,msgValue);});});}
vm.page.saveButtonState="error";deferred.reject(err);});return deferred.promise;}}
function init(contentType){if(contentType.groups.length!==0){angular.forEach(contentType.groups,function(group){angular.forEach(group.properties,function(property){getDataTypeDetails(property);});});}
convertLegacyIcons(contentType);editorState.set(contentType);vm.contentType=contentType;}
function convertLegacyIcons(contentType){var contentTypeArray=[];contentTypeArray.push({"icon":contentType.icon});iconHelper.formatContentTypeIcons(contentTypeArray);contentType.icon=contentTypeArray[0].icon;}
function getDataTypeDetails(property){if(property.propertyState!=="init"){dataTypeResource.getById(property.dataTypeId).then(function(dataType){property.dataTypeIcon=dataType.icon;property.dataTypeName=dataType.name;});}}
function syncTreeNode(dt,path,initialLoad){navigationService.syncTree({tree:"membertypes",path:path.split(","),forceReload:initialLoad!==true}).then(function(syncArgs){vm.currentNode=syncArgs.node;});}}
angular.module("umbraco").controller("Umbraco.Editors.MemberTypes.EditController",MemberTypesEditController);})();angular.module("umbraco").controller("Umbraco.Editors.MemberTypes.MoveController",function($scope){});function imageFilePickerController($scope){$scope.pick=function(){$scope.mediaPickerDialog={};$scope.mediaPickerDialog.view="mediapicker";$scope.mediaPickerDialog.show=true;$scope.mediaPickerDialog.submit=function(model){$scope.model.value=model.selectedImages[0].image;$scope.mediaPickerDialog.show=false;$scope.mediaPickerDialog=null;};$scope.mediaPickerDialog.close=function(oldModel){$scope.mediaPickerDialog.show=false;$scope.mediaPickerDialog=null;};};}
angular.module('umbraco').controller("Umbraco.PrevalueEditors.ImageFilePickerController",imageFilePickerController);function mediaPickerController($scope,dialogService,entityResource,$log,iconHelper){function trim(str,chr){var rgxtrim=(!chr)?new RegExp('^\\s+|\\s+$','g'):new RegExp('^'+chr+'+|'+chr+'+$','g');return str.replace(rgxtrim,'');}
$scope.renderModel=[];var dialogOptions={multiPicker:false,entityType:"Media",section:"media",treeAlias:"media"};$scope.openContentPicker=function(){$scope.contentPickerOverlay=dialogOptions;$scope.contentPickerOverlay.view="treePicker";$scope.contentPickerOverlay.show=true;$scope.contentPickerOverlay.submit=function(model){if($scope.contentPickerOverlay.multiPicker){_.each(model.selection,function(item,i){$scope.add(item);});}
else{$scope.clear();$scope.add(model.selection[0]);}
$scope.contentPickerOverlay.show=false;$scope.contentPickerOverlay=null;};$scope.contentPickerOverlay.close=function(oldModel){$scope.contentPickerOverlay.show=false;$scope.contentPickerOverlay=null;};}
$scope.remove=function(index,event){event.preventDefault();$scope.renderModel.splice(index,1);};$scope.clear=function(){$scope.renderModel=[];};$scope.add=function(item){var currIds=_.map($scope.renderModel,function(i){return i.id;});if(currIds.indexOf(item.id)<0){item.icon=iconHelper.convertFromLegacyIcon(item.icon);$scope.renderModel.push({name:item.name,id:item.id,icon:item.icon});}};var unsubscribe=$scope.$on("formSubmitting",function(ev,args){var currIds=_.map($scope.renderModel,function(i){return i.id;});$scope.model.value=trim(currIds.join(),",");});$scope.$on('$destroy',function(){unsubscribe();});var modelIds=$scope.model.value?$scope.model.value.split(','):[];entityResource.getByIds(modelIds,dialogOptions.entityType).then(function(data){_.each(data,function(item,i){item.icon=iconHelper.convertFromLegacyIcon(item.icon);$scope.renderModel.push({name:item.name,id:item.id,icon:item.icon});});});}
angular.module('umbraco').controller("Umbraco.PrevalueEditors.MediaPickerController",mediaPickerController);angular.module("umbraco").controller("Umbraco.PrevalueEditors.MultiValuesController",function($scope,$timeout){$scope.newItem="";$scope.hasError=false;if(!angular.isArray($scope.model.value)){var items=[];for(var i in $scope.model.value){items.push({value:$scope.model.value[i].value,sortOrder:$scope.model.value[i].sortOrder,id:i});}
items.sort(function(a,b){return(a.sortOrder>b.sortOrder)?1:((b.sortOrder>a.sortOrder)?-1:0);});$scope.model.value=items;}
$scope.remove=function(item,evt){evt.preventDefault();$scope.model.value=_.reject($scope.model.value,function(x){return x.value===item.value;});};$scope.add=function(evt){evt.preventDefault();if($scope.newItem){if(!_.contains($scope.model.value,$scope.newItem)){$scope.model.value.push({value:$scope.newItem});$scope.newItem="";$scope.hasError=false;return;}}
$scope.hasError=true;};$scope.sortableOptions={axis:'y',containment:'parent',cursor:'move',items:'> div.control-group',tolerance:'pointer',update:function(e,ui){var newIndex=ui.item.index();var movedPrevalueText=$('input[type="text"]',ui.item).val();var originalIndex=getElementIndexByPrevalueText(movedPrevalueText);if(originalIndex>-1){var movedElement=$scope.model.value[originalIndex];$scope.model.value.splice(originalIndex,1);$scope.model.value.splice(newIndex,0,movedElement);}}};function getElementIndexByPrevalueText(value){for(var i=0;i<$scope.model.value.length;i++){if($scope.model.value[i].value===value){return i;}}
return-1;}});angular.module('umbraco').controller("Umbraco.PrevalueEditors.TreePickerController",function($scope,dialogService,entityResource,$log,iconHelper){$scope.renderModel=[];$scope.ids=[];var config={multiPicker:false,entityType:"Document",type:"content",treeAlias:"content"};if($scope.model.value){$scope.ids=$scope.model.value.split(',');entityResource.getByIds($scope.ids,config.entityType).then(function(data){_.each(data,function(item,i){item.icon=iconHelper.convertFromLegacyIcon(item.icon);$scope.renderModel.push({name:item.name,id:item.id,icon:item.icon});});});}
$scope.openContentPicker=function(){$scope.treePickerOverlay={};$scope.treePickerOverlay.section=config.type;$scope.treePickerOverlay.treeAlias=config.treeAlias;$scope.treePickerOverlay.multiPicker=config.multiPicker;$scope.treePickerOverlay.view="treePicker";$scope.treePickerOverlay.show=true;$scope.treePickerOverlay.submit=function(model){if(config.multiPicker){populate(model.selection);}else{populate(model.selection[0]);}
$scope.treePickerOverlay.show=false;$scope.treePickerOverlay=null;};$scope.treePickerOverlay.close=function(oldModel){$scope.treePickerOverlay.show=false;$scope.treePickerOverlay=null;};}
$scope.remove=function(index){$scope.renderModel.splice(index,1);$scope.ids.splice(index,1);$scope.model.value=trim($scope.ids.join(),",");};$scope.clear=function(){$scope.model.value="";$scope.renderModel=[];$scope.ids=[];};$scope.add=function(item){if($scope.ids.indexOf(item.id)<0){item.icon=iconHelper.convertFromLegacyIcon(item.icon);$scope.ids.push(item.id);$scope.renderModel.push({name:item.name,id:item.id,icon:item.icon});$scope.model.value=trim($scope.ids.join(),",");}};var unsubscribe=$scope.$on("formSubmitting",function(ev,args){$scope.model.value=trim($scope.ids.join(),",");});$scope.$on('$destroy',function(){unsubscribe();});function trim(str,chr){var rgxtrim=(!chr)?new RegExp('^\\s+|\\s+$','g'):new RegExp('^'+chr+'+|'+chr+'+$','g');return str.replace(rgxtrim,'');}
function populate(data){if(angular.isArray(data)){_.each(data,function(item,i){$scope.add(item);});}else{$scope.clear();$scope.add(data);}}});angular.module('umbraco').controller("Umbraco.PrevalueEditors.TreeSourceController",function($scope,dialogService,entityResource,$log,iconHelper){if(!$scope.model){$scope.model={};}
if(!$scope.model.value){$scope.model.value={type:"content"};}
if($scope.model.value.id&&$scope.model.value.type!=="member"){var ent="Document";if($scope.model.value.type==="media"){ent="Media";}
entityResource.getById($scope.model.value.id,ent).then(function(item){item.icon=iconHelper.convertFromLegacyIcon(item.icon);$scope.node=item;});}
$scope.openContentPicker=function(){$scope.treePickerOverlay={view:"treepicker",section:$scope.model.value.type,treeAlias:$scope.model.value.type,multiPicker:false,show:true,submit:function(model){var item=model.selection[0];populate(item);$scope.treePickerOverlay.show=false;$scope.treePickerOverlay=null;}};};$scope.clear=function(){$scope.model.value.id=undefined;$scope.node=undefined;$scope.model.value.query=undefined;};var unsubscribe=$scope.$on("formSubmitting",function(ev,args){if($scope.model.value.type==="member"){$scope.model.value.id=-1;$scope.model.value.query="";}});$scope.$on('$destroy',function(){unsubscribe();});function populate(item){$scope.clear();item.icon=iconHelper.convertFromLegacyIcon(item.icon);$scope.node=item;$scope.model.value.id=item.id;}});function booleanEditorController($scope,$rootScope,assetsService){function setupViewModel(){$scope.renderModel={value:false};if($scope.model.config&&$scope.model.config.default&&$scope.model.config.default.toString()==="1"&&$scope.model&&!$scope.model.value){$scope.renderModel.value=true;}
if($scope.model&&$scope.model.value&&($scope.model.value.toString()==="1"||angular.lowercase($scope.model.value)==="true")){$scope.renderModel.value=true;}}
setupViewModel();$scope.$watch("renderModel.value",function(newVal){$scope.model.value=newVal===true?"1":"0";});$scope.model.onValueChanged=function(newVal,oldVal){setupViewModel();};}
angular.module("umbraco").controller("Umbraco.PropertyEditors.BooleanController",booleanEditorController);angular.module("umbraco").controller("Umbraco.PropertyEditors.ChangePasswordController",function($scope,$routeParams){function resetModel(isNew){if(!$scope.model.config||$scope.model.config.disableToggle===undefined){$scope.model.config.disableToggle=false;}
if(!$scope.model.config||$scope.model.config.hasPassword===undefined){$scope.model.config.hasPassword=false;}
if(!$scope.model.config||$scope.model.config.enablePasswordRetrieval===undefined){$scope.model.config.enablePasswordRetrieval=true;}
if(!$scope.model.config||$scope.model.config.requiresQuestionAnswer===undefined){$scope.model.config.requiresQuestionAnswer=false;}
if(!$scope.model.config||$scope.model.config.enableReset===undefined){$scope.model.config.enableReset=true;}
if(!$scope.model.config||$scope.model.config.minPasswordLength===undefined){$scope.model.config.minPasswordLength=0;}
if(!angular.isObject($scope.model.value)){$scope.model.value={newPassword:null,oldPassword:null,reset:null,answer:null};}
else{if(!isNew){$scope.model.value.newPassword=null;$scope.model.value.oldPassword=null;}
$scope.model.value.reset=null;$scope.model.value.answer=null;}
if(!isNew){$scope.model.confirm="";}
else if($scope.model.value.newPassword&&$scope.model.value.newPassword.length>0){$scope.model.confirm=$scope.model.value.newPassword;}}
resetModel($routeParams.create);$scope.changing=$scope.model.config.disableToggle===true||!$scope.model.config.hasPassword;if(!$scope.changing){$scope.model.value=null;}
$scope.doChange=function(){resetModel();$scope.changing=true;$scope.model.value.generatedPassword=null;};$scope.cancelChange=function(){$scope.changing=false;$scope.model.value=null;};var unsubscribe=[];unsubscribe.push($scope.$on("formSubmitted",function(){if($scope.model.config.disableToggle===false){$scope.changing=false;}}));unsubscribe.push($scope.$on("formSubmitting",function(){if($scope.changing&&$scope.model.value){$scope.model.value.generatedPassword=null;}
else if(!$scope.changing){$scope.model.value=null;}}));$scope.$on('$destroy',function(){for(var u in unsubscribe){unsubscribe[u]();}});$scope.showReset=function(){return $scope.model.config.hasPassword&&$scope.model.config.enableReset;};$scope.showOldPass=function(){return $scope.model.config.hasPassword&&!$scope.model.config.allowManuallyChangingPassword&&!$scope.model.config.enablePasswordRetrieval&&!$scope.model.value.reset;};$scope.showNewPass=function(){return!$scope.model.value.reset;};$scope.showConfirmPass=function(){return!$scope.model.value.reset;};$scope.showCancelBtn=function(){return $scope.model.config.disableToggle!==true&&$scope.model.config.hasPassword;};});angular.module("umbraco").controller("Umbraco.PropertyEditors.CheckboxListController",function($scope){if(angular.isObject($scope.model.config.items)){var newItems=[];var vals=_.values($scope.model.config.items);var keys=_.keys($scope.model.config.items);for(var i=0;i<vals.length;i++){newItems.push({id:keys[i],sortOrder:vals[i].sortOrder,value:vals[i].value});}
newItems.sort(function(a,b){return(a.sortOrder>b.sortOrder)?1:((b.sortOrder>a.sortOrder)?-1:0);});$scope.model.config.items=newItems;}
function setupViewModel(){$scope.selectedItems=[];if($scope.model.value===null||$scope.model.value===undefined){$scope.model.value=[];}
for(var i=0;i<$scope.model.config.items.length;i++){var isChecked=_.contains($scope.model.value,$scope.model.config.items[i].id);$scope.selectedItems.push({checked:isChecked,key:$scope.model.config.items[i].id,val:$scope.model.config.items[i].value});}}
setupViewModel();$scope.$watch("selectedItems",function(newVal,oldVal){$scope.model.value=[];for(var x=0;x<$scope.selectedItems.length;x++){if($scope.selectedItems[x].checked){$scope.model.value.push($scope.selectedItems[x].key);}}},true);$scope.model.onValueChanged=function(newVal,oldVal){setupViewModel();};});function ColorPickerController($scope){$scope.toggleItem=function(color){if($scope.model.value==color){$scope.model.value="";$scope.propertyForm.modelValue.$setViewValue($scope.model.value);}
else{$scope.model.value=color;$scope.propertyForm.modelValue.$setViewValue($scope.model.value);}};$scope.validateMandatory=function(){return{isValid:!$scope.model.validation.mandatory||($scope.model.value!=null&&$scope.model.value!=""),errorMsg:"Value cannot be empty",errorKey:"required"};}
$scope.isConfigured=$scope.model.config&&$scope.model.config.items&&_.keys($scope.model.config.items).length>0;}
angular.module("umbraco").controller("Umbraco.PropertyEditors.ColorPickerController",ColorPickerController);angular.module("umbraco").controller("Umbraco.PrevalueEditors.MultiColorPickerController",function($scope,$timeout,assetsService,angularHelper,$element){var defaultColor="000000";$scope.newColor=defaultColor;$scope.hasError=false;assetsService.load(["lib/spectrum/spectrum.js"],$scope).then(function(){var elem=$element.find("input");elem.spectrum({color:null,showInitial:false,chooseText:"choose",cancelText:"cancel",preferredFormat:"hex",showInput:true,clickoutFiresChange:true,hide:function(color){$element.find(".btn.add").show();},change:function(color){angularHelper.safeApply($scope,function(){$scope.newColor=color.toHexString().trimStart("#");});},show:function(){$element.find(".btn.add").hide();}});});if(!angular.isArray($scope.model.value)){var items=[];for(var i in $scope.model.value){items.push({value:$scope.model.value[i],id:i});}
$scope.model.value=items;}
$scope.remove=function(item,evt){evt.preventDefault();$scope.model.value=_.reject($scope.model.value,function(x){return x.value===item.value;});};$scope.add=function(evt){evt.preventDefault();if($scope.newColor){var exists=_.find($scope.model.value,function(item){return item.value.toUpperCase()==$scope.newColor.toUpperCase();});if(!exists){$scope.model.value.push({value:$scope.newColor});$scope.hasError=false;return;}
$scope.hasError=true;}};assetsService.loadCss("lib/spectrum/spectrum.css");});function contentPickerController($scope,dialogService,entityResource,editorState,$log,iconHelper,$routeParams,fileManager,contentEditingHelper,angularHelper,navigationService,$location){function trim(str,chr){var rgxtrim=(!chr)?new RegExp('^\\s+|\\s+$','g'):new RegExp('^'+chr+'+|'+chr+'+$','g');return str.replace(rgxtrim,'');}
function startWatch(){$scope.$watch(function(){return _.map($scope.renderModel,function(i){return i.id;}).join();},function(newVal){var currIds=_.map($scope.renderModel,function(i){return i.id;});$scope.model.value=trim(currIds.join(),",");if($scope.model.config&&$scope.model.config.minNumber&&parseInt($scope.model.config.minNumber)>$scope.renderModel.length){$scope.contentPickerForm.minCount.$setValidity("minCount",false);}
else{$scope.contentPickerForm.minCount.$setValidity("minCount",true);}
if($scope.model.config&&$scope.model.config.maxNumber&&parseInt($scope.model.config.maxNumber)<$scope.renderModel.length){$scope.contentPickerForm.maxCount.$setValidity("maxCount",false);}
else{$scope.contentPickerForm.maxCount.$setValidity("maxCount",true);}});}
$scope.renderModel=[];$scope.dialogEditor=editorState&&editorState.current&&editorState.current.isDialogEditor===true;var defaultConfig={multiPicker:false,showOpenButton:false,showEditButton:false,showPathOnHover:false,startNode:{query:"",type:"content",id:$scope.model.config.startNodeId?$scope.model.config.startNodeId:-1}};if($scope.model.config){$scope.model.config=angular.extend(defaultConfig,$scope.model.config);}
$scope.model.config.multiPicker=($scope.model.config.multiPicker==="1"?true:false);$scope.model.config.showOpenButton=($scope.model.config.showOpenButton==="1"?true:false);$scope.model.config.showEditButton=($scope.model.config.showEditButton==="1"?true:false);$scope.model.config.showPathOnHover=($scope.model.config.showPathOnHover==="1"?true:false);var entityType=$scope.model.config.startNode.type==="member"?"Member":$scope.model.config.startNode.type==="media"?"Media":"Document";$scope.allowOpenButton=entityType==="Document"||entityType==="Media";$scope.allowEditButton=entityType==="Document";var dialogOptions={multiPicker:$scope.model.config.multiPicker,entityType:entityType,filterCssClass:"not-allowed not-published",startNodeId:null,callback:function(data){if(angular.isArray(data)){_.each(data,function(item,i){$scope.add(item);});}else{$scope.clear();$scope.add(data);}
angularHelper.getCurrentForm($scope).$setDirty();},treeAlias:$scope.model.config.startNode.type,section:$scope.model.config.startNode.type};angular.extend(dialogOptions,$scope.model.config);if(entityType==="Member"){dialogOptions.filterCssClass="not-allowed";var currFilter=dialogOptions.filter;dialogOptions.filter=function(i){if(i.metaData.isContainer){return true;}
if(!currFilter){return false;}
var filterItem=currFilter.toLowerCase().split(',');var found=filterItem.indexOf(i.metaData.contentType.toLowerCase())>=0;if(!currFilter.startsWith("!")&&!found||currFilter.startsWith("!")&&found){return true;}
return false;}}
if($scope.model.config.startNode.query){var rootId=$routeParams.id;entityResource.getByQuery($scope.model.config.startNode.query,rootId,"Document").then(function(ent){dialogOptions.startNodeId=ent.id;});}else{dialogOptions.startNodeId=$scope.model.config.startNode.id;}
$scope.openContentPicker=function(){$scope.contentPickerOverlay=dialogOptions;$scope.contentPickerOverlay.view="treepicker";$scope.contentPickerOverlay.show=true;$scope.contentPickerOverlay.submit=function(model){if(angular.isArray(model.selection)){_.each(model.selection,function(item,i){$scope.add(item);});}
$scope.contentPickerOverlay.show=false;$scope.contentPickerOverlay=null;}
$scope.contentPickerOverlay.close=function(oldModel){$scope.contentPickerOverlay.show=false;$scope.contentPickerOverlay=null;}};$scope.remove=function(index){$scope.renderModel.splice(index,1);angularHelper.getCurrentForm($scope).$setDirty();};$scope.showNode=function(index){var item=$scope.renderModel[index];var id=item.id;var section=$scope.model.config.startNode.type.toLowerCase();entityResource.getPath(id,entityType).then(function(path){navigationService.changeSection(section);navigationService.showTree(section,{tree:section,path:path,forceReload:false,activate:true});var routePath=section+"/"+section+"/edit/"+id.toString();$location.path(routePath).search("");});}
$scope.add=function(item){var currIds=_.map($scope.renderModel,function(i){return i.id;});if(currIds.indexOf(item.id)<0){item.icon=iconHelper.convertFromLegacyIcon(item.icon);$scope.renderModel.push({name:item.name,id:item.id,icon:item.icon,path:item.path});}};$scope.clear=function(){$scope.renderModel=[];};var unsubscribe=$scope.$on("formSubmitting",function(ev,args){var currIds=_.map($scope.renderModel,function(i){return i.id;});$scope.model.value=trim(currIds.join(),",");});$scope.$on('$destroy',function(){unsubscribe();});var modelIds=$scope.model.value?$scope.model.value.split(','):[];entityResource.getByIds(modelIds,entityType).then(function(data){_.each(modelIds,function(id,i){var entity=_.find(data,function(d){return d.id==id;});if(entity){entity.icon=iconHelper.convertFromLegacyIcon(entity.icon);$scope.renderModel.push({name:entity.name,id:entity.id,icon:entity.icon,path:entity.path});}});startWatch();});}
angular.module('umbraco').controller("Umbraco.PropertyEditors.ContentPickerController",contentPickerController);function dateTimePickerController($scope,notificationsService,assetsService,angularHelper,userService,$element){var config={pickDate:true,pickTime:true,useSeconds:true,format:"YYYY-MM-DD HH:mm:ss",icons:{time:"icon-time",date:"icon-calendar",up:"icon-chevron-up",down:"icon-chevron-down"}};$scope.model.config=angular.extend(config,$scope.model.config);if($scope.model.config.format===""||$scope.model.config.format===undefined||$scope.model.config.format===null){$scope.model.config.format=$scope.model.config.pickTime?"YYYY-MM-DD HH:mm:ss":"YYYY-MM-DD";}
$scope.hasDatetimePickerValue=$scope.model.value?true:false;$scope.datetimePickerValue=null;$scope.hidePicker=function(){var dtp=$element.find("div:first");if(dtp&&dtp.datetimepicker){dtp.datetimepicker("hide");}};$(document).bind("click",$scope.hidePicker);function applyDate(e){angularHelper.safeApply($scope,function(){if(e.date&&e.date.isValid()){$scope.datePickerForm.datepicker.$setValidity("pickerError",true);$scope.hasDatetimePickerValue=true;$scope.datetimePickerValue=e.date.format($scope.model.config.format);$scope.model.value=$scope.datetimePickerValue;}
else{$scope.hasDatetimePickerValue=false;$scope.datetimePickerValue=null;}
if(!$scope.model.config.pickTime){$element.find("div:first").datetimepicker("hide",0);}});}
var picker=null;$scope.clearDate=function(){$scope.hasDatetimePickerValue=false;$scope.datetimePickerValue=null;$scope.model.value=null;$scope.datePickerForm.datepicker.$setValidity("pickerError",true);}
userService.getCurrentUser().then(function(user){assetsService.loadCss('lib/datetimepicker/bootstrap-datetimepicker.min.css').then(function(){var filesToLoad=["lib/moment/moment-with-locales.js","lib/datetimepicker/bootstrap-datetimepicker.js"];$scope.model.config.language=user.locale;assetsService.load(filesToLoad,$scope).then(function(){var pickerId=$scope.model.alias;var element=$element.find("div:first");element.datetimepicker(angular.extend({useCurrent:true},$scope.model.config)).on("dp.change",applyDate).on("dp.error",function(a,b,c){$scope.hasDatetimePickerValue=false;$scope.datePickerForm.datepicker.$setValidity("pickerError",false);});if($scope.hasDatetimePickerValue){var dateVal=$scope.model.value?moment($scope.model.value,"YYYY-MM-DD HH:mm:ss"):moment();element.datetimepicker("setValue",dateVal);$scope.datetimePickerValue=dateVal.format($scope.model.config.format);}
element.find("input").bind("blur",function(){$scope.$apply();});$scope.$on('$destroy',function(){element.find("input").unbind("blur");element.datetimepicker("destroy");});var unsubscribe=$scope.$on("formSubmitting",function(ev,args){if($scope.hasDatetimePickerValue){var elementData=$element.find("div:first").data().DateTimePicker;if($scope.model.config.pickTime){$scope.model.value=elementData.getDate().format("YYYY-MM-DD HH:mm:ss");}
else{$scope.model.value=elementData.getDate().format("YYYY-MM-DD");}}
else{$scope.model.value=null;}});$scope.$on('$destroy',function(){unsubscribe();});});});});var unsubscribe=$scope.$on("formSubmitting",function(ev,args){if($scope.hasDatetimePickerValue){if($scope.model.config.pickTime){$scope.model.value=$element.find("div:first").data().DateTimePicker.getDate().format("YYYY-MM-DD HH:mm:ss");}
else{$scope.model.value=$element.find("div:first").data().DateTimePicker.getDate().format("YYYY-MM-DD");}}
else{$scope.model.value=null;}});$scope.$on('$destroy',function(){$(document).unbind("click",$scope.hidePicker);unsubscribe();});}
angular.module("umbraco").controller("Umbraco.PropertyEditors.DatepickerController",dateTimePickerController);angular.module("umbraco").controller("Umbraco.PropertyEditors.DropdownController",function($scope){var config={items:[],multiple:false};angular.extend(config,$scope.model.config);$scope.model.config=config;function convertArrayToDictionaryArray(model){var newItems=[];for(var i=0;i<model.length;i++){newItems.push({id:model[i],sortOrder:0,value:model[i]});}
return newItems;}
function convertObjectToDictionaryArray(model){var newItems=[];var vals=_.values($scope.model.config.items);var keys=_.keys($scope.model.config.items);for(var i=0;i<vals.length;i++){var label=vals[i].value?vals[i].value:vals[i];newItems.push({id:keys[i],sortOrder:vals[i].sortOrder,value:label});}
return newItems;}
if(angular.isArray($scope.model.config.items)){if(!angular.isObject($scope.model.config.items[0])){$scope.model.config.items=convertArrayToDictionaryArray($scope.model.config.items);}}
else if(angular.isObject($scope.model.config.items)){$scope.model.config.items=convertObjectToDictionaryArray($scope.model.config.items);}
else{throw"The items property must be either an array or a dictionary";}
$scope.model.config.items.sort(function(a,b){return(a.sortOrder>b.sortOrder)?1:((b.sortOrder>a.sortOrder)?-1:0);});if($scope.model.value===null||$scope.model.value===undefined){if($scope.model.config.multiple){$scope.model.value=[];}
else{$scope.model.value="";}}});function entityPicker($scope,entityResource){if(!$scope.model.config.entityType){$scope.model.config.entityType="DocumentType";}
if(!$scope.model.config.publishBy){$scope.selectOptions="entity.id as entity.name for entity in entities";}
else{$scope.selectOptions="entity."+$scope.model.config.publishBy+" as entity.name for entity in entities";}
entityResource.getAll($scope.model.config.entityType).then(function(data){_.each(data,function(d){d.id=d.id.toString();});$scope.entities=data;});if($scope.model.value===null||$scope.model.value===undefined){if($scope.model.config.multiple){$scope.model.value=[];}
else{$scope.model.value="";}}
else{if($scope.model.config.multiple==="1"){if(_.isString($scope.model.value)){$scope.model.value=$scope.model.value.split(',');}}}}
angular.module('umbraco').controller("Umbraco.PropertyEditors.EntityPickerController",entityPicker);function fileUploadController($scope,$element,$compile,imageHelper,fileManager,umbRequestHelper,mediaHelper){function clearFiles(){fileManager.setFiles($scope.model.alias,[]);$scope.files=[];if($scope.propertyForm){if($scope.propertyForm.fileCount){$scope.propertyForm.fileCount.$setViewValue($scope.files.length);}}}
function initialize(index){clearFiles();if(!index){index=1;}
$scope.rebuildInput={index:index};$scope.files=[];$scope.originalValue=$scope.model.value;if($scope.model.value!=""&&$scope.model.value!=undefined){var images=$scope.model.value.split(",");$scope.persistedFiles=_.map(images,function(item){return{file:item,isImage:imageHelper.detectIfImageByExtension(item)};});}
else{$scope.persistedFiles=[];}
_.each($scope.persistedFiles,function(file){var thumbnailUrl=umbRequestHelper.getApiUrl("imagesApiBaseUrl","GetBigThumbnail",[{originalImagePath:file.file}]);file.thumbnail=thumbnailUrl;});$scope.clearFiles=false;}
initialize();$scope.validateMandatory=function(){return{isValid:!$scope.model.validation.mandatory||((($scope.persistedFiles!=null&&$scope.persistedFiles.length>0)||($scope.files!=null&&$scope.files.length>0))&&!$scope.clearFiles),errorMsg:"Value cannot be empty",errorKey:"required"};}
$scope.$watch("clearFiles",function(isCleared){if(isCleared==true){$scope.model.value={clearFiles:true};clearFiles();}
else{$scope.model.value=$scope.originalValue;if($scope.propertyForm){$scope.propertyForm.fileCount.$setViewValue($scope.files.length);}}});$scope.$on("filesSelected",function(event,args){$scope.$apply(function(){fileManager.setFiles($scope.model.alias,args.files);$scope.files=[];var newVal="";for(var i=0;i<args.files.length;i++){$scope.files.push({alias:$scope.model.alias,file:args.files[i]});newVal+=args.files[i].name+",";}
$scope.propertyForm.fileCount.$setViewValue($scope.files.length);$scope.clearFiles=false;$scope.model.value={selectedFiles:newVal.trimEnd(",")};});});$scope.$watch("model.value",function(newVal,oldVal){if(newVal!==null&&newVal!==undefined&&newVal!==oldVal){if(newVal.clearFiles!==true&&newVal!==$scope.originalValue&&!newVal.selectedFiles){initialize($scope.rebuildInput.index+1);}}});};angular.module("umbraco").controller('Umbraco.PropertyEditors.FileUploadController',fileUploadController).run(function(mediaHelper,umbRequestHelper,assetsService){if(mediaHelper&&mediaHelper.registerFileResolver){assetsService.load(["lib/moment/moment-with-locales.js"]).then(function(){mediaHelper.registerFileResolver("Umbraco.UploadField",function(property,entity,thumbnail){if(thumbnail){if(mediaHelper.detectIfImageByExtension(property.value)){var thumbnailUrl=property.value+"?rnd="+moment(entity.updateDate).format("YYYYMMDDHHmmss")+"&width=500&animationprocessmode=first";return thumbnailUrl;}
else{return null;}}
else{return property.value;}});});}});angular.module("umbraco").controller("Umbraco.PropertyEditors.FolderBrowserController",function($rootScope,$scope,contentTypeResource){contentTypeResource.getPropertyTypeScaffold(-96).then(function(dt){$scope.fakeProperty={alias:"contents",config:dt.config,description:"",editor:dt.editor,hideLabel:true,id:1,label:"Contents:",validation:{mandatory:false,pattern:null},value:"",view:dt.view};});});angular.module("umbraco").controller("Umbraco.PropertyEditors.GoogleMapsController",function($element,$rootScope,$scope,notificationsService,dialogService,assetsService,$log,$timeout){assetsService.loadJs('http://www.google.com/jsapi').then(function(){google.load("maps","3",{callback:initMap,other_params:"sensor=false"});});function initMap(){var valueArray=$scope.model.value.split(',');var latLng=new google.maps.LatLng(valueArray[0],valueArray[1]);var mapDiv=document.getElementById($scope.model.alias+'_map');var mapOptions={zoom:$scope.model.config.zoom,center:latLng,mapTypeId:google.maps.MapTypeId[$scope.model.config.mapType]};var geocoder=new google.maps.Geocoder();var map=new google.maps.Map(mapDiv,mapOptions);var marker=new google.maps.Marker({map:map,position:latLng,draggable:true});google.maps.event.addListener(map,'click',function(event){dialogService.mediaPicker({callback:function(data){var image=data.selection[0].src;var latLng=event.latLng;var marker=new google.maps.Marker({map:map,icon:image,position:latLng,draggable:true});google.maps.event.addListener(marker,"dragend",function(e){var newLat=marker.getPosition().lat();var newLng=marker.getPosition().lng();codeLatLng(marker.getPosition(),geocoder);$scope.model.vvalue=newLat+","+newLng;});}});});var tabShown=function(e){google.maps.event.trigger(map,'resize');};if(tabsCtrl!=null){tabsCtrl.onTabShown(function(args){tabShown();});}
$element.closest('.umb-panel.tabbable').on('shown','.nav-tabs a',tabShown);$scope.$on('$destroy',function(){$element.closest('.umb-panel.tabbable').off('shown','.nav-tabs a',tabShown);});}
function codeLatLng(latLng,geocoder){geocoder.geocode({'latLng':latLng},function(results,status){if(status==google.maps.GeocoderStatus.OK){var location=results[0].formatted_address;$rootScope.$apply(function(){notificationsService.success("Peter just went to: ",location);});}});}
$scope.model.onValueChanged=function(newVal,oldVal){initMap();};});angular.module("umbraco").controller("Umbraco.PropertyEditors.GridPrevalueEditor.LayoutConfigController",function($scope){$scope.currentLayout=$scope.model.currentLayout;$scope.columns=$scope.model.columns;$scope.rows=$scope.model.rows;$scope.scaleUp=function(section,max,overflow){var add=1;if(overflow!==true){add=(max>1)?1:max;}
section.grid=section.grid+add;};$scope.scaleDown=function(section){var remove=(section.grid>1)?1:section.grid;section.grid=section.grid-remove;};$scope.percentage=function(spans){return((spans/$scope.columns)*100).toFixed(8);};$scope.toggleCollection=function(collection,toggle){if(toggle){collection=[];}else{delete collection;}};$scope.configureSection=function(section,template){if(section===undefined){var space=($scope.availableLayoutSpace>4)?4:$scope.availableLayoutSpace;section={grid:space};template.sections.push(section);}
$scope.currentSection=section;};$scope.deleteSection=function(index){$scope.currentTemplate.sections.splice(index,1);};$scope.closeSection=function(){$scope.currentSection=undefined;};$scope.$watch("currentLayout",function(layout){if(layout){var total=0;_.forEach(layout.sections,function(section){total=(total+section.grid);});$scope.availableLayoutSpace=$scope.columns-total;}},true);});function RowConfigController($scope){$scope.currentRow=$scope.model.currentRow;$scope.editors=$scope.model.editors;$scope.columns=$scope.model.columns;$scope.scaleUp=function(section,max,overflow){var add=1;if(overflow!==true){add=(max>1)?1:max;}
section.grid=section.grid+add;};$scope.scaleDown=function(section){var remove=(section.grid>1)?1:section.grid;section.grid=section.grid-remove;};$scope.percentage=function(spans){return((spans/$scope.columns)*100).toFixed(8);};$scope.toggleCollection=function(collection,toggle){if(toggle){collection=[];}
else{delete collection;}};$scope.configureCell=function(cell,row){if($scope.currentCell&&$scope.currentCell===cell){delete $scope.currentCell;}
else{if(cell===undefined){var available=$scope.availableRowSpace;var space=4;if(available<4&&available>0){space=available;}
cell={grid:space};row.areas.push(cell);}
$scope.currentCell=cell;}};$scope.deleteArea=function(index){$scope.currentRow.areas.splice(index,1);};$scope.closeArea=function(){$scope.currentCell=undefined;};$scope.nameChanged=false;var originalName=$scope.currentRow.name;$scope.$watch("currentRow",function(row){if(row){var total=0;_.forEach(row.areas,function(area){total=(total+area.grid);});$scope.availableRowSpace=$scope.columns-total;if(originalName){if(originalName!=row.name){$scope.nameChanged=true;}
else{$scope.nameChanged=false;}}}},true);}
angular.module("umbraco").controller("Umbraco.PropertyEditors.GridPrevalueEditor.RowConfigController",RowConfigController);angular.module("umbraco").controller("Umbraco.PropertyEditors.Grid.EmbedController",function($scope,$rootScope,$timeout){$scope.setEmbed=function(){$scope.embedDialog={};$scope.embedDialog.view="embed";$scope.embedDialog.show=true;$scope.embedDialog.submit=function(model){$scope.control.value=model.embed.preview;$scope.embedDialog.show=false;$scope.embedDialog=null;};$scope.embedDialog.close=function(oldModel){$scope.embedDialog.show=false;$scope.embedDialog=null;};};$timeout(function(){if($scope.control.$initializing){$scope.setEmbed();}},200);});angular.module("umbraco").controller("Umbraco.PropertyEditors.Grid.MacroController",function($scope,$rootScope,$timeout,dialogService,macroResource,macroService,$routeParams){$scope.title="Click to insert macro";$scope.setMacro=function(){var dialogData={richTextEditor:true,macroData:$scope.control.value||{macroAlias:$scope.control.editor.config&&$scope.control.editor.config.macroAlias?$scope.control.editor.config.macroAlias:""}};$scope.macroPickerOverlay={};$scope.macroPickerOverlay.view="macropicker";$scope.macroPickerOverlay.dialogData=dialogData;$scope.macroPickerOverlay.show=true;$scope.macroPickerOverlay.submit=function(model){var macroObject=macroService.collectValueData(model.selectedMacro,model.macroParams,dialogData.renderingEngine);$scope.control.value={macroAlias:macroObject.macroAlias,macroParamsDictionary:macroObject.macroParamsDictionary};$scope.setPreview($scope.control.value);$scope.macroPickerOverlay.show=false;$scope.macroPickerOverlay=null;};$scope.macroPickerOverlay.close=function(oldModel){$scope.macroPickerOverlay.show=false;$scope.macroPickerOverlay=null;};};$scope.setPreview=function(macro){var contentId=$routeParams.id;macroResource.getMacroResultAsHtmlForEditor(macro.macroAlias,contentId,macro.macroParamsDictionary).then(function(htmlResult){$scope.title=macro.macroAlias;if(htmlResult.trim().length>0&&htmlResult.indexOf("Macro:")<0){$scope.preview=htmlResult;}});};$timeout(function(){if($scope.control.$initializing){$scope.setMacro();}else if($scope.control.value){$scope.setPreview($scope.control.value);}},200);});angular.module("umbraco").controller("Umbraco.PropertyEditors.Grid.MediaController",function($scope,$rootScope,$timeout){$scope.setImage=function(){$scope.mediaPickerOverlay={};$scope.mediaPickerOverlay.view="mediapicker";$scope.mediaPickerOverlay.cropSize=$scope.control.editor.config&&$scope.control.editor.config.size?$scope.control.editor.config.size:undefined;$scope.mediaPickerOverlay.showDetails=true;$scope.mediaPickerOverlay.disableFolderSelect=true;$scope.mediaPickerOverlay.onlyImages=true;$scope.mediaPickerOverlay.show=true;$scope.mediaPickerOverlay.submit=function(model){var selectedImage=model.selectedImages[0];$scope.control.value={focalPoint:selectedImage.focalPoint,id:selectedImage.id,image:selectedImage.image,altText:selectedImage.altText};$scope.setUrl();$scope.mediaPickerOverlay.show=false;$scope.mediaPickerOverlay=null;};$scope.mediaPickerOverlay.close=function(oldModel){$scope.mediaPickerOverlay.show=false;$scope.mediaPickerOverlay=null;};};$scope.setUrl=function(){if($scope.control.value.image){var url=$scope.control.value.image;if($scope.control.editor.config&&$scope.control.editor.config.size){url+="?width="+$scope.control.editor.config.size.width;url+="&height="+$scope.control.editor.config.size.height;url+="&animationprocessmode=first";if($scope.control.value.focalPoint){url+="&center="+$scope.control.value.focalPoint.top+","+$scope.control.value.focalPoint.left;url+="&mode=crop";}}
if(url.indexOf('?')==-1)
{url+="?width=800&upscale=false&animationprocessmode=false"}
$scope.url=url;}};$timeout(function(){if($scope.control.$initializing){$scope.setImage();}else if($scope.control.value){$scope.setUrl();}},200);});(function(){"use strict";function GridRichTextEditorController($scope,tinyMceService,macroService){var vm=this;vm.openLinkPicker=openLinkPicker;vm.openMediaPicker=openMediaPicker;vm.openMacroPicker=openMacroPicker;vm.openEmbed=openEmbed;function openLinkPicker(editor,currentTarget,anchorElement){vm.linkPickerOverlay={view:"linkpicker",currentTarget:currentTarget,show:true,submit:function(model){tinyMceService.insertLinkInEditor(editor,model.target,anchorElement);vm.linkPickerOverlay.show=false;vm.linkPickerOverlay=null;}};}
function openMediaPicker(editor,currentTarget,userData){vm.mediaPickerOverlay={currentTarget:currentTarget,onlyImages:true,showDetails:true,startNodeId:userData.startMediaId,view:"mediapicker",show:true,submit:function(model){tinyMceService.insertMediaInEditor(editor,model.selectedImages[0]);vm.mediaPickerOverlay.show=false;vm.mediaPickerOverlay=null;}};}
function openEmbed(editor){vm.embedOverlay={view:"embed",show:true,submit:function(model){tinyMceService.insertEmbeddedMediaInEditor(editor,model.embed.preview);vm.embedOverlay.show=false;vm.embedOverlay=null;}};}
function openMacroPicker(editor,dialogData){vm.macroPickerOverlay={view:"macropicker",dialogData:dialogData,show:true,submit:function(model){var macroObject=macroService.collectValueData(model.selectedMacro,model.macroParams,dialogData.renderingEngine);tinyMceService.insertMacroInEditor(editor,macroObject,$scope);vm.macroPickerOverlay.show=false;vm.macroPickerOverlay=null;}};}}
angular.module("umbraco").controller("Umbraco.PropertyEditors.Grid.RichTextEditorController",GridRichTextEditorController);})();angular.module("umbraco").controller("Umbraco.PropertyEditors.Grid.TextStringController",function($scope,$rootScope,$timeout,dialogService){});angular.module("umbraco").controller("Umbraco.PropertyEditors.GridController",function($scope,$http,assetsService,localizationService,$rootScope,dialogService,gridService,mediaResource,imageHelper,$timeout,umbRequestHelper,angularHelper){var placeHolder="";var currentForm=angularHelper.getCurrentForm($scope);$scope.currentRow=null;$scope.currentCell=null;$scope.currentToolsControl=null;$scope.currentControl=null;$scope.openRTEToolbarId=null;$scope.hasSettings=false;$scope.showRowConfigurations=true;$scope.sortMode=false;$scope.reorderKey="general_reorder";var draggedRteSettings;$scope.sortableOptionsRow={distance:10,cursor:"move",placeholder:"ui-sortable-placeholder",handle:".umb-row-title-bar",helper:"clone",forcePlaceholderSize:true,tolerance:"pointer",zIndex:999999999999999999,scrollSensitivity:100,cursorAt:{top:40,left:60},sort:function(event,ui){var max=$(".umb-grid").width()-150;if(parseInt(ui.helper.css("left"))>max){ui.helper.css({"left":max+"px"});}
if(parseInt(ui.helper.css("left"))<20){ui.helper.css({"left":20});}},start:function(e,ui){ui.item.context.style.display="block";ui.item.context.style.opacity="0.5";draggedRteSettings={};ui.item.find(".mceNoEditor").each(function(){var id=$(this).attr("id");draggedRteSettings[id]=_.findWhere(tinyMCE.editors,{id:id}).settings;});},stop:function(e,ui){ui.item.context.style.opacity="1";ui.item.parents(".umb-column").find(".mceNoEditor").each(function(){var id=$(this).attr("id");draggedRteSettings[id]=draggedRteSettings[id]||_.findWhere(tinyMCE.editors,{id:id}).settings;tinyMCE.execCommand("mceRemoveEditor",false,id);tinyMCE.init(draggedRteSettings[id]);});currentForm.$setDirty();}};var notIncludedRte=[];var cancelMove=false;$scope.sortableOptionsCell={distance:10,cursor:"move",placeholder:"ui-sortable-placeholder",handle:".umb-control-handle",helper:"clone",connectWith:".umb-cell-inner",forcePlaceholderSize:true,tolerance:"pointer",zIndex:999999999999999999,scrollSensitivity:100,cursorAt:{top:45,left:90},sort:function(event,ui){var position=parseInt(ui.item.parent().offset().left)+parseInt(ui.helper.css("left"))-parseInt($(".umb-grid").offset().left);var max=$(".umb-grid").width()-220;if(position>max){ui.helper.css({"left":max-parseInt(ui.item.parent().offset().left)+parseInt($(".umb-grid").offset().left)+"px"});}
if(position<0){ui.helper.css({"left":0-parseInt(ui.item.parent().offset().left)+parseInt($(".umb-grid").offset().left)+"px"});}},over:function(event,ui){var allowedEditors=$(event.target).scope().area.allowed;if($.inArray(ui.item.scope().control.editor.alias,allowedEditors)<0&&allowedEditors){$scope.$apply(function(){$(event.target).scope().area.dropNotAllowed=true;});ui.placeholder.hide();cancelMove=true;}
else{if($(event.target).scope().area.controls.length==0){$scope.$apply(function(){$(event.target).scope().area.dropOnEmpty=true;});ui.placeholder.hide();}else{ui.placeholder.show();}
cancelMove=false;}},out:function(event,ui){$scope.$apply(function(){$(event.target).scope().area.dropNotAllowed=false;$(event.target).scope().area.dropOnEmpty=false;});},update:function(event,ui){if(!ui.sender){if(cancelMove){ui.item.sortable.cancel();}
ui.item.parents(".umb-cell.content").find(".mceNoEditor").each(function(){if($.inArray($(this).attr("id"),notIncludedRte)<0){notIncludedRte.splice(0,0,$(this).attr("id"));}});}
else{$(event.target).find(".mceNoEditor").each(function(){if($.inArray($(this).attr("id"),notIncludedRte)<0){notIncludedRte.splice(0,0,$(this).attr("id"));}});}
currentForm.$setDirty();},start:function(e,ui){ui.item.context.style.display="block";ui.item.context.style.opacity="0.5";draggedRteSettings=undefined;ui.item.context.style.display="block";ui.item.find(".mceNoEditor").each(function(){notIncludedRte=[];var editors=_.findWhere(tinyMCE.editors,{id:$(this).attr("id")});if(editors){draggedRteSettings=editors.settings;tinyMCE.execCommand("mceRemoveEditor",false,$(this).attr("id"));}});},stop:function(e,ui){ui.item.context.style.opacity="1";ui.item.parents(".umb-cell-content").find(".mceNoEditor").each(function(){if($.inArray($(this).attr("id"),notIncludedRte)<0){notIncludedRte.splice(0,0,$(this).attr("id"));}});$timeout(function(){if(draggedRteSettings!==undefined){tinyMCE.init(draggedRteSettings);}
_.forEach(notIncludedRte,function(id){if(draggedRteSettings===undefined||id!==draggedRteSettings.id){var rteSettings=_.findWhere(tinyMCE.editors,{id:id}).settings;tinyMCE.execCommand("mceRemoveEditor",false,id);tinyMCE.init(rteSettings);}});},500,false);$scope.$apply(function(){var cell=$(e.target).scope().area;cell.hasActiveChild=hasActiveChild(cell,cell.controls);cell.active=false;});}};$scope.toggleSortMode=function(){$scope.sortMode=!$scope.sortMode;if($scope.sortMode){$scope.reorderKey="general_reorderDone";}else{$scope.reorderKey="general_reorder";}};$scope.showReorderButton=function(){if($scope.model.value&&$scope.model.value.sections){for(var i=0;$scope.model.value.sections.length>i;i++){var section=$scope.model.value.sections[i];if(section.rows&&section.rows.length>0){return true;}}}};$scope.openEditorOverlay=function(event,area,index,key){$scope.editorOverlay={view:"itempicker",filter:false,title:localizationService.localize("grid_insertControl"),availableItems:area.$allowedEditors,event:event,show:true,submit:function(model){$scope.addControl(model.selectedItem,area,index);$scope.editorOverlay.show=false;$scope.editorOverlay=null;}};};$scope.addTemplate=function(template){$scope.model.value=angular.copy(template);_.forEach($scope.model.value.sections,function(section){$scope.initSection(section);});};$scope.clickRow=function(index,rows){rows[index].active=true;};$scope.clickOutsideRow=function(index,rows){rows[index].active=false;};function getAllowedLayouts(section){var layouts=$scope.model.config.items.layouts;if(section.allowed&&section.allowed.length>0){return _.filter(layouts,function(layout){return _.indexOf(section.allowed,layout.name)>=0;});}
else{return layouts;}}
$scope.addRow=function(section,layout){var row=angular.copy(layout);row=$scope.initRow(row);if(row){section.rows.push(row);}
currentForm.$setDirty();$scope.showRowConfigurations=false;};$scope.removeRow=function(section,$index){if(section.rows.length>0){section.rows.splice($index,1);$scope.currentRow=null;$scope.openRTEToolbarId=null;currentForm.$setDirty();}
if(section.rows.length===0){$scope.showRowConfigurations=true;}};$scope.editGridItemSettings=function(gridItem,itemType){placeHolder="{0}";var styles,config;if(itemType==='control'){styles=null;config=angular.copy(gridItem.editor.config.settings);}else{styles=_.filter(angular.copy($scope.model.config.items.styles),function(item){return(item.applyTo===undefined||item.applyTo===itemType);});config=_.filter(angular.copy($scope.model.config.items.config),function(item){return(item.applyTo===undefined||item.applyTo===itemType);});}
if(angular.isObject(gridItem.config)){_.each(config,function(cfg){var val=gridItem.config[cfg.key];if(val){cfg.value=stripModifier(val,cfg.modifier);}});}
if(angular.isObject(gridItem.styles)){_.each(styles,function(style){var val=gridItem.styles[style.key];if(val){style.value=stripModifier(val,style.modifier);}});}
$scope.gridItemSettingsDialog={};$scope.gridItemSettingsDialog.view="views/propertyeditors/grid/dialogs/config.html";$scope.gridItemSettingsDialog.title="Settings";$scope.gridItemSettingsDialog.styles=styles;$scope.gridItemSettingsDialog.config=config;$scope.gridItemSettingsDialog.show=true;$scope.gridItemSettingsDialog.submit=function(model){var styleObject={};var configObject={};_.each(model.styles,function(style){if(style.value){styleObject[style.key]=addModifier(style.value,style.modifier);}});_.each(model.config,function(cfg){if(cfg.value){configObject[cfg.key]=addModifier(cfg.value,cfg.modifier);}});gridItem.styles=styleObject;gridItem.config=configObject;gridItem.hasConfig=gridItemHasConfig(styleObject,configObject);currentForm.$setDirty();$scope.gridItemSettingsDialog.show=false;$scope.gridItemSettingsDialog=null;};$scope.gridItemSettingsDialog.close=function(oldModel){$scope.gridItemSettingsDialog.show=false;$scope.gridItemSettingsDialog=null;};};function stripModifier(val,modifier){if(!val||!modifier||modifier.indexOf(placeHolder)<0){return val;}else{var paddArray=modifier.split(placeHolder);if(paddArray.length==1){if(modifier.indexOf(placeHolder)===0){return val.slice(0,-paddArray[0].length);}else{return val.slice(paddArray[0].length,0);}}else{if(paddArray[1].length===0){return val.slice(paddArray[0].length);}
return val.slice(paddArray[0].length,-paddArray[1].length);}}}
var addModifier=function(val,modifier){if(!modifier||modifier.indexOf(placeHolder)<0){return val;}else{return modifier.replace(placeHolder,val);}};function gridItemHasConfig(styles,config){if(_.isEmpty(styles)&&_.isEmpty(config)){return false;}else{return true;}}
$scope.clickCell=function(index,cells,row){cells[index].active=true;row.hasActiveChild=true;};$scope.clickOutsideCell=function(index,cells,row){cells[index].active=false;row.hasActiveChild=hasActiveChild(row,cells);};$scope.cellPreview=function(cell){if(cell&&cell.$allowedEditors){var editor=cell.$allowedEditors[0];return editor.icon;}else{return"icon-layout";}};$scope.clickControl=function(index,controls,cell){controls[index].active=true;cell.hasActiveChild=true;};$scope.clickOutsideControl=function(index,controls,cell){controls[index].active=false;cell.hasActiveChild=hasActiveChild(cell,controls);};function hasActiveChild(item,children){var activeChild=false;for(var i=0;children.length>i;i++){var child=children[i];if(child.active){activeChild=true;}}
if(activeChild){return true;}}
var guid=(function(){function s4(){return Math.floor((1+Math.random())*0x10000).toString(16).substring(1);}
return function(){return s4()+s4()+"-"+s4()+"-"+s4()+"-"+
s4()+"-"+s4()+s4()+s4();};})();$scope.setUniqueId=function(cell,index){return guid();};$scope.addControl=function(editor,cell,index,initialize){initialize=(initialize!==false);var newControl={value:null,editor:editor,$initializing:initialize};if(index===undefined){index=cell.controls.length;}
newControl.active=true;$scope.initControl(newControl,index+1);cell.controls.push(newControl);};$scope.addTinyMce=function(cell){var rte=$scope.getEditor("rte");$scope.addControl(rte,cell);};$scope.getEditor=function(alias){return _.find($scope.availableEditors,function(editor){return editor.alias===alias;});};$scope.removeControl=function(cell,$index){$scope.currentControl=null;cell.controls.splice($index,1);};$scope.percentage=function(spans){return((spans/$scope.model.config.items.columns)*100).toFixed(8);};$scope.clearPrompt=function(scopedObject,e){scopedObject.deletePrompt=false;e.preventDefault();e.stopPropagation();};$scope.togglePrompt=function(scopedObject){scopedObject.deletePrompt=!scopedObject.deletePrompt;};$scope.hidePrompt=function(scopedObject){scopedObject.deletePrompt=false;};$scope.toggleAddRow=function(){$scope.showRowConfigurations=!$scope.showRowConfigurations;};$scope.initContent=function(){var clear=true;if(($scope.model.config.items.config&&$scope.model.config.items.config.length>0)||($scope.model.config.items.styles&&$scope.model.config.items.styles.length>0)){$scope.hasSettings=true;}
if($scope.model.config.items.columns&&angular.isString($scope.model.config.items.columns)){$scope.model.config.items.columns=parseInt($scope.model.config.items.columns);}else{$scope.model.config.items.columns=12;}
if($scope.model.value&&$scope.model.value.sections&&$scope.model.value.sections.length>0&&$scope.model.value.sections[0].rows&&$scope.model.value.sections[0].rows.length>0){if($scope.model.value.name&&angular.isArray($scope.model.config.items.templates)){var found=_.find($scope.model.config.items.templates,function(t){return t.name===$scope.model.value.name;});if(found&&angular.isArray(found.sections)&&found.sections.length===$scope.model.value.sections.length){_.each(found.sections,function(templateSection,index){angular.extend($scope.model.value.sections[index],angular.copy(templateSection));});}}
_.forEach($scope.model.value.sections,function(section,index){if(section.grid>0){$scope.initSection(section);if(section.rows.length>0){clear=false;}}else{$scope.model.value.sections.splice(index,1);}});}else if($scope.model.config.items.templates&&$scope.model.config.items.templates.length===1){$scope.addTemplate($scope.model.config.items.templates[0]);clear=false;}
if(clear){$scope.model.value=undefined;}};$scope.initSection=function(section){section.$percentage=$scope.percentage(section.grid);section.$allowedLayouts=getAllowedLayouts(section);if(!section.rows||section.rows.length===0){section.rows=[];if(section.$allowedLayouts.length===1){$scope.addRow(section,section.$allowedLayouts[0]);}}else{_.forEach(section.rows,function(row,index){if(!row.$initialized){var initd=$scope.initRow(row);if(!initd){section.rows.splice(index,1);}else{section.rows[index]=initd;}}});$scope.showRowConfigurations=false;}};$scope.initRow=function(row){var original=_.find($scope.model.config.items.layouts,function(o){return o.name===row.name;});if(!original){return null;}else{original=angular.copy(original);original.styles=row.styles;original.config=row.config;original.hasConfig=gridItemHasConfig(row.styles,row.config);_.each(original.areas,function(area,areaIndex){if(area.grid>0){var currentArea=row.areas[areaIndex];if(currentArea){area.config=currentArea.config;area.styles=currentArea.styles;area.hasConfig=gridItemHasConfig(currentArea.styles,currentArea.config);}
if(!area.allowed||area.allowAll===true){area.$allowedEditors=$scope.availableEditors;area.$allowsRTE=true;}else{area.$allowedEditors=_.filter($scope.availableEditors,function(editor){return _.indexOf(area.allowed,editor.alias)>=0;});if(_.indexOf(area.allowed,"rte")>=0){area.$allowsRTE=true;}}
if(row.areas.length>areaIndex&&row.areas[areaIndex].controls){area.controls=currentArea.controls;_.forEach(area.controls,function(control,controlIndex){$scope.initControl(control,controlIndex);});}else{area.controls=[];if(area.$allowedEditors.length===1){$scope.addControl(area.$allowedEditors[0],area,0,false);}}
area.$percentage=$scope.percentage(area.grid);area.$uniqueId=$scope.setUniqueId();}else{original.areas.splice(areaIndex,1);}});original.$initialized=true;original.$uniqueId=$scope.setUniqueId();original.id=!row.id?$scope.setUniqueId():row.id;return original;}};$scope.initControl=function(control,index){control.$index=index;control.$uniqueId=$scope.setUniqueId();if(!control.editor){control.$editorPath="views/propertyeditors/grid/editors/error.html";}
if(!control.$editorPath){var editorConfig=$scope.getEditor(control.editor.alias);if(editorConfig){control.editor=editorConfig;if(control.editor.view.startsWith("/")||control.editor.view.startsWith("~/")){control.$editorPath=umbRequestHelper.convertVirtualToAbsolutePath(control.editor.view);}
else{control.$editorPath="views/propertyeditors/grid/editors/"+control.editor.view+".html";}}
else{control.$editorPath="views/propertyeditors/grid/editors/error.html";}}};gridService.getGridEditors().then(function(response){$scope.availableEditors=response.data;$scope.contentReady=true;$scope.initContent();});var unsubscribe=$scope.$on("formSubmitting",function(){if($scope.model.value&&$scope.model.value.sections){_.each($scope.model.value.sections,function(section){if(section.rows){_.each(section.rows,function(row){if(row.areas){_.each(row.areas,function(area){if(area.editors){delete area.editors;}
if(area.controls){_.each(area.controls,function(control){if(control.editor){var alias=control.editor.alias;control.editor={alias:alias};}});}});}});}});}});$scope.$on("$destroy",function(){unsubscribe();});});angular.module("umbraco").controller("Umbraco.PropertyEditors.GridPrevalueEditorController",function($scope,$http,assetsService,$rootScope,dialogService,mediaResource,gridService,imageHelper,$timeout){var emptyModel={styles:[{label:"Set a background image",description:"Set a row background",key:"background-image",view:"imagepicker",modifier:"url({0})"}],config:[{label:"Class",description:"Set a css class",key:"class",view:"textstring"}],columns:12,templates:[{name:"1 column layout",sections:[{grid:12,}]},{name:"2 column layout",sections:[{grid:4,},{grid:8}]}],layouts:[{name:"Headline",areas:[{grid:12,editors:["headline"]}]},{name:"Article",areas:[{grid:4},{grid:8}]}]};$scope.configureTemplate=function(template){var templatesCopy=angular.copy($scope.model.value.templates);if(template===undefined){template={name:"",sections:[]};$scope.model.value.templates.push(template);}
$scope.layoutConfigOverlay={};$scope.layoutConfigOverlay.view="views/propertyEditors/grid/dialogs/layoutconfig.html";$scope.layoutConfigOverlay.currentLayout=template;$scope.layoutConfigOverlay.rows=$scope.model.value.layouts;$scope.layoutConfigOverlay.columns=$scope.model.value.columns;$scope.layoutConfigOverlay.show=true;$scope.layoutConfigOverlay.submit=function(model){$scope.layoutConfigOverlay.show=false;$scope.layoutConfigOverlay=null;};$scope.layoutConfigOverlay.close=function(oldModel){$scope.model.value.templates=templatesCopy;$scope.layoutConfigOverlay.show=false;$scope.layoutConfigOverlay=null;}};$scope.deleteTemplate=function(index){$scope.model.value.templates.splice(index,1);};$scope.configureLayout=function(layout){var layoutsCopy=angular.copy($scope.model.value.layouts);if(layout===undefined){layout={name:"",areas:[]};$scope.model.value.layouts.push(layout);}
$scope.rowConfigOverlay={};$scope.rowConfigOverlay.view="views/propertyEditors/grid/dialogs/rowconfig.html";$scope.rowConfigOverlay.currentRow=layout;$scope.rowConfigOverlay.editors=$scope.editors;$scope.rowConfigOverlay.columns=$scope.model.value.columns;$scope.rowConfigOverlay.show=true;$scope.rowConfigOverlay.submit=function(model){$scope.rowConfigOverlay.show=false;$scope.rowConfigOverlay=null;};$scope.rowConfigOverlay.close=function(oldModel){$scope.model.value.layouts=layoutsCopy;$scope.rowConfigOverlay.show=false;$scope.rowConfigOverlay=null;};};$scope.deleteLayout=function(index){$scope.rowDeleteOverlay={};$scope.rowDeleteOverlay.view="views/propertyEditors/grid/dialogs/rowdeleteconfirm.html";$scope.rowDeleteOverlay.dialogData={rowName:$scope.model.value.layouts[index].name};$scope.rowDeleteOverlay.show=true;$scope.rowDeleteOverlay.submit=function(model){$scope.model.value.layouts.splice(index,1);$scope.rowDeleteOverlay.show=false;$scope.rowDeleteOverlay=null;};$scope.rowDeleteOverlay.close=function(oldModel){$scope.rowDeleteOverlay.show=false;$scope.rowDeleteOverlay=null;};};$scope.toggleCollection=function(collection,toggle){if(toggle){collection=[];}else{delete collection;}};$scope.percentage=function(spans){return((spans/$scope.model.value.columns)*100).toFixed(8);};$scope.zeroWidthFilter=function(cell){return cell.grid>0;};$scope.removeConfigValue=function(collection,index){collection.splice(index,1);};var editConfigCollection=function(configValues,title,callback){$scope.editConfigCollectionOverlay={};$scope.editConfigCollectionOverlay.view="views/propertyeditors/grid/dialogs/editconfig.html";$scope.editConfigCollectionOverlay.config=configValues;$scope.editConfigCollectionOverlay.title=title;$scope.editConfigCollectionOverlay.show=true;$scope.editConfigCollectionOverlay.submit=function(model){callback(model.config)
$scope.editConfigCollectionOverlay.show=false;$scope.editConfigCollectionOverlay=null;};$scope.editConfigCollectionOverlay.close=function(oldModel){$scope.editConfigCollectionOverlay.show=false;$scope.editConfigCollectionOverlay=null;};};$scope.editConfig=function(){editConfigCollection($scope.model.value.config,"Settings",function(data){$scope.model.value.config=data;});};$scope.editStyles=function(){editConfigCollection($scope.model.value.styles,"Styling",function(data){$scope.model.value.styles=data;});};gridService.getGridEditors().then(function(response){$scope.editors=response.data;});if(!$scope.model.value||$scope.model.value===""||!$scope.model.value.templates){$scope.model.value=emptyModel;}else{if(!$scope.model.value.columns){$scope.model.value.columns=emptyModel.columns;}
if(!$scope.model.value.config){$scope.model.value.config=[];}
if(!$scope.model.value.styles){$scope.model.value.styles=[];}}
var unsubscribe=$scope.$on("formSubmitting",function(ev,args){var ts=$scope.model.value.templates;var ls=$scope.model.value.layouts;_.each(ts,function(t){_.each(t.sections,function(section,index){if(section.grid===0){t.sections.splice(index,1);}});});_.each(ls,function(l){_.each(l.areas,function(area,index){if(area.grid===0){l.areas.splice(index,1);}});});});$scope.$on('$destroy',function(){unsubscribe();});});angular.module('umbraco').controller("Umbraco.PropertyEditors.ImageCropperController",function($rootScope,$routeParams,$scope,$log,mediaHelper,cropperHelper,$timeout,editorState,umbRequestHelper,fileManager,angularHelper){var config=angular.copy($scope.model.config);$scope.imageIsLoaded=false;if($scope.model.value){if(angular.isString($scope.model.value)){config.src=$scope.model.value;$scope.model.value=config;}else if($scope.model.value.crops){_.each($scope.model.value.crops,function(saved){var configured=_.find(config.crops,function(item){return item.alias===saved.alias});if(configured&&configured.height===saved.height&&configured.width===saved.width){configured.coordinates=saved.coordinates;}});$scope.model.value.crops=config.crops;if(!$scope.model.value.focalPoint){$scope.model.value.focalPoint={left:0.5,top:0.5};}}
$scope.imageSrc=$scope.model.value.src;}
$scope.crop=function(crop){$scope.currentCrop=crop;$scope.currentPoint=undefined;};$scope.done=function(){$scope.currentCrop=undefined;$scope.currentPoint=undefined;};$scope.clear=function(crop){fileManager.setFiles($scope.model.alias,[]);$scope.imageSrc=undefined;if($scope.model.value){delete $scope.model.value;}
var currForm=angularHelper.getCurrentForm($scope);currForm.$setDirty();};$scope.togglePreviews=function(){if($scope.showPreviews){$scope.showPreviews=false;$scope.tempShowPreviews=false;}else{$scope.showPreviews=true;}};$scope.imageLoaded=function(){$scope.imageIsLoaded=true;};$scope.$on("filesSelected",function(ev,args){$scope.model.value=config;if(args.files&&args.files[0]){fileManager.setFiles($scope.model.alias,args.files);var reader=new FileReader();reader.onload=function(e){$scope.$apply(function(){$scope.imageSrc=e.target.result;});};reader.readAsDataURL(args.files[0]);}});$scope.model.onValueChanged=function(newVal,oldVal){fileManager.setFiles($scope.model.alias,[]);};var unsubscribe=$scope.$on("formSubmitting",function(){$scope.done();});$scope.$on('$destroy',function(){unsubscribe();});}).run(function(mediaHelper,umbRequestHelper){if(mediaHelper&&mediaHelper.registerFileResolver){mediaHelper.registerFileResolver("Umbraco.ImageCropper",function(property,entity,thumbnail){if(property.value.src){if(thumbnail===true){return property.value.src+"?width=500&mode=max&animationprocessmode=first";}
else{return property.value.src;}}
else if(angular.isString(property.value)){if(thumbnail){if(mediaHelper.detectIfImageByExtension(property.value)){var thumbnailUrl=umbRequestHelper.getApiUrl("imagesApiBaseUrl","GetBigThumbnail",[{originalImagePath:property.value}]);return thumbnailUrl;}
else{return null;}}
else{return property.value;}}
return null;});}});angular.module("umbraco").controller("Umbraco.PrevalueEditors.CropSizesController",function($scope,$timeout){if(!$scope.model.value){$scope.model.value=[];}
$scope.remove=function(item,evt){evt.preventDefault();$scope.model.value=_.reject($scope.model.value,function(x){return x.alias===item.alias;});};$scope.edit=function(item,evt){evt.preventDefault();$scope.newItem=item;};$scope.cancel=function(evt){evt.preventDefault();$scope.newItem=null;};$scope.add=function(evt){evt.preventDefault();if($scope.newItem&&$scope.newItem.alias&&angular.isNumber($scope.newItem.width)&&angular.isNumber($scope.newItem.height)&&$scope.newItem.width>0&&$scope.newItem.height>0){var exists=_.find($scope.model.value,function(item){return $scope.newItem.alias===item.alias;});if(!exists){$scope.model.value.push($scope.newItem);$scope.newItem={};$scope.hasError=false;return;}}
$scope.hasError=true;};});function includePropsPreValsController($rootScope,$scope,localizationService,contentTypeResource){if(!$scope.model.value){$scope.model.value=[];}
$scope.propertyAliases=[];$scope.selectedField=null;$scope.systemFields=[{value:"sortOrder"},{value:"updateDate"},{value:"updater"},{value:"createDate"},{value:"owner"},{value:"published"},{value:"contentTypeAlias"},{value:"email"},{value:"username"}];$scope.getLocalizedKey=function(alias){switch(alias){case"name":return"general_name";case"sortOrder":return"general_sort";case"updateDate":return"content_updateDate";case"updater":return"content_updatedBy";case"createDate":return"content_createDate";case"owner":return"content_createBy";case"published":return"content_isPublished";case"contentTypeAlias":return"content_documentType";case"email":return"general_email";case"username":return"general_username";}
return alias;}
$scope.removeField=function(e){$scope.model.value=_.reject($scope.model.value,function(x){return x.alias===e.alias;});}
_.each($scope.systemFields,function(e,i){var key=$scope.getLocalizedKey(e.value);localizationService.localize(key).then(function(v){e.name=v;switch(e.value){case"updater":e.name+=" (Content only)";break;case"published":e.name+=" (Content only)";break;case"email":e.name+=" (Members only)";break;case"username":e.name+=" (Members only)";break;}});});var fixHelper=function(e,ui){var h=ui.clone();h.children().each(function(){$(this).width($(this).width());});h.css("background-color","lightgray");return h;};$scope.sortableOptions={helper:fixHelper,handle:".handle",opacity:0.5,axis:'y',containment:'parent',cursor:'move',items:'> tr',tolerance:'pointer',update:function(e,ui){var newIndex=ui.item.index();var movedAlias=$('.alias-value',ui.item).text().trim();var originalIndex=getAliasIndexByText(movedAlias);if(originalIndex>-1){var movedElement=$scope.model.value[originalIndex];$scope.model.value.splice(originalIndex,1);$scope.model.value.splice(newIndex,0,movedElement);}}};contentTypeResource.getAllPropertyTypeAliases().then(function(data){$scope.propertyAliases=data;});$scope.addField=function(){var val=$scope.selectedField;var isSystem=val.startsWith("_system_");if(isSystem){val=val.trimStart("_system_");}
var exists=_.find($scope.model.value,function(i){return i.alias===val;});if(!exists){$scope.model.value.push({alias:val,isSystem:isSystem?1:0});}}
function getAliasIndexByText(value){for(var i=0;i<$scope.model.value.length;i++){if($scope.model.value[i].alias===value){return i;}}
return-1;}}
angular.module("umbraco").controller("Umbraco.PrevalueEditors.IncludePropertiesListViewController",includePropsPreValsController);(function(){"use strict";function ListViewLayoutsPreValsController($scope){var vm=this;vm.focusLayoutName=false;vm.layoutsSortableOptions={distance:10,tolerance:"pointer",opacity:0.7,scroll:true,cursor:"move",handle:".list-view-layout__sort-handle"};vm.addLayout=addLayout;vm.showPrompt=showPrompt;vm.hidePrompt=hidePrompt;vm.removeLayout=removeLayout;vm.openIconPicker=openIconPicker;function activate(){}
function addLayout(){vm.focusLayoutName=false;var layout={"name":"","path":"","icon":"icon-stop","selected":true};$scope.model.value.push(layout);}
function showPrompt(layout){layout.deletePrompt=true;}
function hidePrompt(layout){layout.deletePrompt=false;}
function removeLayout($index,layout){$scope.model.value.splice($index,1);}
function openIconPicker(layout){vm.iconPickerDialog={view:"iconpicker",show:true,submit:function(model){if(model.color){layout.icon=model.icon+" "+model.color;}else{layout.icon=model.icon;}
vm.focusLayoutName=true;vm.iconPickerDialog.show=false;vm.iconPickerDialog=null;}};}
activate();}
angular.module("umbraco").controller("Umbraco.PrevalueEditors.ListViewLayoutsPreValsController",ListViewLayoutsPreValsController);})();(function(){"use strict";function ListViewGridLayoutController($scope,$routeParams,mediaHelper,mediaResource,$location,listViewHelper){var vm=this;vm.nodeId=$scope.contentId;vm.acceptedFileTypes=!mediaHelper.formatFileTypes(Umbraco.Sys.ServerVariables.umbracoSettings.disallowedUploadFiles);vm.maxFileSize=Umbraco.Sys.ServerVariables.umbracoSettings.maxFileSize+"KB";vm.activeDrag=false;vm.mediaDetailsTooltip={};vm.itemsWithoutFolders=[];vm.isRecycleBin=$scope.contentId==='-21'||$scope.contentId==='-20';vm.dragEnter=dragEnter;vm.dragLeave=dragLeave;vm.onFilesQueue=onFilesQueue;vm.onUploadComplete=onUploadComplete;vm.hoverMediaItemDetails=hoverMediaItemDetails;vm.selectContentItem=selectContentItem;vm.selectItem=selectItem;vm.selectFolder=selectFolder;vm.goToItem=goToItem;function activate(){vm.itemsWithoutFolders=filterOutFolders($scope.items);}
function filterOutFolders(items){var newArray=[];if(items&&items.length){for(var i=0;items.length>i;i++){var item=items[i];var isFolder=!mediaHelper.hasFilePropertyType(item);if(!isFolder){newArray.push(item);}}}
return newArray;}
function dragEnter(el,event){vm.activeDrag=true;}
function dragLeave(el,event){vm.activeDrag=false;}
function onFilesQueue(){vm.activeDrag=false;}
function onUploadComplete(){$scope.getContent($scope.contentId);}
function hoverMediaItemDetails(item,event,hover){if(hover&&!vm.mediaDetailsTooltip.show){vm.mediaDetailsTooltip.event=event;vm.mediaDetailsTooltip.item=item;vm.mediaDetailsTooltip.show=true;}else if(!hover&&vm.mediaDetailsTooltip.show){vm.mediaDetailsTooltip.show=false;}}
function selectContentItem(item,$event,$index){listViewHelper.selectHandler(item,$index,$scope.items,$scope.selection,$event);}
function selectItem(item,$event,$index){listViewHelper.selectHandler(item,$index,vm.itemsWithoutFolders,$scope.selection,$event);}
function selectFolder(folder,$event,$index){listViewHelper.selectHandler(folder,$index,$scope.folders,$scope.selection,$event);}
function goToItem(item,$event,$index){$location.path($scope.entityType+'/'+$scope.entityType+'/edit/'+item.id);}
activate();}
angular.module("umbraco").controller("Umbraco.PropertyEditors.ListView.GridLayoutController",ListViewGridLayoutController);})();(function(){"use strict";function ListViewListLayoutController($scope,listViewHelper,$location,mediaHelper){var vm=this;vm.nodeId=$scope.contentId;vm.acceptedFileTypes=!mediaHelper.formatFileTypes(Umbraco.Sys.ServerVariables.umbracoSettings.disallowedUploadFiles);vm.maxFileSize=Umbraco.Sys.ServerVariables.umbracoSettings.maxFileSize+"KB";vm.activeDrag=false;vm.isRecycleBin=$scope.contentId==='-21'||$scope.contentId==='-20';vm.selectItem=selectItem;vm.clickItem=clickItem;vm.selectAll=selectAll;vm.isSelectedAll=isSelectedAll;vm.isSortDirection=isSortDirection;vm.sort=sort;vm.dragEnter=dragEnter;vm.dragLeave=dragLeave;vm.onFilesQueue=onFilesQueue;vm.onUploadComplete=onUploadComplete;function selectAll($event){listViewHelper.selectAllItems($scope.items,$scope.selection,$event);}
function isSelectedAll(){return listViewHelper.isSelectedAll($scope.items,$scope.selection);}
function selectItem(selectedItem,$index,$event){listViewHelper.selectHandler(selectedItem,$index,$scope.items,$scope.selection,$event);}
function clickItem(item){$location.path($scope.entityType+'/'+$scope.entityType+'/edit/'+item.id);}
function isSortDirection(col,direction){return listViewHelper.setSortingDirection(col,direction,$scope.options);}
function sort(field,allow){if(allow){listViewHelper.setSorting(field,allow,$scope.options);$scope.getContent($scope.contentId);}}
function dragEnter(el,event){vm.activeDrag=true;}
function dragLeave(el,event){vm.activeDrag=false;}
function onFilesQueue(){vm.activeDrag=false;}
function onUploadComplete(){$scope.getContent($scope.contentId);}}
angular.module("umbraco").controller("Umbraco.PropertyEditors.ListView.ListLayoutController",ListViewListLayoutController);})();function listViewController($rootScope,$scope,$routeParams,$injector,$cookieStore,notificationsService,iconHelper,dialogService,editorState,localizationService,$location,appState,$timeout,$q,mediaResource,listViewHelper,userService){if($routeParams.create){$scope.isNew=true;return;}
var contentResource,getContentTypesCallback,getListResultsCallback,deleteItemCallback,getIdCallback,createEditUrlCallback;if(($scope.model.config.entityType&&$scope.model.config.entityType==="member")||(appState.getSectionState("currentSection")==="member")){$scope.entityType="member";contentResource=$injector.get('memberResource');getContentTypesCallback=$injector.get('memberTypeResource').getTypes;getListResultsCallback=contentResource.getPagedResults;deleteItemCallback=contentResource.deleteByKey;getIdCallback=function(selected){var selectedKey=getItemKey(selected.id);return selectedKey;};createEditUrlCallback=function(item){return"/"+$scope.entityType+"/"+$scope.entityType+"/edit/"+item.key+"?page="+$scope.options.pageNumber+"&listName="+$scope.contentId;};}
else{if(($scope.model.config.entityType&&$scope.model.config.entityType==="media")||(appState.getSectionState("currentSection")==="media")){$scope.entityType="media";contentResource=$injector.get('mediaResource');getContentTypesCallback=$injector.get('mediaTypeResource').getAllowedTypes;}
else{$scope.entityType="content";contentResource=$injector.get('contentResource');getContentTypesCallback=$injector.get('contentTypeResource').getAllowedTypes;}
getListResultsCallback=contentResource.getChildren;deleteItemCallback=contentResource.deleteById;getIdCallback=function(selected){return selected.id;};createEditUrlCallback=function(item){return"/"+$scope.entityType+"/"+$scope.entityType+"/edit/"+item.id+"?page="+$scope.options.pageNumber;};}
$scope.pagination=[];$scope.isNew=false;$scope.actionInProgress=false;$scope.selection=[];$scope.folders=[];$scope.listViewResultSet={totalPages:0,items:[]};$scope.currentNodePermissions={}
if(editorState.current){var currentUserPermissions=editorState.current.allowedActions;$scope.currentNodePermissions={"canCopy":_.contains(currentUserPermissions,'O'),"canCreate":_.contains(currentUserPermissions,'C'),"canDelete":_.contains(currentUserPermissions,'D'),"canMove":_.contains(currentUserPermissions,'M'),"canPublish":_.contains(currentUserPermissions,'U'),"canUnpublish":_.contains(currentUserPermissions,'U'),};}
$scope.buttonPermissions=null;if($scope.entityType==="content"){var idsWithPermissions=null;$scope.buttonPermissions={canCopy:true,canCreate:true,canDelete:true,canMove:true,canPublish:true,canUnpublish:true};$scope.$watch(function(){return $scope.selection.length;},function(newVal,oldVal){if((idsWithPermissions==null&&newVal>0)||(idsWithPermissions!=null)){var ids=_.map($scope.selection,function(i){return i.id.toString();});var filtered={};_.each(idsWithPermissions,function(value,key,list){if(_.contains(ids,key)){filtered[key]=value;}});idsWithPermissions=filtered;var existingIds=_.keys(idsWithPermissions);var missingLookup=_.map(_.difference(ids,existingIds),function(i){return Number(i);});if(missingLookup.length>0){contentResource.getPermissions(missingLookup).then(function(p){$scope.buttonPermissions=listViewHelper.getButtonPermissions(p,idsWithPermissions);});}
else{$scope.buttonPermissions=listViewHelper.getButtonPermissions({},idsWithPermissions);}}});}
$scope.options={displayAtTabNumber:$scope.model.config.displayAtTabNumber?$scope.model.config.displayAtTabNumber:1,pageSize:$scope.model.config.pageSize?$scope.model.config.pageSize:10,pageNumber:($routeParams.page&&Number($routeParams.page)!=NaN&&Number($routeParams.page)>0)?$routeParams.page:1,filter:'',orderBy:($scope.model.config.orderBy?$scope.model.config.orderBy:'VersionDate').trim(),orderDirection:$scope.model.config.orderDirection?$scope.model.config.orderDirection.trim():"desc",includeProperties:$scope.model.config.includeProperties?$scope.model.config.includeProperties:[{alias:'updateDate',header:'Last edited',isSystem:1},{alias:'updater',header:'Last edited by',isSystem:1}],layout:{layouts:$scope.model.config.layouts,activeLayout:listViewHelper.getLayout($routeParams.id,$scope.model.config.layouts)},allowBulkPublish:$scope.entityType==='content'&&$scope.model.config.bulkActionPermissions.allowBulkPublish,allowBulkUnpublish:$scope.entityType==='content'&&$scope.model.config.bulkActionPermissions.allowBulkUnpublish,allowBulkCopy:$scope.entityType==='content'&&$scope.model.config.bulkActionPermissions.allowBulkCopy,allowBulkMove:$scope.model.config.bulkActionPermissions.allowBulkMove,allowBulkDelete:$scope.model.config.bulkActionPermissions.allowBulkDelete};_.each($scope.options.includeProperties,function(e,i){if(e.isSystem){if(e.alias!="contentTypeAlias"){e.allowSorting=true;}
var key=getLocalizedKey(e.alias);localizationService.localize(key).then(function(v){e.header=v;});}});$scope.selectLayout=function(selectedLayout){$scope.options.layout.activeLayout=listViewHelper.setLayout($routeParams.id,selectedLayout,$scope.model.config.layouts);};function showNotificationsAndReset(err,reload,successMsg){if(err.status&&err.status>=500){$scope.ysodOverlay={view:"ysod",error:err,show:true};}
$timeout(function(){$scope.bulkStatus="";$scope.actionInProgress=false;},500);if(reload===true){$scope.reloadView($scope.contentId);}
if(err.data&&angular.isArray(err.data.notifications)){for(var i=0;i<err.data.notifications.length;i++){notificationsService.showNotification(err.data.notifications[i]);}}
else if(successMsg){notificationsService.success("Done",successMsg);}}
$scope.next=function(pageNumber){$scope.options.pageNumber=pageNumber;$scope.reloadView($scope.contentId);};$scope.goToPage=function(pageNumber){$scope.options.pageNumber=pageNumber;$scope.reloadView($scope.contentId);};$scope.prev=function(pageNumber){$scope.options.pageNumber=pageNumber;$scope.reloadView($scope.contentId);};$scope.reloadView=function(id){$scope.viewLoaded=false;listViewHelper.clearSelection($scope.listViewResultSet.items,$scope.folders,$scope.selection);getListResultsCallback(id,$scope.options).then(function(data){$scope.actionInProgress=false;$scope.listViewResultSet=data;if($scope.listViewResultSet.items){_.each($scope.listViewResultSet.items,function(e,index){setPropertyValues(e);});}
if($scope.entityType==='media'){mediaResource.getChildFolders($scope.contentId).then(function(folders){$scope.folders=folders;$scope.viewLoaded=true;});}else{$scope.viewLoaded=true;}
if($scope.options.pageNumber>$scope.listViewResultSet.totalPages){$scope.options.pageNumber=$scope.listViewResultSet.totalPages;$scope.reloadView(id);}});};var searchListView=_.debounce(function(){$scope.$apply(function(){makeSearch();});},500);$scope.forceSearch=function(ev){switch(ev.keyCode){case 13:makeSearch();break;}};$scope.enterSearch=function(){$scope.viewLoaded=false;searchListView();};function makeSearch(){if($scope.options.filter!==null&&$scope.options.filter!==undefined){$scope.options.pageNumber=1;$scope.reloadView($scope.contentId);}}
$scope.isAnythingSelected=function(){if($scope.selection.length===0){return false;}else{return true;}};$scope.selectedItemsCount=function(){return $scope.selection.length;};$scope.clearSelection=function(){listViewHelper.clearSelection($scope.listViewResultSet.items,$scope.folders,$scope.selection);};$scope.getIcon=function(entry){return iconHelper.convertFromLegacyIcon(entry.icon);};function serial(selected,fn,getStatusMsg,index){return fn(selected,index).then(function(content){index++;$scope.bulkStatus=getStatusMsg(index,selected.length);return index<selected.length?serial(selected,fn,getStatusMsg,index):content;},function(err){var reload=index>0;showNotificationsAndReset(err,reload);return err;});}
function applySelected(fn,getStatusMsg,getSuccessMsg,confirmMsg){var selected=$scope.selection;if(selected.length===0)
return;if(confirmMsg&&!confirm(confirmMsg))
return;$scope.actionInProgress=true;$scope.bulkStatus=getStatusMsg(0,selected.length);serial(selected,fn,getStatusMsg,0).then(function(result){if(!(result.data&&angular.isArray(result.data.notifications)))
showNotificationsAndReset(result,true,getSuccessMsg(selected.length));});}
$scope.delete=function(){applySelected(function(selected,index){return deleteItemCallback(getIdCallback(selected[index]));},function(count,total){return"Deleted "+count+" out of "+total+" item"+(total>1?"s":"");},function(total){return"Deleted "+total+" item"+(total>1?"s":"");},"Sure you want to delete?");};$scope.publish=function(){applySelected(function(selected,index){return contentResource.publishById(getIdCallback(selected[index]));},function(count,total){return"Published "+count+" out of "+total+" item"+(total>1?"s":"");},function(total){return"Published "+total+" item"+(total>1?"s":"");});};$scope.unpublish=function(){applySelected(function(selected,index){return contentResource.unPublish(getIdCallback(selected[index]));},function(count,total){return"Unpublished "+count+" out of "+total+" item"+(total>1?"s":"");},function(total){return"Unpublished "+total+" item"+(total>1?"s":"");});};$scope.move=function(){$scope.moveDialog={};$scope.moveDialog.title="Move";$scope.moveDialog.section=$scope.entityType;$scope.moveDialog.currentNode=$scope.contentId;$scope.moveDialog.view="move";$scope.moveDialog.show=true;$scope.moveDialog.submit=function(model){if(model.target){performMove(model.target);}
$scope.moveDialog.show=false;$scope.moveDialog=null;};$scope.moveDialog.close=function(oldModel){$scope.moveDialog.show=false;$scope.moveDialog=null;};};function performMove(target){applySelected(function(selected,index){return contentResource.move({parentId:target.id,id:getIdCallback(selected[index])});},function(count,total){return"Moved "+count+" out of "+total+" item"+(total>1?"s":"");},function(total){return"Moved "+total+" item"+(total>1?"s":"");});}
$scope.copy=function(){$scope.copyDialog={};$scope.copyDialog.title="Copy";$scope.copyDialog.section=$scope.entityType;$scope.copyDialog.currentNode=$scope.contentId;$scope.copyDialog.view="copy";$scope.copyDialog.show=true;$scope.copyDialog.submit=function(model){if(model.target){performCopy(model.target,model.relateToOriginal);}
$scope.copyDialog.show=false;$scope.copyDialog=null;};$scope.copyDialog.close=function(oldModel){$scope.copyDialog.show=false;$scope.copyDialog=null;};};function performCopy(target,relateToOriginal){applySelected(function(selected,index){return contentResource.copy({parentId:target.id,id:getIdCallback(selected[index]),relateToOriginal:relateToOriginal});},function(count,total){return"Copied "+count+" out of "+total+" item"+(total>1?"s":"");},function(total){return"Copied "+total+" item"+(total>1?"s":"");});}
function getCustomPropertyValue(alias,properties){var value='';var index=0;var foundAlias=false;for(var i=0;i<properties.length;i++){if(properties[i].alias==alias){foundAlias=true;break;}
index++;}
if(foundAlias){value=properties[index].value;}
return value;}
function setPropertyValues(result){result.editPath=createEditUrlCallback(result);_.each($scope.options.includeProperties,function(e,i){var alias=e.alias;var value=result[alias];if(value===Object(value)){value=value['name'];}
if(typeof value==='undefined'){value=getCustomPropertyValue(alias,result.properties);}
if(isDate(value)){value=value.substring(0,value.length-3);}
result[alias]=value;});}
function isDate(val){if(angular.isString(val)){return val.match(/^(\d{4})\-(\d{2})\-(\d{2})\ (\d{2})\:(\d{2})\:(\d{2})$/);}
return false;}
function initView(){var id=$routeParams.id;if(id===undefined){id=-1;}
$scope.listViewAllowedTypes=getContentTypesCallback(id);$scope.contentId=id;$scope.isTrashed=id==="-20"||id==="-21";$scope.options.allowBulkPublish=$scope.options.allowBulkPublish&&!$scope.isTrashed;$scope.options.allowBulkUnpublish=$scope.options.allowBulkUnpublish&&!$scope.isTrashed;$scope.options.bulkActionsAllowed=$scope.options.allowBulkPublish||$scope.options.allowBulkUnpublish||$scope.options.allowBulkCopy||$scope.options.allowBulkMove||$scope.options.allowBulkDelete;$scope.reloadView($scope.contentId);}
function getLocalizedKey(alias){switch(alias){case"sortOrder":return"general_sort";case"updateDate":return"content_updateDate";case"updater":return"content_updatedBy";case"createDate":return"content_createDate";case"owner":return"content_createBy";case"published":return"content_isPublished";case"contentTypeAlias":return $scope.entityType==="content"?"content_documentType":"content_mediatype";case"email":return"general_email";case"username":return"general_username";}
return alias;}
function getItemKey(itemId){for(var i=0;i<$scope.listViewResultSet.items.length;i++){var item=$scope.listViewResultSet.items[i];if(item.id===itemId){return item.key;}}}
initView();}
angular.module("umbraco").controller("Umbraco.PropertyEditors.ListViewController",listViewController);function sortByPreValsController($rootScope,$scope,localizationService){$scope.sortByFields=[{value:"SortOrder",key:"general_sort"},{value:"Name",key:"general_name"},{value:"VersionDate",key:"content_updateDate"},{value:"Updater",key:"content_updatedBy"},{value:"CreateDate",key:"content_createDate"},{value:"Owner",key:"content_createBy"},{value:"ContentTypeAlias",key:"content_documentType"},{value:"Published",key:"content_isPublished"},{value:"Email",key:"general_email"},{value:"Username",key:"general_username"}];_.each($scope.sortByFields,function(e,i){localizationService.localize(e.key).then(function(v){e.name=v;switch(e.value){case"Updater":e.name+=" (Content only)";break;case"Published":e.name+=" (Content only)";break;case"Email":e.name+=" (Members only)";break;case"Username":e.name+=" (Members only)";break;}});});}
angular.module("umbraco").controller("Umbraco.PrevalueEditors.SortByListViewController",sortByPreValsController);angular.module('umbraco').controller("Umbraco.PropertyEditors.MacroContainerController",function($scope,dialogService,entityResource,macroService){$scope.renderModel=[];if($scope.model.value){var macros=$scope.model.value.split('>');angular.forEach(macros,function(syntax,key){if(syntax&&syntax.length>10){syntax=syntax+">";var parsed=macroService.parseMacroSyntax(syntax);if(!parsed){parsed={};}
parsed.syntax=syntax;collectDetails(parsed);$scope.renderModel.push(parsed);}});}
function collectDetails(macro){macro.details="";if(macro.macroParamsDictionary){angular.forEach((macro.macroParamsDictionary),function(value,key){macro.details+=key+": "+value+" ";});}}
function openDialog(index){var dialogData={allowedMacros:$scope.model.config.allowed};if(index!==null&&$scope.renderModel[index]){var macro=$scope.renderModel[index];dialogData["macroData"]=macro;}
$scope.macroPickerOverlay={};$scope.macroPickerOverlay.view="macropicker";$scope.macroPickerOverlay.dialogData=dialogData;$scope.macroPickerOverlay.show=true;$scope.macroPickerOverlay.submit=function(model){var macroObject=macroService.collectValueData(model.selectedMacro,model.macroParams,dialogData.renderingEngine);collectDetails(macroObject);if(index!==null&&$scope.renderModel[index]){$scope.renderModel[index]=macroObject;}else{$scope.renderModel.push(macroObject);}
$scope.macroPickerOverlay.show=false;$scope.macroPickerOverlay=null;};$scope.macroPickerOverlay.close=function(oldModel){$scope.macroPickerOverlay.show=false;$scope.macroPickerOverlay=null;};}
$scope.edit=function(index){openDialog(index);};$scope.add=function(){if($scope.model.config.max&&$scope.model.config.max>0&&$scope.renderModel.length>=$scope.model.config.max){return;}
openDialog();};$scope.remove=function(index){$scope.renderModel.splice(index,1);};$scope.clear=function(){$scope.model.value="";$scope.renderModel=[];};var unsubscribe=$scope.$on("formSubmitting",function(ev,args){var syntax=[];angular.forEach($scope.renderModel,function(value,key){syntax.push(value.syntax);});$scope.model.value=syntax.join("");});$scope.$on('$destroy',function(){unsubscribe();});function trim(str,chr){var rgxtrim=(!chr)?new RegExp('^\\s+|\\s+$','g'):new RegExp('^'+chr+'+|'+chr+'+$','g');return str.replace(rgxtrim,'');}});function MacroListController($scope,entityResource){$scope.items=[];entityResource.getAll("Macro").then(function(items){_.each(items,function(i){$scope.items.push({name:i.name,alias:i.alias});});});}
angular.module("umbraco").controller("Umbraco.PrevalueEditors.MacroList",MacroListController);function MarkdownEditorController($scope,$element,assetsService,dialogService,angularHelper,$timeout){if($scope.model.value===null||$scope.model.value===""){$scope.model.value=$scope.model.config.defaultValue;}
function openMediaPicker(callback){$scope.mediaPickerOverlay={};$scope.mediaPickerOverlay.view="mediaPicker";$scope.mediaPickerOverlay.show=true;$scope.mediaPickerOverlay.disableFolderSelect=true;$scope.mediaPickerOverlay.submit=function(model){var selectedImagePath=model.selectedImages[0].image;callback(selectedImagePath);$scope.mediaPickerOverlay.show=false;$scope.mediaPickerOverlay=null;};$scope.mediaPickerOverlay.close=function(model){$scope.mediaPickerOverlay.show=false;$scope.mediaPickerOverlay=null;};}
assetsService.load(["lib/markdown/markdown.converter.js","lib/markdown/markdown.sanitizer.js","lib/markdown/markdown.editor.js"]).then(function(){setTimeout(function(){$timeout(function(){var converter2=new Markdown.Converter();var editor2=new Markdown.Editor(converter2,"-"+$scope.model.alias);editor2.run();editor2.hooks.set("insertImageDialog",function(callback){openMediaPicker(callback);return true;});editor2.hooks.set("onPreviewRefresh",function(){angularHelper.getCurrentForm($scope).$setDirty();$scope.model.value=$("textarea",$element).val();});},200);});assetsService.loadCss("lib/markdown/markdown.css");})}
angular.module("umbraco").controller("Umbraco.PropertyEditors.MarkdownEditorController",MarkdownEditorController);angular.module('umbraco').controller("Umbraco.PropertyEditors.MediaPickerController",function($rootScope,$scope,dialogService,entityResource,mediaResource,mediaHelper,$timeout,userService,$location){var multiPicker=$scope.model.config.multiPicker&&$scope.model.config.multiPicker!=='0'?true:false;var onlyImages=$scope.model.config.onlyImages&&$scope.model.config.onlyImages!=='0'?true:false;if(!$scope.model.config.startNodeId){userService.getCurrentUser().then(function(userData){$scope.model.config.startNodeId=userData.startMediaId;});}
function setupViewModel(){$scope.images=[];$scope.ids=[];if($scope.model.value){var ids=$scope.model.value.split(',');entityResource.getByIds(ids,"Media").then(function(medias){_.each(medias,function(media,i){if(media.parentId>=-1){if(!media.thumbnail){media.thumbnail=mediaHelper.resolveFileFromEntity(media,true);}
$scope.images.push(media);$scope.ids.push(media.id);}});$scope.sync();});}}
setupViewModel();$scope.remove=function(index){$scope.images.splice(index,1);$scope.ids.splice(index,1);$scope.sync();};$scope.goToItem=function(item){$location.path('media/media/edit/'+item.id);};$scope.add=function(){$scope.mediaPickerOverlay={view:"mediapicker",title:"Select media",startNodeId:$scope.model.config.startNodeId,multiPicker:multiPicker,onlyImages:onlyImages,show:true,submit:function(model){_.each(model.selectedImages,function(media,i){if(!media.thumbnail){media.thumbnail=mediaHelper.resolveFileFromEntity(media,true);}
$scope.images.push(media);$scope.ids.push(media.id);});$scope.sync();$scope.mediaPickerOverlay.show=false;$scope.mediaPickerOverlay=null;}};};$scope.sortableOptions={update:function(e,ui){var r=[];$timeout(function(){angular.forEach($scope.images,function(value,key){r.push(value.id);});$scope.ids=r;$scope.sync();},500,false);}};$scope.sync=function(){$scope.model.value=$scope.ids.join();};$scope.showAdd=function(){if(!multiPicker){if($scope.model.value&&$scope.model.value!==""){return false;}}
return true;};$scope.model.onValueChanged=function(newVal,oldVal){setupViewModel();};});function memberGroupPicker($scope,dialogService){function trim(str,chr){var rgxtrim=(!chr)?new RegExp('^\\s+|\\s+$','g'):new RegExp('^'+chr+'+|'+chr+'+$','g');return str.replace(rgxtrim,'');}
$scope.renderModel=[];if($scope.model.value){var modelIds=$scope.model.value.split(',');_.each(modelIds,function(item,i){$scope.renderModel.push({name:item,id:item,icon:'icon-users'});});}
$scope.openMemberGroupPicker=function(){$scope.memberGroupPicker={};$scope.memberGroupPicker.multiPicker=true;$scope.memberGroupPicker.view="memberGroupPicker";$scope.memberGroupPicker.show=true;$scope.memberGroupPicker.submit=function(model){if(model.selectedMemberGroups){_.each(model.selectedMemberGroups,function(item,i){$scope.add(item);});}
if(model.selectedMemberGroup){$scope.clear();$scope.add(model.selectedMemberGroup);}
$scope.memberGroupPicker.show=false;$scope.memberGroupPicker=null;};$scope.memberGroupPicker.close=function(oldModel){$scope.memberGroupPicker.show=false;$scope.memberGroupPicker=null;};};$scope.remove=function(index){$scope.renderModel.splice(index,1);};$scope.add=function(item){var currIds=_.map($scope.renderModel,function(i){return i.id;});if(currIds.indexOf(item)<0){$scope.renderModel.push({name:item,id:item,icon:'icon-users'});}};$scope.clear=function(){$scope.renderModel=[];};var unsubscribe=$scope.$on("formSubmitting",function(ev,args){var currIds=_.map($scope.renderModel,function(i){return i.id;});$scope.model.value=trim(currIds.join(),",");});$scope.$on('$destroy',function(){unsubscribe();});}
angular.module('umbraco').controller("Umbraco.PropertyEditors.MemberGroupPickerController",memberGroupPicker);function memberGroupController($rootScope,$scope,dialogService,mediaResource,imageHelper,$log){$scope.getAvailable=function(){var available=[];for(var n in $scope.model.value){if($scope.model.value[n]===false){available.push(n);}}
return available;};$scope.getSelected=function(){var selected=[];for(var n in $scope.model.value){if($scope.model.value[n]===true){selected.push(n);}}
return selected;};$scope.addItem=function(item){$scope.model.value[item]=true;};$scope.removeItem=function(item){$scope.model.value[item]=false;};}
angular.module('umbraco').controller("Umbraco.PropertyEditors.MemberGroupController",memberGroupController);function memberPickerController($scope,dialogService,entityResource,$log,iconHelper,angularHelper){function trim(str,chr){var rgxtrim=(!chr)?new RegExp('^\\s+|\\s+$','g'):new RegExp('^'+chr+'+|'+chr+'+$','g');return str.replace(rgxtrim,'');}
$scope.renderModel=[];var dialogOptions={multiPicker:false,entityType:"Member",section:"member",treeAlias:"member",filter:function(i){return i.metaData.isContainer==true;},filterCssClass:"not-allowed",callback:function(data){if(angular.isArray(data)){_.each(data,function(item,i){$scope.add(item);});}else{$scope.clear();$scope.add(data);}
angularHelper.getCurrentForm($scope).$setDirty();}};if($scope.model.config){angular.extend(dialogOptions,$scope.model.config);}
$scope.openMemberPicker=function(){$scope.memberPickerOverlay=dialogOptions;$scope.memberPickerOverlay.view="memberPicker";$scope.memberPickerOverlay.show=true;$scope.memberPickerOverlay.submit=function(model){if(model.selection){_.each(model.selection,function(item,i){$scope.add(item);});}
$scope.memberPickerOverlay.show=false;$scope.memberPickerOverlay=null;};$scope.memberPickerOverlay.close=function(oldModel){$scope.memberPickerOverlay.show=false;$scope.memberPickerOverlay=null;};};$scope.remove=function(index){$scope.renderModel.splice(index,1);};$scope.add=function(item){var currIds=_.map($scope.renderModel,function(i){return i.id;});if(currIds.indexOf(item.id)<0){item.icon=iconHelper.convertFromLegacyIcon(item.icon);$scope.renderModel.push({name:item.name,id:item.id,icon:item.icon});}};$scope.clear=function(){$scope.renderModel=[];};var unsubscribe=$scope.$on("formSubmitting",function(ev,args){var currIds=_.map($scope.renderModel,function(i){return i.id;});$scope.model.value=trim(currIds.join(),",");});$scope.$on('$destroy',function(){unsubscribe();});var modelIds=$scope.model.value?$scope.model.value.split(','):[];entityResource.getByIds(modelIds,"Member").then(function(data){_.each(data,function(item,i){item.icon=iconHelper.convertFromLegacyIcon(item.icon);$scope.renderModel.push({name:item.name,id:item.id,icon:item.icon});});});}
angular.module('umbraco').controller("Umbraco.PropertyEditors.MemberPickerController",memberPickerController);function MultipleTextBoxController($scope){$scope.sortableOptions={axis:'y',containment:'parent',cursor:'move',items:'> div.control-group',tolerance:'pointer'};if(!$scope.model.value){$scope.model.value=[];}
if($scope.model.config.min>0){for(var i=0;i<$scope.model.config.min;i++){if((i+1)>$scope.model.value.length){$scope.model.value.push({value:""});}}}
$scope.add=function(){if($scope.model.config.max<=0||$scope.model.value.length<$scope.model.config.max){$scope.model.value.push({value:""});}};$scope.remove=function(index){var remainder=[];for(var x=0;x<$scope.model.value.length;x++){if(x!==index){remainder.push($scope.model.value[x]);}}
$scope.model.value=remainder;};}
angular.module("umbraco").controller("Umbraco.PropertyEditors.MultipleTextBoxController",MultipleTextBoxController);angular.module("umbraco").controller("Umbraco.PropertyEditors.RadioButtonsController",function($scope){if(angular.isObject($scope.model.config.items)){var newItems=[];var vals=_.values($scope.model.config.items);var keys=_.keys($scope.model.config.items);for(var i=0;i<vals.length;i++){newItems.push({id:keys[i],sortOrder:vals[i].sortOrder,value:vals[i].value});}
newItems.sort(function(a,b){return(a.sortOrder>b.sortOrder)?1:((b.sortOrder>a.sortOrder)?-1:0);});$scope.model.config.items=newItems;}});function ReadOnlyValueController($rootScope,$scope,$filter){function formatDisplayValue(){if($scope.model.config&&angular.isArray($scope.model.config)&&$scope.model.config.length>0&&$scope.model.config[0]&&$scope.model.config.filter){if($scope.model.config.format){$scope.displayvalue=$filter($scope.model.config.filter)($scope.model.value,$scope.model.config.format);}else{$scope.displayvalue=$filter($scope.model.config.filter)($scope.model.value);}}else{$scope.displayvalue=$scope.model.value;}}
formatDisplayValue();$scope.$watch("model.value",function(newVal,oldVal){if(newVal!==null&&newVal!==undefined&&newVal!==oldVal){formatDisplayValue();}});}
angular.module('umbraco').controller("Umbraco.PropertyEditors.ReadOnlyValueController",ReadOnlyValueController);angular.module("umbraco").controller("Umbraco.PropertyEditors.RelatedLinksController",function($rootScope,$scope,dialogService,iconHelper){if(!$scope.model.value){$scope.model.value=[];}
$scope.model.config.max=isNumeric($scope.model.config.max)&&$scope.model.config.max!==0?$scope.model.config.max:Number.MAX_VALUE;$scope.newCaption='';$scope.newLink='http://';$scope.newNewWindow=false;$scope.newInternal=null;$scope.newInternalName='';$scope.newInternalIcon=null;$scope.addExternal=true;$scope.currentEditLink=null;$scope.hasError=false;$scope.internal=function($event){$scope.currentEditLink=null;$scope.contentPickerOverlay={};$scope.contentPickerOverlay.view="contentpicker";$scope.contentPickerOverlay.multiPicker=false;$scope.contentPickerOverlay.show=true;$scope.contentPickerOverlay.submit=function(model){select(model.selection[0]);$scope.contentPickerOverlay.show=false;$scope.contentPickerOverlay=null;};$scope.contentPickerOverlay.close=function(oldModel){$scope.contentPickerOverlay.show=false;$scope.contentPickerOverlay=null;};$event.preventDefault();};$scope.selectInternal=function($event,link){$scope.currentEditLink=link;$scope.contentPickerOverlay={};$scope.contentPickerOverlay.view="contentpicker";$scope.contentPickerOverlay.multiPicker=false;$scope.contentPickerOverlay.show=true;$scope.contentPickerOverlay.submit=function(model){select(model.selection[0]);$scope.contentPickerOverlay.show=false;$scope.contentPickerOverlay=null;};$scope.contentPickerOverlay.close=function(oldModel){$scope.contentPickerOverlay.show=false;$scope.contentPickerOverlay=null;};$event.preventDefault();};$scope.edit=function(idx){for(var i=0;i<$scope.model.value.length;i++){$scope.model.value[i].edit=false;}
$scope.model.value[idx].edit=true;};$scope.saveEdit=function(idx){$scope.model.value[idx].title=$scope.model.value[idx].caption;$scope.model.value[idx].edit=false;};$scope.delete=function(idx){$scope.model.value.splice(idx,1);};$scope.add=function($event){if($scope.newCaption==""){$scope.hasError=true;}else{if($scope.addExternal){var newExtLink=new function(){this.caption=$scope.newCaption;this.link=$scope.newLink;this.newWindow=$scope.newNewWindow;this.edit=false;this.isInternal=false;this.type="external";this.title=$scope.newCaption;};$scope.model.value.push(newExtLink);}else{var newIntLink=new function(){this.caption=$scope.newCaption;this.link=$scope.newInternal;this.newWindow=$scope.newNewWindow;this.internal=$scope.newInternal;this.edit=false;this.isInternal=true;this.internalName=$scope.newInternalName;this.internalIcon=$scope.newInternalIcon;this.type="internal";this.title=$scope.newCaption;};$scope.model.value.push(newIntLink);}
$scope.newCaption='';$scope.newLink='http://';$scope.newNewWindow=false;$scope.newInternal=null;$scope.newInternalName='';$scope.newInternalIcon=null;}
$event.preventDefault();};$scope.switch=function($event){$scope.addExternal=!$scope.addExternal;$event.preventDefault();};$scope.switchLinkType=function($event,link){link.isInternal=!link.isInternal;link.type=link.isInternal?"internal":"external";if(!link.isInternal)
link.link=$scope.newLink;$event.preventDefault();};$scope.move=function(index,direction){var temp=$scope.model.value[index];$scope.model.value[index]=$scope.model.value[index+direction];$scope.model.value[index+direction]=temp;};$scope.canAdd=function(){return $scope.model.config.max<=0||$scope.model.config.max>countVisible();}
$scope.canSort=function(){return countVisible()>1;}
$scope.sortableOptions={axis:'y',handle:'.handle',cursor:'move',cancel:'.no-drag',containment:'parent',placeholder:'sortable-placeholder',forcePlaceholderSize:true,helper:function(e,ui){ui.children().each(function(){$(this).width($(this).width());});return ui;},items:'> tr:not(.unsortable)',tolerance:'pointer',update:function(e,ui){var newIndex=ui.item.index();var movedLinkUrl=ui.item.attr('data-link');var originalIndex=getElementIndexByUrl(movedLinkUrl);var movedElement=$scope.model.value[originalIndex];$scope.model.value.splice(originalIndex,1);$scope.model.value.splice(newIndex,0,movedElement);},start:function(e,ui){var cellCount=0;$('td, th',ui.helper).each(function(){var colspan=1;var colspanAttr=$(this).attr('colspan');if(colspanAttr>1){colspan=colspanAttr;}
cellCount+=colspan;});ui.placeholder.html('<td colspan="'+cellCount+'"></td>').height(ui.item.height());}};function countVisible(){return $scope.model.value.length;}
function isNumeric(n){return!isNaN(parseFloat(n))&&isFinite(n);}
function getElementIndexByUrl(url){for(var i=0;i<$scope.model.value.length;i++){if($scope.model.value[i].link==url){return i;}}
return-1;}
function select(data){if($scope.currentEditLink!=null){$scope.currentEditLink.internal=data.id;$scope.currentEditLink.internalName=data.name;$scope.currentEditLink.internalIcon=iconHelper.convertFromLegacyIcon(data.icon);$scope.currentEditLink.link=data.id;}else{$scope.newInternal=data.id;$scope.newInternalName=data.name;$scope.newInternalIcon=iconHelper.convertFromLegacyIcon(data.icon);}}});angular.module("umbraco").controller("Umbraco.PropertyEditors.RTEController",function($rootScope,$scope,$q,dialogService,$log,imageHelper,assetsService,$timeout,tinyMceService,angularHelper,stylesheetResource,macroService){$scope.isLoading=true;var d=new Date();var n=d.getTime();$scope.textAreaHtmlId=$scope.model.alias+"_"+n+"_rte";var alreadyDirty=false;function syncContent(editor){editor.save();angularHelper.safeApply($scope,function(){$scope.model.value=editor.getContent();});if(!alreadyDirty){var currForm=angularHelper.getCurrentForm($scope);currForm.$setDirty();alreadyDirty=true;}}
tinyMceService.configuration().then(function(tinyMceConfig){var validElements=tinyMceConfig.validElements;var extendedValidElements="@[id|class|style],-div[id|dir|class|align|style],ins[datetime|cite],-ul[class|style],-li[class|style],span[id|class|style]";var invalidElements=tinyMceConfig.inValidElements;var plugins=_.map(tinyMceConfig.plugins,function(plugin){if(plugin.useOnFrontend){return plugin.name;}}).join(" ");var editorConfig=$scope.model.config.editor;if(!editorConfig||angular.isString(editorConfig)){editorConfig=tinyMceService.defaultPrevalues();}
var toolbar=editorConfig.toolbar.join(" | ");var stylesheets=[];var styleFormats=[];var await=[];if(!editorConfig.maxImageSize&&editorConfig.maxImageSize!=0){editorConfig.maxImageSize=tinyMceService.defaultPrevalues().maxImageSize;}
if(typeof tinymce==="undefined"){await.push(assetsService.loadJs("lib/tinymce/tinymce.min.js",$scope));}
angular.forEach(editorConfig.stylesheets,function(val,key){stylesheets.push(Umbraco.Sys.ServerVariables.umbracoSettings.cssPath+"/"+val+".css?"+new Date().getTime());await.push(stylesheetResource.getRulesByName(val).then(function(rules){angular.forEach(rules,function(rule){var r={};r.title=rule.name;if(rule.selector[0]=="."){r.inline="span";r.classes=rule.selector.substring(1);}
else if(rule.selector[0]=="#"){r.inline="span";r.attributes={id:rule.selector.substring(1)};}
else if(rule.selector[0]!="."&&rule.selector.indexOf(".")>-1){var split=rule.selector.split(".");r.block=split[0];r.classes=rule.selector.substring(rule.selector.indexOf(".")+1).replace("."," ");}
else if(rule.selector[0]!="#"&&rule.selector.indexOf("#")>-1){var split=rule.selector.split("#");r.block=split[0];r.classes=rule.selector.substring(rule.selector.indexOf("#")+1);}
else{r.block=rule.selector;}
styleFormats.push(r);});}));});var tinyMceEditor=null;$q.all(await).then(function(){var baseLineConfigObj={mode:"exact",skin:"umbraco",plugins:plugins,valid_elements:validElements,invalid_elements:invalidElements,extended_valid_elements:extendedValidElements,menubar:false,statusbar:false,height:editorConfig.dimensions.height,width:editorConfig.dimensions.width,maxImageSize:editorConfig.maxImageSize,toolbar:toolbar,content_css:stylesheets,relative_urls:false,style_formats:styleFormats};if(tinyMceConfig.customConfig){for(var i in tinyMceConfig.customConfig){var val=tinyMceConfig.customConfig[i];if(val){val=val.toString().trim();if(val.detectIsJson()){try{tinyMceConfig.customConfig[i]=JSON.parse(val);if(angular.isArray(baseLineConfigObj[i])&&angular.isArray(tinyMceConfig.customConfig[i])){tinyMceConfig.customConfig[i]=baseLineConfigObj[i].concat(tinyMceConfig.customConfig[i]);}}
catch(e){}}}}
angular.extend(baseLineConfigObj,tinyMceConfig.customConfig);}
baseLineConfigObj.elements=$scope.textAreaHtmlId;baseLineConfigObj.setup=function(editor){tinyMceEditor=editor;editor.on('init',function(e){editor.getBody().setAttribute('spellcheck',true);});editor.on('blur',function(e){editor.save();angularHelper.safeApply($scope,function(){$scope.model.value=editor.getContent();});});editor.on('ExecCommand',function(e){syncContent(editor);});editor.on('KeyUp',function(e){syncContent(editor);});editor.on('SetContent',function(e){if(!e.initial){syncContent(editor);}});editor.on('ObjectResized',function(e){var qs="?width="+e.width+"&height="+e.height;var srcAttr=$(e.target).attr("src");var path=srcAttr.split("?")[0];$(e.target).attr("data-mce-src",path+qs);syncContent(editor);});tinyMceService.createLinkPicker(editor,$scope,function(currentTarget,anchorElement){$scope.linkPickerOverlay={view:"linkpicker",currentTarget:currentTarget,show:true,submit:function(model){tinyMceService.insertLinkInEditor(editor,model.target,anchorElement);$scope.linkPickerOverlay.show=false;$scope.linkPickerOverlay=null;}};});tinyMceService.createMediaPicker(editor,$scope,function(currentTarget,userData){$scope.mediaPickerOverlay={currentTarget:currentTarget,onlyImages:true,showDetails:true,disableFolderSelect:true,startNodeId:userData.startMediaId,view:"mediapicker",show:true,submit:function(model){tinyMceService.insertMediaInEditor(editor,model.selectedImages[0]);$scope.mediaPickerOverlay.show=false;$scope.mediaPickerOverlay=null;}};});tinyMceService.createInsertEmbeddedMedia(editor,$scope,function(){$scope.embedOverlay={view:"embed",show:true,submit:function(model){tinyMceService.insertEmbeddedMediaInEditor(editor,model.embed.preview);$scope.embedOverlay.show=false;$scope.embedOverlay=null;}};});tinyMceService.createInsertMacro(editor,$scope,function(dialogData){$scope.macroPickerOverlay={view:"macropicker",dialogData:dialogData,show:true,submit:function(model){var macroObject=macroService.collectValueData(model.selectedMacro,model.macroParams,dialogData.renderingEngine);tinyMceService.insertMacroInEditor(editor,macroObject,$scope);$scope.macroPickerOverlay.show=false;$scope.macroPickerOverlay=null;}};});};function loadTinyMce(){$timeout(function(){tinymce.DOM.events.domLoaded=true;tinymce.init(baseLineConfigObj);$scope.isLoading=false;},200,false);}
loadTinyMce();$scope.model.onValueChanged=function(newVal,oldVal){tinyMceEditor.setContent(newVal,{format:'raw'});tinyMceEditor.fire('LoadContent',null);};var unsubscribe=$scope.$on("formSubmitting",function(){$scope.model.value=tinyMceEditor.getContent();});$scope.$on('$destroy',function(){unsubscribe();});});});});angular.module("umbraco").controller("Umbraco.PrevalueEditors.RteController",function($scope,$timeout,$log,tinyMceService,stylesheetResource,assetsService){var cfg=tinyMceService.defaultPrevalues();if($scope.model.value){if(angular.isString($scope.model.value)){$scope.model.value=cfg;}}else{$scope.model.value=cfg;}
if(!$scope.model.value.stylesheets){$scope.model.value.stylesheets=[];}
if(!$scope.model.value.toolbar){$scope.model.value.toolbar=[];}
if(!$scope.model.value.maxImageSize&&$scope.model.value.maxImageSize!=0){$scope.model.value.maxImageSize=cfg.maxImageSize;}
tinyMceService.configuration().then(function(config){$scope.tinyMceConfig=config;$scope.tinyMceConfig.commands=_.map($scope.tinyMceConfig.commands,function(obj){var icon=getFontIcon(obj.frontEndCommand);return angular.extend(obj,{fontIcon:icon.name,isCustom:icon.isCustom});});});stylesheetResource.getAll().then(function(stylesheets){$scope.stylesheets=stylesheets;});$scope.selected=function(cmd,alias,lookup){if(lookup&&angular.isArray(lookup)){cmd.selected=lookup.indexOf(alias)>=0;return cmd.selected;}
return false;};$scope.selectCommand=function(command){var index=$scope.model.value.toolbar.indexOf(command.frontEndCommand);if(command.selected&&index===-1){$scope.model.value.toolbar.push(command.frontEndCommand);}else if(index>=0){$scope.model.value.toolbar.splice(index,1);}};$scope.selectStylesheet=function(css){var index=$scope.model.value.stylesheets.indexOf(css.name);if(css.selected&&index===-1){$scope.model.value.stylesheets.push(css.name);}else if(index>=0){$scope.model.value.stylesheets.splice(index,1);}};function getFontIcon(alias){var icon={name:alias,isCustom:false};switch(alias){case"codemirror":icon.name="code";icon.isCustom=false;break;case"styleselect":icon.name="icon-list";icon.isCustom=true;break;case"umbembeddialog":icon.name="icon-tv";icon.isCustom=true;break;case"umbmediapicker":icon.name="icon-picture";icon.isCustom=true;break;case"umbmacro":icon.name="icon-settings-alt";icon.isCustom=true;break;case"umbmacro":icon.name="icon-settings-alt";icon.isCustom=true;break;default:icon.name=alias;icon.isCustom=false;}
return icon;}
var unsubscribe=$scope.$on("formSubmitting",function(ev,args){var commands=_.where($scope.tinyMceConfig.commands,{selected:true});$scope.model.value.toolbar=_.pluck(commands,"frontEndCommand");});$scope.$on('$destroy',function(){unsubscribe();});assetsService.loadCss("lib/tinymce/skins/umbraco/skin.min.css");});function sliderController($scope,$log,$element,assetsService,angularHelper){if(!$scope.model.config.orientation){$scope.model.config.orientation="horizontal";}
if(!$scope.model.config.enableRange){$scope.model.config.enableRange=false;}
else{$scope.model.config.enableRange=$scope.model.config.enableRange==="1"?true:false;}
if(!$scope.model.config.initVal1){$scope.model.config.initVal1=0;}
else{$scope.model.config.initVal1=parseFloat($scope.model.config.initVal1);}
if(!$scope.model.config.initVal2){$scope.model.config.initVal2=0;}
else{$scope.model.config.initVal2=parseFloat($scope.model.config.initVal2);}
if(!$scope.model.config.minVal){$scope.model.config.minVal=0;}
else{$scope.model.config.minVal=parseFloat($scope.model.config.minVal);}
if(!$scope.model.config.maxVal){$scope.model.config.maxVal=100;}
else{$scope.model.config.maxVal=parseFloat($scope.model.config.maxVal);}
if(!$scope.model.config.step){$scope.model.config.step=1;}
else{$scope.model.config.step=parseFloat($scope.model.config.step);}
if(!$scope.model.config.handle){$scope.model.config.handle="round";}
if(!$scope.model.config.reversed){$scope.model.config.reversed=false;}
else{$scope.model.config.reversed=$scope.model.config.reversed==="1"?true:false;}
if(!$scope.model.config.tooltip){$scope.model.config.tooltip="show";}
if(!$scope.model.config.tooltipSplit){$scope.model.config.tooltipSplit=false;}
else{$scope.model.config.tooltipSplit=$scope.model.config.tooltipSplit==="1"?true:false;}
if($scope.model.config.tooltipFormat){$scope.model.config.formatter=function(value){if(angular.isArray(value)&&$scope.model.config.enableRange){return $scope.model.config.tooltipFormat.replace("{0}",value[0]).replace("{1}",value[1]);}else{return $scope.model.config.tooltipFormat.replace("{0}",value);}}}
if(!$scope.model.config.ticks){$scope.model.config.ticks=[];}
else{$scope.model.config.ticks=_.map($scope.model.config.ticks.split(','),function(item){return parseInt(item.trim());});}
if(!$scope.model.config.ticksPositions){$scope.model.config.ticksPositions=[];}
else{$scope.model.config.ticksPositions=_.map($scope.model.config.ticksPositions.split(','),function(item){return parseInt(item.trim());});console.log($scope.model.config.ticksPositions);}
if(!$scope.model.config.ticksLabels){$scope.model.config.ticksLabels=[];}
else{$scope.model.config.ticksLabels=_.map($scope.model.config.ticksLabels.split(','),function(item){return item.trim();});}
if(!$scope.model.config.ticksSnapBounds){$scope.model.config.ticksSnapBounds=0;}
else{$scope.model.config.ticksSnapBounds=parseFloat($scope.model.config.ticksSnapBounds);}
function createSlider(){var sliderVal=null;if($scope.model.config.enableRange==true){if(!$scope.model.value||$scope.model.value.indexOf(",")==-1){var i1=parseFloat($scope.model.config.initVal1);var i2=parseFloat($scope.model.config.initVal2);sliderVal=[isNaN(i1)?$scope.model.config.minVal:(i1>=$scope.model.config.minVal?i1:$scope.model.config.minVal),isNaN(i2)?$scope.model.config.maxVal:(i2>i1?(i2<=$scope.model.config.maxVal?i2:$scope.model.config.maxVal):$scope.model.config.maxVal)];}
else{sliderVal=_.map($scope.model.value.split(','),function(item){return parseFloat(item);});}}
else{if($scope.model.value){sliderVal=parseFloat($scope.model.value);}
else{sliderVal=$scope.model.config.initVal1;}}
if(!$scope.model.value){setModelValueFromSlider(sliderVal);}
var slider=$element.find('.slider-item').bootstrapSlider({max:$scope.model.config.maxVal,min:$scope.model.config.minVal,orientation:$scope.model.config.orientation,selection:$scope.model.config.reversed?"after":"before",step:$scope.model.config.step,precision:$scope.model.config.precision,tooltip:$scope.model.config.tooltip,tooltip_split:$scope.model.config.tooltipSplit,tooltip_position:$scope.model.config.tooltipPosition,handle:$scope.model.config.handle,reversed:$scope.model.config.reversed,ticks:$scope.model.config.ticks,ticks_positions:$scope.model.config.ticksPositions,ticks_labels:$scope.model.config.ticksLabels,ticks_snap_bounds:$scope.model.config.ticksSnapBounds,formatter:$scope.model.config.formatter,range:$scope.model.config.enableRange,value:sliderVal}).on('slideStop',function(e){var value=e.value;angularHelper.safeApply($scope,function(){setModelValueFromSlider(value);});}).data('slider');}
function setModelValueFromSlider(sliderVal){if($scope.model.config.enableRange==true){$scope.model.value=sliderVal.join(",");}
else{$scope.model.value=sliderVal.toString();}}
assetsService.loadJs("lib/slider/js/bootstrap-slider.js").then(function(){createSlider();$scope.model.onValueChanged=function(newVal,oldVal){if(newVal!=oldVal){createSlider();}};});assetsService.loadCss("lib/slider/bootstrap-slider.css");assetsService.loadCss("lib/slider/bootstrap-slider-custom.css");}
angular.module("umbraco").controller("Umbraco.PropertyEditors.SliderController",sliderController);angular.module("umbraco").controller("Umbraco.PropertyEditors.TagsController",function($rootScope,$scope,$log,assetsService,umbRequestHelper,angularHelper,$timeout,$element){var $typeahead;$scope.isLoading=true;$scope.tagToAdd="";assetsService.loadJs("lib/typeahead.js/typeahead.bundle.min.js").then(function(){$scope.isLoading=false;if($scope.model.value){if(!$scope.model.config.storageType||$scope.model.config.storageType!=="Json"){if(!$scope.model.value){$scope.model.value=[];}
else{if($scope.model.value.length>0){$scope.model.value=$scope.model.value.split(",");}}}}
else{$scope.model.value=[];}
$scope.validateMandatory=function(){return{isValid:!$scope.model.validation.mandatory||($scope.model.value!=null&&$scope.model.value.length>0),errorMsg:"Value cannot be empty",errorKey:"required"};}
function addTag(tagToAdd){if(tagToAdd!=null&&tagToAdd.length>0){if($scope.model.value.indexOf(tagToAdd)<0){$scope.model.value.push(tagToAdd);$scope.propertyForm.tagCount.$setViewValue($scope.model.value.length);}}}
$scope.addTagOnEnter=function(e){var code=e.keyCode||e.which;if(code==13){if($element.find('.tags-'+$scope.model.alias).parent().find(".tt-dropdown-menu .tt-cursor").length===0){e.preventDefault();$scope.addTag();}}};$scope.addTag=function(){addTag($scope.tagToAdd);$scope.tagToAdd="";$typeahead.typeahead('val','');};$scope.removeTag=function(tag){var i=$scope.model.value.indexOf(tag);if(i>=0){$scope.model.value.splice(i,1);$scope.propertyForm.tagCount.$setViewValue($scope.model.value.length);}};$scope.model.onValueChanged=function(newVal,oldVal){$scope.model.value=newVal;if(!$scope.model.config.storageType||$scope.model.config.storageType!=="Json"){if(!$scope.model.value){$scope.model.value=[];}
else{$scope.model.value=$scope.model.value.split(",");}}};function dataTransform(list){var tagList=_.map(list,function(i){return{value:i.text};});return $.grep(tagList,function(tag){return($.inArray(tag.value,$scope.model.value)===-1);});}
function removeCurrentTagsFromSuggestions(suggestions){return $.grep(suggestions,function(suggestion){return($.inArray(suggestion.value,$scope.model.value)===-1);});}
var tagsHound=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace('value'),queryTokenizer:Bloodhound.tokenizers.whitespace,dupDetector:function(remoteMatch,localMatch){return(remoteMatch["value"]==localMatch["value"]);},prefetch:{url:umbRequestHelper.getApiUrl("tagsDataBaseUrl","GetTags",[{tagGroup:$scope.model.config.group}]),ttl:300000,filter:dataTransform},remote:{url:umbRequestHelper.getApiUrl("tagsDataBaseUrl","GetTags",[{tagGroup:$scope.model.config.group}]),filter:dataTransform}});tagsHound.initialize(true);$timeout(function(){$typeahead=$element.find('.tags-'+$scope.model.alias).typeahead({hint:false,highlight:true,cacheKey:new Date(),minLength:1},{name:$scope.model.config.group,displayKey:"value",source:function(query,cb){tagsHound.get(query,function(suggestions){cb(removeCurrentTagsFromSuggestions(suggestions));});},}).bind("typeahead:selected",function(obj,datum,name){angularHelper.safeApply($scope,function(){addTag(datum["value"]);$scope.tagToAdd="";$typeahead.typeahead('val','');});}).bind("typeahead:autocompleted",function(obj,datum,name){angularHelper.safeApply($scope,function(){addTag(datum["value"]);$scope.tagToAdd="";});}).bind("typeahead:opened",function(obj){});});$scope.$on('$destroy',function(){tagsHound.clearPrefetchCache();tagsHound.clearRemoteCache();$element.find('.tags-'+$scope.model.alias).typeahead('destroy');delete tagsHound;});});});angular.module('umbraco').controller("Umbraco.PropertyEditors.EmbeddedContentController",function($rootScope,$scope,$log){$scope.showForm=false;$scope.fakeData=[];$scope.create=function(){$scope.showForm=true;$scope.fakeData=angular.copy($scope.model.config.fields);};$scope.show=function(){$scope.showCode=true;};$scope.add=function(){$scope.showForm=false;if(!($scope.model.value instanceof Array)){$scope.model.value=[];}
$scope.model.value.push(angular.copy($scope.fakeData));$scope.fakeData=[];};});angular.module('umbraco').controller("Umbraco.PropertyEditors.UrlListController",function($rootScope,$scope,$filter){function formatDisplayValue(){if(angular.isArray($scope.model.value)){$scope.renderModel=_.map($scope.model.value,function(item){return{url:item.url,linkText:item.linkText,urlTarget:(item.target)?item.target:"_blank",icon:(item.icon)?item.icon:"icon-out"};});}
else{$scope.renderModel=_.map($scope.model.value.split(","),function(item){return{url:item,linkText:"",urlTarget:($scope.config&&$scope.config.target)?$scope.config.target:"_blank",icon:($scope.config&&$scope.config.icon)?$scope.config.icon:"icon-out"};});}}
$scope.getUrl=function(valueUrl){if(valueUrl.indexOf("/")>=0){return valueUrl;}
return"#";};formatDisplayValue();$scope.model.onValueChanged=function(newVal,oldVal){formatDisplayValue();};});})();
;;;
app.config(function($routeProvider){var canRoute=function(isRequired){return{isAuthenticatedAndReady:function($q,userService,$route,assetsService,appState){var deferred=$q.defer();if(!$route.current.params.section&&($route.current.params.check===false||$route.current.params.check==="false")){deferred.resolve(true);return deferred.promise;}
userService.isAuthenticated().then(function(){assetsService._loadInitAssets().then(function(){var broadcast=appState.getGlobalState("isReady")!==true;userService.getCurrentUser({broadcastEvent:broadcast}).then(function(user){if(isRequired){if(user.allowedSections.indexOf($route.current.params.section)>-1){deferred.resolve(true);}else{deferred.reject({path:"/"+user.allowedSections[0]});}}
else{deferred.reject({path:"/"});}});});},function(){if(isRequired){deferred.reject({path:"/login/false"});}
else{deferred.resolve(true);}});return deferred.promise;}};};var doLogout=function(){return{isLoggedOut:function($q,userService){var deferred=$q.defer();userService.logout().then(function(){deferred.resolve(true);},function(){deferred.reject({path:"/login/false"});});return deferred.promise;}}}
$routeProvider.when('/login',{templateUrl:'views/common/login.html',resolve:canRoute(false)}).when('/login/:check',{templateUrl:'views/common/login.html',resolve:canRoute(false)}).when('/logout',{redirectTo:'/login/false',resolve:doLogout()}).when('/:section',{templateUrl:function(rp){if(rp.section.toLowerCase()==="default"||rp.section.toLowerCase()==="umbraco"||rp.section==="")
{rp.section="content";}
rp.url="dashboard.aspx?app="+rp.section;return'views/common/dashboard.html';},resolve:canRoute(true)}).when('/:section/framed/:url',{templateUrl:function(rp){if(!rp.url)
throw"A framed resource must have a url route parameter";return'views/common/legacy.html';},resolve:canRoute(true)}).when('/:section/:tree/:method',{templateUrl:function(rp){if(!rp.method)
return"views/common/dashboard.html";return('views/'+rp.tree+'/'+rp.method+'.html');},resolve:canRoute(true)}).when('/:section/:tree/:method/:id',{template:"<div ng-include='templateUrl'></div>",controller:function($scope,$route,$routeParams,treeService){if(!$routeParams.tree||!$routeParams.method){$scope.templateUrl="views/common/dashboard.html";}
var packageTreeFolder=treeService.getTreePackageFolder($routeParams.tree);if(packageTreeFolder){$scope.templateUrl=(Umbraco.Sys.ServerVariables.umbracoSettings.appPluginsPath+"/"+packageTreeFolder+"/backoffice/"+$routeParams.tree+"/"+$routeParams.method+".html");}
else{$scope.templateUrl=('views/'+$routeParams.tree+'/'+$routeParams.method+'.html');}},resolve:canRoute(true)}).otherwise({redirectTo:'/login'});}).config(function($locationProvider){});
;;;
app.run(['userService','$log','$rootScope','$location','navigationService','appState','editorState','fileManager','assetsService','eventsService','$cookies','$templateCache',function(userService,$log,$rootScope,$location,navigationService,appState,editorState,fileManager,assetsService,eventsService,$cookies,$templateCache){$.ajaxSetup({beforeSend:function(xhr){xhr.setRequestHeader("X-XSRF-TOKEN",$cookies["XSRF-TOKEN"]);}});eventsService.on("app.authenticated",function(evt,data){assetsService._loadInitAssets().then(function(){appState.setGlobalState("isReady",true);eventsService.emit("app.ready",data);returnToPath=null,returnToSearch=null;});});$rootScope.$on('$routeChangeSuccess',function(event,current,previous){if(current.params.section){$rootScope.locationTitle=current.params.section+" - "+$location.$$host;}
else{$rootScope.locationTitle="Umbraco - "+$location.$$host;}
editorState.reset();fileManager.clearFiles();});$rootScope.$on('$routeChangeError',function(event,current,previous,rejection){event.preventDefault();var returnPath=null;if(rejection.path=="/login"||rejection.path.startsWith("/login/")){returnPath=encodeURIComponent($location.url());}
$location.path(rejection.path)
if(returnPath){$location.search("returnPath",returnPath);}});navigationService.init();var touchDevice=/android|webos|iphone|ipad|ipod|blackberry|iemobile|touch/i.test(navigator.userAgent.toLowerCase());appState.setGlobalState("touchDevice",touchDevice);}]);
;;;
angular.module('umbraco').filter('ellipsisLimit',function(){return function(value,max){if(!value){return'';}
max=parseInt(max,10);if(!max){return value;}
if(value.length<=max){return value;}
value=value.substr(0,max);return value+' …';};});angular.module('umbraco').directive('maxlen',function(){return{require:'ngModel',link:function(scope,el,attrs,ctrl){var validate=false;var length=999999;if(attrs.name==='title'){validate=scope.model.config.allowLongTitles!=='1';length=scope.serpTitleLength;}else if(attrs.name==='description'){validate=scope.model.config.allowLongDescriptions!=='1';length=scope.serpDescriptionLength;}
ctrl.$parsers.unshift(function(viewValue){if(validate&&viewValue.length>length){ctrl.$setValidity('maxlen',false);}else{ctrl.$setValidity('maxlen',true);}
return viewValue;});}};});angular.module("umbraco").controller("EpiphanySeoMetadataController",['$scope','contentResource',function($scope,contentResource){$scope.invalidate=true;$scope.model.hideLabel=true;$scope.serpTitleLength=!!$scope.model.config.serpTitleLength?$scope.model.config.serpTitleLength:65;$scope.serpDescriptionLength=!!$scope.model.config.serpDescriptionLength?$scope.model.config.serpDescriptionLength:150;$scope.developerName=$scope.model.config.developerName||'your agency';$scope.doNotIndexExplanation=$scope.model.config.doNotIndexExplanation||'';$scope.siteTitle=$scope.model.config.siteTitle||'';if(!$scope.model.value){$scope.model.value={title:'',description:'',urlName:'',noIndex:false};}
function slugify(text){return text.toString().toLowerCase().trim().replace(/\s+/g,'-').replace(/&/g,'').replace(/[^\w\-]+/g,'').replace(/\-\-+/g,'-');}
$scope.init=function(){var content=$scope.GetParentContent();if(!content.published){contentResource.getById(content.parentId).then(function(data){$scope.parentUrl=data.urls[0];});}};$scope.GetUrl=function(){var name,url;var pageContent=$scope.GetParentContent();if(!pageContent.published){if($scope.model.value.urlName&&$scope.model.value.urlName.length){name=slugify($scope.model.value.urlName);}else if(typeof(pageContent.name)!=='undefined'){name=slugify(pageContent.name);}
if(typeof(name)==='undefined'||name.length===0){name="unpublished-page";}
return $scope.ProtocolAndHost()+$scope.parentUrl+name+"/";}
var nodeUrl=pageContent.urls[0];url=/^https?:\/\//i.test(nodeUrl)?nodeUrl:$scope.ProtocolAndHost()+nodeUrl;var urlSplit=url.split('/');if($scope.model.value.urlName&&$scope.model.value.urlName.length){if(urlSplit.length>4){if(urlSplit[urlSplit.length-1]===""){urlSplit[urlSplit.length-2]=slugify($scope.model.value.urlName);}else{urlSplit[urlSplit.length-1]=slugify($scope.model.value.urlName);}}
url=urlSplit.join('/');}else{urlSplit.splice(-2,2);name=pageContent.name?slugify(pageContent.name):'unpublished-page';url=urlSplit.join('/')+'/'+name+'/';}
return url;};$scope.ProtocolAndHost=function(){var http=location.protocol;var slashes=http.concat("//");return slashes.concat(window.location.hostname);};$scope.GetTitle=function(){var title=$scope.model.value.title||'Page Title';if(title!=='Page Title'&&$scope.siteTitle!==''){title+=$scope.siteTitle.replace('&nbsp;',' ');}
return title;};$scope.GetParentContent=function(){var currentScope=$scope.$parent;for(var i=0;i<150;i++){if(currentScope.content){return currentScope.content;}
currentScope=currentScope.$parent;}
return null;};$(window).resize(function(){$scope.$apply(function(){if(window.innerWidth<=1500&&!$scope.hideSerp){$scope.hideSerp=true;}
if(window.innerWidth>1500){$scope.hideSerp=false;}});});$scope.init();}]);
;;;
function modelsBuilderController($scope,umbRequestHelper,$log,$http,modelsBuilderResource){$scope.generate=function(){$scope.generating=true;umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("modelsBuilderBaseUrl","BuildModels")),'Failed to generate.').then(function(result){$scope.generating=false;$scope.dashboard=result;});};$scope.reload=function(){$scope.ready=false;modelsBuilderResource.getDashboard().then(function(result){$scope.dashboard=result;$scope.ready=true;});};function init(){modelsBuilderResource.getDashboard().then(function(result){$scope.dashboard=result;$scope.ready=true;});}
init();}
angular.module("umbraco").controller("Umbraco.Dashboard.ModelsBuilderController",modelsBuilderController);
;;;
function modelsBuilderResource($q,$http,umbRequestHelper){return{getModelsOutOfDateStatus:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("modelsBuilderBaseUrl","GetModelsOutOfDateStatus")),"Failed to get models out-of-date status");},buildModels:function(){return umbRequestHelper.resourcePromise($http.post(umbRequestHelper.getApiUrl("modelsBuilderBaseUrl","BuildModels")),"Failed to build models");},getDashboard:function(){return umbRequestHelper.resourcePromise($http.get(umbRequestHelper.getApiUrl("modelsBuilderBaseUrl","GetDashboard")),"Failed to get dashboard");}};}
angular.module("umbraco.resources").factory("modelsBuilderResource",modelsBuilderResource);
;;;
angular.module("umbraco").controller("TheDashboard.Controller",function($scope,$http,notificationsService){$http.get('/umbraco/backoffice/api/TheDashboard/GetViewModel').success(function(data,status,headers,config){$scope.vm=data;}).error(function(data,status,headers,config){});});
;;;
angular.module("umbraco").controller("TheDevDashboard.Controller",function($scope,$http){$http.get('/umbraco/backoffice/api/TheDevDashboard/GetViewModel').success(function(data,status,headers,config){$scope.vm=data;}).error(function(data,status,headers,config){});});
;;;
angular.module("umbraco").controller("UmbracoForms.RenderTypes.FileController",function($scope){var imageExts=['jpg','jpeg','png','gif','bmp'];$scope.files=$scope.field.replace('~','').split(',');$scope.isImage=function(filepath){return imageExts.indexOf($scope.getExtension(filepath))>=0;};$scope.getExtension=function(filepath){return filepath.substring(filepath.lastIndexOf(".")+1).toLowerCase();};$scope.getFileName=function(filepath){return filepath.substring(filepath.lastIndexOf("/")+1);};$scope.getPreview=function(filepath){return filepath.replace('~','')+"?width=400";};});angular.module("umbraco").controller("UmbracoForms.SettingTypes.DocumentMapperController",function($scope,$routeParams,pickerResource){if(!$scope.setting.value){}else{var value=JSON.parse($scope.setting.value);$scope.doctype=value.doctype;$scope.nameField=value.nameField;$scope.nameStaticValue=value.nameStaticValue;$scope.properties=value.properties;}
pickerResource.getAllDocumentTypesWithAlias().then(function(response){$scope.doctypes=response.data;});pickerResource.getAllFields($routeParams.id).then(function(response){$scope.fields=response.data;});$scope.setDocType=function(){pickerResource.getAllProperties($scope.doctype).then(function(response){$scope.properties=response.data;});};$scope.setValue=function(){var val={};val.doctype=$scope.doctype;val.nameField=$scope.nameField;val.nameStaticValue=$scope.nameStaticValue;val.properties=$scope.properties;$scope.setting.value=JSON.stringify(val);};});angular.module("umbraco").controller("UmbracoForms.SettingTypes.FieldMapperController",function($scope,$routeParams,pickerResource){function init(){if(!$scope.setting.value){$scope.mappings=[];}else{$scope.mappings=JSON.parse($scope.setting.value);}
var formId=$routeParams.id;if(formId===-1&&$scope.model&&$scope.model.fields){}else{pickerResource.getAllFields($routeParams.id).then(function(response){$scope.fields=response.data;});}}
$scope.addMapping=function(){$scope.mappings.push({alias:"",value:"",staticValue:""});};$scope.deleteMapping=function(index){$scope.mappings.splice(index,1);$scope.setting.value=JSON.stringify($scope.mappings);};$scope.stringifyValue=function(){$scope.setting.value=JSON.stringify($scope.mappings);};init();});angular.module("umbraco").controller("UmbracoForms.SettingTypes.File",function($scope,dialogService,utilityService){var umbracoVersion=Umbraco.Sys.ServerVariables.application.version;$scope.openMediaPicker=function(){var compareOptions={zeroExtend:true};var versionCompare=utilityService.compareVersions(umbracoVersion,"7.4",compareOptions);if(versionCompare===0||versionCompare===1){$scope.mediaPickerOverlay={view:"mediapicker",show:true,submit:function(model){var selectedImage=model.selectedImages[0];populateFile(selectedImage);$scope.mediaPickerOverlay.show=false;$scope.mediaPickerOverlay=null;}};}else{dialogService.mediaPicker({callback:populateFile});}};function populateFile(item){var umbracoFileProp=_.findWhere(item.properties,{alias:"umbracoFile"});$scope.setting.value=umbracoFileProp.value;}});angular.module("umbraco").controller("UmbracoForms.SettingTypes.Pickers.ConnectionStringController",function($scope,$routeParams,pickerResource){pickerResource.getAllConnectionStrings().then(function(response){$scope.strings=response.data;});});angular.module("umbraco").controller("UmbracoForms.SettingTypes.Pickers.ContentController",function($scope,$routeParams,dialogService,entityResource,iconHelper){if(!$scope.setting){$scope.setting={};}
var val=parseInt($scope.setting.value);if(!isNaN(val)&&angular.isNumber(val)){$scope.showQuery=false;entityResource.getById($scope.setting.value,"Document").then(function(item){item.icon=iconHelper.convertFromLegacyIcon(item.icon);$scope.node=item;});}
$scope.openContentPicker=function(){var d=dialogService.treePicker({section:"content",treeAlias:"content",multiPicker:false,callback:populate});};$scope.clear=function(){$scope.id=undefined;$scope.node=undefined;$scope.setting.value=undefined;};function populate(item){$scope.clear();item.icon=iconHelper.convertFromLegacyIcon(item.icon);$scope.node=item;$scope.id=item.id;$scope.setting.value=item.id;}});angular.module("umbraco").controller("UmbracoForms.SettingTypes.Pickers.ContentWithXpathController",function($scope,$routeParams,dialogService,entityResource,iconHelper,utilityService){var umbracoVersion=Umbraco.Sys.ServerVariables.application.version;$scope.queryIsVisible=false;$scope.helpIsVisible=false;$scope.query="";if(!$scope.setting){$scope.setting={};}
function init(){if(angular.isNumber($scope.setting.value)){entityResource.getById($scope.setting.value,"Document").then(function(item){item.icon=iconHelper.convertFromLegacyIcon(item.icon);$scope.node=item;});}else if($scope.setting.value){$scope.queryIsVisible=true;$scope.query=$scope.setting.value;}}
$scope.openContentPicker=function(){var compareOptions={zeroExtend:true};var versionCompare=utilityService.compareVersions(umbracoVersion,"7.4",compareOptions);if(versionCompare===0||versionCompare===1){$scope.treePickerOverlay={view:"treepicker",section:"content",treeAlias:"content",multiPicker:false,title:"Where to save",subtitle:"Choose location to save this node",hideSubmitButton:true,show:true,submit:function(model){var selectedItem=model.selection[0];populate(selectedItem);$scope.treePickerOverlay.show=false;$scope.treePickerOverlay=null;}};}else{var d=dialogService.treePicker({section:"content",treeAlias:"content",multiPicker:false,callback:populate});}};$scope.showQuery=function(){$scope.queryIsVisible=true;};$scope.toggleHelp=function(){$scope.helpIsVisible=!$scope.helpIsVisible;};$scope.setXpath=function(){$scope.setting.value=$scope.query;};$scope.clear=function(){$scope.id=undefined;$scope.node=undefined;$scope.setting.value=undefined;$scope.query=undefined;$scope.queryIsVisible=false;};function populate(item){$scope.clear();item.icon=iconHelper.convertFromLegacyIcon(item.icon);$scope.node=item;$scope.id=item.id;$scope.setting.value=item.id;}
init();});angular.module("umbraco").controller("UmbracoForms.SettingTypes.Pickers.DataTypeController",function($scope,$routeParams,pickerResource){pickerResource.getAllDataTypes().then(function(response){$scope.datatypes=response.data;});});angular.module("umbraco").controller("UmbracoForms.SettingTypes.Pickers.DocumentTypeController",function($scope,$routeParams,pickerResource){pickerResource.getAllDocumentTypesWithAlias().then(function(response){$scope.doctypes=response.data;});});angular.module("umbraco").controller("UmbracoForms.Dashboards.ActivityController",function($scope,recordResource){});angular.module("umbraco").controller("UmbracoForms.Dashboards.LicensingController",function($scope,$location,$routeParams,$cookieStore,formResource,licensingResource,updatesResource,notificationsService,userService,utilityService){$scope.overlay={show:false,title:"Congratulations",description:"You've just installed Umbraco Forms - Let's create your first form"};var packageInstall=$cookieStore.get("umbPackageInstallId");if(packageInstall){$scope.overlay.show=true;$cookieStore.put("umbPackageInstallId","");}
if(!$scope.overlay.show){formResource.getOverView().then(function(response){if(response.data.length===0){$scope.overlay.show=true;$scope.overlay.title="Create a form";$scope.overlay.description="You do not have any forms setup yet, how about creating one now?";}});}
$scope.getLicenses=function(config){$scope.loginError=false;$scope.hasLicenses=undefined;licensingResource.getAvailableLicenses(config).then(function(response){var licenses=response.data;var currentDomain=window.location.hostname;$scope.hasLicenses=licenses.length>0;_.each(licenses,function(lic){if(lic.bindings&&lic.bindings.indexOf(currentDomain)>=0){lic.currentDomainMatch=true;}});$scope.configuredLicenses=_.filter(licenses,function(license){return license.configured;});$scope.openLicenses=_.filter(licenses,function(license){return license.configured===false;});},function(err){$scope.loginError=true;$scope.hasLicenses=undefined;});};$scope.configure=function(config){licensingResource.configureLicense(config).then(function(response){$scope.configuredLicenses.length=0;$scope.openLicenses.length=0;$scope.loadStatus();notificationsService.success("License configured","Umbraco forms have been configured to be used on this website");});};$scope.loadStatus=function(){licensingResource.getLicenseStatus().then(function(response){$scope.status=response.data;});userService.getCurrentUser().then(function(response){$scope.currentUser=response;$scope.isAdminUser=response.userType.toLowerCase()==="admin";});updatesResource.getUpdateStatus().then(function(response){$scope.version=response.data;});updatesResource.getVersion().then(function(response){$scope.currentVersion=response.data;});};$scope.upgrade=function(){if(!$scope.isAdminUser){notificationsService.error("Insufficient Permissions","Only Admin users have the ability to upgrade Umbraco Forms");return;}
$scope.installing=true;updatesResource.installLatest($scope.version.remoteVersion).then(function(response){window.location.reload();},function(reason){$scope.installing=false;});};$scope.create=function(){var umbracoVersion=Umbraco.Sys.ServerVariables.application.version;var compareOptions={zeroExtend:true};var versionCompare=utilityService.compareVersions(umbracoVersion,"7.4",compareOptions);if(versionCompare<0){$location.url("forms/form/edit-legacy/-1?template=&create=true");}
else{$location.url("forms/form/edit/-1?template=&create=true");}};$scope.configuration={domain:window.location.hostname};$scope.loadStatus();});angular.module("umbraco").controller("UmbracoForms.Dashboards.YourFormsController",function($scope,$location,formResource,recordResource,userService,securityResource,utilityService){var vm=this;vm.entriesUrl='entries';var umbracoVersion=Umbraco.Sys.ServerVariables.application.version;var compareOptions={zeroExtend:true};var versionCompare=utilityService.compareVersions(umbracoVersion,"7.4",compareOptions);if(versionCompare<0){vm.entriesUrl='entries-legacy';}
vm.formsLimit=4;vm.showAll=function(){vm.formsLimit=50;};formResource.getOverView().then(function(response){vm.forms=response.data;_.each(vm.forms,function(form){var filter={form:form.id};recordResource.getRecordsCount(filter).then(function(response){form.entries=response.data.count;});});});});angular.module("umbraco").controller("UmbracoForms.Editors.DataSource.DeleteController",function($scope,dataSourceResource,navigationService,treeService){$scope.delete=function(id){dataSourceResource.deleteByGuid(id).then(function(){treeService.removeNode($scope.currentNode);navigationService.hideNavigation();});};$scope.cancelDelete=function(){navigationService.hideNavigation();};});angular.module("umbraco").controller("UmbracoForms.Editors.DataSource.EditController",function($scope,$routeParams,dataSourceResource,editorState,notificationsService,dialogService,navigationService,userService,securityResource){var currentUserId=null;userService.getCurrentUser().then(function(response){currentUserId=response.id;securityResource.getByUserId(currentUserId).then(function(response){$scope.security=response.data;if(!$scope.security.userSecurity.manageDataSources){notificationsService.error("Access Denied","You do not have access to edit Datasources");navigationService.syncTree({tree:"datasource",path:['-1'],forceReload:true,activate:false}).then(function(response){navigationService.reloadNode(response.node);});return;}});});if($routeParams.create){dataSourceResource.getScaffold().then(function(response){$scope.loaded=true;$scope.dataSource=response.data;dataSourceResource.getAllDataSourceTypesWithSettings().then(function(resp){$scope.types=resp.data;});editorState.set($scope.form);});}
else{dataSourceResource.getByGuid($routeParams.id).then(function(response){$scope.dataSource=response.data;dataSourceResource.getAllDataSourceTypesWithSettings().then(function(resp){$scope.types=resp.data;setTypeAndSettings();$scope.loaded=true;});editorState.set($scope.dataSource);});}
$scope.setType=function(){setTypeAndSettings();};$scope.save=function(){$scope.dataSource.settings={};angular.forEach($scope.dataSource.$type.settings,function(setting){var key=setting.alias;var value=setting.value;$scope.dataSource.settings[key]=value;});dataSourceResource.validateSettings($scope.dataSource).then(function(response){$scope.errors=response.data;if($scope.errors.length>0){$scope.dataSource.valid=false;angular.forEach($scope.errors,function(error){notificationsService.error("Datasource failed to save",error.Message);});}else{dataSourceResource.save($scope.dataSource).then(function(response){$scope.dataSource=response.data;editorState.set($scope.dataSource);setTypeAndSettings();navigationService.syncTree({tree:"datasource",path:[String($scope.dataSource.id)],forceReload:true});notificationsService.success("Datasource saved","");$scope.dataSource.valid=true;$scope.dataSourceForm.$dirty=false;},function(err){notificationsService.error("Datasource failed to save","");});}},function(err){notificationsService.error("Datasource failed to save","Please check if your settings are valid");});};$scope.showWizard=function(){dialogService.open({template:"/app_plugins/UmbracoForms/Backoffice/Datasource/dialogs/wizard.html",dataSourceId:$scope.dataSource.id});};var setTypeAndSettings=function(){$scope.dataSource.$type=_.where($scope.types,{id:$scope.dataSource.formDataSourceTypeId})[0];angular.forEach($scope.dataSource.settings,function(setting){for(var key in $scope.dataSource.settings){if($scope.dataSource.settings.hasOwnProperty(key)){if(_.where($scope.dataSource.$type.settings,{alias:key}).length>0){_.where($scope.dataSource.$type.settings,{alias:key})[0].value=$scope.dataSource.settings[key];}}}});};});angular.module("umbraco").controller("UmbracoForms.Editors.DataSource.WizardController",function($scope,$routeParams,dataSourceWizardResource,navigationService,notificationsService,dialogService){$scope.currentStep=1;dataSourceWizardResource.getScaffold($scope.dialogOptions.dataSourceId).then(function(response){$scope.wizard=response.data;$scope.hasPrimaryKeys=$scope.wizard.mappings.length!=_.where($scope.wizard.mappings,{prevalueKeyField:null}).length;dataSourceWizardResource.getAllFieldTypes().then(function(resp){$scope.fieldtypes=resp.data;$scope.ready=true;});});$scope.createForm=function(){dataSourceWizardResource.createForm($scope.wizard).then(function(resp){dialogService.closeAll();notificationsService.success("Form created","");});};$scope.gotoStep=function(step){$scope.currentStep=step;}
$scope.gotoThirdStep=function(){if($scope.hasPrimaryKeys){$scope.currentStep=3;}else{$scope.currentStep=4;}}
$scope.goBackToThirdStep=function(){if($scope.hasPrimaryKeys){$scope.currentStep=3;}else{$scope.currentStep=2;}}});angular.module("umbraco").controller("UmbracoForms.Editors.Form.CopyController",function($scope,formResource,navigationService){$scope.copyForm=function(formId){formResource.copy(formId,$scope.newFormName).then(function(response){var newFormId=response.data.id;navigationService.syncTree({tree:"form",path:["-1",String(newFormId)],forceReload:true,activate:false});navigationService.hideNavigation();});};$scope.cancelCopy=function(){navigationService.hideNavigation();}});angular.module("umbraco").controller("UmbracoForms.Editors.Form.CreateController",function($scope,$routeParams,formResource,editorState,notificationsService,utilityService){var vm=this;vm.editUrl='edit';var umbracoVersion=Umbraco.Sys.ServerVariables.application.version;var compareOptions={zeroExtend:true};var versionCompare=utilityService.compareVersions(umbracoVersion,"7.4",compareOptions);if(versionCompare<0){vm.editUrl='edit-legacy';}
formResource.getAllTemplates().then(function(response){vm.formTemplates=response.data;});});angular.module("umbraco").controller("UmbracoForms.Editors.Form.DeleteController",function($scope,formResource,navigationService,treeService){$scope.delete=function(id){formResource.deleteByGuid(id).then(function(){treeService.removeNode($scope.currentNode);navigationService.hideNavigation();});};$scope.cancelDelete=function(){navigationService.hideNavigation();};});angular.module("umbraco").controller("UmbracoForms.Editors.Form.EditController",function($scope,$routeParams,formResource,editorState,dialogService,formService,notificationsService,contentEditingHelper,formHelper,navigationService,userService,securityResource,localizationService,workflowResource){var currentUserId=null;var currentFormSecurity=null;$scope.hasAccessToCurrentForm=true;$scope.displayEditor=true;$scope.page={};$scope.page.navigation=[{"name":localizationService.localize("general_design"),"icon":"icon-document-dashed-line","view":"/App_Plugins/UmbracoForms/Backoffice/Form/views/design/design.html","active":true},{"name":"Settings","icon":"icon-settings","view":"/App_Plugins/UmbracoForms/Backoffice/Form/views/settings/settings.html"}];userService.getCurrentUser().then(function(response){currentUserId=response.id;securityResource.getByUserId(currentUserId).then(function(response){$scope.security=response.data;currentFormSecurity=_.where(response.data.formsSecurity,{Form:$routeParams.id});if(currentFormSecurity.length===1){$scope.hasAccessToCurrentForm=currentFormSecurity[0].HasAccess;}
if(!$scope.hasAccessToCurrentForm||!$scope.security.userSecurity.manageForms){notificationsService.error("Access Denied","You do not have access to edit this form");navigationService.syncTree({tree:"form",path:['-1'],forceReload:true,activate:false}).then(function(response){navigationService.reloadNode(response.node);});return;}});});if($routeParams.create){formResource.getScaffoldWithWorkflows($routeParams.template).then(function(response){$scope.form=response.data;editorState.set($scope.form);});}else{$scope.workflowsUrl="#/forms/form/workflows/"+$routeParams.id;$scope.entriesUrl="#/forms/form/entries/"+$routeParams.id;formResource.getWithWorkflowsByGuid($routeParams.id).then(function(response){navigationService.syncTree({tree:"form",path:[String($routeParams.id)],forceReload:false});$scope.form=response.data;$scope.saved=true;angular.forEach($scope.form.pages,function(page){angular.forEach(page.fieldSets,function(fieldSet){angular.forEach(fieldSet.containers,function(container){angular.forEach(container.fields,function(field){field.removePrevalueEditor=true;});});});});editorState.set($scope.form);},function(reason){var jsonErrorResponse=reason.data;notificationsService.add({headline:"Unable to load form",message:jsonErrorResponse.ExceptionMessage,type:'error',sticky:true});$scope.displayEditor=false;});}
$scope.editForm=function(form,section){dialogService.open({template:"/app_plugins/UmbracoForms/Backoffice/Form/dialogs/formsettings.html",form:form,section:section,page:$scope.currentPage});};$scope.save=function(){if(formHelper.submitForm({scope:$scope})){$scope.page.saveButtonState="busy";formService.syncContainerWidths($scope.form);formResource.saveWithWorkflows($scope.form).then(function(response){formHelper.resetForm({scope:$scope});contentEditingHelper.handleSuccessfulSave({scope:$scope,savedContent:response.data});$scope.ready=true;editorState.set($scope.form);$scope.page.saveButtonState="success";navigationService.syncTree({tree:"form",path:[String($scope.form.id)],forceReload:true});notificationsService.success("Form saved","");},function(err){contentEditingHelper.handleSaveError({redirectOnFailure:false,err:err});$scope.page.saveButtonState="error";});}};});angular.module("umbraco").controller("UmbracoForms.Editors.Form.EditLegacyController",function($scope,$routeParams,formResource,editorState,dialogService,formService,notificationsService,contentEditingHelper,formHelper,navigationService,userService,securityResource){var currentUserId=null;var currentFormSecurity=null;$scope.hasAccessToCurrentForm=true;userService.getCurrentUser().then(function(response){currentUserId=response.id;securityResource.getByUserId(currentUserId).then(function(response){$scope.security=response.data;currentFormSecurity=_.where(response.data.formsSecurity,{Form:$routeParams.id});if(currentFormSecurity.length===1){$scope.hasAccessToCurrentForm=currentFormSecurity[0].HasAccess;}
if(!$scope.hasAccessToCurrentForm||!$scope.security.userSecurity.manageForms){notificationsService.error("Access Denied","You do not have access to edit this form");navigationService.syncTree({tree:"form",path:['-1'],forceReload:true,activate:false}).then(function(response){navigationService.reloadNode(response.node);});return;}});});if($routeParams.create){formResource.getScaffold($routeParams.template).then(function(response){$scope.form=response.data;$scope.currentPage={};formResource.getPrevalueSources().then(function(resp){$scope.prevaluesources=resp.data;});formResource.getAllFieldTypesWithSettings().then(function(resp){$scope.fieldtypes=resp.data;$scope.ready=true;});editorState.set($scope.form);});}else{$scope.workflowsUrl="#/forms/form/workflows/"+$routeParams.id;$scope.entriesUrl="#/forms/form/entries/"+$routeParams.id;formResource.getByGuid($routeParams.id).then(function(response){navigationService.syncTree({tree:"form",path:[String($routeParams.id)],forceReload:false});$scope.form=response.data;$scope.saved=true;formResource.getPrevalueSources().then(function(resp){$scope.prevaluesources=resp.data;});formResource.getAllFieldTypesWithSettings().then(function(resp){$scope.fieldtypes=resp.data;$scope.ready=true;});editorState.set($scope.form);});}
$scope.editForm=function(form,section){dialogService.open({template:"/app_plugins/UmbracoForms/Backoffice/Form/dialogs/formsettings.html",form:form,section:section,page:$scope.currentPage});};$scope.save=function(){if(formHelper.submitForm({scope:$scope})){formService.syncContainerWidths($scope.form);formResource.save($scope.form).then(function(response){formHelper.resetForm({scope:$scope});contentEditingHelper.handleSuccessfulSave({scope:$scope,savedContent:response.data});$scope.ready=true;editorState.set($scope.form);navigationService.syncTree({tree:"form",path:[String($scope.form.id)],forceReload:true});notificationsService.success("Form saved","");},function(err){notificationsService.error("Form Failed to save",err.data.Message);});}};});angular.module("umbraco").controller("UmbracoForms.Editors.Form.EntriesController",function($scope,$routeParams,recordResource,formResource,dialogService,editorState,userService,securityResource,notificationsService,navigationService){var currentUserId=null;var currentFormSecurity=null;var vm=this;vm.pagination={pageNumber:1,totalPages:1};vm.allIsChecked=false;vm.selectedEntry={};vm.showEntryDetails=false;vm.userLocale="";vm.nextPage=nextPage;vm.prevPage=prevPage;vm.goToPageNumber=goToPageNumber;vm.viewEntryDetails=viewEntryDetails;vm.closeEntryDetails=closeEntryDetails;vm.nextEntryDetails=nextEntryDetails;vm.prevEntryDetails=prevEntryDetails;vm.datePickerChange=datePickerChange;vm.toggleRecordState=toggleRecordState;vm.keyboardShortcutsOverview=[{"name":"Entry details","shortcuts":[{"description":"Next entry","keys":[{"key":"→"}]},{"description":"Previous entry","keys":[{"key":"←"}]},{"description":"Close details","keys":[{"key":"esc"}]}]}];$scope.hasAccessToCurrentForm=true;userService.getCurrentUser().then(function(response){currentUserId=response.id;vm.userLocale=response.locale;securityResource.getByUserId(currentUserId).then(function(response){$scope.security=response.data;currentFormSecurity=_.where(response.data.formsSecurity,{Form:$routeParams.id});if(currentFormSecurity.length===1){$scope.hasAccessToCurrentForm=currentFormSecurity[0].HasAccess;}
if(!$scope.hasAccessToCurrentForm||!$scope.security.userSecurity.manageForms){notificationsService.error("Access Denied","You do not have access to view this form's entries");navigationService.syncTree({tree:"form",path:['-1'],forceReload:true,activate:false}).then(function(response){navigationService.reloadNode(response.node);});return;}});});formResource.getByGuid($routeParams.id).then(function(response){$scope.form=response.data;$scope.loaded=true;navigationService.syncTree({tree:"form",path:[String($routeParams.id),String($routeParams.id)+"_entries"],forceReload:false});});$scope.states=[{"name":"Approved","isChecked":true},{"name":"Submitted","isChecked":true}];$scope.filter={startIndex:1,length:20,form:$routeParams.id,sortBy:"created",sortOrder:"descending",states:["Approved","Submitted"]};$scope.records=[];$scope.loading=false;recordResource.getRecordSetActions().then(function(response){$scope.recordSetActions=response.data;$scope.recordActions=response.data;});$scope.toggleRecordStateSelection=function(recordState){var idx=$scope.filter.states.indexOf(recordState);if(idx>-1){$scope.filter.states.splice(idx,1);}
else{$scope.filter.states.push(recordState);}};$scope.hiddenFields=[2];$scope.toggleSelection=function toggleSelection(field){var idx=$scope.hiddenFields.indexOf(field);if(idx>-1){$scope.hiddenFields.splice(idx,1);}else{$scope.hiddenFields.push(field);}};$scope.edit=function(schema){dialogService.open({template:"/app_plugins/UmbracoForms/Backoffice/Form/dialogs/entriessettings.html",schema:schema,toggle:$scope.toggleSelection,hiddenFields:$scope.hiddenFields,filter:$scope.filter});};$scope.viewdetail=function(schema,row,event){dialogService.open({template:"/app_plugins/UmbracoForms/Backoffice/Form/dialogs/entriesdetail.html",schema:schema,row:row,hiddenFields:$scope.hiddenFields});if(event){event.stopPropagation();}};function nextPage(pageNumber){$scope.filter.startIndex++;$scope.loadRecords($scope.filter);}
function prevPage(pageNumber){$scope.filter.startIndex--;$scope.loadRecords($scope.filter);}
function goToPageNumber(pageNumber){$scope.filter.startIndex=pageNumber;$scope.loadRecords($scope.filter);}
function viewEntryDetails(schema,entry,event){vm.selectedEntry={};var entryIndex=$scope.records.results.indexOf(entry);var entryCount=$scope.filter.length*($scope.filter.startIndex-1)+(entryIndex+1);vm.selectedEntry=entry;vm.selectedEntry.index=entryIndex;vm.selectedEntry.entryCount=entryCount;vm.selectedEntry.details=[];if(schema&&entry){for(var index=0;index<schema.length;index++){var schemaItem=schema[index];var valueItem=entry.fields[index];var itemToPush={name:schemaItem.name,value:valueItem,viewName:schemaItem.view,view:'/app_plugins/umbracoforms/Backoffice/common/rendertypes/'+schemaItem.view+'.html'};var excludeItems=["member","state","created","updated"];var found=excludeItems.indexOf(schemaItem.id);if(excludeItems.indexOf(schemaItem.id)===-1){vm.selectedEntry.details.push(itemToPush);}}}
vm.showEntryDetails=true;if(event){event.stopPropagation();}}
function closeEntryDetails(){vm.selectedEntry={};vm.showEntryDetails=false;}
function nextEntryDetails(){var nextEntryIndex=vm.selectedEntry.index+1;var entriesCount=$scope.records.results.length;var currentPage=$scope.filter.startIndex;var totalNumberOfPages=$scope.records.totalNumberOfPages;if(nextEntryIndex<entriesCount){var entry=$scope.records.results[nextEntryIndex];viewEntryDetails($scope.records.schema,entry);}else if(totalNumberOfPages>1&&currentPage<totalNumberOfPages){$scope.filter.startIndex++;vm.pagination.pageNumber++;recordResource.getRecords($scope.filter).then(function(response){$scope.records=response.data;$scope.allIsChecked=($scope.selectedRows.length>=$scope.records.results.length);vm.pagination.totalPages=response.data.totalNumberOfPages;limitRecordFields($scope.records);var entry=$scope.records.results[0];viewEntryDetails($scope.records.schema,entry);});}}
function prevEntryDetails(){var prevEntryIndex=vm.selectedEntry.index-1;var totalNumberOfPages=$scope.records.totalNumberOfPages;var currentPage=$scope.filter.startIndex;if(vm.selectedEntry.index>0){var entry=$scope.records.results[prevEntryIndex];viewEntryDetails($scope.records.schema,entry);}else if(totalNumberOfPages>1&&currentPage!==1){$scope.filter.startIndex--;vm.pagination.pageNumber--;recordResource.getRecords($scope.filter).then(function(response){$scope.records=response.data;$scope.allIsChecked=($scope.selectedRows.length>=$scope.records.results.length);vm.pagination.totalPages=response.data.totalNumberOfPages;limitRecordFields($scope.records);var lastEntryIndex=$scope.records.results.length-1;var entry=$scope.records.results[lastEntryIndex];viewEntryDetails($scope.records.schema,entry);});}}
function datePickerChange(dateRange){$scope.filter.startDate=dateRange.startDate;$scope.filter.endDate=dateRange.endDate;$scope.filterChanged();}
function toggleRecordState(recordState){if(recordState.isChecked){$scope.filter.states.push(recordState.name);}else{var index=$scope.filter.states.indexOf(recordState.name);if(index!==-1){$scope.filter.states.splice(index,1);}}
$scope.filterChanged();}
$scope.next=function(){$scope.filter.startIndex++;};$scope.prev=function(){$scope.filter.startIndex--;};$scope.goToPage=function(index){$scope.filter.startIndex=index;};$scope.search=_.debounce(function(resetIndex){$scope.loading=true;$scope.reset(resetIndex);$scope.$apply(function(){recordResource.getRecords($scope.filter).then(function(response){$scope.loading=false;$scope.records=response.data;vm.pagination.totalPages=response.data.totalNumberOfPages;limitRecordFields($scope.records);});});},300);$scope.filterChanged=function(){var resetIndex=true;$scope.search(resetIndex);};$scope.loadRecords=function(filter,append){$scope.loading=true;recordResource.getRecords(filter).then(function(response){$scope.loading=false;if(append){$scope.records=$scope.records.results.concat(response.data.results);}else{$scope.records=response.data;}
$scope.allIsChecked=($scope.selectedRows.length>=$scope.records.results.length);limitRecordFields($scope.records);vm.pagination.totalPages=response.data.totalNumberOfPages;});};$scope.loadRecords($scope.filter);function limitRecordFields(records){var falseFromIndex=2;var falseToIndex=records.schema.length-4;var trueFalseArray=[];angular.forEach(records.schema,function(schema,index){if(index<=falseFromIndex||index>=falseToIndex){trueFalseArray.push(true);}else{trueFalseArray.push(false);}});records.showSchemaArray=trueFalseArray;angular.forEach(records.results,function(result){result.showRecordsArray=trueFalseArray;});}
$scope.reset=function(resetIndex){$scope.selectedRows.length=0;$scope.allIsChecked=false;if(resetIndex){$scope.filter.startIndex=1;}};$scope.clearSelection=function(){$scope.selectedRows.length=0;vm.allIsChecked=false;for(var i=0;i<$scope.records.results.length;i++){var row=$scope.records.results[i];row.selected=false;}};$scope.more=function(){$scope.filter.startIndex++;$scope.loadRecords($scope.filter,true);};$scope.selectedRows=[];$scope.toggleRow=function(row){row.selected=!row.selected;if(row.selected){$scope.selectedRows.push(row.id);$scope.allIsChecked=($scope.selectedRows.length>=$scope.records.results.length);}else{var i=$scope.selectedRows.indexOf(row.id);$scope.selectedRows.splice(i,1);$scope.allIsChecked=false;}};$scope.toggleRowLegacy=function(row){if(row.selected){$scope.selectedRows.push(row.id);$scope.allIsChecked=($scope.selectedRows.length>=$scope.records.results.length);}else{var i=$scope.selectedRows.indexOf(row.id);$scope.selectedRows.splice(i,1);$scope.allIsChecked=false;}};$scope.allIsChecked=false;$scope.toggleAllLegacy=function($event){var checkbox=$event.target;$scope.selectedRows.length=0;for(var i=0;i<$scope.records.results.length;i++){var entity=$scope.records.results[i];entity.selected=checkbox.checked;if(checkbox.checked){$scope.selectedRows.push(entity.id);}}};$scope.toggleAll=function(allIsChecked){$scope.selectedRows.length=0;for(var i=0;i<$scope.records.results.length;i++){var entity=$scope.records.results[i];entity.selected=allIsChecked;if(allIsChecked){$scope.selectedRows.push(entity.id);}}};$scope.executeRecordSetAction=function(action){var model={formId:$scope.form.id,recordKeys:$scope.selectedRows,actionId:action.id};if(action.needsConfirm&&action.confirmMessage.length>0){var result=confirm(action.confirmMessage);if(!result){return;}}
recordResource.executeRecordSetAction(model).then(function(response){$scope.reset(true);$scope.loadRecords($scope.filter,false);notificationsService.success("Excuted Action","Successfully excuted action "+action.name);},function(err){notificationsService.error("Excuted Action","Failed to excute action "+action.name+" due to error: "+err);});};});angular.module("umbraco").controller("UmbracoForms.Editors.Form.EntriesSettingsController",function($scope,$log,$timeout,exportResource){var formId=$scope.dialogOptions.filter.form;exportResource.getExportTypes(formId).then(function(response){$scope.exportTypes=response.data;});$scope.export=function(type,filter){filter.exportType=type.id;exportResource.generateExport(filter).then(function(response){var url=exportResource.getExportUrl(response.data.formId,response.data.fileName);var iframe=document.createElement('iframe');iframe.id="hiddenDownloadframe";iframe.style.display='none';document.body.appendChild(iframe);iframe.src=url;$timeout(function(){document.body.removeChild(iframe);},1000);});};});angular.module("umbraco").controller("UmbracoForms.Editors.Form.Dialogs.FieldsetSettingController",function($scope,formService,dialogService){$scope.deleteConditionRule=function(rules,rule){formService.deleteConditionRule(rules,rule);};$scope.addConditionRule=function(condition){formService.addConditionRule(condition);};$scope.close=function(){dialogService.closeAll();}});angular.module("umbraco").controller("UmbracoForms.Editors.Form.Dialogs.FieldSettingController",function($scope,formService,dialogService){$scope.deleteConditionRule=function(rules,rule){formService.deleteConditionRule(rules,rule);};$scope.addConditionRule=function(condition){formService.addConditionRule(condition);};$scope.getPrevalues=function(field){formService.loadFieldTypePrevalues(field);};$scope.close=function(){$scope.dialogOptions.field.settings={};angular.forEach($scope.dialogOptions.field.$fieldType.settings,function(setting){var key=setting.alias;var value=setting.value;$scope.dialogOptions.field.settings[key]=value;dialogService.closeAll();});}});angular.module("umbraco").controller("UmbracoForms.Editors.Form.WorkflowsController",function($scope,$routeParams,workflowResource,editorState,dialogService,$window,userService,securityResource,notificationsService,navigationService){var currentUserId=null;var currentFormSecurity=null;$scope.hasAccessToCurrentForm=true;userService.getCurrentUser().then(function(response){currentUserId=response.id;securityResource.getByUserId(currentUserId).then(function(response){$scope.security=response.data;currentFormSecurity=_.where(response.data.formsSecurity,{Form:$routeParams.id});if(currentFormSecurity.length===1){$scope.hasAccessToCurrentForm=currentFormSecurity[0].HasAccess;}
if(!$scope.hasAccessToCurrentForm||!$scope.security.userSecurity.manageWorkflows||!$scope.security.userSecurity.manageForms){notificationsService.error("Access Denied","You do not have access to edit this form's workflow");navigationService.syncTree({tree:"form",path:['-1'],forceReload:true,activate:false}).then(function(response){navigationService.reloadNode(response.node);});return;}});});workflowResource.getAllWorkflows($routeParams.id).then(function(resp){$scope.workflows=resp.data;$scope.loaded=true;navigationService.syncTree({tree:"form",path:[String($routeParams.id),String($routeParams.id)+"_workflows"],forceReload:true});});$scope.sortableOptions={handle:'.handle',cursor:"move",connectWith:'.workflows',update:function(e,ui){var wfGuids=[];var wfcount=0;var state=ui.item.parent().attr("rel");ui.item.parent().children().each(function(){if($(this).attr("rel")!=null){wfGuids[wfcount]=$(this).attr("rel");wfcount++;}});workflowResource.updateSortOrder(state,wfGuids).then(function(){});},};$scope.deleteWorkflow=function(workflow){var deleteWorkflow=$window.confirm('Are you sure you want to delete the workflow?');if(deleteWorkflow){workflowResource.deleteByGuid(workflow.id).then(function(){$scope.workflows.splice($scope.workflows.indexOf(workflow),1);});}};$scope.updateWorkflow=function(state,workflow){data={};data.workflow=workflow;data.state=state;data.form=$routeParams.id;data.add=false;dialogService.open({template:'/app_plugins/UmbracoForms/Backoffice/Form/dialogs/workflow.html',show:true,callback:update,dialogData:data,workflows:$scope.workflows});};$scope.addWorkflow=function(state){data={};data.state=state;data.form=$routeParams.id;data.add=true;dialogService.open({template:'/app_plugins/UmbracoForms/Backoffice/Form/dialogs/workflow.html',show:true,callback:add,dialogData:data});};function add(data){$scope.workflows.push(data);}
function update(data){}});angular.module("umbraco").controller("UmbracoForms.Editors.Form.Dialogs.WorkflowsController",function($scope,$routeParams,workflowResource,dialogService,notificationsService,$window){if($scope.dialogData.workflow){$scope.workflow=$scope.dialogData.workflow;workflowResource.getAllWorkflowTypesWithSettings().then(function(resp){$scope.types=resp.data;setTypeAndSettings();});}else{workflowResource.getScaffold().then(function(response){$scope.loaded=true;$scope.workflow=response.data;$scope.workflow.executesOn=$scope.dialogData.state;$scope.workflow.form=$scope.dialogData.form;$scope.workflow.active=true;workflowResource.getAllWorkflowTypesWithSettings().then(function(resp){$scope.types=resp.data;});});}
$scope.setType=function(){setTypeAndSettings();};$scope.close=function(){dialogService.closeAll();};$scope.add=function(){save();};$scope.update=function(){save();};$scope.delete=function(){var deleteWorkflow=$window.confirm('Are you sure you want to delete the workflow?');if(deleteWorkflow){workflowResource.deleteByGuid($scope.workflow.id).then(function(){$scope.dialogOptions.workflows.splice($scope.dialogOptions.workflows.indexOf($scope.workflow),1);notificationsService.success("Workflow deleted","");dialogService.closeAll();});}}
var save=function(){$scope.workflow.settings={};angular.forEach($scope.workflow.$type.settings,function(setting){var key=setting.alias;var value=setting.value;$scope.workflow.settings[key]=value;});workflowResource.validateSettings($scope.workflow).then(function(response){$scope.errors=response.data;if($scope.errors.length>0){angular.forEach($scope.errors,function(error){notificationsService.error("Workflow failed to save",error.Message);});}else{workflowResource.save($scope.workflow).then(function(response){$scope.workflow=response.data;setTypeAndSettings();notificationsService.success("Workflow saved","");$scope.submit($scope.workflow);dialogService.closeAll();},function(err){notificationsService.error("Workflow failed to save","");});}},function(err){notificationsService.error("Workflow failed to save","Please check if your settings are valid");});};var setTypeAndSettings=function(){$scope.workflow.$type=_.where($scope.types,{id:$scope.workflow.workflowTypeId})[0];if(!$scope.workflow.name){$scope.workflow.name=$scope.workflow.$type.name;}
angular.forEach($scope.workflow.settings,function(setting){for(var key in $scope.workflow.settings){if($scope.workflow.settings.hasOwnProperty(key)){if(_.where($scope.workflow.$type.settings,{alias:key}).length>0){_.where($scope.workflow.$type.settings,{alias:key})[0].value=$scope.workflow.settings[key];}}}});};});(function(){"use strict";function FieldsetSettingsOverlay($scope,formService){var vm=this;vm.actionTypes=[];vm.logicTypes=[];vm.operators=[];vm.deleteConditionRule=deleteConditionRule;vm.addConditionRule=addConditionRule;vm.conditionFieldSelected=conditionFieldSelected;vm.addColumn=addColumn;vm.removeColumn=removeColumn;function init(){vm.actionTypes=formService.getActionTypes();vm.logicTypes=formService.getLogicTypes();vm.operators=formService.getOperators();if(!$scope.model.fieldset.condition){$scope.model.fieldset.condition={};$scope.model.fieldset.condition.actionType=vm.actionTypes[0].value;$scope.model.fieldset.condition.logicType=vm.logicTypes[0].value;}}
function deleteConditionRule(rules,rule){formService.deleteConditionRule(rules,rule);}
function addConditionRule(condition){formService.addEmptyConditionRule(condition);var lastIndex=condition.rules.length-1;condition.rules[lastIndex].operator=vm.operators[0].value;}
function conditionFieldSelected(selectedField,rule){formService.populateConditionRulePrevalues(selectedField,rule,$scope.model.fields);}
function addColumn(){var index=$scope.model.fieldset.containers.length;formService.addContainer($scope.model.fieldset,index);}
function removeColumn(container){formService.deleteContainer($scope.model.fieldset,container);}
init();}
angular.module("umbraco").controller("UmbracoForms.Overlays.FieldsetSettingsOverlay",FieldsetSettingsOverlay);})();(function(){"use strict";function FieldSettingsOverlay($scope,localizationService,formService){var vm=this;vm.showValidationPattern=false;vm.focusOnPatternField=false;vm.focusOnMandatoryField=false;vm.selectedValidationType={};vm.actionTypes=[];vm.logicTypes=[];vm.operators=[];vm.validationTypes=[{"name":localizationService.localize("validation_validateAsEmail"),"key":"email","pattern":"[a-zA-Z0-9_\.\+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-\.]+","enableEditing":true},{"name":localizationService.localize("validation_validateAsNumber"),"key":"number","pattern":"^[0-9]*$","enableEditing":true},{"name":localizationService.localize("validation_validateAsUrl"),"key":"url","pattern":"https?\:\/\/[a-zA-Z0-9\-\.]+\.[a-zA-Z]{2,}","enableEditing":true},{"name":localizationService.localize("validation_enterCustomValidation"),"key":"custom","pattern":"","enableEditing":true}];vm.changeValidationType=changeValidationType;vm.changeValidationPattern=changeValidationPattern;vm.openFieldTypePickerOverlay=openFieldTypePickerOverlay;vm.deleteConditionRule=deleteConditionRule;vm.addConditionRule=addConditionRule;vm.getPrevalues=getPrevalues;vm.conditionFieldSelected=conditionFieldSelected;function activate(){vm.actionTypes=formService.getActionTypes();vm.logicTypes=formService.getLogicTypes();vm.operators=formService.getOperators();if(!$scope.model.field.condition){$scope.model.field.condition={};$scope.model.field.condition.actionType=vm.actionTypes[0].value;$scope.model.field.condition.logicType=vm.logicTypes[0].value;}
matchValidationType();}
function changeValidationPattern(){matchValidationType();}
function openFieldTypePickerOverlay(field){vm.focusOnMandatoryField=false;vm.fieldTypePickerOverlay={view:"/app_plugins/UmbracoForms/Backoffice/Form/overlays/fieldtypepicker/field-type-picker.html",title:"Choose answer type",hideSubmitButton:true,show:true,submit:function(model){formService.loadFieldTypeSettings(field,model.fieldType);field.removePrevalueEditor=true;vm.fieldTypePickerOverlay.show=false;vm.fieldTypePickerOverlay=null;}};}
function matchValidationType(){if($scope.model.field.regex!==null&&$scope.model.field.regex!==""&&$scope.model.field.regex!==undefined){var match=false;angular.forEach(vm.validationTypes,function(validationType,index){if($scope.model.field.regex===validationType.pattern){vm.selectedValidationType=validationType;vm.showValidationPattern=true;match=true;}});if(!match){angular.forEach(vm.validationTypes,function(validationType){if(validationType.key==="custom"){vm.selectedValidationType=validationType;vm.showValidationPattern=true;}});}}}
function changeValidationType(selectedValidationType){if(selectedValidationType){$scope.model.field.regex=selectedValidationType.pattern;vm.showValidationPattern=true;if(selectedValidationType.key==="custom"){vm.focusOnPatternField=true;}}else{$scope.model.field.regex="";vm.showValidationPattern=false;}}
function conditionFieldSelected(selectedField,rule){formService.populateConditionRulePrevalues(selectedField,rule,$scope.model.fields);}
function deleteConditionRule(rules,rule){formService.deleteConditionRule(rules,rule);}
function addConditionRule(condition){formService.addEmptyConditionRule(condition);var lastIndex=condition.rules.length-1;condition.rules[lastIndex].operator=vm.operators[0].value;}
function getPrevalues(field){formService.loadFieldTypePrevalues(field);}
activate();}
angular.module("umbraco").controller("UmbracoForms.Overlays.FieldSettingsOverlay",FieldSettingsOverlay);})();(function(){"use strict";function FieldTypePickerOverlayController($scope,formResource,formService){var vm=this;vm.fieldTypes=[];vm.searchTerm="";vm.pickFieldType=pickFieldType;vm.filterItems=filterItems;vm.showDetailsOverlay=showDetailsOverlay;vm.hideDetailsOverlay=hideDetailsOverlay;function init(){formResource.getAllFieldTypesWithSettings().then(function(response){vm.fieldTypes=response.data;});}
function pickFieldType(selectedFieldType){$scope.model.fieldType=selectedFieldType;$scope.model.submit($scope.model);}
function filterItems(){$scope.model.itemDetails=null;}
function showDetailsOverlay(workflowType){var workflowDetails={};workflowDetails.icon=workflowType.icon;workflowDetails.title=workflowType.name;workflowDetails.description=workflowType.description;$scope.model.itemDetails=workflowDetails;}
function hideDetailsOverlay(){$scope.model.itemDetails=null;}
init();}
angular.module("umbraco").controller("UmbracoForms.Overlays.FieldTypePickerOverlayController",FieldTypePickerOverlayController);})();(function(){"use strict";function WorkflowSettingsOverlayController($scope,workflowResource){var vm=this;vm.workflowTypes=[];vm.focusWorkflowName=true;if($scope.model.workflowType&&$scope.model.workflowType.id){workflowResource.getScaffoldWorkflowType($scope.model.workflowType.id).then(function(response){$scope.model.workflow=response.data;});}}
angular.module("umbraco").controller("UmbracoForms.Overlays.WorkflowSettingsOverlayController",WorkflowSettingsOverlayController);})();(function(){"use strict";function WorkflowsOverviewOverlayController($scope,workflowResource,notificationsService){var vm=this;vm.focusOverlay=true;vm.openWorkflowsTypesOverlay=openWorkflowsTypesOverlay;vm.editWorkflow=editWorkflow;vm.removeWorkflow=removeWorkflow;vm.editSubmitMessageWorkflow=editSubmitMessageWorkflow;vm.workflowsSortableOptions={distance:10,tolerance:"pointer",connectWith:".umb-forms-workflows__sortable-wrapper",opacity:0.7,scroll:true,cursor:"move",zIndex:6000,handle:".sortable-handle",items:".sortable",placeholder:"umb-forms-workflow__workflow-placeholder",start:function(e,ui){ui.placeholder.height(ui.item.height());},stop:function(event,ui){updateSortOrder($scope.model.formWorkflows.onSubmit);updateSortOrder($scope.model.formWorkflows.onApprove);}};function updateSortOrder(array){var sortOrder=0;for(var i=0;i<array.length;i++){var arrayItem=array[i];if(arrayItem.isDeleted===false){arrayItem.sortOrder=sortOrder;sortOrder++;}}}
function openWorkflowsTypesOverlay(workflowArray){vm.workflowsTypesOverlay={view:"/app_plugins/UmbracoForms/Backoffice/Form/overlays/workflows/workflow-types.html",title:"Choose workflow",fields:$scope.model.fields,hideSubmitButton:true,show:true,submit:function(model){workflowArray.push(model.workflow);updateSortOrder(workflowArray);vm.workflowsTypesOverlay.show=false;vm.workflowsTypesOverlay=null;}};}
function editWorkflow(workflow){vm.workflowSettingsOverlay={view:"/app_plugins/UmbracoForms/Backoffice/Form/overlays/workflows/workflow-settings.html",title:workflow.name,workflow:workflow,fields:$scope.model.fields,show:true,submit:function(model){workflowResource.validateWorkflowSettings(model.workflow).then(function(response){if(response.data.length>0){angular.forEach(response.data,function(error){notificationsService.error("Workflow failed to save",error.Message);});}else{vm.workflowSettingsOverlay.show=false;vm.workflowSettingsOverlay=null;}});}};}
function editSubmitMessageWorkflow(){vm.submitMessageWorkflowOverlay={view:"/app_plugins/UmbracoForms/Backoffice/Form/overlays/workflows/submit-message-workflow-settings.html",title:"Message on submit",messageOnSubmit:$scope.model.messageOnSubmit,goToPageOnSubmit:$scope.model.goToPageOnSubmit,show:true,submit:function(model){$scope.model.messageOnSubmit=model.messageOnSubmit;$scope.model.goToPageOnSubmit=model.goToPageOnSubmit;vm.submitMessageWorkflowOverlay.show=false;vm.submitMessageWorkflowOverlay=null;}};}
function removeWorkflow(workflow,event,workflowTypeArray){workflow.isDeleted=true;updateSortOrder(workflowTypeArray);event.stopPropagation();}}
angular.module("umbraco").controller("UmbracoForms.Overlays.WorkflowsOverviewOverlayController",WorkflowsOverviewOverlayController);})();(function(){"use strict";function WorkflowTypesOverlayController($scope,workflowResource,notificationsService){var vm=this;vm.workflowTypes=[];vm.searchTerm="";vm.pickWorkflowType=pickWorkflowType;vm.filterItems=filterItems;vm.showDetailsOverlay=showDetailsOverlay;vm.hideDetailsOverlay=hideDetailsOverlay;function init(){workflowResource.getAllWorkflowTypesWithSettings().then(function(response){vm.workflowTypes=response.data;setDefaultWorkflowIcon(vm.workflowTypes);});}
function setDefaultWorkflowIcon(workflowTypes){for(var i=0;i<workflowTypes.length;i++){var workflowType=workflowTypes[i];if(!workflowType.icon){workflowType.icon="icon-mindmap";}}}
function pickWorkflowType(selectedWorkflowType){vm.workflowSettingsOverlay={view:"/app_plugins/UmbracoForms/Backoffice/Form/overlays/workflows/workflow-settings.html",title:selectedWorkflowType.name,workflow:$scope.model.workflow,workflowType:selectedWorkflowType,fields:$scope.model.fields,show:true,submit:function(model){workflowResource.validateWorkflowSettings(model.workflow).then(function(response){if(response.data.length>0){angular.forEach(response.data,function(error){notificationsService.error("Workflow failed to save",error.Message);});}else{$scope.model.workflow=model.workflow;$scope.model.submit($scope.model);vm.workflowSettingsOverlay.show=false;vm.workflowSettingsOverlay=null;}});}};}
function filterItems(){$scope.model.itemDetails=null;}
function showDetailsOverlay(workflowType){var workflowDetails={};workflowDetails.icon=workflowType.icon;workflowDetails.title=workflowType.name;workflowDetails.description=workflowType.description;$scope.model.itemDetails=workflowDetails;}
function hideDetailsOverlay(){$scope.model.itemDetails=null;}
init();}
angular.module("umbraco").controller("UmbracoForms.Overlays.WorkflowTypesOverlayController",WorkflowTypesOverlayController);})();(function(){"use strict";function formDesignController($scope,formResource,userService,securityResource){var vm=this;var currentUser={};vm.currentPage={};vm.security={};formResource.getPrevalueSources().then(function(resp){vm.prevaluesources=resp.data;formResource.getAllFieldTypesWithSettings().then(function(resp){vm.fieldtypes=resp.data;vm.ready=true;});});userService.getCurrentUser().then(function(response){currentUser=response;securityResource.getByUserId(currentUser.id).then(function(response){vm.security=response.data;});});}
angular.module("umbraco").controller("UmbracoForms.Editors.Form.FormDesignController",formDesignController);})();angular.module("umbraco").controller("UmbracoForms.Editors.Security.EditController",function($scope,$routeParams,securityResource,notificationsService,navigationService){navigationService.syncTree({tree:"formsecurity",path:[String($routeParams.id)],forceReload:true});securityResource.getByUserId($routeParams.id).then(function(resp){$scope.security=resp.data;$scope.loaded=true;});$scope.save=function(){$scope.security.userSecurity.user=$routeParams.id;securityResource.save($scope.security).then(function(response){$scope.userSecurity=response.data;notificationsService.success("User's Form Security saved","");$scope.securityForm.$setPristine();},function(err){notificationsService.error("User's Form Security failed to save","");});};});angular.module("umbraco").controller("UmbracoForms.Editors.PreValueSource.DeleteController",function($scope,preValueSourceResource,navigationService,treeService){$scope.delete=function(id){preValueSourceResource.deleteByGuid(id).then(function(){treeService.removeNode($scope.currentNode);navigationService.hideNavigation();});};$scope.cancelDelete=function(){navigationService.hideNavigation();};});angular.module("umbraco").controller("UmbracoForms.Editors.PreValueSource.EditController",function($scope,$routeParams,preValueSourceResource,editorState,notificationsService,navigationService,userService,securityResource){var currentUserId=null;userService.getCurrentUser().then(function(response){currentUserId=response.id;securityResource.getByUserId(currentUserId).then(function(response){$scope.security=response.data;if(!$scope.security.userSecurity.managePreValueSources){notificationsService.error("Access Denied","You do not have access to edit Prevalue sources");navigationService.syncTree({tree:"prevaluesource",path:['-1'],forceReload:true,activate:false}).then(function(response){navigationService.reloadNode(response.node);});return;}});});if($routeParams.create){preValueSourceResource.getScaffold().then(function(response){$scope.loaded=true;$scope.preValueSource=response.data;preValueSourceResource.getAllPreValueSourceTypesWithSettings().then(function(resp){$scope.types=resp.data;});editorState.set($scope.form);});}else{preValueSourceResource.getByGuid($routeParams.id).then(function(response){$scope.preValueSource=response.data;preValueSourceResource.getAllPreValueSourceTypesWithSettings().then(function(resp){$scope.types=resp.data;setTypeAndSettings();getPrevalues();$scope.loaded=true;});navigationService.syncTree({tree:"prevaluesource",path:[String($routeParams.id)],forceReload:false});editorState.set($scope.preValueSource);});}
$scope.setType=function(){$scope.prevalues=null;setTypeAndSettings();};$scope.save=function(){$scope.preValueSource.settings={};angular.forEach($scope.preValueSource.$type.settings,function(setting){var key=setting.alias;var value=setting.value;$scope.preValueSource.settings[key]=value;});preValueSourceResource.validateSettings($scope.preValueSource).then(function(response){$scope.errors=response.data;if($scope.errors.length>0){angular.forEach($scope.errors,function(error){notificationsService.error("Prevaluesource failed to save",error.Message);});}else{preValueSourceResource.save($scope.preValueSource).then(function(response){$scope.preValueSource=response.data;editorState.set($scope.preValueSource);setTypeAndSettings();getPrevalues();$scope.preValueSourceForm.$dirty=false;navigationService.syncTree({tree:"prevaluesource",path:[String($scope.preValueSource.id)],forceReload:true});notificationsService.success("Prevaluesource saved","");},function(err){notificationsService.error("Prevaluesource failed to save","");});}},function(err){notificationsService.error("Prevaluesource failed to save","Please check if your settings are valid");});};var setTypeAndSettings=function(){$scope.preValueSource.$type=_.where($scope.types,{id:$scope.preValueSource.fieldPreValueSourceTypeId})[0];angular.forEach($scope.preValueSource.settings,function(setting){for(var key in $scope.preValueSource.settings){if($scope.preValueSource.settings.hasOwnProperty(key)){if(_.where($scope.preValueSource.$type.settings,{alias:key}).length>0){_.where($scope.preValueSource.$type.settings,{alias:key})[0].value=$scope.preValueSource.settings[key];}}}});};var getPrevalues=function(){preValueSourceResource.getPreValues($scope.preValueSource).then(function(response){$scope.prevalues=response.data;});};});angular.module("umbraco").controller("UmbracoForms.FormPickerController",function($scope,$http,formResource){function massageFormDataObject(form){var fields=[];var fieldSummary='';for(var pageIndex=0;pageIndex<form.pages.length;pageIndex++){for(var fieldsetIndex=0;fieldsetIndex<form.pages[pageIndex].fieldSets.length;fieldsetIndex++)
{for(var containerIndex=0;containerIndex<form.pages[pageIndex].fieldSets[fieldsetIndex].containers.length;containerIndex++)
{for(var fieldIndex=0;fieldIndex<form.pages[pageIndex].fieldSets[fieldsetIndex].containers[containerIndex].fields.length;fieldIndex++)
{var field=form.pages[pageIndex].fieldSets[fieldsetIndex].containers[containerIndex].fields[fieldIndex];fields.push(field);}}}}
var currentFieldItem=null;if(fields.length<=4){for(var i=0;i<fields.length;i++){currentFieldItem=fields[i];if(i!==fields.length-1){fieldSummary+=currentFieldItem.caption;if(i!==fields.length-2){fieldSummary+=', ';}}
else{fieldSummary+=' and '+currentFieldItem.caption;}}}
else{for(var x=0;x<4;x++){currentFieldItem=fields[x];fieldSummary+=currentFieldItem.caption;if(x!==fields.length-1){fieldSummary+=', ';}}
var countExtraFields=fields.length-4;fieldSummary+='and '+countExtraFields+' additional fields';}
var pages=form.pages.length;var summary=pages+' page form with '+fields.length+' fields';return{id:form.id,name:form.name,fields:fieldSummary,summary:summary,workflows:form.workflows.length};};$scope.loading=true;var selectedForm=null;formResource.getOverView().then(function(response){$scope.forms=response.data;$scope.loading=false;if($scope.model.value){selectedForm=_.where(response.data,{id:$scope.model.value});if(selectedForm.length===1){$scope.pickedFormName=selectedForm[0].name;}else{formResource.getByGuid($scope.model.value).then(function(response){var form=response.data;var formToPush=massageFormDataObject(form);$scope.forms.push(formToPush);});}}},function(err){$scope.error="An Error has occured while loading!";$scope.loading=false;});$scope.clear=function(){$scope.model.value=null;}});function dataSourceResource($http){var apiRoot="backoffice/UmbracoForms/DataSource/";return{getScaffold:function(template){return $http.get(apiRoot+"GetScaffold");},getByGuid:function(id){return $http.get(apiRoot+"GetByGuid?guid="+id);},deleteByGuid:function(id){return $http.delete(apiRoot+"DeleteByGuid?guid="+id);},save:function(preValueSource){return $http.post(apiRoot+"PostSave",preValueSource);},validateSettings:function(preValueSource){return $http.post(apiRoot+"ValidateSettings",preValueSource);},getAllDataSourceTypesWithSettings:function(){return $http.get(apiRoot+"GetAllDataSourceTypesWithSettings");}};}
angular.module('umbraco.resources').factory('dataSourceResource',dataSourceResource);function dataSourceWizardResource($http){var apiRoot="backoffice/UmbracoForms/DataSourceWizard/";return{getScaffold:function(id){return $http.get(apiRoot+"GetScaffold?guid="+id);},getAllFieldTypes:function(){return $http.get(apiRoot+"GetAllFieldTypes");},createForm:function(wizard){return $http.post(apiRoot+"CreateForm",wizard);}};}
angular.module('umbraco.resources').factory('dataSourceWizardResource',dataSourceWizardResource);function exportResource($http){var apiRoot="backoffice/UmbracoForms/Export/";return{getExportTypes:function(formId){return $http.get(apiRoot+"GetExportTypes?formId="+formId);},generateExport:function(config){return $http.post(apiRoot+"PostGenerateExport",config);},getExportUrl:function(formId,fileName){return apiRoot+"GetExport?formId="+formId+"&fileName="+fileName;},getExport:function(token){return $http.get(apiRoot+"GetExport?token="+token);}};}
angular.module('umbraco.resources').factory('exportResource',exportResource);function formResource($http){var apiRoot="backoffice/UmbracoForms/Form/";return{getScaffold:function(template){return $http.get(apiRoot+"GetScaffold?template="+template);},getScaffoldWithWorkflows:function(template){return $http.get(apiRoot+"GetScaffoldWithWorkflows?template="+template);},getAllTemplates:function(){return $http.get(apiRoot+"GetFormTemplates");},getOverView:function(){return $http.get(apiRoot+'GetOverView');},getByGuid:function(id){return $http.get(apiRoot+"GetByGuid?guid="+id);},getWithWorkflowsByGuid:function(id){return $http.get(apiRoot+"GetWithWorkflowsByGuid?guid="+id);},deleteByGuid:function(id){return $http.delete(apiRoot+"DeleteByGuid?guid="+id);},save:function(form){return $http.post(apiRoot+"PostSave",form);},saveWithWorkflows:function(formWithWorkflows){return $http.post(apiRoot+"SaveForm",formWithWorkflows);},getAllFieldTypes:function(){return $http.get(apiRoot+"GetAllFieldTypes");},getAllFieldTypesWithSettings:function(){return $http.get(apiRoot+"GetAllFieldTypesWithSettings");},getPrevalueSources:function(){return $http.get(apiRoot+"GetPrevalueSources");},copy:function(id,newFormName){return $http.post(apiRoot+"CopyForm",{guid:id,newName:newFormName});}};}
angular.module('umbraco.resources').factory('formResource',formResource);function licensingResource($http){var apiRoot="backoffice/UmbracoForms/Licensing/";return{getLicenseStatus:function(){return $http.get(apiRoot+"GetLicenseStatus");},getAvailableLicenses:function(config){return $http.post(apiRoot+"PostRetriveAvailableLicenses",config);},configureLicense:function(config){return $http.post(apiRoot+"PostConfigureLicense",config);}};}
angular.module('umbraco.resources').factory('licensingResource',licensingResource);function pickerResource($http){var apiRoot="backoffice/UmbracoForms/Picker/";return{getAllConnectionStrings:function(){return $http.get(apiRoot+"GetAllConnectionStrings");},getAllDataTypes:function(){return $http.get(apiRoot+"GetAllDataTypes");},getAllDocumentTypes:function(){return $http.get(apiRoot+"GetAllDocumentTypes");},getAllDocumentTypesWithAlias:function(){return $http.get(apiRoot+"GetAllDocumentTypesWithAlias");},getAllMediaTypes:function(){return $http.get(apiRoot+"GetAllMediaTypes");},getAllFields:function(formGuid){return $http.get(apiRoot+"GetAllFields?formGuid="+formGuid);},getAllProperties:function(doctypeAlias){return $http.get(apiRoot+"GetAllProperties?doctypeAlias="+doctypeAlias);}};}
angular.module('umbraco.resources').factory('pickerResource',pickerResource);function preValueSourceResource($http){var apiRoot="backoffice/UmbracoForms/PreValueSource/";return{getScaffold:function(template){return $http.get(apiRoot+"GetScaffold");},getByGuid:function(id){return $http.get(apiRoot+"GetByGuid?guid="+id);},deleteByGuid:function(id){return $http.delete(apiRoot+"DeleteByGuid?guid="+id);},save:function(preValueSource){return $http.post(apiRoot+"PostSave",preValueSource);},validateSettings:function(preValueSource){return $http.post(apiRoot+"ValidateSettings",preValueSource);},getPreValues:function(preValueSource){return $http.post(apiRoot+"GetPreValues",preValueSource);},getPreValuesByGuid:function(preValueSourceId){return $http.get(apiRoot+"GetPreValuesByGuid?preValueSourceId="+preValueSourceId);},getAllPreValueSourceTypesWithSettings:function(){return $http.get(apiRoot+"GetAllPreValueSourceTypesWithSettings");}};}
angular.module('umbraco.resources').factory('preValueSourceResource',preValueSourceResource);function recordResource($http){var apiRoot="backoffice/UmbracoForms/Record/";return{getRecords:function(filter){return $http.post(apiRoot+"PostRetriveRecords",filter);},getRecordsCount:function(filter){return $http.post(apiRoot+"PostRetriveRecordsCount",filter);},getRecordActions:function(){return $http.get(apiRoot+"GetRecordActions");},getRecordSetActions:function(){return $http.get(apiRoot+"GetRecordSetActions");},executeRecordSetAction:function(model){return $http.post(apiRoot+"PostExecuteRecordSetAction",model);}};}
angular.module('umbraco.resources').factory('recordResource',recordResource);function securityResource($http){var apiRoot="backoffice/UmbracoForms/FormSecurity/";return{getByUserId:function(userId){return $http.get(apiRoot+"GetByUserId?userId="+userId);},save:function(userSecurity){return $http.post(apiRoot+"PostSave",userSecurity);}};}
angular.module('umbraco.resources').factory('securityResource',securityResource);function updatesResource($http){var apiRoot="backoffice/UmbracoForms/Updates/";return{getUpdateStatus:function(){return $http.get(apiRoot+"GetUpdateStatus");},installLatest:function(version){return $http.get(apiRoot+"InstallLatest?version="+version);},getVersion:function(){return $http.get(apiRoot+"GetVersion");}};}
angular.module('umbraco.resources').factory('updatesResource',updatesResource);function workflowResource($http){var apiRoot="backoffice/UmbracoForms/Workflow/";return{getScaffold:function(template){return $http.get(apiRoot+"GetScaffold");},getByGuid:function(id){return $http.get(apiRoot+"GetByGuid?guid="+id);},deleteByGuid:function(id){return $http.delete(apiRoot+"DeleteByGuid?guid="+id);},save:function(preValueSource){return $http.post(apiRoot+"PostSave",preValueSource);},validateSettings:function(preValueSource){return $http.post(apiRoot+"ValidateSettings",preValueSource);},getAllWorkflowTypesWithSettings:function(){return $http.get(apiRoot+"GetAllWorkflowTypesWithSettings");},getAllWorkflows:function(formGuid){return $http.get(apiRoot+"GetAllWorkflows?formGuid="+formGuid);},updateSortOrder:function(state,workflowIds){var data={};data.state=state;data.guids=workflowIds;return $http.post(apiRoot+"UpdateSortOrder",data);},getScaffoldWorkflowType:function(workflowTypeId){return $http.get(apiRoot+"GetScaffoldWorkflowType?workflowTypeId="+workflowTypeId);},validateWorkflowSettings:function(workflowViewModel){return $http.post(apiRoot+"ValidateWorkflowSettings",workflowViewModel);}};}
angular.module('umbraco.resources').factory('workflowResource',workflowResource);angular.module("umbraco.directives").directive('umbFormsAutoFocus',function($timeout){return function(scope,element,attr){var update=function(){if(element.val().indexOf(" field")>=0){element.focus();}};$timeout(function(){update();});scope.$watch(attr.umbFormsFocusOn,function(_focusVal){$timeout(function(){if(_focusVal){element.focus();element.select();update();}});});};});angular.module("umbraco.directives").directive('umbFormsAutoSize',function($timeout){return function(scope,element,attr){var domEl=element[0];var update=function(force){if(force===true){element.height(0);}
if(domEl.scrollHeight!==domEl.clientHeight){element.height(domEl.scrollHeight);}};element.bind('keyup keydown keypress change',update);element.bind('blur',function(){update(true);});$timeout(function(){update();});};});angular.module("umbraco.directives").directive('umbFormsContentPicker',function(dialogService,entityResource,iconHelper){return{restrict:'E',replace:true,templateUrl:'/App_Plugins/UmbracoForms/directives/umb-forms-content-picker.html',require:"ngModel",link:function(scope,element,attr,ctrl){ctrl.$render=function(){var val=parseInt(ctrl.$viewValue);if(!isNaN(val)&&angular.isNumber(val)&&val>0){entityResource.getById(val,"Document").then(function(item){item.icon=iconHelper.convertFromLegacyIcon(item.icon);scope.node=item;});}};scope.openContentPicker=function(){scope.contentPickerOverlay={view:"contentpicker",show:true,submit:function(model){populate(model.selection[0]);scope.contentPickerOverlay.show=false;scope.contentPickerOverlay=null;}};};scope.clear=function(){scope.id=undefined;scope.node=undefined;updateModel(0);};function populate(item){scope.clear();item.icon=iconHelper.convertFromLegacyIcon(item.icon);scope.node=item;scope.id=item.id;updateModel(item.id);}
function updateModel(id){ctrl.$setViewValue(id);}}};});angular.module("umbraco.directives").directive('umbFormsDateRangePicker',function(assetsService,userService){return{restrict:'A',scope:{userLocale:"@",onChange:"="},template:'<div class="daterange daterange--double"></div>',link:function(scope,element){assetsService.load(["/App_Plugins/UmbracoForms/Assets/moment/min/moment-with-locales.min.js","/App_Plugins/UmbracoForms/Assets/BaremetricsCalendar/public/js/calendar.js"]).then(function(){moment.locale(scope.userLocale);var dd=new Calendar({element:$(".daterange--double"),earliest_date:'January 1, 2000',latest_date:moment(),start_date:moment().subtract(29,'days'),end_date:moment(),same_day_range:true,callback:function(){var start=moment(this.start_date);var end=moment(this.end_date);var dateFilter={};dateFilter.startDate=start.format('YYYY-MM-DD');dateFilter.endDate=end.format('YYYY-MM-DD');if(scope.onChange){scope.onChange(dateFilter);}}});});assetsService.loadCss("/App_Plugins/UmbracoForms/Assets/BaremetricsCalendar/public/css/application.css");}};});angular.module("umbraco.directives").directive('ufDelayedMouseleave',function($timeout,$parse){return{restrict:'A',link:function(scope,element,attrs,ctrl){var active=false;var fn=$parse(attrs.ufDelayedMouseleave);element.on("mouseleave",function(event){var callback=function(){fn(scope,{$event:event});};active=false;$timeout(function(){if(active===false){scope.$apply(callback);}},650);});element.on("mouseenter",function(event,args){active=true;});}};});angular.module("umbraco.directives").directive('umbFormsDesigner',function(dialogService,formService){return{scope:{form:"=",fieldtypes:"=",prevaluesources:"="},transclude:true,restrict:'E',replace:true,templateUrl:'/App_Plugins/UmbracoForms/directives/umb-forms-designer.html',link:function(scope,element,attrs,ctrl){scope.initForm=function(form,fieldtypes){formService.initForm(form,fieldtypes);scope.gotoPageIndex(0);};scope.gotoPageIndex=function(index){scope.form.$currentPage=scope.form.pages[index];scope.currentPageIndex=index;scope.onFirstPage=scope.currentPageIndex===0;scope.onLastPage=scope.currentPageIndex===scope.form.pages.length-1;};scope.addPage=function(form){scope.closeItemOverlay();formService.addPage(form);scope.gotoPageIndex(form.pages.length-1);};scope.deletePage=function(page){var index=scope.form.pages.indexOf(page);scope.form.pages.splice(index,1);if(index>0){scope.currentPageIndex=index-1;scope.form.$currentPage=scope.form.pages[index-1];}else{scope.currentPageIndex=0;scope.form.$currentPage=scope.form.pages[0];}
scope.onFirstPage=scope.currentPageIndex===0;scope.onLastPage=scope.currentPageIndex===scope.form.pages.length-1;populateFields();};scope.setCurrentFieldset=function(fieldset){scope.currentFieldset=fieldset;};scope.addFieldset=function(page,fieldset,container,index){scope.closeItemOverlay();var _index=page.fieldSets.indexOf(fieldset);formService.addFieldset(page,_index+1);};scope.deleteFieldset=function(page,fieldset){formService.deleteFieldset(page,fieldset);};scope.editFieldset=function(fieldset){populateFields();dialogService.open({template:"/app_plugins/UmbracoForms/Backoffice/Form/dialogs/fieldsetsettings.html",fieldset:fieldset,fields:scope.fields});};scope.addContainer=function(fieldset,container,index){scope.closeItemOverlay();var _index=fieldset.containers.indexOf(container);formService.splitContainer(fieldset,container,_index+1);};scope.initField=function(field){if(field&&!field.$fieldType){formService.setFieldType(field,field.fieldTypeId);}};scope.addField=function(container,fieldtype,index){scope.closeItemOverlay();formService.addField(container,fieldtype,index+1);};scope.editField=function(field){populateFields();scope.setFieldType(field);dialogService.open({template:"/app_plugins/UmbracoForms/Backoffice/Form/dialogs/fieldsettings.html",field:field,fields:scope.fields,setFieldType:formService.setFieldType,fieldtypes:scope.fieldtypes,prevaluesources:scope.prevaluesources});};scope.deleteField=function(fieldset,container,field){formService.deleteField(fieldset,container,field);};scope.copyField=function(container,field){var copy={};angular.copy(field,copy);copy.id=generateGUID();copy.caption="copy of "+copy.caption;container.fields.splice(container.fields.indexOf(field)+1,0,copy);populateFields();};scope.setFieldType=function(field){angular.forEach(field.settings,function(setting){for(var key in field.settings){if(field.settings.hasOwnProperty(key)){if(_.where(field.$fieldType.settings,{alias:key}).length>0){_.where(field.$fieldType.settings,{alias:key})[0].value=field.settings[key];}}}});};scope.setCurrentControl=function(field){scope.currentControl=field;};scope.setCurrentToolsControl=function(field){scope.currentToolsControl=field;};scope.setCurrentRemoveControl=function(Control){scope.currentRemoveControl=Control;};scope.setCurrentMoveControl=function(Control){scope.currentMoveControl=Control;};scope.setCurrentContainer=function(container){scope.currentContainer=container;};scope.addConditionRule=function(condition){if(!condition.rules){condition.rules=[];}
condition.rules.push({field:condition.$newrule.field,operator:condition.$newrule.operator,value:condition.$newrule.value});condition.$newrule.field=null;condition.$newrule.operator=null;condition.$newrule.value=null;};scope.deleteFieldConditionRule=function(rules,rule){var index=rules.indexOf(rule);rules.splice(index,1);};scope.fieldSetSortableOptions={distance:10,cursor:"move",placeholder:'ui-sortable-placeholder',handle:'.cell-tools-move',connectWith:".umb-forms-fieldsets"};scope.fieldSortableOptions={distance:10,cursor:"move",placeholder:'ui-sortable-placeholder',handle:'.cell-tools-move',connectWith:".umb-forms-fields-container"};scope.overlayMenu={show:false,style:{},container:undefined,fieldset:undefined};scope.addItemOverlay=function(sender,field,fieldset,container,index){scope.overlayMenu.container=container;scope.overlayMenu.fieldset=fieldset;scope.overlayMenu.index=index;scope.overlayMenu.style={};scope.overlayMenu.field=field;var offset=$(sender.target).offset();var height=$(window).height();var width=$(window).width();if((height-offset.top)<250){scope.overlayMenu.style.bottom=0;scope.overlayMenu.style.top="initial";}else if(offset.top<300){scope.overlayMenu.style.top=190;}
scope.overlayMenu.show=true;};scope.closeItemOverlay=function(){scope.overlayMenu.show=false;scope.overlayMenu.field=undefined;};scope.adjustSize=function(ev){if(ev.target.scrollHeight>ev.target.clientHeight){$(ev.target).height(ev.target.scrollHeight);}};scope.editForm=function(form,section){dialogService.closeAll();dialogService.open({template:"/app_plugins/UmbracoForms/Backoffice/Form/dialogs/formsettings.html",form:form,section:section,page:scope.currentPage});};var populateFields=function(){scope.fields=[];angular.forEach(scope.form.pages,function(page){angular.forEach(page.fieldSets,function(fieldset){angular.forEach(fieldset.containers,function(container){angular.forEach(container.fields,function(field){scope.fields.push(field);});});});});};scope.initForm(scope.form,scope.fieldtypes);}};});angular.module("umbraco.directives").directive('umbFormsDesignerNew',function(dialogService,formService,workflowResource,notificationsService){return{scope:{form:"=",fieldtypes:"=",prevaluesources:"=",security:"="},transclude:true,restrict:'E',replace:true,templateUrl:'/App_Plugins/UmbracoForms/directives/umb-forms-designer-new.html',link:function(scope,element,attrs,ctrl){scope.sortingMode=false;scope.sortingButtonKey="general_reorder";scope.sortablePages={distance:10,tolerance:"pointer",opacity:0.7,scroll:true,cursor:"move",placeholder:"umb-forms__page-placeholder",zIndex:6000,handle:".sortable-handle",items:".sortable",start:function(e,ui){ui.placeholder.height(ui.item.height());}};scope.sortableFieldsets={distance:10,tolerance:"pointer",connectWith:".umb-forms__fieldsets",opacity:0.7,scroll:true,cursor:"move",placeholder:"umb-forms__fieldset-placeholder",zIndex:6000,handle:".sortable-handle",items:".sortable",start:function(e,ui){ui.placeholder.height(ui.item.height());},over:function(e,ui){scope.$apply(function(){$(e.target).scope().page.dropOnEmpty=true;});},out:function(e,ui){scope.$apply(function(){$(e.target).scope().page.dropOnEmpty=false;});}};scope.sortableFields={distance:10,tolerance:"pointer",connectWith:".umb-forms__fields",opacity:0.7,scroll:true,cursor:"move",placeholder:"umb-forms__field-placeholder",zIndex:6000,handle:".sortable-handle",items:".sortable",start:function(e,ui){ui.placeholder.height(ui.item.height());},over:function(e,ui){scope.$apply(function(){$(e.target).scope().container.dropOnEmpty=true;});},out:function(e,ui){scope.$apply(function(){$(e.target).scope().container.dropOnEmpty=false;});}};scope.toggleSortingMode=function(){scope.sortingMode=!scope.sortingMode;if(scope.sortingMode){scope.sortingButtonKey="general_reorderDone";}else{scope.sortingButtonKey="general_reorder";}};scope.initForm=function(form,fieldtypes){formService.initForm(form,fieldtypes);};scope.togglePrompt=function(object){object.deletePrompt=!object.deletePrompt;};scope.hidePrompt=function(object){object.deletePrompt=false;};scope.addPage=function(form){formService.addPage(form);};scope.removePage=function(pages,index){pages.splice(index,1);};scope.formHasFields=function(form){var hasFields=false;angular.forEach(scope.form.pages,function(page){angular.forEach(page.fieldSets,function(fieldset){angular.forEach(fieldset.containers,function(container){if(container.fields.length>0){hasFields=true;}});});});return hasFields;};scope.pageHasFields=function(page){var hasFields=false;angular.forEach(page.fieldSets,function(fieldset){angular.forEach(fieldset.containers,function(container){if(container.fields.length>0){hasFields=true;}});});return hasFields;};scope.addFieldset=function(page){var _index=page.fieldSets.length;formService.addFieldset(page,_index);};scope.removeFieldset=function(page,fieldset){formService.deleteFieldset(page,fieldset);};scope.editFieldset=function(fieldset){populateFields();scope.fieldsetSettingsOverlay={view:"/app_plugins/UmbracoForms/Backoffice/Form/overlays/fieldsetsettings/fieldset-settings.html",title:"Edit group",fieldset:fieldset,fields:scope.fields,closeButtonLabel:"Cancel",show:true,submit:function(model){scope.fieldsetSettingsOverlay.show=false;scope.fieldsetSettingsOverlay=null;},close:function(oldModel){fieldset.containers=oldModel.fieldset.containers;fieldset.condition=oldModel.fieldset.condition;scope.fieldsetSettingsOverlay.show=false;scope.fieldsetSettingsOverlay=null;}};};scope.addField=function(fieldset,container){populateFields();var emptyField=formService.addEmptyField(container);scope.fieldSettingsOverlay={view:"/app_plugins/UmbracoForms/Backoffice/Form/overlays/fieldsettings/field-settings.html",title:"Add question",field:emptyField,fields:scope.fields,prevalueSources:scope.prevaluesources,show:true,submit:function(model){emptyField.settings={};for(var i=0;i<model.field.$fieldType.settings.length;i++){var setting=model.field.$fieldType.settings[i];var key=setting.alias;var value=setting.value;emptyField.settings[key]=value;}
scope.fieldSettingsOverlay.show=false;scope.fieldSettingsOverlay=null;},close:function(oldModel){formService.deleteField(fieldset,container,emptyField);scope.fieldSettingsOverlay.show=false;scope.fieldSettingsOverlay=null;}};};scope.openFieldSettings=function(field){populateFields();scope.setFieldType(field);scope.fieldSettingsOverlay={view:"/app_plugins/UmbracoForms/Backoffice/Form/overlays/fieldsettings/field-settings.html",title:"Edit question",field:field,fields:scope.fields,prevalueSources:scope.prevaluesources,show:true,submit:function(model){field.settings={};for(var i=0;i<model.field.$fieldType.settings.length;i++){var setting=model.field.$fieldType.settings[i];var key=setting.alias;var value=setting.value;field.settings[key]=value;}
scope.fieldSettingsOverlay.show=false;scope.fieldSettingsOverlay=null;}};};scope.removeField=function(fieldset,container,field){formService.deleteField(fieldset,container,field);};scope.setFieldType=function(field){angular.forEach(field.settings,function(setting){for(var key in field.settings){if(field.settings.hasOwnProperty(key)){if(_.where(field.$fieldType.settings,{alias:key}).length>0){_.where(field.$fieldType.settings,{alias:key})[0].value=field.settings[key];}}}});};scope.getFieldNameFromGuid=function(selectedFieldId){populateFields();for(var i=0;i<scope.fields.length;i++){var field=scope.fields[i];if(field.id===selectedFieldId){return field.caption;}}};scope.editWorkflows=function(){if(scope.security&&scope.security.userSecurity.manageWorkflows){populateFields();scope.workflowsOverlay={view:"/app_plugins/UmbracoForms/Backoffice/Form/overlays/workflows/workflows-overview.html",title:"Workflows",formWorkflows:scope.form.formWorkflows,messageOnSubmit:scope.form.messageOnSubmit,goToPageOnSubmit:scope.form.goToPageOnSubmit,submitLabel:scope.form.submitLabel,manualApproval:scope.form.manualApproval,fields:scope.fields,closeButtonLabel:"Cancel",show:true,submit:function(model){scope.form.formWorkflows=model.formWorkflows;scope.form.messageOnSubmit=model.messageOnSubmit;scope.form.goToPageOnSubmit=model.goToPageOnSubmit;scope.workflowsOverlay.show=false;scope.workflowsOverlay=null;},close:function(oldModel){scope.form.formWorkflows=oldModel.formWorkflows;scope.form.messageOnSubmit=oldModel.messageOnSubmit;scope.form.goToPageOnSubmit=oldModel.goToPageOnSubmit;scope.workflowsOverlay.show=false;scope.workflowsOverlay=null;}};}};scope.editWorkflowSettings=function(workflow){if(scope.security&&scope.security.userSecurity.manageWorkflows){populateFields();scope.workflowSettingsOverlay={view:"/app_plugins/UmbracoForms/Backoffice/Form/overlays/workflows/workflow-settings.html",workflow:workflow,fields:scope.fields,title:workflow.name,show:true,submit:function(model){workflowResource.validateWorkflowSettings(model.workflow).then(function(response){if(response.data.length>0){angular.forEach(response.data,function(error){notificationsService.error("Workflow failed to save",error.Message);});}else{scope.workflowSettingsOverlay.show=false;scope.workflowSettingsOverlay=null;}});}};}};scope.editSubmitMessageWorkflow=function(){scope.submitMessageWorkflowOverlay={view:"/app_plugins/UmbracoForms/Backoffice/Form/overlays/workflows/submit-message-workflow-settings.html",title:"Message on submit",messageOnSubmit:scope.form.messageOnSubmit,goToPageOnSubmit:scope.form.goToPageOnSubmit,show:true,submit:function(model){scope.form.messageOnSubmit=model.messageOnSubmit;scope.form.goToPageOnSubmit=model.goToPageOnSubmit;scope.submitMessageWorkflowOverlay.show=false;scope.submitMessageWorkflowOverlay=null;}};};var populateFields=function(){scope.fields=[];angular.forEach(scope.form.pages,function(page){angular.forEach(page.fieldSets,function(fieldset){angular.forEach(fieldset.containers,function(container){angular.forEach(container.fields,function(field){scope.fields.push(field);});});});});};scope.initForm(scope.form,scope.fieldtypes);}};});(function(){'use strict';function FormsEntryDetail(){function link(scope,el,attr,ctrl){}
var directive={restrict:'E',replace:true,templateUrl:'/App_Plugins/UmbracoForms/directives/umb-forms-entry-detail.html',scope:{entry:'='},link:link};return directive;}
angular.module('umbraco.directives').directive('umbFormsEntryDetail',FormsEntryDetail);})();angular.module("umbraco.directives").directive('umbFormsInlinePrevalueEditor',function(notificationsService){return{restrict:'E',replace:true,templateUrl:'/App_Plugins/UmbracoForms/directives/umb-forms-inline-prevalue-editor.html',require:"ngModel",link:function(scope,element,attr,ctrl){scope.prevalues=[];ctrl.$render=function(){if(Object.prototype.toString.call(ctrl.$viewValue)==='[object Array]'){scope.prevalues=ctrl.$viewValue;}};function updateModel(){ctrl.$setViewValue(scope.prevalues);}
function addPrevalue(){if(scope.prevalues.indexOf(scope.newPrevalue)<0){scope.prevalues.push(scope.newPrevalue);scope.newPrevalue='';updateModel();}else{notificationsService.error("PreValue Error","Unable to add PreValue as this is a duplicate");}}
scope.addPrevalue=function(){addPrevalue();};}};});angular.module("umbraco.directives").directive('umbFormsOverlay',function(){return{restrict:'A',link:function(scope,el,attrs,ctrl){var margin=50,winHeight=$(window).height(),calculate=_.throttle(function(){if(el){var bottom_dif=(el.offset().top+el.height()+margin)-winHeight;if(bottom_dif>0){$(el).css('margin-top',function(index,curValue){return parseInt(curValue,10)-bottom_dif+'px';});}else{}}},1000);$(window).bind("resize",function(){winHeight=$(window).height();calculate();});}};});angular.module("umbraco.directives").directive('umbFormsPrevalueEditor',function(notificationsService){return{restrict:'E',replace:true,templateUrl:'/App_Plugins/UmbracoForms/directives/umb-forms-prevalue-editor.html',require:"ngModel",link:function(scope,element,attr,ctrl){scope.prevalues=[];ctrl.$render=function(){if(Object.prototype.toString.call(ctrl.$viewValue)==='[object Array]'){scope.prevalues=ctrl.$viewValue;}};function updateModel(){ctrl.$setViewValue(scope.prevalues);}
scope.deletePrevalue=function(idx){scope.prevalues.splice(idx,1);updateModel();};scope.addPrevalue=function(){if(scope.prevalues.indexOf(scope.newPrevalue)<0){scope.prevalues.push(scope.newPrevalue);scope.newPrevalue='';updateModel();}else{notificationsService.error("PreValue Error","Unable to add PreValue as this is a duplicate");}};}};});(function(){'use strict';function FormsRenderType(){var directive={restrict:'E',replace:true,templateUrl:'/App_Plugins/UmbracoForms/directives/umb-forms-render-type.html',scope:{view:"=",field:'='}};return directive;}
angular.module('umbraco.directives').directive('umbFormsRenderType',FormsRenderType);})();function formService(preValueSourceResource){var generateGUID=function(){var d=new Date().getTime();var uuid='xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(c){var r=(d+Math.random()*16)%16|0;d=Math.floor(d/16);return(c==='x'?r:(r&0x7|0x8)).toString(16);});return uuid;};var service={fieldTypes:[],actionTypes:[{name:"show",value:"Show"},{name:"hide",value:"Hide"}],logicTypes:[{name:"all",value:"All"},{name:"any",value:"Any"}],operators:[{name:"is",value:"Is"},{name:"is not",value:"IsNot"},{name:"is greater than",value:"GreaterThen"},{name:"is less than",value:"LessThen"},{name:"contains",value:"Contains"},{name:"starts with",value:"StartsWith"},{name:"ends with",value:"EndsWith"}],getActionTypes:function(){return service.actionTypes;},getLogicTypes:function(){return service.logicTypes;},getOperators:function(){return service.operators;},initForm:function(form,fieldtypes){service.fieldTypes=fieldtypes;if(!form.pages||form.pages.length===0){service.addPage(form);}else{_.each(service.getAllFields(form),function(field){if(!field.$fieldType){service.setFieldType(field,field.fieldTypeId);}});}},addPage:function(form,index){var p={caption:"",fieldSets:[]};service.addFieldset(p);if(form.pages.length>index){form.pages.splice(index,0,p);}else{form.pages.push(p);}},addFieldset:function(page,index){var fs={caption:"",containers:[],id:generateGUID()};service.addContainer(fs);if(page.fieldSets.length>index){page.fieldSets.splice(index,0,fs);}else{page.fieldSets.push(fs);}},deleteFieldset:function(page,fieldset){if(page.fieldSets.length>1){var index=page.fieldSets.indexOf(fieldset);page.fieldSets.splice(index,1);}else{fieldset.containers.length=0;service.addContainer(fieldset);}},deleteFieldsetAtIndex:function(page,index){if(page.fieldSets.length>1){page.fieldSets.splice(index,1);}else{fieldset.containers.length=0;service.addContainer(fieldset);}},splitFieldset:function(page,fieldset,container,splitAtIndex){var newfieldset={caption:"",containers:[{caption:"",fields:[]}]};var insertAt=page.fieldSets.indexOf(fieldset);page.fieldSets.splice(insertAt+1,0,newfieldset);var oldFields=container.fields.slice(0,splitAtIndex+1);var newFields=container.fields.slice(splitAtIndex+1);newfieldset.containers[0].fields=newFields;container.fields=oldFields;},addContainer:function(fieldset,index){var c={caption:"",fields:[]};if(fieldset.containers.length>index){fieldset.containers.splice(index,0,c);}else{fieldset.containers.push(c);}},splitContainer:function(fieldset,container,splitAtIndex){var newContainer={caption:"",fields:[]};var insertAt=fieldset.containers.indexOf(container);fieldset.containers.splice(insertAt-1,0,newContainer);var newFields=container.fields.slice(0,splitAtIndex+1);var oldFields=container.fields.slice(splitAtIndex+1);newContainer.fields=newFields;container.fields=oldFields;},deleteContainer:function(fieldset,container){if(fieldset.containers.length>1){var index=fieldset.containers.indexOf(container);if(index>=0){service.deleteContainerAtIndex(fieldset,index);}}else{container.fields.length=0;}},deleteContainerAtIndex:function(fieldset,index){if(fieldset.containers.length>1){fieldset.containers.splice(index,1);}else{fieldset.containers.length=0;}},syncContainerWidths:function(form){_.each(form.pages,function(page){_.each(page.fieldSets,function(fieldset){var containers=fieldset.containers.length;var avrg=Math.floor(12/containers);_.each(fieldset.containers,function(container){container.width=avrg;});});});},addField:function(container,fieldtype,index){var newField={caption:"",id:generateGUID(),settings:{},preValues:[],$focus:true};service.loadFieldTypeSettings(newField,fieldtype);if(container.fields.length>index){container.fields.splice(index,0,newField);}else{container.fields.push(newField);}},addEmptyField:function(container){var newField={caption:"",id:generateGUID(),settings:{},preValues:[],$focus:true};container.fields.push(newField);return newField;},getAllFields:function(form){var fields=[];if(form.pages){_.each(form.pages,function(page){if(page.fieldSets){_.each(page.fieldSets,function(fieldset){if(fieldset.containers){_.each(fieldset.containers,function(container){if(container.fields){_.each(container.fields,function(field){fields.push(field);});}});}});}});}
return fields;},deleteField:function(fieldset,container,field){var index=container.fields.indexOf(field);if(index>=0){service.deleteFieldAtIndex(fieldset,container,index);}},deleteFieldAtIndex:function(fieldset,container,index){container.fields.splice(index,1);if(container.fields.length===0){service.deleteContainer(fieldset,container);}},setFieldType:function(field,fieldTypeId){field.fieldTypeId=fieldTypeId;var fldt=_.find(service.fieldTypes,function(ft){return ft.id===field.fieldTypeId;});field.$fieldType=fldt;service.loadFieldTypeSettings(field,field.$fieldType);service.loadFieldTypePrevalues(field);},loadFieldTypePrevalues:function(field){if(field.prevalueSourceId!==null&&field.prevalueSourceId!=="00000000-0000-0000-0000-000000000000"){preValueSourceResource.getPreValuesByGuid(field.prevalueSourceId).then(function(response){field.$preValues=response.data;});}else{field.$preValues=null;}},loadFieldTypeSettings:function(field,fieldtype){var stng=angular.copy(fieldtype.settings);if(field.fieldTypeId!==fieldtype.id){field.settings={};}
field.fieldTypeId=fieldtype.id;field.$fieldType=fieldtype;if(fieldtype.settings){_.each(fieldtype.settings,function(setting){if(!field.settings[setting.alias]){field.settings[setting.alias]="";}});}},deleteConditionRule:function(rules,rule){var index=rules.indexOf(rule);rules.splice(index,1);},addConditionRule:function(condition){if(!condition.rules){condition.rules=[];}
condition.rules.push({field:condition.$newrule.field,operator:condition.$newrule.operator,value:condition.$newrule.value});},addEmptyConditionRule:function(condition){if(!condition.rules){condition.rules=[];}
condition.rules.push({field:"",operator:"",value:""});},populateConditionRulePrevalues:function(selectedField,rule,fields){for(var i=0;i<fields.length;i++){var field=fields[i];if(field.id===selectedField){if(field.$preValues&&field.$preValues.length>0){rule.$preValues=field.$preValues;}else if(field.preValues&&field.preValues.length>0){var rulePreValuesObjectArray=[];for(var preValueIndex=0;preValueIndex<field.preValues.length;preValueIndex++){var preValue=field.preValues[preValueIndex];var preValueObject={value:preValue};rulePreValuesObjectArray.push(preValueObject);}
rule.$preValues=rulePreValuesObjectArray;}else{rule.$preValues=null;}}}}};return service;}
angular.module('umbraco.services').factory('formService',formService);(function(){'use strict';function utilityService(){function compareVersions(v1,v2,options){var lexicographical=options&&options.lexicographical,zeroExtend=options&&options.zeroExtend,v1parts=v1.split('.'),v2parts=v2.split('.');function isValidPart(x){return(lexicographical?/^\d+[A-Za-z]*$/:/^\d+$/).test(x);}
if(!v1parts.every(isValidPart)||!v2parts.every(isValidPart)){return NaN;}
if(zeroExtend){while(v1parts.length<v2parts.length){v1parts.push("0");}
while(v2parts.length<v1parts.length){v2parts.push("0");}}
if(!lexicographical){v1parts=v1parts.map(Number);v2parts=v2parts.map(Number);}
for(var i=0;i<v1parts.length;++i){if(v2parts.length===i){return 1;}
if(v1parts[i]===v2parts[i]){continue;}else if(v1parts[i]>v2parts[i]){return 1;}else{return-1;}}
if(v1parts.length!==v2parts.length){return-1;}
return 0;}
var service={compareVersions:compareVersions};return service;}
angular.module('umbraco.services').factory('utilityService',utilityService);})();angular.module('umbraco.filters').filter('truncate',function(){return function(input,noOfChars,appendDots){if(input.length>noOfChars){input=input.substr(0,noOfChars);if(appendDots){input=input+"...";}}
return input;};}).filter('fileName',function(){return function(input){input=input.split('\\').pop().split('/').pop();return input;};});
;;;